{"version":3,"mappings":"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","names":["getTranslation","key","categories","icon","Settings","description","color","bgColor","borderColor","Globe","Palette","ThemeInfo","theme","setTheme","useTheme","isAnimating","setIsAnimating","useState","useEffect","timer","setTimeout","clearTimeout","jsxs","className","children","jsx","Badge","variant","value","Sun","label","Moon","Laptop","map","Icon","Button","size","onClick","handleThemeChange","newTheme","SidebarMenu","activeCategory","onCategoryChange","isMobileSidebarOpen","setIsMobileSidebarOpen","Card","CardContent","category","isActive","handleCategoryClick","categoryKey","ChevronRight","PlaceholderSettings","title","GeneralSettings","setActiveCategory","isLoading","setIsLoading","isMobile","useIsMobile","navigate","useNavigate","hasAccess","useAppSettingsAccess","PageLayout","keywords","GeneralSettingsComponent","SEOSettings","BrandingSettings","renderSettingsComponent","Lock","AccountSettings","translate","useApp","toast","useToast","CardHeader","CardTitle","CardDescription","Label","htmlFor","Input","id","defaultValue","type","CardFooter","NotificationSettings","Switch","defaultChecked","AppearanceSettings","ThemeSelector","LanguageManager","language","setLanguage","isMultiLanguageEnabled","setMultiLanguageEnabled","currentUser","availableLanguages","setAvailableLanguages","languageNames","isAdmin","role","activeTab","setActiveTab","searchQuery","setSearchQuery","isAddLanguageDialogOpen","setIsAddLanguageDialogOpen","languageStatusList","setLanguageStatusList","Object","entries","code","name","langCode","enabled","includes","isDefault","enabledLanguages","filter","lang","filteredLanguages","toLowerCase","Tabs","onValueChange","TabsList","TabsTrigger","TabsContent","checked","onCheckedChange","disabled","Fragment","ToggleLeft","Alert","AlertCircle","AlertTitle","AlertDescription","LanguageSelector","forceShow","Plus","length","Search","placeholder","onChange","e","target","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","languageCode","prev","handleLanguageToggle","Trash2","colSpan","AddLanguageDialog","open","onClose","onAddLanguage","some","newLanguage","existingLanguageCodes","ApiSettings","hasPermission","showApiKey","setShowApiKey","settings","appSettings","useApplicationSettings","sb","supabase","adminSb","adminSupabase","apis","setApis","loadingAPIs","setLoadingAPIs","openModal","setOpenModal","editingApiId","setEditingApiId","savingApi","setSavingApi","testingApiId","setTestingApiId","testingSmartId","setTestingSmartId","deletingApiId","setDeletingApiId","modalShowKey","setModalShowKey","form","setForm","provider_name","base_url","api_key","status","model_name","temperature","max_tokens","priority","daily_limit","requests_per_minute_limit","tokens_per_minute_limit","requests_per_day_limit","editingApi","useMemo","find","a","testPromptMap","setTestPromptMap","modelOverrideMap","setModelOverrideMap","testResponseMap","setTestResponseMap","responseDialogOpen","setResponseDialogOpen","activeResponseProviderId","setActiveResponseProviderId","aiListFilter","setAiListFilter","testMetaMap","setTestMetaMap","selectedProviderId","setSelectedProviderId","usageLogs","setUsageLogs","loadingLogs","setLoadingLogs","providerFilter","setProviderFilter","statusFilter","setStatusFilter","dateFrom","setDateFrom","dateTo","setDateTo","selectedLog","setSelectedLog","logsPage","setLogsPage","logsPageSize","setLogsPageSize","logsTotal","setLogsTotal","modelLimits","setModelLimits","smtpHost","setSmtpHost","smtpPort","setSmtpPort","smtpSecure","setSmtpSecure","smtpUser","setSmtpUser","smtpPassword","setSmtpPassword","fromEmail","setFromEmail","fromName","setFromName","showPassword","setShowPassword","testEmail","setTestEmail","previewUrl","setPreviewUrl","saving","setSaving","sending","setSending","async","fetchAPIs","data","error","from","select","order","ascending","message","fetchModelLimits","fetchUsageLogs","Math","max","to","query","count","range","gte","Date","toISOString","end","setHours","lte","eq","isGemini","api","url","String","cfg","loadSMTPConfig","smtp_host","smtp_port","Boolean","smtp_secure","smtp_user","smtp_password","from_email","from_name","ch1","channel","on","event","schema","table","payload","new","subscribe","ch2","ch3","removeChannel","providerNames","Array","Set","allowedProviders","base","filteredLogs","namesSet","log","nameOk","has","providerOk","search","trim","searchOk","endpoint","overviewMetrics","Map","set","requests","avgMs","errors","sums","cur","get","rt","Number","response_time","status_code","totalRt","monitorMetrics","byProvider","total","success","times","m","response_time_ms","isNaN","push","rows","avg","reduce","b","sorted","slice","sort","idx","floor","p95","successRate","round","p95Ms","trendData","counts","d","created_at","getFullYear","getMonth","padStart","getDate","localeCompare","date","googleApis","currentMonthStart","now","googleRateLimitRows","monthLogs","isGoogle","createdIso","timestamp","createdAt","logsByProvider","pn","providerName","providerLogs","minuteCounts","minuteTokenCounts","dayCounts","minuteKey","getHours","getMinutes","dayKey","tokens","total_tokens","prompt_tokens","completion_tokens","peakRPM","values","v","peakRPD","peakTPM","limitsMatch","l","latest","model","deriveCategory","rpmLimitNum","rpm_unlimited","rpm_limit","rpdLimitNum","rpd_unlimited","rpd_limit","tpmLimitNum","tpm_limit","rpm","tpm","rpd","warnThreshold","warn_threshold_percent","rpmUtilPct","rpdUtilPct","tpmUtilPct","rpmUtil","rpdUtil","tpmUtil","warn","provider","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","usage_count","last_tested","toLocaleString","update","toggleStatus","listStatus","listMs","toFixed","genStatus","genMs","promptOverride","modelOverride","replace","listUrl","listInit","method","encodeURIComponent","headers","Authorization","listStart","performance","listOk","listTime","listRes","fetch","ok","insert","genSnippet","genTime","promptText","genUrl","genStart","genRes","body","JSON","stringify","contents","parts","text","json","candidates","content","prompt","answer","useModel","messages","choices","errData","descParts","join","err","testConnection","res","Error","next","editAPI","delete","deleteAPI","Dialog","onOpenChange","DialogContent","DialogHeader","DialogTitle","DialogDescription","Textarea","readOnly","DialogFooter","navigator","clipboard","writeText","csv","r","blob","Blob","URL","createObjectURL","document","createElement","href","download","click","revokeObjectURL","exportCsvOverview","exportCsvLogs","mod","__vitePreload","import","__VITE_PRELOAD__","doc","jsPDF","default","setFontSize","y","addPage","save","exportPdfOverview","metrics","ceil","p","ResponsiveContainer","LineChart","margin","top","right","left","bottom","CartesianGrid","strokeDasharray","XAxis","dataKey","YAxis","allowDecimals","Tooltip","Legend","Line","BarChart","Bar","row","EyeOffIcon","EyeIcon","step","current_minute_requests","current_minute_tokens","current_day_requests","last_reset_minute","last_reset_day","client","isAdminClientConfigured","updated_at","insertPayload","fallback_reason","AccessControl","searchTerm","setSearchTerm","selectedCategory","setSelectedCategory","hasUnsavedChanges","setHasUnsavedChanges","rolePermissions","setRolePermissions","super_admin","manager","staff","agent","dashboardAccess","setDashboardAccess","dashboardId","allowedRoles","allowedDepartments","restrictByDepartment","allPermissions","defaultRoles","isSystemCritical","Users","Shield","roles","departments","filteredPermissions","permission","matchesSearch","matchesCategory","initialRolePermissions","forEach","Undo","localStorage","setItem","Save","AlertTriangle","BarChart3","permissionId","updatedPermissions","togglePermission","CheckCircle","dashboard","accessConfig","toggleDepartmentRestriction","toggleDashboardRoleAccess","department","toggleDashboardDepartmentAccess","Eye","Separator","AgentSettings","breadcrumbItems","ArrowLeft","FileText","DollarSign","AgentOperationsTab","DocumentManagementTab","PermissionsTab","CommissionManagementTab","PlatformIntegrationTab","TranslationTool","Languages","Book","LiveTranslator","PricingSettings","setSettings","defaultMarkupPercentage","useSlabPricing","markupSlabs","slabApplicationMode","showPricingToAgents","showPricingToStaff","allowStaffPricingEdit","enhancedSettings","setEnhancedSettings","countryRules","regionalTemplates","currencyConversion","baseCurrency","autoUpdateRates","updateFrequency","fallbackRates","conversionMargins","enableCountryBasedPricing","defaultCountry","popularDestinations","countries","setCountries","defaultCountryCode","setDefaultCountryCode","defaultConfigRow","setDefaultConfigRow","editingSlab","setEditingSlab","isCreating","setIsCreating","deletingSlabId","setDeletingSlabId","pricingSupabaseOk","setPricingSupabaseOk","pricingSupabaseTs","setPricingSupabaseTs","defaultCurrency","useCurrency","countryList","defaultConfig","Promise","all","CountriesService","listActiveCountries","PricingConfigurationService","getDefaultConfiguration","hydratedCountryCode","default_country","hydratedBaseCurrency","base_currency","mapped","toPricingSettings","toLocaleTimeString","enable_country_based_pricing","seeded","setDefaultConfiguration","seedErr","handleRefresh","config","handleSettingsUpdate","updates","updatedSettings","selectedCountry","c","upsertConfiguration","country_code","country_name","currency","currency_symbol","symbol","base_markup_percentage","slab_markup_enabled","is_active","is_default","refreshed","supErr","handleSaveSlab","slabData","updatedSlabs","actionType","configId","cfgErr","persistedId","createMarkupSlab","slab","updatedAt","updateMarkupSlab","charAt","toUpperCase","handleCancelEdit","min","Percent","Select","countryCode","toString","countryName","currencySymbol","defaultMarkup","markupType","region","tier","conversionMargin","SelectTrigger","SelectValue","SelectContent","SelectItem","country","configRow","updatedCount","updateAllMarkupSlabStatusForConfig","latestConfig","rule","EnhancedMarkupSlabForm","onSave","onCancel","existingSlabs","isEditing","Edit","MarkupSlabsPagination","slabs","onEdit","onDelete","slabId","onToggleStatus","current","s","updateMarkupSlabStatus","toggledSlab","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","slabToDelete","getMarkupSlabById","deleteMarkupSlab","handleDeleteSlab","CountryPricingManager","onUpdate","MarkupExportPreview","onSettingsChange","TaxManagement","onTaxUpdate","taxSettings","AdvancedPricingEngine","onPricingUpdate","pricingData","PricingSimulator","EmailTemplates","templates","setTemplates","variables","setVariables","selectedTemplate","setSelectedTemplate","editingTemplate","setEditingTemplate","isCreateDialogOpen","setIsCreateDialogOpen","isEditDialogOpen","setIsEditDialogOpen","isPreviewDialogOpen","setIsPreviewDialogOpen","previewVariables","setPreviewVariables","filterCategory","setFilterCategory","loading","setLoading","loadTemplates","loadVariables","templateList","emailTemplateService","getTemplates","variableList","getAvailableVariables","filteredTemplates","template","subject","getPreview","previewTemplate","stats","getTemplateStats","trigger","Play","active","byRole","traveller","SettingsIcon","byCategory","templateId","toggleTemplateStatus","handleToggleStatus","lead","quotation","booking","payment","account","itinerary","reminder","feedback","support","defaultValues","variable","variableInfo","example","handlePreviewTemplate","openEditDialog","duplicateTemplate","handleDuplicateTemplate","Copy","deleteTemplate","handleDeleteTemplate","createTemplate","createdBy","updateTemplate","sendTestEmail","Send","currencies","CurrencyConverter","customRates","CurrencyService","getDefaultRates","defaultMargin","newRate","setNewRate","fromCurrency","toCurrency","rate","additionalSurcharge","apiUsage","setApiUsage","used","limit","remaining","isApiKeyConfigured","setIsApiKeyConfigured","nextRefreshTime","setNextRefreshTime","currentISTTime","setCurrentISTTime","savedSettings","getItem","parsed","parse","apiKey","CurrencyApiService","getApiKey","usage","getApiUsage","updateTime","formatISTTime","getISTTime","CurrencyScheduler","getNextRefreshTime","timeInterval","setInterval","scheduleDaily9AM","handleRefreshRates","clearInterval","rates","allRates","isRealTime","fetchAllRealTimeRates","updatedRates","isFixed","rateKey","lastUpdated","newUsage","realTimeCount","mockCount","isThbToInr","CurrencyApiConfig","Info","CurrencyCalculator","parseFloat","ExchangeRateManager","onUpdateRates","onRefreshRates","customRate","isCustom","clearSchedule","EmailConfigurationSettings","configurations","setConfigurations","testing","setTesting","isDialogOpen","setIsDialogOpen","editingConfig","setEditingConfig","showTestDialog","setShowTestDialog","configToTest","setConfigToTest","deleteDialogOpen","setDeleteDialogOpen","configToDelete","setConfigToDelete","formData","setFormData","daily_send_limit","loadConfigurations","response","emailConfigurationService","getEmailConfigurations","openCreateDialog","resetForm","Loader2","action","Mail","Server","Star","handleDelete","current_day_sent","style","toggleEmailConfigurationStatus","setDefaultEmailConfiguration","handleSetDefault","onSubmit","preventDefault","configData","parseInt","updateEmailConfiguration","createEmailConfiguration","required","console","testEmailConfiguration","handleTest","CountryEmailSettings","deleteEmailConfiguration","SmsOtpSettings","setProvider","mode","setMode","setApiKey","senderId","setSenderId","templateName","setTemplateName","companyName","setCompanyName","companyWebsite","setCompanyWebsite","approvalStatus","setApprovalStatus","nature","setNature","purpose","setPurpose","isOpenTemplate","setIsOpenTemplate","templateText","setTemplateText","enabledSend","setEnabledSend","enabledVerify","setEnabledVerify","health","setHealth","testPhone","setTestPhone","requestId","setRequestId","otp","setOtp","verifying","setVerifying","logs","setLogs","getSmsConfigStatus","AppSettingsService","getSetting","setting_json","j","sender_id","template_name","company_name","company_website","approval_status","is_open_template","template_text","enabled_send","enabled_verify","AppSettingsHelpers","upsertSetting","setting_key","sendOtp","request_id","verifyOtp","phone","error_message","modules","path","subLinks","Bell","ImageIcon","Code","CreditCard","adminOnly","MessageSquare","SettingsPage","Link","SIcon","LogoTestPage","TestTube","LogoDebug","ThemeTestSuite"],"ignoreList":[],"sources":["../../src/pages/settings/GeneralSettings.tsx","../../src/pages/settings/AccountSettings.tsx","../../src/pages/settings/NotificationSettings.tsx","../../src/pages/settings/AppearanceSettings.tsx","../../src/pages/settings/LanguageManager.tsx","../../src/pages/settings/ApiSettings.tsx","../../src/pages/settings/AccessControl.tsx","../../src/pages/settings/AgentSettings.tsx","../../src/pages/settings/TranslationTool.tsx","../../src/pages/settings/PricingSettings.tsx","../../src/pages/settings/EmailTemplates.tsx","../../src/pages/settings/CurrencyConverter.tsx","../../src/pages/settings/EmailConfiguration.tsx","../../src/pages/settings/SmsOtpSettings.tsx","../../src/pages/settings/SettingsPage.tsx","../../src/pages/settings/LogoTest.tsx"],"sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  Settings, \n  Globe, \n  Palette, \n  Shield, \n  Bell, \n  Database, \n  Smartphone, \n  Monitor,\n  Sun,\n  Moon,\n  Laptop,\n  ChevronRight,\n  User,\n  Lock,\n  Sparkles,\n  Zap\n} from 'lucide-react';\nimport { GeneralSettings as GeneralSettingsComponent } from '@/components/settings/categories/GeneralSettings';\nimport { SEOSettings } from '@/components/settings/categories/SEOSettings';\nimport { BrandingSettings } from '@/components/settings/categories/BrandingSettings';\nimport { MetaWhatsAppSettings } from '@/components/settings/categories/MetaWhatsAppSettings';\n// Note: These components may need to be created if they don't exist\n// import { SecuritySettings } from '@/components/settings/SecuritySettings';\n// import { NotificationSettings } from '@/components/settings/NotificationSettings';\n// import { DatabaseSettings } from '@/components/settings/DatabaseSettings';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport { useTheme } from '@/components/ui/theme-provider';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { AppSettingsService, SETTING_CATEGORIES } from '@/services/appSettingsService';\nimport { useAppSettingsAccess } from '@/hooks/useAppSettingsAccess';\nimport PageLayout from '@/components/layout/PageLayout';\n\n// Translation helper function\nconst getTranslation = (key: string): string => {\n  const translations: Record<string, string> = {\n    'settings.title': 'Settings',\n    'settings.description': 'Manage your application settings and preferences',\n    'settings.access_denied': 'Access Denied',\n    'settings.admin_required': 'You need administrator privileges to access this page.',\n    'common.go_back': 'Go Back',\n    'settings.categories.general': 'General',\n    'settings.categories.seo': 'SEO',\n    'settings.categories.branding': 'Branding',\n    'settings.categories.security': 'Security',\n    'settings.categories.notifications': 'Notifications',\n    'settings.categories.database': 'Database',\n  };\n  return translations[key] || key;\n};\n\n// Available categories - only include those with existing components\nconst categories = [\n  { \n    key: 'general', \n    icon: Settings, \n    description: 'Basic application settings and preferences',\n    color: 'text-blue-500 dark:text-blue-400',\n    bgColor: 'bg-blue-50 dark:bg-blue-950/30',\n    borderColor: 'border-blue-200 dark:border-blue-800'\n  },\n  { \n    key: 'seo', \n    icon: Globe, \n    description: 'Search engine optimization settings',\n    color: 'text-green-500 dark:text-green-400',\n    bgColor: 'bg-green-50 dark:bg-green-950/30',\n    borderColor: 'border-green-200 dark:border-green-800'\n  },\n  { \n    key: 'branding', \n    icon: Palette, \n    description: 'Customize your brand appearance',\n    color: 'text-purple-500 dark:text-purple-400',\n    bgColor: 'bg-purple-50 dark:bg-purple-950/30',\n    borderColor: 'border-purple-200 dark:border-purple-800'\n  },\n];\n\nconst ThemeInfo = () => {\n  const { theme, setTheme } = useTheme();\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  const handleThemeChange = (newTheme: 'light' | 'dark' | 'system') => {\n    setIsAnimating(true);\n    setTheme(newTheme);\n  };\n\n  useEffect(() => {\n    if (isAnimating) {\n      const timer = setTimeout(() => setIsAnimating(false), 300);\n      return () => clearTimeout(timer);\n    }\n  }, [isAnimating]);\n\n  const getThemeIcon = () => {\n    switch (theme) {\n      case 'light':\n        return <Sun className=\"h-4 w-4\" />;\n      case 'dark':\n        return <Moon className=\"h-4 w-4\" />;\n      default:\n        return <Laptop className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getThemeLabel = () => {\n    switch (theme) {\n      case 'light':\n        return 'Light';\n      case 'dark':\n        return 'Dark';\n      default:\n        return 'System';\n    }\n  };\n\n  return (\n    <div className=\"p-4 border-t border-border/50\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <span className=\"text-sm font-medium\">Theme</span>\n        <Badge variant=\"outline\" className=\"text-xs\">\n          {getThemeLabel()}\n        </Badge>\n      </div>\n      <div className=\"grid grid-cols-3 gap-2\">\n        {[\n          { value: 'light', icon: Sun, label: 'Light' },\n          { value: 'dark', icon: Moon, label: 'Dark' },\n          { value: 'system', icon: Laptop, label: 'System' }\n        ].map(({ value, icon: Icon, label }) => (\n          <Button\n            key={value}\n            variant={theme === value ? 'default' : 'outline'}\n            size=\"sm\"\n            onClick={() => handleThemeChange(value as 'light' | 'dark' | 'system')}\n            className={`h-8 text-xs transition-all duration-200 ${\n              isAnimating && theme === value ? 'scale-95' : ''\n            }`}\n          >\n            <Icon className=\"h-3 w-3 mr-1\" />\n            {label}\n          </Button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nconst SidebarMenu = ({ \n  activeCategory, \n  onCategoryChange, \n  isMobileSidebarOpen, \n  setIsMobileSidebarOpen \n}: {\n  activeCategory: string;\n  onCategoryChange: (category: string) => void;\n  isMobileSidebarOpen: boolean;\n  setIsMobileSidebarOpen: (open: boolean) => void;\n}) => {\n  const handleCategoryClick = (categoryKey: string) => {\n    onCategoryChange(categoryKey);\n    if (isMobileSidebarOpen) {\n      setIsMobileSidebarOpen(false);\n    }\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg bg-gradient-to-br from-card to-card/80 backdrop-blur-sm sticky top-4\">\n      <CardContent className=\"p-0\">\n        <div className=\"p-4 border-b border-border/50 bg-gradient-to-r from-primary/5 to-primary/10\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 rounded-lg bg-primary/10\">\n              <Settings className=\"h-5 w-5 text-primary\" />\n            </div>\n            <div>\n              <h2 className=\"font-semibold\">{getTranslation('settings.title')}</h2>\n              <p className=\"text-xs text-muted-foreground\">\n                {getTranslation('settings.description')}\n              </p>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"p-2\">\n          {categories.map((category) => {\n            const Icon = category.icon;\n            const isActive = activeCategory === category.key;\n            \n            return (\n              <Button\n                key={category.key}\n                variant={isActive ? 'default' : 'ghost'}\n                className={`w-full justify-start mb-1 h-auto p-3 transition-all duration-200 ${\n                  isActive \n                    ? `${category.bgColor} ${category.borderColor} border shadow-sm` \n                    : 'hover:bg-muted/50'\n                }`}\n                onClick={() => handleCategoryClick(category.key)}\n              >\n                <div className=\"flex items-center gap-3 w-full\">\n                  <div className={`p-1.5 rounded-md ${isActive ? 'bg-background/50' : 'bg-muted/30'}`}>\n                    <Icon className={`h-4 w-4 ${isActive ? category.color : 'text-muted-foreground'}`} />\n                  </div>\n                  <div className=\"flex-1 text-left\">\n                    <div className={`font-medium text-sm ${isActive ? 'text-foreground' : 'text-muted-foreground'}`}>\n                      {getTranslation(`settings.categories.${category.key}`)}\n                    </div>\n                    <div className=\"text-xs text-muted-foreground/70 mt-0.5\">\n                      {category.description}\n                    </div>\n                  </div>\n                  {isActive && (\n                    <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n                  )}\n                </div>\n              </Button>\n            );\n          })}\n        </div>\n        \n        <ThemeInfo />\n      </CardContent>\n    </Card>\n  );\n};\n\nconst PlaceholderSettings = ({ title }: { title: string }) => (\n  <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n    <div className=\"p-4 rounded-full bg-muted/50 mb-4\">\n      <Settings className=\"h-8 w-8 text-muted-foreground\" />\n    </div>\n    <h3 className=\"text-lg font-semibold mb-2\">{title} Settings</h3>\n    <p className=\"text-muted-foreground mb-4\">\n      This settings section is coming soon.\n    </p>\n    <Badge variant=\"secondary\">Under Development</Badge>\n  </div>\n);\n\nexport default function GeneralSettings() {\n  const [activeCategory, setActiveCategory] = useState<string>('general');\n  const [isMobileSidebarOpen, setIsMobileSidebarOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const isMobile = useIsMobile();\n  const navigate = useNavigate();\n  const { hasAccess } = useAppSettingsAccess();\n\n  useEffect(() => {\n    // Simulate loading time for smooth transition\n    const timer = setTimeout(() => setIsLoading(false), 500);\n    return () => clearTimeout(timer);\n  }, []);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"flex flex-col items-center gap-4\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n          <p className=\"text-sm text-muted-foreground\">Loading settings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!hasAccess) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Card className=\"w-full max-w-md mx-4\">\n          <CardContent className=\"pt-6 text-center\">\n            <div className=\"mb-4\">\n              <Lock className=\"h-12 w-12 text-muted-foreground mx-auto\" />\n            </div>\n            <h2 className=\"text-xl font-semibold mb-2\">{getTranslation('settings.access_denied')}</h2>\n            <p className=\"text-muted-foreground mb-4\">\n              {getTranslation('settings.admin_required')}\n            </p>\n            <Button onClick={() => navigate(-1)} variant=\"outline\">\n              {getTranslation('common.go_back')}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const renderSettingsComponent = () => {\n    switch (activeCategory) {\n      case 'general':\n        return <GeneralSettingsComponent />;\n      case 'seo':\n        return <SEOSettings />;\n      case 'branding':\n        return <BrandingSettings />;\n      case 'security':\n        return <PlaceholderSettings title=\"Security\" />;\n      case 'notifications':\n        return <PlaceholderSettings title=\"Notifications\" />;\n      case 'database':\n        return <PlaceholderSettings title=\"Database\" />;\n      default:\n        return <GeneralSettingsComponent />;\n    }\n  };\n\n  return (\n    <PageLayout\n      title=\"General Settings - Tour Management System\"\n      description=\"Manage your application settings and preferences. Configure general settings, SEO, branding, and more.\"\n      keywords={['settings', 'configuration', 'preferences', 'general settings', 'SEO', 'branding']}\n    >\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          {/* Settings Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <SidebarMenu\n              activeCategory={activeCategory}\n              onCategoryChange={setActiveCategory}\n              isMobileSidebarOpen={isMobileSidebarOpen}\n              setIsMobileSidebarOpen={setIsMobileSidebarOpen}\n            />\n          </div>\n\n          {/* Mobile Sidebar Overlay */}\n          {isMobile && isMobileSidebarOpen && (\n            <div className=\"fixed inset-0 z-50 lg:hidden\">\n              <div \n                className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n                onClick={() => setIsMobileSidebarOpen(false)}\n              />\n              <div className=\"absolute left-0 top-0 h-full w-80 max-w-[85vw] bg-background border-r shadow-2xl\">\n                <div className=\"p-4 border-b\">\n                  <div className=\"flex items-center justify-between\">\n                    <h2 className=\"font-semibold\">{getTranslation('settings.title')}</h2>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setIsMobileSidebarOpen(false)}\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n                <div className=\"overflow-y-auto h-[calc(100vh-80px)]\">\n                  <SidebarMenu\n                    activeCategory={activeCategory}\n                    onCategoryChange={setActiveCategory}\n                    isMobileSidebarOpen={isMobileSidebarOpen}\n                    setIsMobileSidebarOpen={setIsMobileSidebarOpen}\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Main Content */}\n          <div className=\"lg:col-span-3\">\n            <Card className=\"border-0 shadow-lg bg-gradient-to-br from-card to-card/80 backdrop-blur-sm overflow-hidden\">\n              <div className=\"p-6 border-b border-border/50 bg-gradient-to-r from-primary/5 to-primary/10\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"p-3 rounded-xl bg-primary/10\">\n                    <Settings className=\"h-6 w-6 text-primary\" />\n                  </div>\n                  <div>\n                    <h1 className=\"text-2xl font-bold\">{getTranslation('settings.title')}</h1>\n                    <p className=\"text-muted-foreground\">\n                      {getTranslation('settings.description')}\n                    </p>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"p-6\">\n                <div className=\"transition-all duration-300 ease-in-out\">\n                  {renderSettingsComponent()}\n                </div>\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </PageLayout>\n  );\n}\n","\nimport React from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { useToast } from '@/hooks/use-toast';\nimport { useApp } from '@/contexts/AppContext';\n\nconst AccountSettings: React.FC = () => {\n  const { translate } = useApp();\n  const { toast } = useToast();\n  \n  const handleSave = () => {\n    toast({\n      title: translate('success'),\n      description: translate('accountSettingsSaved'),\n    });\n  };\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        {/* Heading hidden as requested */}\n        \n        <Card>\n          <CardHeader>\n            <CardTitle>Account Settings</CardTitle>\n            <CardDescription>Manage your account preferences</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"full-name\">Full Name</Label>\n              <Input id=\"full-name\" defaultValue=\"Admin User\" />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email Address</Label>\n              <Input id=\"email\" type=\"email\" defaultValue=\"admin@tripoex.com\" />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input id=\"password\" type=\"password\" defaultValue=\"********\" />\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"profile-image\">Profile Image</Label>\n              <div className=\"flex items-center space-x-4\">\n                <div className=\"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\n                  <span className=\"text-lg text-gray-600\">AU</span>\n                </div>\n                <Button variant=\"outline\" size=\"sm\">Change Image</Button>\n              </div>\n            </div>\n          </CardContent>\n          <CardFooter className=\"border-t px-6 py-4\">\n            <Button onClick={handleSave}>Update Account</Button>\n          </CardFooter>\n        </Card>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AccountSettings;\n","\nimport React from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { useToast } from '@/hooks/use-toast';\nimport { useApp } from '@/contexts/AppContext';\n\nconst NotificationSettings: React.FC = () => {\n  const { translate } = useApp();\n  const { toast } = useToast();\n  \n  const handleSave = () => {\n    toast({\n      title: translate('success'),\n      description: translate('notificationSettingsSaved'),\n    });\n  };\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        <h1 className=\"text-xl md:text-2xl font-bold\">{translate('notificationSettings')}</h1>\n        \n        <Card>\n          <CardHeader>\n            <CardTitle>Notification Settings</CardTitle>\n            <CardDescription>Manage your notification preferences</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"font-medium\">Email Notifications</p>\n                <p className=\"text-sm text-muted-foreground\">Receive email for new queries and bookings</p>\n              </div>\n              <Switch defaultChecked id=\"email-notifications\" />\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"font-medium\">System Notifications</p>\n                <p className=\"text-sm text-muted-foreground\">In-app notifications for system events</p>\n              </div>\n              <Switch defaultChecked id=\"system-notifications\" />\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"font-medium\">Task Reminders</p>\n                <p className=\"text-sm text-muted-foreground\">Reminders for upcoming tasks and follow-ups</p>\n              </div>\n              <Switch defaultChecked id=\"task-reminders\" />\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"font-medium\">Marketing Updates</p>\n                <p className=\"text-sm text-muted-foreground\">Notifications for marketing and promotional content</p>\n              </div>\n              <Switch id=\"marketing-updates\" />\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"font-medium\">Mobile Push Notifications</p>\n                <p className=\"text-sm text-muted-foreground\">Enable push notifications on mobile devices</p>\n              </div>\n              <Switch defaultChecked id=\"push-notifications\" />\n            </div>\n          </CardContent>\n          <CardFooter className=\"border-t px-6 py-4\">\n            <Button onClick={handleSave}>Save Preferences</Button>\n          </CardFooter>\n        </Card>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default NotificationSettings;\n","\nimport React from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport ThemeSelector from '@/components/settings/ThemeSelector';\nimport { useToast } from '@/hooks/use-toast';\nimport { useApp } from '@/contexts/AppContext';\n\nconst AppearanceSettings: React.FC = () => {\n  const { translate } = useApp();\n  const { toast } = useToast();\n  \n  const handleSave = () => {\n    toast({\n      title: translate('success'),\n      description: translate('appearanceSettingsSaved'),\n    });\n  };\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        <h1 className=\"text-xl md:text-2xl font-bold\">{translate('appearance')}</h1>\n        \n        <Card>\n          <CardHeader>\n            <CardTitle>{translate('appearance')}</CardTitle>\n            <CardDescription>Customize the look and feel of the application</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <ThemeSelector />\n                \n            <div className=\"border-t pt-4\">\n              <div className=\"flex items-center space-x-2\">\n                <Switch id=\"compact-mode\" />\n                <Label htmlFor=\"compact-mode\">Compact Mode</Label>\n              </div>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                Use less space between elements for a more compact view\n              </p>\n            </div>\n\n            <div className=\"flex items-center space-x-2\">\n              <Switch id=\"animations\" defaultChecked />\n              <Label htmlFor=\"animations\">Enable Animations</Label>\n            </div>\n            \n            <div className=\"space-y-2 pt-4 border-t\">\n              <Label>Font Size</Label>\n              <div className=\"flex space-x-4\">\n                <Button variant=\"outline\" size=\"sm\">Small</Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"bg-primary/10\">Medium</Button>\n                <Button variant=\"outline\" size=\"sm\">Large</Button>\n              </div>\n            </div>\n            \n            <div className=\"space-y-2 pt-4 border-t\">\n              <Label>Navigation Style</Label>\n              <div className=\"flex space-x-4\">\n                <Button variant=\"outline\" size=\"sm\" className=\"bg-primary/10\">Sidebar</Button>\n                <Button variant=\"outline\" size=\"sm\">Top Navigation</Button>\n              </div>\n            </div>\n          </CardContent>\n          <CardFooter className=\"border-t px-6 py-4\">\n            <Button onClick={handleSave}>{translate('save')}</Button>\n          </CardFooter>\n        </Card>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AppearanceSettings;\n","\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { useToast } from '@/hooks/use-toast';\nimport { useApp, Language } from '@/contexts/AppContext';\nimport LanguageSelector from '@/components/settings/LanguageSelector';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Search, Globe, ToggleLeft, Plus, Trash2, Power, AlertCircle } from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n} from '@/components/ui/alert';\nimport AddLanguageDialog from '@/components/settings/AddLanguageDialog';\nimport { globalLanguages } from '@/components/settings/AdvancedLanguageSelector';\nimport { Badge } from '@/components/ui/badge';\n\ntype LanguageStatus = {\n  code: Language;\n  name: string;\n  enabled: boolean;\n  isDefault?: boolean;\n};\n\nconst LanguageManager: React.FC = () => {\n  const { translate, language, setLanguage, isMultiLanguageEnabled, setMultiLanguageEnabled, currentUser, availableLanguages, setAvailableLanguages, languageNames } = useApp();\n  const { toast } = useToast();\n  const navigate = useNavigate();\n  \n  // Check if user has admin privileges (super_admin or manager)\n  const isAdmin = currentUser?.role === 'super_admin' || currentUser?.role === 'manager';\n  \n  useEffect(() => {\n    if (!isAdmin) {\n      toast({\n        title: translate(\"Access denied\") || \"Access denied\",\n        description: translate(\"You don't have permission to manage language settings\") || \"You don't have permission to manage language settings\",\n        variant: \"destructive\"\n      });\n      navigate('/');\n    }\n  }, [isAdmin, navigate, toast, translate]);\n\n  const [activeTab, setActiveTab] = useState<string>('general');\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [isAddLanguageDialogOpen, setIsAddLanguageDialogOpen] = useState(false);\n\n  // Initialize language status list using availableLanguages from context\n  const [languageStatusList, setLanguageStatusList] = useState<LanguageStatus[]>(() => {\n    // Create language status entries for all languages in languageNames\n    return Object.entries(languageNames).map(([code, name]) => {\n      const langCode = code as Language;\n      return {\n        code: langCode,\n        name,\n        enabled: availableLanguages.includes(langCode), // Set enabled based on availableLanguages\n        isDefault: langCode === 'en'\n      };\n    });\n  });\n\n  // Effect to sync languageStatusList with availableLanguages in context\n  useEffect(() => {\n    // Update availableLanguages in context when languageStatusList changes\n    const enabledLanguages = languageStatusList\n      .filter(lang => lang.enabled)\n      .map(lang => lang.code);\n    \n    setAvailableLanguages(enabledLanguages);\n  }, [languageStatusList, setAvailableLanguages]);\n\n  // Handle language toggle\n  const handleLanguageToggle = (languageCode: Language, enabled: boolean) => {\n    setLanguageStatusList(prev => \n      prev.map(lang => \n        lang.code === languageCode \n          ? { ...lang, enabled }\n          : lang\n      )\n    );\n    \n    toast({\n      title: translate('success') || 'Success',\n      description: `${languageNames[languageCode]} ${enabled ? \n        (translate('enabled') || 'enabled') : \n        (translate('disabled') || 'disabled')}`,\n    });\n  };\n\n  // Handle removing a language\n  const handleRemoveLanguage = (languageCode: Language) => {\n    if (languageCode === 'en') {\n      toast({\n        title: translate('Error') || 'Error',\n        description: translate('Cannot remove English as it is the default language') || 'Cannot remove English as it is the default language',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (languageCode === language) {\n      // If removing the currently active language, switch to English\n      setLanguage('en');\n      toast({\n        title: translate('Information') || 'Information',\n        description: translate('Switched to English because the current language was removed') || 'Switched to English because the current language was removed',\n      });\n    }\n\n    setLanguageStatusList(prev => prev.filter(lang => lang.code !== languageCode));\n    \n    toast({\n      title: translate('success') || 'Success',\n      description: `${languageNames[languageCode]} ${translate('removed from language list') || 'removed from language list'}`,\n    });\n  };\n\n  // Add a new language\n  const handleAddLanguage = (code: string, name: string) => {\n    // Check if language already exists\n    if (languageStatusList.some(lang => lang.code === code)) {\n      toast({\n        title: translate('Warning') || 'Warning',\n        description: `${name} ${translate('is already in your language list') || 'is already in your language list'}`,\n        variant: \"default\"\n      });\n      return;\n    }\n    \n    const newLanguage: LanguageStatus = {\n      code: code as Language,\n      name,\n      enabled: true\n    };\n    \n    setLanguageStatusList(prev => [...prev, newLanguage]);\n    \n    toast({\n      title: translate('success') || 'Success',\n      description: `${name} ${translate('added to language list') || 'added to language list'}`,\n    });\n    \n    setIsAddLanguageDialogOpen(false);\n  };\n\n  // Filter languages based on search query\n  const filteredLanguages = languageStatusList.filter(lang =>\n    lang.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    lang.code.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  // Effect to update the AppContext when multi-language setting changes\n  useEffect(() => {\n    // This would normally make an API call to save settings to the server\n    console.log(\"Multi-language enabled:\", isMultiLanguageEnabled);\n    \n    // When multi-language is disabled, we could potentially set the app to use English only\n    if (!isMultiLanguageEnabled) {\n      // This could be enhanced to save this setting to backend or localStorage\n      console.log(\"Language set to English only\");\n    }\n  }, [isMultiLanguageEnabled]);\n\n  const renderMultiLanguageToggle = () => {\n    return (\n      <Card className=\"mb-6\">\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"text-lg\">{translate('Multi-language Support') || 'Multi-language Support'}</CardTitle>\n              <CardDescription>{translate('Enable or disable multi-language functionality for the entire application') || 'Enable or disable multi-language functionality for the entire application'}</CardDescription>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <Label htmlFor=\"multi-language-toggle\" className=\"font-medium\">\n                {isMultiLanguageEnabled ? translate('Enabled') || 'Enabled' : translate('Disabled') || 'Disabled'}\n              </Label>\n              <Switch\n                id=\"multi-language-toggle\"\n                checked={isMultiLanguageEnabled}\n                onCheckedChange={(checked) => {\n                  setMultiLanguageEnabled(checked);\n                  toast({\n                    title: translate('success') || 'Success',\n                    description: checked ? \n                      (translate('Multi-language support enabled') || 'Multi-language support enabled') : \n                      (translate('Multi-language support disabled') || 'Multi-language support disabled'),\n                  });\n                }}\n                disabled={!isAdmin}\n              />\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center space-x-3 text-sm\">\n            {isMultiLanguageEnabled ? (\n              <>\n                <Globe size={18} className=\"text-green-500\" />\n                <span>{translate('Multiple languages are currently available to users') || 'Multiple languages are currently available to users'}</span>\n              </>\n            ) : (\n              <>\n                <ToggleLeft size={18} className=\"text-gray-500\" />\n                <span>{translate('The application is using English only') || 'The application is using English only'}</span>\n              </>\n            )}\n          </div>\n          \n          {!isMultiLanguageEnabled && (\n            <Alert variant=\"warning\" className=\"mt-4\">\n              <AlertCircle className=\"h-4 w-4\" />\n              <AlertTitle>{translate('Note') || 'Note'}</AlertTitle>\n              <AlertDescription>\n                {translate('When multi-language support is disabled, the language switcher will be hidden from the header and all users will see content in English only.') || \n                'When multi-language support is disabled, the language switcher will be hidden from the header and all users will see content in English only.'}\n              </AlertDescription>\n            </Alert>\n          )}\n        </CardContent>\n      </Card>\n    );\n  };\n\n  const renderLanguageManagement = () => {\n    return (\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>{translate('Language Management') || 'Language Management'}</CardTitle>\n              <CardDescription>\n                {translate('Manage available languages, enable/disable them, and add new languages') || 'Manage available languages, enable/disable them, and add new languages'}\n              </CardDescription>\n            </div>\n            <Button \n              className=\"flex items-center gap-2\"\n              onClick={() => setIsAddLanguageDialogOpen(true)}\n            >\n              <Plus size={16} />\n              {translate('Add Language') || 'Add Language'}\n            </Button>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {/* Language Stats */}\n            <div className=\"flex flex-wrap gap-3 mb-6\">\n              <Badge variant=\"secondary\" className=\"px-3 py-1.5\">\n                {translate('Total Languages') || 'Total Languages'}: <strong className=\"ml-1\">{languageStatusList.length}</strong>\n              </Badge>\n              <Badge variant=\"success\" className=\"px-3 py-1.5\">\n                {translate('Enabled') || 'Enabled'}: <strong className=\"ml-1\">\n                  {languageStatusList.filter(lang => lang.enabled).length}\n                </strong>\n              </Badge>\n              <Badge variant=\"outline\" className=\"px-3 py-1.5\">\n                {translate('Disabled') || 'Disabled'}: <strong className=\"ml-1\">\n                  {languageStatusList.filter(lang => !lang.enabled).length}\n                </strong>\n              </Badge>\n            </div>\n\n            {/* Search */}\n            <div className=\"flex items-center space-x-2\">\n              <Search size={16} className=\"text-gray-500\" />\n              <Input\n                placeholder={translate('Search languages...') || 'Search languages...'}\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"max-w-sm\"\n              />\n            </div>\n\n            {/* Languages Table */}\n            <div className=\"border rounded-lg\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>{translate('Language') || 'Language'}</TableHead>\n                    <TableHead>{translate('Code') || 'Code'}</TableHead>\n                    <TableHead>{translate('Status') || 'Status'}</TableHead>\n                    <TableHead>{translate('Default') || 'Default'}</TableHead>\n                    <TableHead className=\"text-right\">{translate('Actions') || 'Actions'}</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredLanguages.length > 0 ? (\n                    filteredLanguages.map((lang) => (\n                      <TableRow key={lang.code} className={lang.code === language ? 'bg-muted/50' : ''}>\n                        <TableCell className=\"font-medium\">{lang.name}</TableCell>\n                        <TableCell className=\"text-muted-foreground uppercase\">{lang.code}</TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center space-x-2\">\n                            <Switch\n                              checked={lang.enabled}\n                              onCheckedChange={(enabled) => handleLanguageToggle(lang.code, enabled)}\n                              disabled={lang.isDefault}\n                            />\n                            <span className={`text-sm ${lang.enabled ? 'text-green-600' : 'text-gray-500'}`}>\n                              {lang.enabled ? translate('Enabled') || 'Enabled' : translate('Disabled') || 'Disabled'}\n                            </span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          {lang.isDefault && (\n                            <Badge variant=\"secondary\" className=\"inline-flex items-center px-2 py-1 rounded-full text-xs\">\n                              {translate('Default') || 'Default'}\n                            </Badge>\n                          )}\n                          {lang.code === language && !lang.isDefault && (\n                            <Badge variant=\"outline\" className=\"inline-flex items-center px-2 py-1 rounded-full text-xs\">\n                              {translate('Current') || 'Current'}\n                            </Badge>\n                          )}\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleRemoveLanguage(lang.code)}\n                            disabled={lang.isDefault}\n                            className=\"text-red-600 hover:text-red-800\"\n                          >\n                            <Trash2 size={16} />\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  ) : (\n                    <TableRow>\n                      <TableCell colSpan={5} className=\"text-center py-8 text-gray-500\">\n                        {translate('No languages found') || 'No languages found'}\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n            \n            {filteredLanguages.length === 0 && (\n              <div className=\"text-center py-8 text-gray-500\">\n                {translate('No languages found') || 'No languages found'}\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  };\n\n  // Render the AddLanguageDialog component\n  const renderAddLanguageDialog = () => {\n    return (\n      <AddLanguageDialog\n        open={isAddLanguageDialogOpen}\n        onClose={() => setIsAddLanguageDialogOpen(false)}\n        onAddLanguage={handleAddLanguage}\n        existingLanguageCodes={languageStatusList.map(lang => lang.code)}\n      />\n    );\n  };\n\n  return (\n    <PageLayout title=\"Languages\">\n      <div className=\"space-y-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-4\">\n          <TabsList>\n            <TabsTrigger value=\"general\">{translate('General') || 'General'}</TabsTrigger>\n            <TabsTrigger value=\"management\">{translate('Language Management') || 'Language Management'}</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"general\" className=\"space-y-6\">\n            {renderMultiLanguageToggle()}\n            \n            <Card>\n              <CardHeader>\n                <CardTitle>{translate('Current Language Settings') || 'Current Language Settings'}</CardTitle>\n                <CardDescription>\n                  {translate('Test the language switching functionality') || 'Test the language switching functionality'}\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                    <div>\n                      <h3 className=\"font-medium\">{translate('Current Application Language') || 'Current Application Language'}</h3>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {translate('Currently displaying in') || 'Currently displaying in'}: <strong>{languageNames[language]}</strong>\n                      </p>\n                    </div>\n                    <LanguageSelector forceShow={true} />\n                  </div>\n                  \n                  <div className=\"p-4 bg-muted rounded-lg\">\n                    <h4 className=\"font-medium mb-2\">{translate('Live Translation Test') || 'Live Translation Test'}</h4>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <p><strong>{translate('dashboard') || 'Dashboard'}:</strong> {translate('dashboard')}</p>\n                        <p><strong>{translate('settings') || 'Settings'}:</strong> {translate('settings')}</p>\n                        <p><strong>{translate('search') || 'Search'}:</strong> {translate('search')}</p>\n                      </div>\n                      <div>\n                        <p><strong>{translate('save') || 'Save'}:</strong> {translate('save')}</p>\n                        <p><strong>{translate('cancel') || 'Cancel'}:</strong> {translate('cancel')}</p>\n                        <p><strong>{translate('language') || 'Language'}:</strong> {translate('language')}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"management\" className=\"space-y-6\">\n            {renderLanguageManagement()}\n          </TabsContent>\n        </Tabs>\n      </div>\n      \n      {/* Add Language Dialog */}\n      <AddLanguageDialog\n        open={isAddLanguageDialogOpen}\n        onClose={() => setIsAddLanguageDialogOpen(false)}\n        onAddLanguage={handleAddLanguage}\n        existingLanguageCodes={languageStatusList.map(lang => lang.code)}\n      />\n    </PageLayout>\n  );\n};\n\nexport default LanguageManager;\n","\nimport React, { useEffect, useMemo, useState } from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { EyeIcon, EyeOffIcon, ArrowRight } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useApp } from '@/contexts/AppContext';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { useNavigate } from 'react-router-dom';\nimport { AppSettingsHelpers, AppSettingsService, SETTING_CATEGORIES } from '@/services/appSettingsService_database';\nimport { agentWelcomeTemplate } from '@/email/templates';\nimport { loadSMTPConfig, sendEmail } from '@/services/emailService';\nimport { useApplicationSettings } from '@/contexts/ApplicationSettingsContext';\nimport { Badge } from '@/components/ui/badge';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\nimport { supabase, adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, BarChart, Bar, ResponsiveContainer } from 'recharts';\n\nconst ApiSettings: React.FC = () => {\n  const { translate, hasPermission, currentUser } = useApp();\n  const { toast } = useToast();\n  const navigate = useNavigate();\n  const [showApiKey, setShowApiKey] = useState(false);\n  const { settings: appSettings } = useApplicationSettings();\n  // Use untyped Supabase for tables not present in generated types\n  const sb = supabase as any;\n  const adminSb = adminSupabase as any;\n  const isAdmin = (currentUser?.role === 'super_admin' || currentUser?.role === 'manager');\n\n  // AI Integrations state\n  const [apis, setApis] = useState<any[]>([]);\n  const [loadingAPIs, setLoadingAPIs] = useState<boolean>(false);\n  const [openModal, setOpenModal] = useState<boolean>(false);\n  const [editingApiId, setEditingApiId] = useState<string | null>(null);\n  const [savingApi, setSavingApi] = useState<boolean>(false);\n  const [testingApiId, setTestingApiId] = useState<string | null>(null);\n  const [testingSmartId, setTestingSmartId] = useState<string | null>(null);\n  const [deletingApiId, setDeletingApiId] = useState<string | null>(null);\n  const [modalShowKey, setModalShowKey] = useState<boolean>(false);\n  const [form, setForm] = useState<{ provider_name: string; base_url: string; api_key: string; status: 'active' | 'inactive'; model_name?: string; temperature?: number; max_tokens?: number; priority?: number; daily_limit?: number; requests_per_minute_limit?: number; tokens_per_minute_limit?: number; requests_per_day_limit?: number }>({\n    provider_name: '',\n    base_url: '',\n    api_key: '',\n    status: 'inactive',\n    model_name: '',\n    temperature: 0.7,\n    max_tokens: 2048,\n    priority: 0,\n    daily_limit: 250,\n    requests_per_minute_limit: 10,\n    tokens_per_minute_limit: 250000,\n    requests_per_day_limit: 250,\n  });\n  // Selected provider being edited (for read-only counters)\n  const editingApi = useMemo(() => apis.find(a => a.id === editingApiId) || null, [apis, editingApiId]);\n  // Prompt testing state per provider\n  const [testPromptMap, setTestPromptMap] = useState<Record<string, string>>({});\n  const [modelOverrideMap, setModelOverrideMap] = useState<Record<string, string>>({});\n  const [testResponseMap, setTestResponseMap] = useState<Record<string, string>>({});\n  const [responseDialogOpen, setResponseDialogOpen] = useState<boolean>(false);\n  const [activeResponseProviderId, setActiveResponseProviderId] = useState<string | null>(null);\n  // UI-only filters and meta for AI Integrations\n  const [aiListFilter, setAiListFilter] = useState<'all' | 'active' | 'inactive'>('all');\n  const [testMetaMap, setTestMetaMap] = useState<Record<string, { listStatus: number; listMs: number; genStatus?: number; genMs?: number }>>({});\n  const [selectedProviderId, setSelectedProviderId] = useState<string | null>(null);\n\n  // Reports state\n  const [usageLogs, setUsageLogs] = useState<any[]>([]);\n  const [loadingLogs, setLoadingLogs] = useState<boolean>(false);\n  const [providerFilter, setProviderFilter] = useState<string>('all');\n  const [statusFilter, setStatusFilter] = useState<'all' | 'active' | 'inactive'>('all');\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [dateFrom, setDateFrom] = useState<string>('');\n  const [dateTo, setDateTo] = useState<string>('');\n  const [selectedLog, setSelectedLog] = useState<any | null>(null);\n  const [logsPage, setLogsPage] = useState<number>(1);\n  const [logsPageSize, setLogsPageSize] = useState<number>(50);\n  const [logsTotal, setLogsTotal] = useState<number>(0);\n  // Model limits configuration (from public.api_model_limits)\n  const [modelLimits, setModelLimits] = useState<any[]>([]);\n\n  // SMTP form state\n  const [smtpHost, setSmtpHost] = useState('');\n  const [smtpPort, setSmtpPort] = useState<string>('');\n  const [smtpSecure, setSmtpSecure] = useState<boolean>(false);\n  const [smtpUser, setSmtpUser] = useState('');\n  const [smtpPassword, setSmtpPassword] = useState('');\n  const [fromEmail, setFromEmail] = useState('');\n  const [fromName, setFromName] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [testEmail, setTestEmail] = useState('');\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [saving, setSaving] = useState(false);\n  const [sending, setSending] = useState(false);\n  \n  const handleRegenerateKey = () => {\n    toast({\n      title: \"API Key Regenerated\",\n      description: \"Your new API key has been generated successfully\",\n    });\n  };\n  \n  const handleSave = () => {\n    toast({\n      title: translate('success'),\n      description: translate('apiSettingsSaved'),\n    });\n  };\n\n  useEffect(() => {\n    // Load SMTP config into form\n    (async () => {\n      try {\n        const cfg = await loadSMTPConfig();\n        setSmtpHost((cfg.smtp_host as string) || '');\n        setSmtpPort(String(cfg.smtp_port || ''));\n        setSmtpSecure(Boolean(cfg.smtp_secure) === true);\n        setSmtpUser((cfg.smtp_user as string) || '');\n        setSmtpPassword((cfg.smtp_password as string) || '');\n        setFromEmail((cfg.from_email as string) || '');\n        setFromName((cfg.from_name as string) || '');\n      } catch (e) {\n        // ignore\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    fetchAPIs();\n  }, []);\n\n  useEffect(() => {\n    // Initial logs load\n    fetchUsageLogs();\n    // Realtime updates for logs and integrations\n    const ch1 = supabase\n      .channel('realtime:api_usage_logs')\n      .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'api_usage_logs' }, (payload: any) => {\n        setUsageLogs(prev => [payload.new, ...prev]);\n      })\n      .subscribe();\n    const ch2 = supabase\n      .channel('realtime:api_integrations')\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'api_integrations' }, () => {\n        fetchAPIs();\n      })\n      .subscribe();\n    // Load model limits and subscribe to changes\n    fetchModelLimits();\n    const ch3 = supabase\n      .channel('realtime:api_model_limits')\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'api_model_limits' }, () => {\n        fetchModelLimits();\n      })\n      .subscribe();\n    return () => {\n      try { supabase.removeChannel(ch1); } catch {}\n      try { supabase.removeChannel(ch2); } catch {}\n      try { supabase.removeChannel(ch3); } catch {}\n    };\n  }, []);\n\n  async function fetchAPIs() {\n    try {\n      setLoadingAPIs(true);\n      const { data, error } = await sb\n        .from('api_integrations')\n        .select('*')\n        .order('priority', { ascending: true })\n        .order('created_at', { ascending: false });\n      if (error) throw error;\n      setApis(data || []);\n    } catch (e: any) {\n      toast({ title: 'Failed to load APIs', description: e?.message || 'Could not fetch API providers', variant: 'destructive' });\n    } finally {\n      setLoadingAPIs(false);\n    }\n  }\n\n  async function fetchModelLimits() {\n    try {\n      const { data, error } = await sb\n        .from('api_model_limits')\n        .select('*')\n        .order('model_name', { ascending: true });\n      if (error) throw error;\n      setModelLimits(data || []);\n    } catch (e: any) {\n      // Keep silent to avoid noise if table empty\n      console.debug('Failed to load model limits:', e?.message);\n    }\n  }\n\n  async function fetchUsageLogs() {\n    try {\n      setLoadingLogs(true);\n      const from = Math.max(0, (logsPage - 1) * logsPageSize);\n      const to = from + logsPageSize - 1;\n      let query = sb\n        .from('api_usage_logs')\n        .select('*', { count: 'exact' })\n        .order('created_at', { ascending: false })\n        .range(from, to);\n      // Date range filter applied server-side if provided\n      if (dateFrom) query = query.gte('created_at', new Date(dateFrom).toISOString());\n      if (dateTo) {\n        const end = new Date(dateTo);\n        end.setHours(23, 59, 59, 999);\n        query = query.lte('created_at', end.toISOString());\n      }\n      if (providerFilter && providerFilter !== 'all') {\n        query = query.eq('provider_name', providerFilter);\n      }\n      const { data, error, count } = await query;\n      if (error) throw error;\n      setUsageLogs(data || []);\n      setLogsTotal(typeof count === 'number' ? count : 0);\n    } catch (e: any) {\n      toast({ title: 'Failed to load logs', description: e?.message || 'Could not fetch API usage logs', variant: 'destructive' });\n    } finally {\n      setLoadingLogs(false);\n    }\n  }\n\n  useEffect(() => {\n    // Re-fetch logs when pagination or date range changes\n    fetchUsageLogs();\n  }, [logsPage, logsPageSize]);\n\n  async function resetMinuteCounters() {\n    try {\n      if (!editingApiId) return;\n      const target = { current_minute_requests: 0, current_minute_tokens: 0, last_reset_minute: new Date().toISOString() } as any;\n      const client = isAdminClientConfigured ? adminSb : sb;\n      const { error } = await client.from('api_integrations').update(target).eq('id', editingApiId);\n      if (error) throw error;\n      setApis(prev => prev.map(api => (api.id === editingApiId ? { ...api, ...target } : api)));\n      toast({ title: 'Minute counters reset', description: 'Current minute counters cleared for this provider.' });\n    } catch (e: any) {\n      toast({ title: 'Failed to reset minute counters', description: e?.message || 'Admin client update failed', variant: 'destructive' });\n    }\n  }\n\n  async function resetDayCounters() {\n    try {\n      if (!editingApiId) return;\n      const target = { current_day_requests: 0, last_reset_day: new Date().toISOString() } as any;\n      const client = isAdminClientConfigured ? adminSb : sb;\n      const { error } = await client.from('api_integrations').update(target).eq('id', editingApiId);\n      if (error) throw error;\n      setApis(prev => prev.map(api => (api.id === editingApiId ? { ...api, ...target } : api)));\n      toast({ title: 'Day counters reset', description: 'Current day requests counter cleared.' });\n    } catch (e: any) {\n      toast({ title: 'Failed to reset day counters', description: e?.message || 'Admin client update failed', variant: 'destructive' });\n    }\n  }\n\n  async function resetAllCounters() {\n    try {\n      if (!editingApiId) return;\n      const target = {\n        current_minute_requests: 0,\n        current_minute_tokens: 0,\n        current_day_requests: 0,\n        last_reset_minute: new Date().toISOString(),\n        last_reset_day: new Date().toISOString(),\n      } as any;\n      const client = isAdminClientConfigured ? adminSb : sb;\n      const { error } = await client.from('api_integrations').update(target).eq('id', editingApiId);\n      if (error) throw error;\n      setApis(prev => prev.map(api => (api.id === editingApiId ? { ...api, ...target } : api)));\n      toast({ title: 'All counters reset', description: 'Minute and day counters cleared.' });\n    } catch (e: any) {\n      toast({ title: 'Failed to reset counters', description: e?.message || 'Admin client update failed', variant: 'destructive' });\n    }\n  }\n\n  async function deleteSelectedLog() {\n    try {\n      if (!selectedLog?.id) return;\n      const client = isAdminClientConfigured ? adminSb : sb;\n      const { error } = await client.from('api_usage_logs').delete().eq('id', selectedLog.id);\n      if (error) throw error;\n      setUsageLogs(prev => prev.filter(l => l.id !== selectedLog.id));\n      setSelectedLog(null);\n      toast({ title: 'Log deleted', description: 'The selected log was removed.' });\n    } catch (e: any) {\n      toast({ title: 'Failed to delete log', description: e?.message || 'Admin client delete failed', variant: 'destructive' });\n    }\n  }\n\n  function isGemini(api: any) {\n    const url = String(api?.base_url || '').toLowerCase();\n    const name = String(api?.provider_name || '').toLowerCase();\n    return url.includes('generativelanguage.googleapis.com') || name.includes('gemini');\n  }\n\n  function startAddAPI() {\n    setEditingApiId(null);\n    setForm({ provider_name: '', base_url: '', api_key: '', status: 'inactive', model_name: '', temperature: 0.7, max_tokens: 2048, priority: 0, daily_limit: 50, requests_per_minute_limit: 60, tokens_per_minute_limit: 30000, requests_per_day_limit: 500 });\n    setOpenModal(true);\n  }\n\n  function editAPI(api: any) {\n    setEditingApiId(api.id);\n    setForm({\n      provider_name: api.provider_name || '',\n      base_url: api.base_url || '',\n      api_key: api.api_key || '',\n      status: (api.status as 'active' | 'inactive') || 'inactive',\n      model_name: api.model_name || '',\n      temperature: typeof api.temperature === 'number' ? api.temperature : 0.7,\n      max_tokens: typeof api.max_tokens === 'number' ? api.max_tokens : 2048,\n      priority: typeof api.priority === 'number' ? api.priority : 0,\n      daily_limit: typeof api.daily_limit === 'number' ? api.daily_limit : 50,\n      requests_per_minute_limit: typeof api.requests_per_minute_limit === 'number' ? api.requests_per_minute_limit : 60,\n      tokens_per_minute_limit: typeof api.tokens_per_minute_limit === 'number' ? api.tokens_per_minute_limit : 30000,\n      requests_per_day_limit: typeof api.requests_per_day_limit === 'number' ? api.requests_per_day_limit : 500,\n    });\n    setOpenModal(true);\n  }\n\n  async function handleSaveProvider() {\n    try {\n      setSavingApi(true);\n      if (editingApiId) {\n        const { error } = await sb\n          .from('api_integrations')\n          .update({\n            provider_name: form.provider_name,\n            base_url: form.base_url,\n            api_key: form.api_key,\n            status: form.status,\n            model_name: form.model_name,\n            temperature: form.temperature,\n            max_tokens: form.max_tokens,\n            priority: typeof form.priority === 'number' ? form.priority : 0,\n            daily_limit: typeof form.daily_limit === 'number' ? form.daily_limit : 50,\n            requests_per_minute_limit: typeof form.requests_per_minute_limit === 'number' ? form.requests_per_minute_limit : 60,\n            tokens_per_minute_limit: typeof form.tokens_per_minute_limit === 'number' ? form.tokens_per_minute_limit : 30000,\n            requests_per_day_limit: typeof form.requests_per_day_limit === 'number' ? form.requests_per_day_limit : 500,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', editingApiId);\n        if (error) throw error;\n        toast({ title: 'API updated successfully' });\n      } else {\n        // Insert only allowed columns for api_integrations\n        const insertPayload = {\n          provider_name: form.provider_name,\n          base_url: form.base_url,\n          api_key: form.api_key,\n          status: form.status,\n          model_name: form.model_name,\n          temperature: form.temperature,\n          max_tokens: form.max_tokens,\n          priority: typeof form.priority === 'number' ? form.priority : 0,\n          daily_limit: typeof form.daily_limit === 'number' ? form.daily_limit : 50,\n          requests_per_minute_limit: typeof form.requests_per_minute_limit === 'number' ? form.requests_per_minute_limit : 60,\n          tokens_per_minute_limit: typeof form.tokens_per_minute_limit === 'number' ? form.tokens_per_minute_limit : 30000,\n          requests_per_day_limit: typeof form.requests_per_day_limit === 'number' ? form.requests_per_day_limit : 500,\n        };\n        const { error } = await sb.from('api_integrations').insert([insertPayload]);\n        if (error) throw error;\n        toast({ title: 'API added successfully' });\n      }\n\n      setOpenModal(false);\n      setEditingApiId(null);\n      fetchAPIs();\n    } catch (e: any) {\n      toast({ title: 'Save failed', description: e?.message || 'Could not save API provider', variant: 'destructive' });\n    } finally {\n      setSavingApi(false);\n    }\n  }\n\n  async function testConnection(api: any, promptOverride?: string, modelOverride?: string) {\n    setTestingApiId(api.id);\n    try {\n      // 1) List models using provider-specific auth semantics\n      const base = String(api.base_url || '').replace(/\\/$/, '');\n      let listUrl = '';\n      let listInit: RequestInit = { method: 'GET' };\n      if (isGemini(api)) {\n        listUrl = `${base}/models?key=${encodeURIComponent(api.api_key)}`;\n      } else {\n        listUrl = `${base}/v1/models`;\n        listInit.headers = { Authorization: `Bearer ${api.api_key}` } as any;\n      }\n      const listStart = performance.now();\n      let listStatus = 0;\n      let listOk = false;\n      let listTime = 0;\n      try {\n        const listRes = await fetch(listUrl, listInit);\n        listTime = performance.now() - listStart;\n        listStatus = listRes.status;\n        listOk = listRes.ok;\n        await sb.from('api_usage_logs').insert({\n          provider_name: api.provider_name,\n          endpoint: 'list-models',\n          status_code: listStatus,\n          response_time: listTime,\n        });\n      } catch (e: any) {\n        listTime = performance.now() - listStart;\n        listStatus = -1; // Network/abort marker\n        listOk = false;\n        // Log a minimal entry so the UI still shows timing\n        try {\n          await sb.from('api_usage_logs').insert({\n            provider_name: api.provider_name,\n            endpoint: 'list-models',\n            status_code: listStatus,\n            response_time: listTime,\n          });\n        } catch { /* ignore secondary logging errors */ }\n      }\n      // Record list meta for UI\n      setTestMetaMap(prev => ({\n        ...prev,\n        [api.id]: { listStatus, listMs: listTime }\n      }));\n\n      let genSnippet = '';\n      let genStatus = 0;\n      let genTime = 0;\n      const promptText = (promptOverride && promptOverride.trim()) ? promptOverride.trim() : 'Test connection: Reply with \"OK\" if you received this message.';\n      const model = (modelOverride && modelOverride.trim()) ? modelOverride.trim() : api.model_name;\n      // 2) If a model_name or override is provided, attempt a short generation\n      if (model || api.model_name) {\n        if (isGemini(api)) {\n          const useModel = model || api.model_name;\n          const genUrl = `${base}/models/${useModel}:generateContent?key=${encodeURIComponent(api.api_key)}`;\n          const genStart = performance.now();\n          const genRes = await fetch(genUrl, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ contents: [{ parts: [{ text: promptText }] }] }),\n          });\n          genTime = performance.now() - genStart;\n          genStatus = genRes.status;\n          if (genRes.ok) {\n            const data = await genRes.json();\n            genSnippet = data?.candidates?.[0]?.content?.parts?.[0]?.text || '';\n          }\n          // Record gen meta for UI\n          setTestMetaMap(prev => ({\n            ...prev,\n            [api.id]: { ...(prev[api.id] || { listStatus, listMs: listTime }), genStatus, genMs: genTime }\n          }));\n          try {\n            await sb.from('api_usage_logs').insert({\n              provider_name: api.provider_name,\n              endpoint: 'generate-content',\n              status_code: genRes.status,\n              response_time: genTime,\n              response_time_ms: Math.round(genTime),\n              prompt: promptText,\n              answer: genSnippet || '',\n              timestamp: new Date().toISOString(),\n            });\n          } catch (e) {\n            await sb.from('api_usage_logs').insert({\n              provider_name: api.provider_name,\n              endpoint: 'generate-content',\n              status_code: genRes.status,\n              response_time: genTime,\n            });\n          }\n          if (genSnippet) {\n            setTestResponseMap(prev => ({ ...prev, [api.id]: genSnippet }));\n            setActiveResponseProviderId(api.id);\n            setResponseDialogOpen(true);\n          }\n        } else {\n          const genUrl = `${base}/v1/chat/completions`;\n          const useModel = (model || api.model_name || 'gpt-4o-mini');\n          const genStart = performance.now();\n          const genRes = await fetch(genUrl, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${api.api_key}` },\n            body: JSON.stringify({\n              model: useModel,\n              messages: [\n                { role: 'system', content: 'You are an AI itinerary assistant.' },\n                { role: 'user', content: promptText },\n              ],\n            }),\n          });\n          genTime = performance.now() - genStart;\n          genStatus = genRes.status;\n          if (genRes.ok) {\n            const data = await genRes.json();\n            genSnippet = data?.choices?.[0]?.message?.content || data?.choices?.[0]?.text || '';\n          } else {\n            // Try to surface error message so user can diagnose\n            try {\n              const errData = await genRes.json();\n              genSnippet = errData?.error?.message ? `Error: ${errData.error.message}` : JSON.stringify(errData);\n            } catch {\n              try {\n                genSnippet = await genRes.text();\n              } catch {\n                genSnippet = '';\n              }\n            }\n          }\n          // Record gen meta for UI\n          setTestMetaMap(prev => ({\n            ...prev,\n            [api.id]: { ...(prev[api.id] || { listStatus, listMs: listTime }), genStatus, genMs: genTime }\n          }));\n          try {\n            await sb.from('api_usage_logs').insert({\n              provider_name: api.provider_name,\n              endpoint: 'chat-completions',\n              status_code: genRes.status,\n              response_time: genTime,\n              response_time_ms: Math.round(genTime),\n              prompt: promptText,\n              answer: genSnippet || '',\n              timestamp: new Date().toISOString(),\n            });\n          } catch (e) {\n            await sb.from('api_usage_logs').insert({\n              provider_name: api.provider_name,\n              endpoint: 'chat-completions',\n              status_code: genRes.status,\n              response_time: genTime,\n            });\n          }\n          if (genSnippet) {\n            setTestResponseMap(prev => ({ ...prev, [api.id]: genSnippet }));\n            setActiveResponseProviderId(api.id);\n            setResponseDialogOpen(true);\n          }\n        }\n      }\n\n      // 3) Update provider metadata\n      await sb\n        .from('api_integrations')\n        .update({\n          last_tested: new Date().toISOString(),\n          usage_count: (typeof api.usage_count === 'number' ? api.usage_count : 0) + 1,\n        })\n        .eq('id', api.id);\n\n      const title = listOk ? ' Connection Successful' : ' Connection Failed';\n      const descParts = [\n        `List status ${listStatus}, ${listTime.toFixed(1)} ms`,\n      ];\n      if (model || api.model_name) {\n        descParts.push(`Gen status ${genStatus || ''}, ${genTime ? genTime.toFixed(1) : ''} ms`);\n      }\n      if (genSnippet) {\n        descParts.push(`\"${genSnippet.slice(0, 100)}\"`);\n      }\n      toast({ title, description: descParts.join('  ') });\n    } catch (err: any) {\n      toast({ title: 'Error', description: err?.message || 'Connection test failed', variant: 'destructive' });\n    } finally {\n      setTestingApiId(null);\n    }\n  }\n\n  async function toggleStatus(id: string, isActive: boolean) {\n    try {\n      // Allow multiple active providers; only update the selected provider\n      const { error } = await sb\n        .from('api_integrations')\n        .update({ status: isActive ? 'active' : 'inactive' })\n        .eq('id', id);\n      if (error) throw error;\n      fetchAPIs();\n    } catch (e: any) {\n      toast({ title: 'Update failed', description: e?.message || 'Could not update status', variant: 'destructive' });\n    }\n  }\n\n  async function deleteAPI(id: string) {\n    try {\n      setDeletingApiId(id);\n      const { error } = await sb.from('api_integrations').delete().eq('id', id);\n      if (error) throw error;\n      toast({ title: 'API deleted' });\n      fetchAPIs();\n    } catch (e: any) {\n      toast({ title: 'Delete failed', description: e?.message || 'Could not delete API provider', variant: 'destructive' });\n    } finally {\n      setDeletingApiId(null);\n    }\n  }\n\n  // Derived report data\n  const providerNames = useMemo(() => Array.from(new Set(apis.map(a => a.provider_name))), [apis]);\n  const allowedProviders = useMemo(() => {\n    const base = statusFilter === 'all' ? apis : apis.filter(a => a.status === statusFilter);\n    if (providerFilter !== 'all') return base.filter(a => a.provider_name === providerFilter);\n    return base;\n  }, [apis, statusFilter, providerFilter]);\n\n  const filteredLogs = useMemo(() => {\n    const namesSet = new Set(allowedProviders.map(a => String(a.provider_name).toLowerCase()));\n    return (usageLogs || []).filter((log: any) => {\n      const nameOk = namesSet.size === 0 ? true : namesSet.has(String(log.provider_name || '').toLowerCase());\n      const providerOk = providerFilter === 'all' || String(log.provider_name) === providerFilter;\n      const search = searchQuery.trim().toLowerCase();\n      const searchOk = !search || String(log.provider_name || '').toLowerCase().includes(search) || String(log.endpoint || '').toLowerCase().includes(search);\n      return nameOk && providerOk && searchOk;\n    });\n  }, [usageLogs, allowedProviders, providerFilter, searchQuery]);\n\n  const overviewMetrics = useMemo(() => {\n    const map = new Map<string, { requests: number; avgMs: number; errors: number }>();\n    for (const api of allowedProviders) {\n      map.set(api.provider_name, { requests: 0, avgMs: 0, errors: 0 });\n    }\n    const sums = new Map<string, number>();\n    for (const log of filteredLogs) {\n      const name = log.provider_name;\n      if (!map.has(name)) continue;\n      const cur = map.get(name)!;\n      cur.requests += 1;\n      const rt = Number(log.response_time || 0);\n      sums.set(name, (sums.get(name) || 0) + rt);\n      if (Number(log.status_code || 0) >= 400) cur.errors += 1;\n    }\n    for (const [name, totalRt] of sums.entries()) {\n      const data = map.get(name)!;\n      data.avgMs = data.requests > 0 ? totalRt / data.requests : 0;\n    }\n    return map;\n  }, [filteredLogs, allowedProviders]);\n\n  const monitorMetrics = useMemo(() => {\n    const byProvider = new Map<string, { total: number; success: number; errors: number; times: number[] }>();\n    for (const api of allowedProviders) {\n      byProvider.set(api.provider_name, { total: 0, success: 0, errors: 0, times: [] });\n    }\n    for (const log of filteredLogs) {\n      const name = String(log.provider_name || '');\n      if (!byProvider.has(name)) continue;\n      const m = byProvider.get(name)!;\n      m.total += 1;\n      const status = Number(log.status_code || 0);\n      if (status >= 400) m.errors += 1; else m.success += 1;\n      const rt = Number(log.response_time || log.response_time_ms || 0);\n      if (!Number.isNaN(rt)) m.times.push(rt);\n    }\n    const rows: Array<{ provider_name: string; total: number; successRate: number; avgMs: number; p95Ms: number; errors: number }> = [];\n    for (const [name, m] of byProvider.entries()) {\n      const avg = m.times.length ? m.times.reduce((a, b) => a + b, 0) / m.times.length : 0;\n      const sorted = m.times.slice().sort((a, b) => a - b);\n      const idx = Math.floor(0.95 * sorted.length) - 1;\n      const p95 = sorted.length ? sorted[Math.max(0, idx)] : 0;\n      const successRate = m.total ? Math.round((m.success / m.total) * 100) : 0;\n      rows.push({ provider_name: name, total: m.total, successRate, avgMs: avg, p95Ms: p95, errors: m.errors });\n    }\n    return rows;\n  }, [filteredLogs, allowedProviders]);\n\n  const trendData = useMemo(() => {\n    // Aggregate by day: YYYY-MM-DD\n    const counts = new Map<string, number>();\n    for (const log of filteredLogs) {\n      const d = new Date(log.created_at);\n      const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n      counts.set(key, (counts.get(key) || 0) + 1);\n    }\n    const entries = Array.from(counts.entries()).sort(([a], [b]) => a.localeCompare(b));\n    return entries.map(([date, total]) => ({ date, total }));\n  }, [filteredLogs]);\n\n  // Google Rate Limits (by model)  current month peak usage vs limits\n  const googleApis = useMemo(() => {\n    return apis.filter((api) => {\n      const url = String(api?.base_url || '').toLowerCase();\n      const name = String(api?.provider_name || '').toLowerCase();\n      return url.includes('generativelanguage.googleapis.com') || name.includes('gemini') || name.includes('google');\n    });\n  }, [apis]);\n\n  const currentMonthStart = useMemo(() => {\n    const now = new Date();\n    return new Date(now.getFullYear(), now.getMonth(), 1);\n  }, []);\n\n  const googleRateLimitRows = useMemo(() => {\n    const monthLogs = (usageLogs || []).filter((log: any) => {\n      const name = String(log?.provider_name || '').toLowerCase();\n      const isGoogle = name.includes('gemini') || name.includes('google');\n      const createdIso = log?.created_at || log?.timestamp;\n      const createdAt = createdIso ? new Date(createdIso) : null;\n      return isGoogle && createdAt && createdAt >= currentMonthStart;\n    });\n\n    const logsByProvider = new Map<string, any[]>();\n    for (const log of monthLogs) {\n      const pn = String(log?.provider_name || '');\n      if (!logsByProvider.has(pn)) logsByProvider.set(pn, []);\n      logsByProvider.get(pn)!.push(log);\n    }\n\n    function deriveCategory(model?: string): string {\n      const m = String(model || '').toLowerCase();\n      if (m.includes('flash-lite')) return 'flash-lite';\n      if (m.includes('flash')) return 'flash';\n      if (m.includes('pro')) return 'pro';\n      return '';\n    }\n\n    return googleApis.map((api) => {\n      const providerName = api.provider_name;\n      const providerLogs = logsByProvider.get(providerName) || [];\n\n      const minuteCounts = new Map<string, number>();\n      const minuteTokenCounts = new Map<string, number>();\n      const dayCounts = new Map<string, number>();\n      for (const log of providerLogs) {\n        const d = new Date(log?.created_at || log?.timestamp);\n        const minuteKey = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')} ${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;\n        const dayKey = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\n        minuteCounts.set(minuteKey, (minuteCounts.get(minuteKey) || 0) + 1);\n        dayCounts.set(dayKey, (dayCounts.get(dayKey) || 0) + 1);\n        const tokens = typeof log?.total_tokens === 'number'\n          ? Number(log.total_tokens)\n          : (typeof log?.prompt_tokens === 'number' || typeof log?.completion_tokens === 'number')\n            ? Number(log.prompt_tokens || 0) + Number(log.completion_tokens || 0)\n            : 0;\n        minuteTokenCounts.set(minuteKey, (minuteTokenCounts.get(minuteKey) || 0) + (tokens || 0));\n      }\n\n      const peakRPM = Array.from(minuteCounts.values()).reduce((m, v) => (v > m ? v : m), 0);\n      const peakRPD = Array.from(dayCounts.values()).reduce((m, v) => (v > m ? v : m), 0);\n      const peakTPM = Array.from(minuteTokenCounts.values()).reduce((m, v) => (v > m ? v : m), 0);\n\n      // Pull configured limits from public.api_model_limits, fallback to latest log metadata if present\n      const limitsMatch = modelLimits.find((l: any) => {\n        return String(l?.provider_name || '') === providerName && String(l?.model_name || '') === String(api?.model_name || '');\n      }) || null;\n\n      const latest = providerLogs.find((l: any) => l?.['Category'] || l?.['RPM'] || l?.['TPM'] || l?.['RPD']) || {};\n      const category = (limitsMatch?.category) || latest?.['Category'] || deriveCategory(api?.model_name);\n\n      const rpmLimitNum = limitsMatch?.rpm_unlimited ? null : (typeof limitsMatch?.rpm_limit === 'number' ? limitsMatch?.rpm_limit : undefined);\n      const rpdLimitNum = limitsMatch?.rpd_unlimited ? null : (typeof limitsMatch?.rpd_limit === 'number' ? limitsMatch?.rpd_limit : undefined);\n      const tpmLimitNum = (typeof limitsMatch?.tpm_limit === 'number' ? limitsMatch?.tpm_limit : undefined);\n\n      const rpm = limitsMatch ? (limitsMatch.rpm_unlimited ? 'Unlimited' : (rpmLimitNum ?? 'N/A')) : (latest?.['RPM'] || '');\n      const tpm = limitsMatch ? (tpmLimitNum ?? 'N/A') : (latest?.['TPM'] || '');\n      const rpd = limitsMatch ? (limitsMatch.rpd_unlimited ? 'Unlimited' : (rpdLimitNum ?? 'N/A')) : (latest?.['RPD'] || '');\n\n      const warnThreshold = typeof limitsMatch?.warn_threshold_percent === 'number' ? limitsMatch.warn_threshold_percent : 80;\n      const rpmUtilPct = (typeof rpmLimitNum === 'number' && rpmLimitNum > 0) ? Math.round((peakRPM / rpmLimitNum) * 100) : null;\n      const rpdUtilPct = (typeof rpdLimitNum === 'number' && rpdLimitNum > 0) ? Math.round((peakRPD / rpdLimitNum) * 100) : null;\n      const tpmUtilPct = (typeof tpmLimitNum === 'number' && tpmLimitNum > 0) ? Math.round((peakTPM / tpmLimitNum) * 100) : null;\n      const rpmUtil = rpmUtilPct !== null ? `${rpmUtilPct}%` : '';\n      const rpdUtil = rpdUtilPct !== null ? `${rpdUtilPct}%` : '';\n      const tpmUtil = tpmUtilPct !== null ? `${tpmUtilPct}%` : '';\n      const warn = (rpmUtilPct !== null && rpmUtilPct >= warnThreshold) || (rpdUtilPct !== null && rpdUtilPct >= warnThreshold) ? ' Extend' : '';\n\n      return {\n        id: api.id,\n        provider: providerName,\n        model: api?.model_name || '',\n        category,\n        rpm,\n        tpm,\n        rpd,\n        peakRPM,\n        peakRPD,\n        peakTPM,\n        rpmUtil,\n        rpdUtil,\n        tpmUtil,\n        warn,\n      };\n    });\n  }, [usageLogs, currentMonthStart, googleApis, modelLimits]);\n\n  function exportCsvOverview() {\n    const rows = [\n      ['Provider', 'Status', 'Total Usage Count', 'Requests (range)', 'Avg Response (ms)', 'Last Tested', 'Errors (range)'],\n    ];\n    for (const api of allowedProviders) {\n      const m = overviewMetrics.get(api.provider_name) || { requests: 0, avgMs: 0, errors: 0 };\n      rows.push([\n        api.provider_name,\n        api.status,\n        String(typeof api.usage_count === 'number' ? api.usage_count : 0),\n        String(m.requests),\n        m.avgMs.toFixed(1),\n        api.last_tested ? new Date(api.last_tested).toLocaleString() : 'Never',\n        String(m.errors),\n      ]);\n    }\n    const csv = rows.map(r => r.map(v => `\"${String(v).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\n    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'api-overview.csv';\n    a.click();\n    URL.revokeObjectURL(url);\n  }\n\n  function exportCsvLogs() {\n    const rows = [ ['Provider', 'Endpoint', 'Status', 'Response Time (ms)', 'Timestamp'] ];\n    for (const log of filteredLogs) {\n      rows.push([\n        log.provider_name || '',\n        log.endpoint || '',\n        String(log.status_code ?? ''),\n        String(Number(log.response_time || 0).toFixed(1)),\n        log.created_at ? new Date(log.created_at).toLocaleString() : '',\n      ]);\n    }\n    const csv = rows.map(r => r.map(v => `\"${String(v).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\n    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'api-logs.csv';\n    a.click();\n    URL.revokeObjectURL(url);\n  }\n\n  async function exportPdfOverview() {\n    try {\n      const mod = await import('jspdf');\n      const jsPDF = (mod as any).jsPDF || (mod as any).default?.jsPDF || (mod as any).default;\n      const doc = new jsPDF();\n      doc.setFontSize(16);\n      doc.text('API Usage Overview', 14, 20);\n      doc.setFontSize(11);\n      let y = 32;\n      for (const api of allowedProviders) {\n        const m = overviewMetrics.get(api.provider_name) || { requests: 0, avgMs: 0, errors: 0 };\n        doc.text(`Provider: ${api.provider_name}`, 14, y); y += 6;\n        doc.text(`Status: ${api.status}`, 14, y); y += 6;\n        doc.text(`Total Usage: ${typeof api.usage_count === 'number' ? api.usage_count : 0}`, 14, y); y += 6;\n        doc.text(`Requests (range): ${m.requests}`, 14, y); y += 6;\n        doc.text(`Avg Response: ${m.avgMs.toFixed(1)} ms`, 14, y); y += 6;\n        doc.text(`Errors (range): ${m.errors}`, 14, y); y += 8;\n        if (y > 270) { doc.addPage(); y = 20; }\n      }\n      doc.save('api-overview.pdf');\n    } catch (e) {\n      toast({ title: 'PDF export failed', description: (e as any)?.message || 'Unable to generate PDF', variant: 'destructive' });\n    }\n  }\n\n  const persistSMTP = async () => {\n    setSaving(true);\n    setPreviewUrl(null);\n    try {\n      const entries = [\n        { key: 'smtp_host', value: smtpHost },\n        { key: 'smtp_port', value: smtpPort },\n        { key: 'smtp_secure', value: smtpSecure },\n        { key: 'smtp_user', value: smtpUser },\n        { key: 'smtp_password', value: smtpPassword },\n        { key: 'from_email', value: fromEmail },\n        { key: 'from_name', value: fromName },\n      ];\n      for (const { key, value } of entries) {\n        await AppSettingsHelpers.upsertSetting({\n          category: SETTING_CATEGORIES.NOTIFICATIONS,\n          setting_key: key,\n          ...(typeof value === 'string' ? { setting_value: value } : { setting_json: value as any }),\n        });\n      }\n      toast({ title: 'SMTP settings saved', description: 'Notifications credentials updated.' });\n    } catch (e: any) {\n      toast({ title: 'Save failed', description: e?.message || 'Could not save SMTP settings', variant: 'destructive' });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleSendTest = async () => {\n    if (!testEmail) {\n      toast({ title: 'Enter test email', description: 'Please provide an email to send test', variant: 'destructive' });\n      return;\n    }\n    setSending(true);\n    setPreviewUrl(null);\n    try {\n      // Build sample email\n      const companyName = appSettings?.companyDetails?.name || 'Triplexa';\n      const html = agentWelcomeTemplate({ companyName, recipientName: 'Test Recipient' });\n      const subject = 'SMTP Test Email';\n      const res = await sendEmail(testEmail, subject, html, {\n        smtp_host: smtpHost,\n        smtp_port: smtpPort,\n        smtp_secure: smtpSecure,\n        smtp_user: smtpUser,\n        smtp_password: smtpPassword,\n        from_email: fromEmail || undefined,\n        from_name: fromName || companyName,\n      });\n      if (res?.previewUrl) {\n        setPreviewUrl(res.previewUrl);\n        toast({ title: 'Test sent', description: 'Preview available via Ethereal link.' });\n      } else {\n        toast({ title: 'Test sent', description: 'Email sent successfully.' });\n      }\n    } catch (e: any) {\n      toast({ title: 'Send failed', description: e?.message || 'Failed to send test email', variant: 'destructive' });\n    } finally {\n      setSending(false);\n    }\n  };\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        {/* Enhanced Unified Header */}\n        <div className=\"flex items-center justify-between bg-gradient-to-r from-blue-50/60 to-indigo-50/60 dark:from-gray-800/30 dark:to-blue-900/20 backdrop-blur-sm rounded-xl p-6 shadow-sm border border-blue-100 dark:border-gray-700\">\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-white/70 dark:bg-gray-700/50 rounded-lg border border-white/80 dark:border-gray-600\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"h-6 w-6 text-blue-600 dark:text-blue-400\">\n                  <path d=\"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z\"/>\n                  <path d=\"m8 16 2-4 4 4 2-4\"/>\n                  <path d=\"M3.5 12H7l2-4 4 4 2-4h3.5\"/>\n                </svg>\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent\">\n                  API Settings & AI Integrations\n                </h1>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300 font-medium\">\n                  Manage AI API providers, monitor usage, and configure model settings with centralized analytics\n                </p>\n              </div>\n            </div>\n          </div>\n          <Button \n            onClick={startAddAPI}\n            className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2.5\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"h-4 w-4 mr-2\">\n              <path d=\"M5 12h14\"/>\n              <path d=\"M12 5v14\"/>\n            </svg>\n            Add API\n          </Button>\n        </div>\n\n        {/* AI Integrations Card */}\n        <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm\">\n          <CardHeader className=\"bg-gradient-to-r from-gray-50/50 to-blue-50/50 dark:from-gray-800/50 dark:to-blue-900/30 rounded-t-lg pb-4\">\n            <div>\n              <CardTitle className=\"text-lg font-bold text-gray-800 dark:text-gray-100\">AI Integrations</CardTitle>\n              <CardDescription className=\"text-gray-600 dark:text-gray-300\">Centralized management for AI API providers</CardDescription>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Filters for AI Integrations */}\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <div className=\"flex items-center gap-2\">\n                <Label className=\"text-sm text-muted-foreground\">View</Label>\n                <div className=\"flex gap-1\">\n                  <Button variant={aiListFilter === 'all' ? 'secondary' : 'outline'} size=\"sm\" onClick={() => setAiListFilter('all')}>All</Button>\n                  <Button variant={aiListFilter === 'active' ? 'secondary' : 'outline'} size=\"sm\" onClick={() => setAiListFilter('active')}>Active</Button>\n                  <Button variant={aiListFilter === 'inactive' ? 'secondary' : 'outline'} size=\"sm\" onClick={() => setAiListFilter('inactive')}>Inactive</Button>\n                </div>\n              </div>\n            </div>\n            {loadingAPIs && <p className=\"text-sm text-muted-foreground\">Loading providers</p>}\n            {!loadingAPIs && apis.length === 0 && (\n              <p className=\"text-sm text-muted-foreground\">No providers configured yet. Click \"Add API\" to create one.</p>\n            )}\n            {!loadingAPIs && apis\n              .filter(api => aiListFilter === 'all' ? true : api.status === aiListFilter)\n              .map((api) => (\n              <Card\n                key={api.id}\n                className={`border ${selectedProviderId === api.id || activeResponseProviderId === api.id ? 'ring-1 ring-primary border-primary' : ''}`}\n                onClick={() => setSelectedProviderId(api.id)}\n              >\n                <CardHeader className=\"flex items-center justify-between\">\n                  <div className=\"space-y-1\">\n                    <h3 className=\"font-semibold flex items-center gap-2\">\n                      <span>{api.provider_name}</span>\n                      {String(api?.base_url || '').toLowerCase().includes('api.openai.com') && (\n                        <Badge variant=\"secondary\">OpenAI</Badge>\n                      )}\n                      {String(api?.base_url || '').toLowerCase().includes('generativelanguage.googleapis.com') && (\n                        <Badge variant=\"secondary\">Gemini</Badge>\n                      )}\n                    </h3>\n                    <div className=\"flex flex-wrap items-center gap-2 text-xs text-muted-foreground\">\n                      <span>Status:</span>\n                      <Badge variant={api.status === 'active' ? 'success' : 'secondary'}>{api.status}</Badge>\n                      <span> Model: {api.model_name || ''}</span>\n                      <span> Priority: {typeof api.priority === 'number' ? api.priority : 0}</span>\n                      <span> Usage: {typeof api.usage_count === 'number' ? api.usage_count : 0}</span>\n                      <span> Last Tested: {api.last_tested ? new Date(api.last_tested).toLocaleString() : 'Never'}</span>\n                    </div>\n                  </div>\n                  <Switch\n                    checked={api.status === 'active'}\n                    onCheckedChange={(checked) => toggleStatus(api.id, checked)}\n                  />\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-gray-600\">Base URL: {api.base_url || ''}</p>\n                  {/* Last test meta chips */}\n                  {testMetaMap[api.id] && (\n                    <div className=\"mt-2 flex flex-wrap items-center gap-2 text-xs text-muted-foreground\">\n                      <Badge variant=\"outline\">List {testMetaMap[api.id].listStatus}</Badge>\n                      <span>{(testMetaMap[api.id].listMs || 0).toFixed(1)} ms</span>\n                      {typeof testMetaMap[api.id].genStatus !== 'undefined' && (\n                        <>\n                          <span></span>\n                          <Badge variant=\"outline\">Gen {testMetaMap[api.id].genStatus}</Badge>\n                          <span>{(testMetaMap[api.id].genMs || 0).toFixed(1)} ms</span>\n                        </>\n                      )}\n                    </div>\n                  )}\n                  {/* Prompt Test Controls */}\n                  <div className=\"mt-3 space-y-2\">\n                    <Label>Test Prompt</Label>\n                    <Input\n                      placeholder=\"Test connection: Reply with 'OK' if you received this message.\"\n                      value={testPromptMap[api.id] || ''}\n                      onChange={(e) => setTestPromptMap(prev => ({ ...prev, [api.id]: e.target.value }))}\n                    />\n                    <div className=\"flex gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setTestPromptMap(prev => ({ ...prev, [api.id]: \"Test connection: Reply with 'OK' if you received this message.\" }))}>Use OK Sample</Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setTestPromptMap(prev => ({ ...prev, [api.id]: `Generate a 4-day Thailand itinerary covering Bangkok and Pattaya. Include hotel suggestions, sightseeing highlights, and approximate timing per day. Keep it short, structured, and easy to read.` }))}>Use Itinerary Sample</Button>\n                    </div>\n                    {/* Model override for OpenAI */}\n                    {((String(api.base_url || '').toLowerCase().includes('api.openai.com')) || (String(api.provider_name || '').toLowerCase().includes('openai'))) && (\n                      <div className=\"mt-2\">\n                        <Label>Model Override (optional)</Label>\n                        <select\n                          className=\"w-full border rounded px-2 py-1\"\n                          value={modelOverrideMap[api.id] || ''}\n                          onChange={(e) => setModelOverrideMap(prev => ({ ...prev, [api.id]: e.target.value }))}\n                        >\n                          <option value=\"\">Default (integration)</option>\n                          <option value=\"gpt-4o-mini\">gpt-4o-mini</option>\n                          <option value=\"gpt-3.5-turbo\">gpt-3.5-turbo</option>\n                        </select>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n                <CardFooter className=\"flex gap-2\">\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => testConnection(api, testPromptMap[api.id], modelOverrideMap[api.id])} disabled={testingApiId === api.id}>\n                    {testingApiId === api.id ? 'Testing' : 'Test'}\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={async () => {\n                      setTestingSmartId(api.id);\n                      try {\n                        const res = await fetch('http://localhost:3000/api/test-ai', {\n                          method: 'POST',\n                          headers: { 'Content-Type': 'application/json' },\n                          body: JSON.stringify({ prompt: 'System test: reply with READY.' }),\n                        });\n                        const data = await res.json();\n                        if (!res.ok) throw new Error(data?.error || 'Test failed');\n                        toast({ title: 'Smart Router', description: ` ${data.provider} (${data.model})  ${Math.round(data.response_time_ms)} ms` });\n                      } catch (e: any) {\n                        toast({ title: 'Smart test failed', description: e?.message || 'Unable to test /api/test-ai', variant: 'destructive' });\n                      } finally {\n                        setTestingSmartId(null);\n                      }\n                    }}\n                    disabled={testingSmartId === api.id}\n                  >\n                    {testingSmartId === api.id ? 'Routing' : 'Test AI'}\n                  </Button>\n                  {testResponseMap[api.id] && (\n                    <>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => { setActiveResponseProviderId(api.id); setResponseDialogOpen(true); }}>View Response</Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setTestResponseMap(prev => { const next = { ...prev }; delete next[api.id]; return next; })}>Clear</Button>\n                    </>\n                  )}\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => editAPI(api)}>Edit</Button>\n                  <Button variant=\"destructive\" size=\"sm\" onClick={() => deleteAPI(api.id)} disabled={deletingApiId === api.id}>\n                    {deletingApiId === api.id ? 'Deleting' : 'Delete'}\n                  </Button>\n                </CardFooter>\n\n                {/* Test Response Viewer Dialog */}\n                <Dialog open={responseDialogOpen && activeResponseProviderId === api.id} onOpenChange={(open) => setResponseDialogOpen(open)}>\n                  <DialogContent className=\"sm:max-w-xl\">\n                    <DialogHeader>\n                      <DialogTitle>Test Response</DialogTitle>\n                      <DialogDescription>\n                        View the API test response and prompt details\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-2\">\n                      <Label>Prompt</Label>\n                      <Textarea readOnly value={(testPromptMap[api.id] || '').trim()} className=\"h-24\" />\n                      <Label>Full Response</Label>\n                      <Textarea readOnly value={(testResponseMap[api.id] || '').trim()} className=\"h-48\" />\n                    </div>\n                    <DialogFooter className=\"gap-2\">\n                      <Button variant=\"outline\" onClick={() => { setResponseDialogOpen(false); }}>Close</Button>\n                      <Button variant=\"outline\" onClick={() => navigator.clipboard.writeText(testResponseMap[api.id] || '')}>Copy</Button>\n                      <Button variant=\"destructive\" onClick={() => { setTestResponseMap(prev => { const next = { ...prev }; delete next[api.id]; return next; }); setResponseDialogOpen(false); }}>Clear</Button>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              </Card>\n              ))}\n          </CardContent>\n        </Card>\n        \n        {/* Currency API Notice */}\n        {/* <Alert>\n          <ArrowRight className=\"h-4 w-4\" />\n          <AlertDescription>\n            <strong>Looking for Currency API settings?</strong> CurrencyAPI.com configuration has been moved to{' '}\n            <button \n              onClick={() => navigate('/settings/currency-converter')}\n              className=\"text-blue-600 hover:underline font-medium\"\n            >\n              Currency Converter Settings\n            </button>{' '}\n            for better integration.\n          </AlertDescription>\n        </Alert> */}\n        \n       \n\n        {/* API Usage Reports */}\n        <Card>\n          <CardHeader className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle>API Usage Reports</CardTitle>\n              <CardDescription>View, analyze, and manage AI API activity and performance</CardDescription>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={() => exportCsvOverview()}>Export Overview CSV</Button>\n              <Button variant=\"outline\" onClick={() => exportCsvLogs()}>Download Logs CSV</Button>\n              <Button onClick={() => exportPdfOverview()}>Export Overview PDF</Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Filters */}\n            <div className=\"grid grid-cols-1 md:grid-cols-6 gap-3\">\n              <div>\n                <Label>Provider</Label>\n                <select className=\"w-full border rounded px-2 py-1\" value={providerFilter} onChange={(e) => setProviderFilter(e.target.value)}>\n                  <option value=\"all\">All</option>\n                  {providerNames.map(name => (\n                    <option key={name} value={name}>{name}</option>\n                  ))}\n                </select>\n              </div>\n              <div>\n                <Label>Status</Label>\n                <select className=\"w-full border rounded px-2 py-1\" value={statusFilter} onChange={(e) => setStatusFilter(e.target.value as any)}>\n                  <option value=\"all\">All</option>\n                  <option value=\"active\">Active</option>\n                  <option value=\"inactive\">Inactive</option>\n                </select>\n              </div>\n              <div>\n                <Label>From</Label>\n                <Input type=\"date\" value={dateFrom} onChange={(e) => setDateFrom(e.target.value)} />\n              </div>\n              <div>\n                <Label>To</Label>\n                <Input type=\"date\" value={dateTo} onChange={(e) => setDateTo(e.target.value)} />\n              </div>\n              <div>\n                <Label>Search</Label>\n                <Input placeholder=\"Provider or keyword\" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} />\n              </div>\n              <div>\n                <Label>Rows</Label>\n                <select className=\"w-full border rounded px-2 py-1\" value={logsPageSize} onChange={(e) => { setLogsPageSize(Number(e.target.value)); setLogsPage(1); }}>\n                  <option value={20}>20</option>\n                  <option value={50}>50</option>\n                  <option value={100}>100</option>\n                </select>\n              </div>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" onClick={() => { setLogsPage(1); fetchUsageLogs(); }} disabled={loadingLogs}>{loadingLogs ? 'Loading' : 'Apply Filters'}</Button>\n              <Button variant=\"outline\" onClick={() => { setDateFrom(''); setDateTo(''); setProviderFilter('all'); setStatusFilter('all'); setSearchQuery(''); setLogsPage(1); fetchUsageLogs(); }}>Reset</Button>\n            </div>\n\n            {/* Tabs: Overview / Logs / Trends */}\n            <Tabs defaultValue=\"overview\" className=\"w-full\">\n              <TabsList>\n                <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n                <TabsTrigger value=\"monitor\">Monitor</TabsTrigger>\n                <TabsTrigger value=\"logs\">Logs</TabsTrigger>\n                <TabsTrigger value=\"trends\">Trends</TabsTrigger>\n                <TabsTrigger value=\"limits\">Google Rate Limits</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"overview\" className=\"space-y-3\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n                  {allowedProviders.map(api => {\n                    const metrics = overviewMetrics.get(api.provider_name) || { requests: 0, avgMs: 0, errors: 0 };\n                    return (\n                      <Card key={api.id} className=\"border\">\n                        <CardHeader>\n                          <CardTitle className=\"flex items-center justify-between\">\n                            <span>{api.provider_name}</span>\n                            <Badge variant={api.status === 'active' ? 'success' : 'secondary'}>{api.status}</Badge>\n                          </CardTitle>\n                          <CardDescription>Last Tested: {api.last_tested ? new Date(api.last_tested).toLocaleString() : 'Never'}</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"space-y-2\">\n                          <div className=\"flex items-center justify-between\"><span>Total Usage Count</span><span className=\"font-semibold\">{typeof api.usage_count === 'number' ? api.usage_count : 0}</span></div>\n                          <div className=\"flex items-center justify-between\"><span>Requests (range)</span><span className=\"font-semibold\">{metrics.requests}</span></div>\n                          <div className=\"flex items-center justify-between\"><span>Avg. Response Time</span><span className=\"font-semibold\">{metrics.avgMs.toFixed(1)} ms</span></div>\n                          <div className=\"flex items-center justify-between\"><span>Recent Errors</span><span className=\"font-semibold\">{metrics.errors}</span></div>\n                        </CardContent>\n                      </Card>\n                    );\n                  })}\n                </div>\n                {/* Error summary panel */}\n                <Card className=\"mt-3\">\n                  <CardHeader>\n                    <CardTitle>Error Summary</CardTitle>\n                    <CardDescription>Recent failures by provider in selected range</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead>Provider</TableHead>\n                          <TableHead>Errors</TableHead>\n                          <TableHead>Last Tested</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {allowedProviders.map(api => {\n                          const m = overviewMetrics.get(api.provider_name) || { errors: 0 } as any;\n                          return (\n                            <TableRow key={api.id}>\n                              <TableCell>{api.provider_name}</TableCell>\n                              <TableCell className=\"text-destructive font-semibold\">{m.errors}</TableCell>\n                              <TableCell>{api.last_tested ? new Date(api.last_tested).toLocaleString() : 'Never'}</TableCell>\n                            </TableRow>\n                          );\n                        })}\n                      </TableBody>\n                    </Table>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"monitor\">\n                <Card className=\"border\">\n                  <CardHeader>\n                    <CardTitle>Provider Health</CardTitle>\n                    <CardDescription>Success rate and latency metrics</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    {monitorMetrics.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No activity in selected range.</p>\n                    ) : (\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead>Provider</TableHead>\n                            <TableHead>Requests</TableHead>\n                            <TableHead>Success Rate</TableHead>\n                            <TableHead>Avg Latency</TableHead>\n                            <TableHead>p95 Latency</TableHead>\n                            <TableHead>Errors</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {monitorMetrics.map((m) => (\n                            <TableRow key={m.provider_name}>\n                              <TableCell>{m.provider_name}</TableCell>\n                              <TableCell>{m.total}</TableCell>\n                              <TableCell>{m.successRate}%</TableCell>\n                              <TableCell>{m.avgMs.toFixed(1)} ms</TableCell>\n                              <TableCell>{m.p95Ms.toFixed(1)} ms</TableCell>\n                              <TableCell className={m.errors > 0 ? 'text-destructive font-semibold' : ''}>{m.errors}</TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"logs\">\n                <Card className=\"border\">\n                  <CardHeader>\n                    <CardTitle>Detailed Logs</CardTitle>\n                    <CardDescription>Endpoint, timestamp, status, and duration</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    {loadingLogs && <p className=\"text-sm text-muted-foreground\">Loading logs</p>}\n                    {!loadingLogs && filteredLogs.length === 0 && <p className=\"text-sm text-muted-foreground\">No logs match current filters.</p>}\n                    {!loadingLogs && filteredLogs.length > 0 && (\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead>Provider</TableHead>\n                            <TableHead>Endpoint</TableHead>\n                            <TableHead>Status</TableHead>\n                            <TableHead>Response Time</TableHead>\n                            <TableHead>Timestamp</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {filteredLogs.map((log: any, idx: number) => (\n                            <TableRow key={`${log.id || idx}`} className=\"cursor-pointer\" onClick={() => setSelectedLog(log)}>\n                              <TableCell>{log.provider_name || ''}</TableCell>\n                              <TableCell className=\"truncate max-w-[260px]\" title={log.endpoint}>{log.endpoint}</TableCell>\n                              <TableCell>{log.status_code}</TableCell>\n                              <TableCell>{Number(log.response_time || 0).toFixed(1)} ms</TableCell>\n                              <TableCell>{log.created_at ? new Date(log.created_at).toLocaleString() : ''}</TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n                    )}\n                    {!loadingLogs && filteredLogs.length > 0 && (\n                      <div className=\"flex items-center justify-between pt-3\">\n                        <div className=\"text-sm text-muted-foreground\">\n                          Page {logsPage} of {Math.max(1, Math.ceil(((logsTotal || filteredLogs.length) / logsPageSize)))}  Showing {filteredLogs.length} rows\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <Button variant=\"outline\" size=\"sm\" onClick={() => setLogsPage(p => Math.max(1, p - 1))} disabled={logsPage <= 1}>Prev</Button>\n                          <Button variant=\"outline\" size=\"sm\" onClick={() => setLogsPage(p => p + 1)} disabled={logsTotal > 0 ? logsPage >= Math.ceil(logsTotal / logsPageSize) : false}>Next</Button>\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"trends\">\n                <Card className=\"border\">\n                  <CardHeader>\n                    <CardTitle>Request Trends</CardTitle>\n                    <CardDescription>Daily volume in selected range</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"h-[260px]\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <LineChart data={trendData} margin={{ top: 8, right: 16, left: 8, bottom: 8 }}>\n                          <CartesianGrid strokeDasharray=\"3 3\" />\n                          <XAxis dataKey=\"date\" />\n                          <YAxis allowDecimals={false} />\n                          <Tooltip />\n                          <Legend />\n                          <Line type=\"monotone\" dataKey=\"total\" stroke=\"#2563eb\" name=\"Requests\" />\n                        </LineChart>\n                      </ResponsiveContainer>\n                    </div>\n                    <div className=\"h-[260px] mt-6\">\n                      <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <BarChart data={trendData} margin={{ top: 8, right: 16, left: 8, bottom: 8 }}>\n                          <CartesianGrid strokeDasharray=\"3 3\" />\n                          <XAxis dataKey=\"date\" />\n                          <YAxis allowDecimals={false} />\n                          <Tooltip />\n                          <Legend />\n                          <Bar dataKey=\"total\" fill=\"#22c55e\" name=\"Requests\" />\n                        </BarChart>\n                      </ResponsiveContainer>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"limits\">\n                <Card className=\"border\">\n                  <CardHeader>\n                    <CardTitle>Rate Limits by Model (Google Keys)</CardTitle>\n                    <CardDescription>Current month peak usage vs configured limits</CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    {googleRateLimitRows.length === 0 ? (\n                      <p className=\"text-sm text-muted-foreground\">No Google integrations found or no logs this month.</p>\n                    ) : (\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead>Provider</TableHead>\n                            <TableHead>Model</TableHead>\n                            <TableHead>Category</TableHead>\n                            <TableHead>RPM</TableHead>\n                            <TableHead>TPM</TableHead>\n                            <TableHead>RPD</TableHead>\n                            <TableHead>Peak RPM (month)</TableHead>\n                          <TableHead>Peak RPD (month)</TableHead>\n                          <TableHead>Peak TPM (month)</TableHead>\n                          <TableHead>RPM Utilization</TableHead>\n                          <TableHead>RPD Utilization</TableHead>\n                          <TableHead>TPM Utilization</TableHead>\n                          <TableHead>Warning</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {googleRateLimitRows.map((row) => (\n                            <TableRow key={row.id}>\n                              <TableCell>{row.provider}</TableCell>\n                              <TableCell className=\"truncate max-w-[220px]\" title={row.model}>{row.model}</TableCell>\n                              <TableCell>{row.category}</TableCell>\n                              <TableCell>{row.rpm}</TableCell>\n                              <TableCell>{row.tpm}</TableCell>\n                              <TableCell>{row.rpd}</TableCell>\n                              <TableCell>{row.peakRPM}</TableCell>\n                              <TableCell>{row.peakRPD}</TableCell>\n                              <TableCell>{row.peakTPM}</TableCell>\n                              <TableCell>{row.rpmUtil}</TableCell>\n                              <TableCell>{row.rpdUtil}</TableCell>\n                              <TableCell>{row.tpmUtil}</TableCell>\n                              <TableCell className={row.warn ? 'text-red-600 font-medium' : ''}>{row.warn || ''}</TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </CardContent>\n        </Card>\n        {/* Add / Edit API Modal */}\n        <Dialog open={openModal} onOpenChange={setOpenModal}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>{editingApiId ? 'Edit API Provider' : 'Add New API'}</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <Input\n                placeholder=\"Provider Name (Gemini / OpenAI)\"\n                value={form.provider_name}\n                onChange={(e) => setForm({ ...form, provider_name: e.target.value })}\n              />\n              <Input\n                placeholder=\"Base URL (e.g. https://generativelanguage.googleapis.com/v1 or https://api.openai.com)\"\n                value={form.base_url}\n                onChange={(e) => setForm({ ...form, base_url: e.target.value })}\n              />\n              <div className=\"relative\">\n                <Input\n                  type={modalShowKey ? 'text' : 'password'}\n                  placeholder=\"API Key\"\n                  value={form.api_key}\n                  onChange={(e) => setForm({ ...form, api_key: e.target.value })}\n                />\n                <button type=\"button\" className=\"absolute right-3 top-2\" onClick={() => setModalShowKey(!modalShowKey)}>\n                  {modalShowKey ? <EyeOffIcon className=\"h-4 w-4 text-gray-500\" /> : <EyeIcon className=\"h-4 w-4 text-gray-500\" />}\n                </button>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <label>Status:</label>\n                <Switch\n                  checked={form.status === 'active'}\n                  onCheckedChange={(checked) => setForm({ ...form, status: checked ? 'active' : 'inactive' })}\n                />\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-3\">\n                <Input\n                  placeholder=\"Model Name (optional, e.g. gemini-2.5-flash or gpt-4o-mini)\"\n                  value={form.model_name || ''}\n                  onChange={(e) => setForm({ ...form, model_name: e.target.value })}\n                />\n                <Input\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"Temperature\"\n                  value={String(form.temperature ?? 0.7)}\n                  onChange={(e) => setForm({ ...form, temperature: Number(e.target.value) })}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"Max Tokens\"\n                  value={String(form.max_tokens ?? 2048)}\n                  onChange={(e) => setForm({ ...form, max_tokens: Number(e.target.value) })}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"Priority (lower runs first, default 0)\"\n                  value={String(typeof form.priority === 'number' ? form.priority : 0)}\n                  onChange={(e) => setForm({ ...form, priority: Number(e.target.value) })}\n                />\n              </div>\n              {/* Limits configuration */}\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-3\">\n                <Input\n                  type=\"number\"\n                  placeholder=\"Daily Limit (requests per day)\"\n                  value={String(typeof form.daily_limit === 'number' ? form.daily_limit : 50)}\n                  onChange={(e) => setForm({ ...form, daily_limit: Number(e.target.value) })}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"RPM (requests per minute)\"\n                  value={String(form.requests_per_minute_limit ?? 60)}\n                  onChange={(e) => setForm({ ...form, requests_per_minute_limit: Number(e.target.value) })}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"TPM (tokens per minute, input)\"\n                  value={String(form.tokens_per_minute_limit ?? 30000)}\n                  onChange={(e) => setForm({ ...form, tokens_per_minute_limit: Number(e.target.value) })}\n                />\n                <Input\n                  type=\"number\"\n                  placeholder=\"RPD (requests per day)\"\n                  value={String(form.requests_per_day_limit ?? 500)}\n                  onChange={(e) => setForm({ ...form, requests_per_day_limit: Number(e.target.value) })}\n                />\n              </div>\n              {editingApi && (\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm text-muted-foreground\">\n                  <div className=\"flex items-center justify-between\"><span>Current minute requests</span><span className=\"font-semibold\">{typeof editingApi.current_minute_requests === 'number' ? editingApi.current_minute_requests : 0}</span></div>\n                  <div className=\"flex items-center justify-between\"><span>Current minute tokens</span><span className=\"font-semibold\">{typeof editingApi.current_minute_tokens === 'number' ? editingApi.current_minute_tokens : 0}</span></div>\n                  <div className=\"flex items-center justify-between\"><span>Current day requests</span><span className=\"font-semibold\">{typeof editingApi.current_day_requests === 'number' ? editingApi.current_day_requests : 0}</span></div>\n                  <div className=\"flex items-center justify-between\"><span>Last reset minute</span><span className=\"font-semibold\">{editingApi.last_reset_minute ? new Date(editingApi.last_reset_minute).toLocaleString() : ''}</span></div>\n                  <div className=\"flex items-center justify-between\"><span>Last reset day</span><span className=\"font-semibold\">{editingApi.last_reset_day ? new Date(editingApi.last_reset_day).toLocaleString() : ''}</span></div>\n                </div>\n              )}\n              {editingApi && isAdmin && (\n                <div className=\"flex flex-wrap gap-2 pt-2\">\n                  <Button variant=\"outline\" size=\"sm\" onClick={resetMinuteCounters}>Reset minute counters</Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={resetDayCounters}>Reset day counters</Button>\n                  <Button variant=\"destructive\" size=\"sm\" onClick={resetAllCounters}>Zero all counters</Button>\n                </div>\n              )}\n            </div>\n            <DialogFooter>\n              <Button onClick={handleSaveProvider} disabled={savingApi}>{savingApi ? 'Saving' : 'Save'}</Button>\n              <Button variant=\"outline\" onClick={() => setOpenModal(false)}>Cancel</Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Log Details Dialog */}\n        <Dialog open={!!selectedLog} onOpenChange={(open) => !open && setSelectedLog(null)}>\n          <DialogContent className=\"sm:max-w-[600px]\">\n            <DialogHeader>\n              <DialogTitle>Log Details</DialogTitle>\n              <DialogDescription>\n                Detailed information about the API usage log\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex items-center justify-between\"><span>Provider</span><span className=\"font-semibold\">{selectedLog?.provider_name || ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Endpoint</span><span className=\"font-semibold truncate max-w-[360px]\" title={selectedLog?.endpoint}>{selectedLog?.endpoint || ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Status Code</span><span className=\"font-semibold\">{selectedLog?.status_code ?? ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Response Time</span><span className=\"font-semibold\">{selectedLog ? Number(selectedLog.response_time || 0).toFixed(1) : ''} ms</span></div>\n              <div className=\"flex items-center justify-between\"><span>Timestamp</span><span className=\"font-semibold\">{selectedLog?.created_at ? new Date(selectedLog.created_at).toLocaleString() : ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Model</span><span className=\"font-semibold\">{selectedLog?.model_name || ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Prompt Tokens</span><span className=\"font-semibold\">{typeof selectedLog?.prompt_tokens === 'number' ? selectedLog?.prompt_tokens : ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Completion Tokens</span><span className=\"font-semibold\">{typeof selectedLog?.completion_tokens === 'number' ? selectedLog?.completion_tokens : ''}</span></div>\n              <div className=\"flex items-center justify-between\"><span>Total Tokens</span><span className=\"font-semibold\">{typeof selectedLog?.total_tokens === 'number' ? selectedLog?.total_tokens : (typeof selectedLog?.prompt_tokens === 'number' || typeof selectedLog?.completion_tokens === 'number' ? (Number(selectedLog?.prompt_tokens || 0) + Number(selectedLog?.completion_tokens || 0)) : '')}</span></div>\n              {selectedLog?.fallback_reason && (<div className=\"flex items-center justify-between\"><span>Fallback</span><span className=\"font-semibold truncate max-w-[360px]\" title={selectedLog.fallback_reason}>{selectedLog.fallback_reason}</span></div>)}\n            </div>\n            <DialogFooter className=\"gap-2\">\n              <Button variant=\"outline\" onClick={() => setSelectedLog(null)}>Close</Button>\n              {isAdmin && selectedLog?.id && (\n                <Button variant=\"destructive\" onClick={deleteSelectedLog}>Delete Log</Button>\n              )}\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default ApiSettings;\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Separator } from '@/components/ui/separator';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { useToast } from '@/components/ui/use-toast';\nimport { useApp } from '@/contexts/AppContext';\nimport { \n  Shield, Users, Settings, Globe, Search, \n  AlertTriangle, CheckCircle, Save, Undo,\n  Eye, EyeOff, Lock, Unlock, BarChart3\n} from 'lucide-react';\nimport { DashboardAccessControl } from '@/types/dashboardTypes';\n\n// Define types for permissions\ninterface Permission {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  defaultRoles: string[];\n  isSystemCritical?: boolean;\n}\n\ninterface RolePermissions {\n  [role: string]: string[];\n}\n\nconst AccessControl: React.FC = () => {\n  const { currentUser } = useApp();\n  const { toast } = useToast();\n  const navigate = useNavigate();\n  const [activeTab, setActiveTab] = useState('roles');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n  const [rolePermissions, setRolePermissions] = useState<RolePermissions>({\n    super_admin: [],\n    manager: [],\n    staff: [],\n    agent: [],\n  });\n\n  // Dashboard access control state\n  const [dashboardAccess, setDashboardAccess] = useState<DashboardAccessControl[]>([\n    {\n      dashboardId: 'operations-dashboard',\n      allowedRoles: ['super_admin', 'manager'],\n      allowedDepartments: ['Operations'],\n      restrictByDepartment: true\n    },\n    {\n      dashboardId: 'sales-dashboard',\n      allowedRoles: ['super_admin', 'manager'],\n      allowedDepartments: ['Sales'],\n      restrictByDepartment: true\n    },\n    {\n      dashboardId: 'content-dashboard',\n      allowedRoles: ['super_admin', 'manager'],\n      allowedDepartments: ['Marketing'],\n      restrictByDepartment: true\n    },\n    {\n      dashboardId: 'support-dashboard',\n      allowedRoles: ['super_admin', 'manager'],\n      allowedDepartments: ['Customer Support'],\n      restrictByDepartment: true\n    },\n    {\n      dashboardId: 'finance-dashboard',\n      allowedRoles: ['super_admin', 'manager'],\n      allowedDepartments: ['Finance'],\n      restrictByDepartment: true\n    }\n  ]);\n\n  // Check if the current user has admin privileges (super_admin or manager)\n  const isAdmin = currentUser?.role === 'super_admin' || currentUser?.role === 'manager';\n  \n  // Redirect non-admin users\n  useEffect(() => {\n    if (!isAdmin) {\n      toast({\n        title: \"Access denied\",\n        description: \"You don't have permission to access this section\",\n        variant: \"destructive\"\n      });\n      navigate('/');\n    }\n  }, [isAdmin, navigate, toast]);\n\n  // Define available permissions grouped by category\n  const allPermissions: Permission[] = [\n    // Inventory permissions\n    { id: 'inventory.hotels.view', name: 'View Hotels', description: 'Can view hotel listings', category: 'inventory', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    { id: 'inventory.hotels.create', name: 'Create Hotels', description: 'Can add new hotels', category: 'inventory', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'inventory.hotels.edit', name: 'Edit Hotels', description: 'Can modify hotel information', category: 'inventory', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'inventory.hotels.delete', name: 'Delete Hotels', description: 'Can remove hotels', category: 'inventory', defaultRoles: ['super_admin'], isSystemCritical: true },\n    { id: 'inventory.packages.view', name: 'View Packages', description: 'Can view travel packages', category: 'inventory', defaultRoles: ['super_admin', 'manager', 'staff', 'agent'] },\n    { id: 'inventory.packages.manage', name: 'Manage Packages', description: 'Can add, edit, and delete travel packages', category: 'inventory', defaultRoles: ['super_admin', 'manager'] },\n    \n    // Queries permissions\n    { id: 'queries.view', name: 'View Queries', description: 'Can view customer queries', category: 'queries', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    { id: 'queries.create', name: 'Create Queries', description: 'Can create new queries', category: 'queries', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    { id: 'queries.assign', name: 'Assign Queries', description: 'Can assign queries to staff', category: 'queries', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'queries.resolve', name: 'Resolve Queries', description: 'Can mark queries as resolved', category: 'queries', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    \n    // Agent permissions\n    { id: 'agents.view', name: 'View All Agents', description: 'Can view all agents in the system', category: 'agents', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'agents.view.own', name: 'View Own Agents', description: 'Can view agents they created or are assigned to', category: 'agents', defaultRoles: ['staff'] },\n    { id: 'agents.create', name: 'Create Agents', description: 'Can create new agents', category: 'agents', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    { id: 'agents.edit.own', name: 'Edit Own Agents', description: 'Can edit agents they created or are assigned to', category: 'agents', defaultRoles: ['staff'] },\n    { id: 'agents.delete.own', name: 'Delete Own Agents', description: 'Can delete agents they created', category: 'agents', defaultRoles: ['staff'] },\n    { id: 'agents.assign.staff', name: 'Assign Staff to Agents', description: 'Can assign other staff members to agents', category: 'agents', defaultRoles: ['super_admin', 'manager', 'staff'] },\n    { id: 'agents.manage.all', name: 'Manage All Agents', description: 'Full management access to all agents', category: 'agents', defaultRoles: ['super_admin', 'manager'], isSystemCritical: true },\n    \n    // Settings permissions\n    { id: 'settings.general', name: 'General Settings', description: 'Can modify general settings', category: 'settings', defaultRoles: ['super_admin'], isSystemCritical: true },\n    { id: 'settings.access', name: 'Access Control', description: 'Can manage user permissions', category: 'settings', defaultRoles: ['super_admin'], isSystemCritical: true },\n    { id: 'settings.languages', name: 'Language Settings', description: 'Can manage languages', category: 'settings', defaultRoles: ['super_admin'] },\n    \n    // Users permissions\n    { id: 'users.view', name: 'View Users', description: 'Can view user list', category: 'users', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'users.create', name: 'Create Users', description: 'Can add new users', category: 'users', defaultRoles: ['super_admin'], isSystemCritical: true },\n    { id: 'users.edit', name: 'Edit Users', description: 'Can modify user profiles', category: 'users', defaultRoles: ['super_admin'] },\n    { id: 'users.delete', name: 'Delete Users', description: 'Can remove users', category: 'users', defaultRoles: ['super_admin'], isSystemCritical: true },\n    \n    // Dashboard permissions with enhanced descriptions\n    { id: 'operations-dashboard', name: 'Operations Dashboard', description: 'Full access to operations executive dashboard', category: 'dashboards', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'sales-dashboard', name: 'Sales Dashboard', description: 'Full access to sales executive dashboard', category: 'dashboards', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'content-dashboard', name: 'Content Dashboard', description: 'Full access to package & content manager dashboard', category: 'dashboards', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'support-dashboard', name: 'Support Dashboard', description: 'Full access to customer support dashboard', category: 'dashboards', defaultRoles: ['super_admin', 'manager'] },\n    { id: 'finance-dashboard', name: 'Finance Dashboard', description: 'Full access to finance & accounts dashboard', category: 'dashboards', defaultRoles: ['super_admin', 'manager'] },\n  ];\n\n  const categories = [\n    { id: 'all', name: 'All Categories', icon: Settings },\n    { id: 'inventory', name: 'Inventory', icon: Globe },\n    { id: 'queries', name: 'Queries', icon: Users },\n    { id: 'agents', name: 'Agents', icon: Users },\n    { id: 'settings', name: 'Settings', icon: Settings },\n    { id: 'users', name: 'Users', icon: Users },\n    { id: 'dashboards', name: 'Dashboards', icon: Shield },\n  ];\n\n  const roles = [\n    { id: 'super_admin', name: 'Super Admin', color: 'bg-red-100 text-red-800' },\n    { id: 'manager', name: 'Manager', color: 'bg-blue-100 text-blue-800' },\n    { id: 'staff', name: 'Staff', color: 'bg-green-100 text-green-800' },\n    { id: 'agent', name: 'Agent', color: 'bg-purple-100 text-purple-800' },\n  ];\n\n  const departments = [\n    'Operations', 'Sales', 'Marketing', 'Customer Support', 'Finance', 'HR'\n  ];\n\n  const dashboards = [\n    { id: 'operations-dashboard', name: 'Operations Dashboard', description: 'Manage bookings, inventory, and operations' },\n    { id: 'sales-dashboard', name: 'Sales Dashboard', description: 'Track sales metrics and customer queries' },\n    { id: 'content-dashboard', name: 'Content Dashboard', description: 'Manage packages and marketing content' },\n    { id: 'support-dashboard', name: 'Support Dashboard', description: 'Handle customer support and tickets' },\n    { id: 'finance-dashboard', name: 'Finance Dashboard', description: 'Monitor financial reports and accounting' }\n  ];\n\n  // Filter permissions based on search and category\n  const filteredPermissions = allPermissions.filter(permission => {\n    const matchesSearch = permission.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         permission.description.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesCategory = selectedCategory === 'all' || permission.category === selectedCategory;\n    return matchesSearch && matchesCategory;\n  });\n\n  // Initialize permissions on component mount\n  useEffect(() => {\n    const initialRolePermissions: RolePermissions = {\n      super_admin: [], \n      manager: [],\n      staff: [],\n      agent: []\n    };\n    \n    // Populate with default permissions\n    allPermissions.forEach(permission => {\n      permission.defaultRoles.forEach(role => {\n        if (initialRolePermissions[role]) {\n          initialRolePermissions[role].push(permission.id);\n        }\n      });\n    });\n    \n    setRolePermissions(initialRolePermissions);\n  }, []);\n\n  // Toggle permission for a role\n  const togglePermission = (role: string, permissionId: string) => {\n    setRolePermissions(prev => {\n      const updatedPermissions = { ...prev };\n      \n      if (updatedPermissions[role].includes(permissionId)) {\n        updatedPermissions[role] = updatedPermissions[role].filter(id => id !== permissionId);\n      } else {\n        updatedPermissions[role] = [...updatedPermissions[role], permissionId];\n      }\n      \n      return updatedPermissions;\n    });\n    \n    setHasUnsavedChanges(true);\n  };\n\n  // Toggle dashboard role access\n  const toggleDashboardRoleAccess = (dashboardId: string, role: string) => {\n    setDashboardAccess(prev => {\n      const updated = prev.map(dashboard => {\n        if (dashboard.dashboardId === dashboardId) {\n          const allowedRoles = dashboard.allowedRoles.includes(role)\n            ? dashboard.allowedRoles.filter(r => r !== role)\n            : [...dashboard.allowedRoles, role];\n          return { ...dashboard, allowedRoles };\n        }\n        return dashboard;\n      });\n      return updated;\n    });\n    setHasUnsavedChanges(true);\n  };\n\n  // Toggle dashboard department access\n  const toggleDashboardDepartmentAccess = (dashboardId: string, department: string) => {\n    setDashboardAccess(prev => {\n      const updated = prev.map(dashboard => {\n        if (dashboard.dashboardId === dashboardId) {\n          const allowedDepartments = dashboard.allowedDepartments.includes(department)\n            ? dashboard.allowedDepartments.filter(d => d !== department)\n            : [...dashboard.allowedDepartments, department];\n          return { ...dashboard, allowedDepartments };\n        }\n        return dashboard;\n      });\n      return updated;\n    });\n    setHasUnsavedChanges(true);\n  };\n\n  // Toggle department restriction\n  const toggleDepartmentRestriction = (dashboardId: string) => {\n    setDashboardAccess(prev => {\n      const updated = prev.map(dashboard => {\n        if (dashboard.dashboardId === dashboardId) {\n          return { ...dashboard, restrictByDepartment: !dashboard.restrictByDepartment };\n        }\n        return dashboard;\n      });\n      return updated;\n    });\n    setHasUnsavedChanges(true);\n  };\n\n  // Save permissions\n  const savePermissions = () => {\n    // In a real implementation, you would send this to an API\n    console.log('Saving permissions:', rolePermissions);\n    console.log('Saving dashboard access:', dashboardAccess);\n    \n    // Save to localStorage for persistence\n    localStorage.setItem('role_permissions', JSON.stringify(rolePermissions));\n    localStorage.setItem('dashboard_access_config', JSON.stringify(dashboardAccess));\n    \n    setHasUnsavedChanges(false);\n    \n    toast({\n      title: \"Permissions saved\",\n      description: \"All permission changes have been saved successfully\",\n    });\n  };\n\n  // Reset changes\n  const resetChanges = () => {\n    const initialRolePermissions: RolePermissions = {\n      super_admin: [], \n      manager: [],\n      staff: [],\n      agent: []\n    };\n    \n    allPermissions.forEach(permission => {\n      permission.defaultRoles.forEach(role => {\n        if (initialRolePermissions[role]) {\n          initialRolePermissions[role].push(permission.id);\n        }\n      });\n    });\n    \n    setRolePermissions(initialRolePermissions);\n    \n    // Reset dashboard access\n    setDashboardAccess([\n      {\n        dashboardId: 'operations-dashboard',\n        allowedRoles: ['super_admin', 'manager'],\n        allowedDepartments: ['Operations'],\n        restrictByDepartment: true\n      },\n      {\n        dashboardId: 'sales-dashboard',\n        allowedRoles: ['super_admin', 'manager'],\n        allowedDepartments: ['Sales'],\n        restrictByDepartment: true\n      },\n      {\n        dashboardId: 'content-dashboard',\n        allowedRoles: ['super_admin', 'manager'],\n        allowedDepartments: ['Marketing'],\n        restrictByDepartment: true\n      },\n      {\n        dashboardId: 'support-dashboard',\n        allowedRoles: ['super_admin', 'manager'],\n        allowedDepartments: ['Customer Support'],\n        restrictByDepartment: true\n      },\n      {\n        dashboardId: 'finance-dashboard',\n        allowedRoles: ['super_admin', 'manager'],\n        allowedDepartments: ['Finance'],\n        restrictByDepartment: true\n      }\n    ]);\n    \n    setHasUnsavedChanges(false);\n    \n    toast({\n      title: \"Changes reset\",\n      description: \"All changes have been reset to default values\",\n    });\n  };\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <h2 className=\"text-2xl font-bold tracking-tight\">Access Control</h2>\n            <p className=\"text-muted-foreground\">\n              Manage user roles and permissions across the system\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            {hasUnsavedChanges && (\n              <Button variant=\"outline\" onClick={resetChanges}>\n                <Undo className=\"h-4 w-4 mr-2\" />\n                Reset Changes\n              </Button>\n            )}\n            <Button onClick={savePermissions} disabled={!hasUnsavedChanges}>\n              <Save className=\"h-4 w-4 mr-2\" />\n              Save Changes\n            </Button>\n          </div>\n        </div>\n\n        {hasUnsavedChanges && (\n          <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\n            <div className=\"flex items-center\">\n              <AlertTriangle className=\"h-5 w-5 text-amber-600 mr-2\" />\n              <span className=\"text-amber-800 font-medium\">You have unsaved changes</span>\n            </div>\n          </div>\n        )}\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-4\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"roles\" className=\"flex items-center\">\n              <Users className=\"h-4 w-4 mr-2\" />\n              Roles & Permissions\n            </TabsTrigger>\n            <TabsTrigger value=\"dashboards\" className=\"flex items-center\">\n              <BarChart3 className=\"h-4 w-4 mr-2\" />\n              Dashboard Access\n            </TabsTrigger>\n            <TabsTrigger value=\"features\" className=\"flex items-center\">\n              <Shield className=\"h-4 w-4 mr-2\" />\n              System Features\n            </TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"roles\" className=\"space-y-6\">\n            {/* Search and Filter Controls */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Filter Permissions</CardTitle>\n                <CardDescription>\n                  Search and filter permissions by category\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex flex-col sm:flex-row gap-4\">\n                  <div className=\"relative flex-1\">\n                    <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                    <Input\n                      placeholder=\"Search permissions...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-10\"\n                    />\n                  </div>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    {categories.map((category) => (\n                      <Button\n                        key={category.id}\n                        variant={selectedCategory === category.id ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => setSelectedCategory(category.id)}\n                        className=\"flex items-center\"\n                      >\n                        <category.icon className=\"h-3 w-3 mr-1\" />\n                        {category.name}\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Permissions Table */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Role-Based Permissions Matrix</CardTitle>\n                <CardDescription>\n                  Configure what each user role can access and modify in the system\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead className=\"w-[250px]\">Permission</TableHead>\n                        <TableHead className=\"w-[300px]\">Description</TableHead>\n                        <TableHead className=\"w-[100px]\">Category</TableHead>\n                        {roles.map((role) => (\n                          <TableHead key={role.id} className=\"w-[100px] text-center\">\n                            <Badge className={role.color}>\n                              {role.name}\n                            </Badge>\n                          </TableHead>\n                        ))}\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {filteredPermissions.map((permission) => (\n                        <TableRow key={permission.id} className={permission.isSystemCritical ? 'border-l-4 border-l-red-500' : ''}>\n                          <TableCell className=\"font-medium\">\n                            <div className=\"flex items-center\">\n                              {permission.isSystemCritical && (\n                                <Lock className=\"h-4 w-4 text-red-500 mr-2\" />\n                              )}\n                              {permission.name}\n                            </div>\n                          </TableCell>\n                          <TableCell className=\"text-sm text-muted-foreground\">\n                            {permission.description}\n                          </TableCell>\n                          <TableCell>\n                            <Badge variant=\"secondary\" className=\"capitalize\">\n                              {permission.category}\n                            </Badge>\n                          </TableCell>\n                          {roles.map((role) => (\n                            <TableCell key={role.id} className=\"text-center\">\n                              <Switch\n                                checked={rolePermissions[role.id]?.includes(permission.id)}\n                                onCheckedChange={() => togglePermission(role.id, permission.id)}\n                                disabled={permission.id === 'settings.access' && role.id !== 'super_admin'}\n                              />\n                            </TableCell>\n                          ))}\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </div>\n                \n                {filteredPermissions.length === 0 && (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Search className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                    <p>No permissions found matching your search criteria</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Legend */}\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"flex items-center\">\n                      <Lock className=\"h-4 w-4 text-red-500 mr-1\" />\n                      <span>System Critical</span>\n                    </div>\n                    <div className=\"flex items-center\">\n                      <CheckCircle className=\"h-4 w-4 text-green-500 mr-1\" />\n                      <span>Enabled</span>\n                    </div>\n                  </div>\n                  <div className=\"text-xs\">\n                    Showing {filteredPermissions.length} of {allPermissions.length} permissions\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"dashboards\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Dashboard Access Control</CardTitle>\n                <CardDescription>\n                  Configure role and department-based access to executive dashboards\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-6\">\n                  {dashboards.map((dashboard) => {\n                    const accessConfig = dashboardAccess.find(d => d.dashboardId === dashboard.id);\n                    if (!accessConfig) return null;\n\n                    return (\n                      <Card key={dashboard.id} className=\"border border-gray-200\">\n                        <CardHeader className=\"pb-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <CardTitle className=\"text-lg\">{dashboard.name}</CardTitle>\n                              <CardDescription>{dashboard.description}</CardDescription>\n                            </div>\n                            <div className=\"flex items-center space-x-2\">\n                              <span className=\"text-sm text-muted-foreground\">Restrict by Department</span>\n                              <Switch\n                                checked={accessConfig.restrictByDepartment}\n                                onCheckedChange={() => toggleDepartmentRestriction(dashboard.id)}\n                              />\n                            </div>\n                          </div>\n                        </CardHeader>\n                        <CardContent className=\"space-y-4\">\n                          {/* Role Access */}\n                          <div>\n                            <h4 className=\"font-medium mb-3\">Role Access</h4>\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                              {roles.map((role) => (\n                                <div key={role.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                                  <Badge className={role.color} variant=\"secondary\">\n                                    {role.name}\n                                  </Badge>\n                                  <Switch\n                                    checked={accessConfig.allowedRoles.includes(role.id)}\n                                    onCheckedChange={() => toggleDashboardRoleAccess(dashboard.id, role.id)}\n                                  />\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n\n                          {/* Department Access */}\n                          {accessConfig.restrictByDepartment && (\n                            <div>\n                              <h4 className=\"font-medium mb-3\">Department Access</h4>\n                              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                                {departments.map((department) => (\n                                  <div key={department} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                                    <span className=\"text-sm font-medium\">{department}</span>\n                                    <Switch\n                                      checked={accessConfig.allowedDepartments.includes(department)}\n                                      onCheckedChange={() => toggleDashboardDepartmentAccess(dashboard.id, department)}\n                                    />\n                                  </div>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n\n                          {/* Access Summary */}\n                          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                            <h5 className=\"font-medium text-blue-900 mb-2\">Access Summary</h5>\n                            <div className=\"text-sm text-blue-700 space-y-1\">\n                              <p><strong>Roles:</strong> {accessConfig.allowedRoles.join(', ') || 'None'}</p>\n                              {accessConfig.restrictByDepartment && (\n                                <p><strong>Departments:</strong> {accessConfig.allowedDepartments.join(', ') || 'None'}</p>\n                              )}\n                              <p className=\"text-xs mt-2\">\n                                {accessConfig.restrictByDepartment \n                                  ? 'Staff users must have both an allowed role AND be in an allowed department to access this dashboard.'\n                                  : 'Only role-based restrictions apply. Department restrictions are disabled.'\n                                }\n                              </p>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    );\n                  })}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          <TabsContent value=\"features\" className=\"space-y-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle>System Feature Controls</CardTitle>\n                <CardDescription>\n                  Enable or disable access to specific system features for all users\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Globe className=\"h-5 w-5 text-blue-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">Multi-language Support</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Allow users to switch between different languages\n                          </p>\n                        </div>\n                      </div>\n                      <Switch defaultChecked />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Settings className=\"h-5 w-5 text-green-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">AI Itinerary Builder</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Enable the AI-powered itinerary creation tool\n                          </p>\n                        </div>\n                      </div>\n                      <Switch defaultChecked />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Shield className=\"h-5 w-5 text-purple-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">API Access</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Allow integration with external systems via API\n                          </p>\n                        </div>\n                      </div>\n                      <Switch />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Eye className=\"h-5 w-5 text-orange-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">Export Functionality</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Enable exporting data to CSV or Excel formats\n                          </p>\n                        </div>\n                      </div>\n                      <Switch defaultChecked />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Users className=\"h-5 w-5 text-indigo-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">Real-time Collaboration</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Enable real-time collaboration features\n                          </p>\n                        </div>\n                      </div>\n                      <Switch defaultChecked />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <Lock className=\"h-5 w-5 text-red-500\" />\n                        <div>\n                          <h4 className=\"font-medium\">Advanced Security</h4>\n                          <p className=\"text-sm text-muted-foreground\">\n                            Enable two-factor authentication and audit logs\n                          </p>\n                        </div>\n                      </div>\n                      <Switch />\n                    </div>\n                  </div>\n                  \n                  <Separator />\n                  \n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                    <div className=\"flex items-start space-x-3\">\n                      <Shield className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                      <div>\n                        <h4 className=\"font-medium text-blue-900\">Security Notice</h4>\n                        <p className=\"text-sm text-blue-700 mt-1\">\n                          Changes to system features may affect user experience and security. \n                          Review all changes carefully before applying them to production.\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AccessControl;\n","\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { ArrowLeft, Settings, Users, FileText, DollarSign, Shield } from 'lucide-react';\n\n// Import components that we'll create\nimport AgentOperationsTab from '@/components/settings/agent/AgentOperationsTab';\nimport DocumentManagementTab from '@/components/settings/agent/DocumentManagementTab';\nimport PermissionsTab from '@/components/settings/agent/PermissionsTab';\nimport CommissionManagementTab from '@/components/settings/agent/CommissionManagementTab';\nimport PlatformIntegrationTab from '@/components/settings/agent/PlatformIntegrationTab';\n\nconst AgentSettings: React.FC = () => {\n  const navigate = useNavigate();\n  const [activeTab, setActiveTab] = useState('operations');\n\n  return (\n    <PageLayout\n      title=\"Agent Settings Management\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Settings\", href: \"/settings\" },\n        { title: \"Agent Management\", href: \"/settings/agents\" },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <Button variant=\"outline\" onClick={() => navigate('/settings')}>\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Settings\n            </Button>\n            <div>\n              <h1 className=\"text-2xl font-bold\">Agent Settings Management</h1>\n              <p className=\"text-gray-600\">Manage agent operations, permissions, and configurations</p>\n            </div>\n          </div>\n          <Badge variant=\"secondary\" className=\"flex items-center\">\n            <Shield className=\"mr-1 h-3 w-3\" />\n            Admin Only\n          </Badge>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            <TabsTrigger value=\"operations\" className=\"flex items-center\">\n              <Users className=\"mr-2 h-4 w-4\" />\n              Operations\n            </TabsTrigger>\n            <TabsTrigger value=\"documents\" className=\"flex items-center\">\n              <FileText className=\"mr-2 h-4 w-4\" />\n              Documents\n            </TabsTrigger>\n            <TabsTrigger value=\"permissions\" className=\"flex items-center\">\n              <Shield className=\"mr-2 h-4 w-4\" />\n              Permissions\n            </TabsTrigger>\n            <TabsTrigger value=\"commission\" className=\"flex items-center\">\n              <DollarSign className=\"mr-2 h-4 w-4\" />\n              Commission\n            </TabsTrigger>\n            <TabsTrigger value=\"platform\" className=\"flex items-center\">\n              <Settings className=\"mr-2 h-4 w-4\" />\n              Platform\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"operations\">\n            <AgentOperationsTab />\n          </TabsContent>\n\n          <TabsContent value=\"documents\">\n            <DocumentManagementTab />\n          </TabsContent>\n\n          <TabsContent value=\"permissions\">\n            <PermissionsTab />\n          </TabsContent>\n\n          <TabsContent value=\"commission\">\n            <CommissionManagementTab />\n          </TabsContent>\n\n          <TabsContent value=\"platform\">\n            <PlatformIntegrationTab />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AgentSettings;\n","\nimport React from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { useApp } from '@/contexts/AppContext';\nimport LiveTranslator from '@/components/settings/LiveTranslator';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Languages, Globe, Book } from 'lucide-react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\n\nconst TranslationTool: React.FC = () => {\n  const { translate, language } = useApp();\n  \n  return (\n    <PageLayout title={translate('Translation Tool') || 'Translation Tool'}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-2\">\n          <Languages className=\"h-6 w-6\" />\n          <h1 className=\"text-2xl font-bold\">{translate('Translation Tool')}</h1>\n        </div>\n        \n        <Alert variant=\"default\" className=\"bg-blue-50 border-blue-200\">\n          <Globe className=\"h-4 w-4\" />\n          <AlertDescription className=\"text-blue-900\">\n            {translate('Translate text between different languages. Your recent translations will be saved in your session history.') || \n             'Translate text between different languages. Your recent translations will be saved in your session history.'}\n          </AlertDescription>\n        </Alert>\n        \n        <Tabs defaultValue=\"translator\" className=\"space-y-4\">\n          <TabsList>\n            <TabsTrigger value=\"translator\">\n              <Globe className=\"mr-2 h-4 w-4\" />\n              {translate('Translator') || 'Translator'}\n            </TabsTrigger>\n            <TabsTrigger value=\"about\">\n              <Book className=\"mr-2 h-4 w-4\" />\n              {translate('About') || 'About'}\n            </TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"translator\" className=\"space-y-4\">\n            <LiveTranslator />\n          </TabsContent>\n          \n          <TabsContent value=\"about\">\n            <Card>\n              <CardHeader>\n                <CardTitle>{translate('About Translation Tool') || 'About Translation Tool'}</CardTitle>\n                <CardDescription>\n                  {translate('How the translation tool works and its limitations') || \n                   'How the translation tool works and its limitations'}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <p>\n                  {translate('This translation tool uses the LibreTranslate API to provide free language translation capabilities.') || \n                   'This translation tool uses the LibreTranslate API to provide free language translation capabilities.'}\n                </p>\n                \n                <h3 className=\"font-medium text-lg mt-4\">\n                  {translate('Features') || 'Features'}:\n                </h3>\n                <ul className=\"list-disc pl-6 space-y-1\">\n                  <li>{translate('Translate text between multiple languages') || 'Translate text between multiple languages'}</li>\n                  <li>{translate('Auto-detect source language') || 'Auto-detect source language'}</li>\n                  <li>{translate('Automatic translation as you type') || 'Automatic translation as you type'}</li>\n                  <li>{translate('Translation history tracking') || 'Translation history tracking'}</li>\n                </ul>\n                \n                <h3 className=\"font-medium text-lg mt-4\">\n                  {translate('Limitations') || 'Limitations'}:\n                </h3>\n                <ul className=\"list-disc pl-6 space-y-1\">\n                  <li>\n                    {translate('Free API has usage limitations and may occasionally fail') || \n                     'Free API has usage limitations and may occasionally fail'}\n                  </li>\n                  <li>\n                    {translate('Some language combinations may not be available') || \n                     'Some language combinations may not be available'}\n                  </li>\n                  <li>\n                    {translate('Translation quality may vary for complex text') || \n                     'Translation quality may vary for complex text'}\n                  </li>\n                </ul>\n                \n                <p className=\"mt-4 text-sm text-muted-foreground\">\n                  {translate('If the API translation fails, a basic translation dictionary will be used as a fallback.') || \n                   'If the API translation fails, a basic translation dictionary will be used as a fallback.'}\n                </p>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default TranslationTool;\n","import React, { useState, useEffect } from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport { useToast } from '@/hooks/use-toast';\nimport { useCurrency } from '@/hooks/useCurrency';\nimport type { EnhancedPricingSettings } from '@/types/enhancedPricing';\nimport { MarkupSlab, PricingSettings as PricingSettingsType } from '@/types/pricing';\nimport EnhancedMarkupSlabForm from '@/components/pricing/EnhancedMarkupSlabForm';\nimport MarkupSlabsPagination from '@/components/pricing/MarkupSlabsPagination';\nimport { Plus, Edit, Trash2, Save, DollarSign, Percent, Settings, Globe, Calculator, FileText, Users } from 'lucide-react';\nimport CountryPricingManager from '@/components/pricing/CountryPricingManager';\nimport RegionalPricingTemplates from '@/components/pricing/RegionalPricingTemplates';\nimport PricingSimulator from '@/components/pricing/PricingSimulator';\nimport TaxManagement from '@/components/pricing/TaxManagement';\nimport AdvancedPricingEngine from '@/components/pricing/AdvancedPricingEngine';\nimport MarkupExportPreview from '@/components/pricing/MarkupExportPreview';\nimport { CountriesService, type CountryListItem } from '@/integrations/supabase/services/countriesService';\nimport { PricingConfigurationService, type PricingConfigurationRow } from '@/integrations/supabase/services/pricingConfigurationService';\n// Removed AppSettingsHelpers usage to avoid DB recursion issues; using Supabase exclusively\nconst PricingSettings: React.FC = () => {\n  const [settings, setSettings] = useState<PricingSettingsType>({\n    defaultMarkupPercentage: 10,\n    useSlabPricing: false,\n    markupSlabs: [],\n    slabApplicationMode: 'total',\n    showPricingToAgents: true,\n    showPricingToStaff: true,\n    allowStaffPricingEdit: true,\n  });\n  const [enhancedSettings, setEnhancedSettings] = useState<EnhancedPricingSettings>({\n    defaultMarkupPercentage: 10,\n    useSlabPricing: false,\n    markupSlabs: [],\n    slabApplicationMode: 'total',\n    showPricingToAgents: true,\n    showPricingToStaff: true,\n    allowStaffPricingEdit: true,\n    countryRules: [],\n    regionalTemplates: [],\n    currencyConversion: {\n      baseCurrency: 'USD',\n      autoUpdateRates: false,\n      updateFrequency: 'daily',\n      fallbackRates: {},\n      conversionMargins: {},\n    },\n    enableCountryBasedPricing: false,\n    defaultCountry: 'TH',\n    popularDestinations: [],\n  });\n  const [countries, setCountries] = useState<CountryListItem[]>([]);\n  const [defaultCountryCode, setDefaultCountryCode] = useState<string>('TH');\n  const [defaultConfigRow, setDefaultConfigRow] = useState<PricingConfigurationRow | null>(null);\n  const [editingSlab, setEditingSlab] = useState<MarkupSlab | null>(null);\n  const [isCreating, setIsCreating] = useState(false);\n  const [deletingSlabId, setDeletingSlabId] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [pricingSupabaseOk, setPricingSupabaseOk] = useState<boolean>(false);\n  const [pricingSupabaseTs, setPricingSupabaseTs] = useState<string | null>(null);\n  const {\n    toast\n  } = useToast();\n  const {\n    defaultCurrency,\n    getCurrencyByCountryCode\n  } = useCurrency();\n  useEffect(() => {\n    // Hydrate from Supabase only (no localStorage)\n    (async () => {\n      try {\n        const [countryList, defaultConfig] = await Promise.all([\n          CountriesService.listActiveCountries(),\n          PricingConfigurationService.getDefaultConfiguration(),\n        ]);\n        setCountries(countryList);\n        if (defaultConfig) {\n          const hydratedCountryCode = (defaultConfig as any).default_country ?? 'TH';\n          const hydratedBaseCurrency = (defaultConfig as any).base_currency ?? defaultCurrency.code;\n          setDefaultCountryCode(hydratedCountryCode);\n          setDefaultConfigRow(defaultConfig);\n          const mapped = await PricingConfigurationService.toPricingSettings(defaultConfig);\n          if (mapped) {\n            setSettings(mapped);\n          }\n          setPricingSupabaseOk(true);\n          setPricingSupabaseTs(new Date().toLocaleTimeString());\n          setEnhancedSettings(prev => ({\n            ...prev,\n            enableCountryBasedPricing: Boolean((defaultConfig as any).enable_country_based_pricing ?? false),\n            defaultCountry: hydratedCountryCode,\n            currencyConversion: {\n              ...prev.currencyConversion,\n              baseCurrency: hydratedBaseCurrency,\n            },\n          }));\n        } else {\n          // Seed a default configuration if tables are empty\n          try {\n            const seeded = await PricingConfigurationService.setDefaultConfiguration(\n              defaultCountryCode,\n              defaultCurrency.code\n            );\n            if (seeded) {\n              setDefaultConfigRow(seeded);\n              setDefaultCountryCode(((seeded as any).default_country ?? defaultCountryCode));\n              const mapped = await PricingConfigurationService.toPricingSettings(seeded);\n              if (mapped) setSettings(mapped);\n              setPricingSupabaseOk(true);\n              setPricingSupabaseTs(new Date().toLocaleTimeString());\n              setEnhancedSettings(prev => ({\n                ...prev,\n                enableCountryBasedPricing: Boolean((seeded as any).enable_country_based_pricing ?? false),\n                defaultCountry: (seeded as any).default_country ?? defaultCountryCode,\n                currencyConversion: {\n                  ...prev.currencyConversion,\n                  baseCurrency: (seeded as any).base_currency ?? defaultCurrency.code,\n                },\n              }));\n            }\n          } catch (seedErr) {\n            console.warn('Failed to seed default pricing configuration.', seedErr);\n          }\n        }\n      } catch (e) {\n        console.warn('Failed to hydrate pricing settings or countries from Supabase.', e);\n      }\n    })();\n  }, []);\n  const handleRefresh = async () => {\n    try {\n      const config = await PricingConfigurationService.getDefaultConfiguration();\n      if (config) {\n        const mapped = await PricingConfigurationService.toPricingSettings(config);\n        if (mapped) setSettings(mapped);\n      }\n    } catch (e) {\n      console.warn('Refresh from Supabase failed:', e);\n    }\n  };\n  const handleSettingsUpdate = async (updates: Partial<PricingSettingsType>) => {\n    setIsLoading(true);\n    try {\n      const updatedSettings = {\n        ...settings,\n        ...updates\n      };\n\n      // Optimistic update\n      setSettings(updatedSettings);\n\n      // Persist core configuration fields to Supabase for the default country\n      try {\n        const selectedCountry = countries.find(c => c.code === defaultCountryCode) || null;\n        const row = await PricingConfigurationService.upsertConfiguration({\n          country_code: defaultCountryCode,\n          country_name: selectedCountry?.name ?? defaultCountryCode,\n          currency: selectedCountry?.currency ?? defaultCurrency.code,\n          currency_symbol: selectedCountry?.currency_symbol ?? defaultCurrency.symbol,\n          base_markup_percentage: updatedSettings.defaultMarkupPercentage,\n          slab_markup_enabled: updatedSettings.useSlabPricing,\n          is_active: true,\n          is_default: defaultConfigRow?.is_default ?? true,\n        });\n        setDefaultConfigRow(row);\n        const refreshed = await PricingConfigurationService.toPricingSettings(row);\n        if (refreshed) setSettings(refreshed);\n      } catch (supErr) {\n        console.warn('Supabase upsert configuration failed.', supErr);\n      }\n      toast({\n        title: \"Settings Updated\",\n        description: \"Pricing settings have been saved successfully.\"\n      });\n    } catch (error) {\n      console.error('Error updating pricing settings:', error);\n      toast({\n        title: \"Update Failed\",\n        description: \"Failed to save pricing settings. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleSaveSlab = async (slabData: MarkupSlab) => {\n    setIsLoading(true);\n    try {\n      let updatedSlabs: MarkupSlab[];\n      let actionType: string;\n      if (isCreating) {\n        // Creating new slab\n        actionType = \"created\";\n        // Ensure a default pricing configuration exists to provide a valid config_id\n        let configId: string | null = defaultConfigRow?.id ?? null;\n        if (!configId) {\n          try {\n            const selectedCountry = countries.find(c => c.code === defaultCountryCode) || null;\n            const row = await PricingConfigurationService.setDefaultConfiguration(\n              defaultCountryCode,\n              selectedCountry?.currency ?? defaultCurrency.code\n            );\n            setDefaultConfigRow(row || null);\n            configId = row?.id ?? null;\n          } catch (cfgErr) {\n            console.warn('Failed to ensure default pricing configuration.', cfgErr);\n          }\n        }\n\n        // Persist to Supabase first to get the canonical slab id (uuid)\n        let persistedId: string | null = null;\n        try {\n          if (configId) {\n            const created = await PricingConfigurationService.createMarkupSlab(configId, slabData);\n            persistedId = created.id;\n          }\n        } catch (supErr) {\n          console.warn('Supabase create markup slab failed.', supErr);\n        }\n        // Refresh slabs from Supabase\n        if (configId) {\n          const cfg = await PricingConfigurationService.getDefaultConfiguration();\n          if (cfg) {\n            const refreshed = await PricingConfigurationService.toPricingSettings(cfg);\n            if (refreshed) setSettings(refreshed);\n          }\n        }\n        updatedSlabs = settings.markupSlabs;\n      } else {\n        // Updating existing slab\n        updatedSlabs = settings.markupSlabs.map(slab => slab.id === slabData.id ? { ...slabData, updatedAt: new Date().toISOString() } : slab);\n        actionType = \"updated\";\n        // Persist update to Supabase for this slab id\n        try {\n          await PricingConfigurationService.updateMarkupSlab(slabData.id, slabData);\n          const cfg = await PricingConfigurationService.getDefaultConfiguration();\n          if (cfg) {\n            const refreshed = await PricingConfigurationService.toPricingSettings(cfg);\n            if (refreshed) setSettings(refreshed);\n          }\n        } catch (supErr) {\n          console.warn('Supabase update markup slab failed.', supErr);\n        }\n      }\n      // Local UI state already refreshed from Supabase\n\n      // Reset form state\n      setIsCreating(false);\n      setEditingSlab(null);\n      toast({\n        title: `Slab ${actionType.charAt(0).toUpperCase() + actionType.slice(1)}`,\n        description: `Markup slab \"${slabData.name}\" has been ${actionType} successfully.`\n      });\n    } catch (error) {\n      console.error(`Error ${isCreating ? 'creating' : 'updating'} markup slab:`, error);\n      toast({\n        title: `${isCreating ? 'Creation' : 'Update'} Failed`,\n        description: `Failed to ${isCreating ? 'create' : 'update'} markup slab. Please try again.`,\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleCancelEdit = () => {\n    setIsCreating(false);\n    setEditingSlab(null);\n  };\n  const handleDeleteSlab = async (slabId: string) => {\n    setIsLoading(true);\n    try {\n      const slabToDelete = settings.markupSlabs.find(slab => slab.id === slabId);\n      // Attempt to delete from Supabase if this slab exists in DB\n      try {\n        const exists = await PricingConfigurationService.getMarkupSlabById(slabId);\n        if (exists) {\n          await PricingConfigurationService.deleteMarkupSlab(slabId);\n        }\n      } catch (supErr) {\n        console.warn('Supabase delete markup slab failed or slab not found.', supErr);\n      }\n      const cfg = await PricingConfigurationService.getDefaultConfiguration();\n      if (cfg) {\n        const refreshed = await PricingConfigurationService.toPricingSettings(cfg);\n        if (refreshed) setSettings(refreshed);\n      }\n      toast({\n        title: \"Slab Deleted\",\n        description: `Markup slab \"${slabToDelete?.name}\" has been deleted successfully.`\n      });\n    } catch (error) {\n      console.error('Error deleting markup slab:', error);\n      toast({\n        title: \"Deletion Failed\",\n        description: \"Failed to delete markup slab. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n      setDeletingSlabId(null);\n    }\n  };\n  const confirmDeleteSlab = (slabId: string) => {\n    setDeletingSlabId(slabId);\n  };\n  const toggleSlabStatus = async (slabId: string) => {\n    setIsLoading(true);\n    try {\n      // Persist status to Supabase for this slab\n      try {\n        const current = settings.markupSlabs.find(s => s.id === slabId);\n        if (current) {\n          await PricingConfigurationService.updateMarkupSlabStatus(slabId, !current.isActive);\n        }\n      } catch (supErr) {\n        console.warn('Supabase update slab status failed or slab not found.', supErr);\n      }\n      const cfg = await PricingConfigurationService.getDefaultConfiguration();\n      if (cfg) {\n        const refreshed = await PricingConfigurationService.toPricingSettings(cfg);\n        if (refreshed) setSettings(refreshed);\n      }\n      const toggledSlab = settings.markupSlabs.find(slab => slab.id === slabId);\n      toast({\n        title: \"Status Updated\",\n        description: `Markup slab \"${toggledSlab?.name}\" status updated.`\n      });\n    } catch (error) {\n      console.error('Error toggling slab status:', error);\n      toast({\n        title: \"Update Failed\",\n        description: \"Failed to update slab status. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return <PageLayout>\n      <div className=\"space-y-4 sm:space-y-6\">\n        <div className=\"flex items-center gap-2 px-2 sm:px-0\">\n          <Settings className=\"h-5 w-5 sm:h-6 sm:w-6\" />\n          <h1 className=\"text-xl sm:text-2xl font-bold truncate\">Pricing Configuration</h1>\n        </div>\n\n        <Tabs defaultValue=\"general\" className=\"space-y-4 sm:space-y-6\">\n          <div className=\"w-full overflow-x-auto\">\n            <TabsList className=\"flex lg:grid lg:grid-cols-6 w-max lg:w-full min-w-full bg-muted p-1 h-auto\">\n              <TabsTrigger value=\"general\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                General & Slabs\n                <Badge variant={pricingSupabaseOk ? 'success' : 'secondary'} className=\"ml-2 text-[10px]\">\n                  {pricingSupabaseOk ? `Supabase OK ${pricingSupabaseTs ?? ''}` : 'Supabase Error'}\n                </Badge>\n              </TabsTrigger>\n              <TabsTrigger value=\"countries\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                Countries\n              </TabsTrigger>\n              <TabsTrigger value=\"export\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                Export Control\n              </TabsTrigger>\n              <TabsTrigger value=\"tax\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                Tax\n                <Badge variant={pricingSupabaseOk ? 'success' : 'secondary'} className=\"ml-2 text-[10px]\">\n                  {pricingSupabaseOk ? `Supabase OK ${pricingSupabaseTs ?? ''}` : 'Supabase Error'}\n                </Badge>\n              </TabsTrigger>\n              <TabsTrigger value=\"advanced\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                Advanced\n              </TabsTrigger>\n              <TabsTrigger value=\"simulator\" className=\"flex-shrink-0 px-2 sm:px-3 py-2 text-xs sm:text-sm whitespace-nowrap\">\n                Calculator\n              </TabsTrigger>\n            </TabsList>\n          </div>\n\n          <TabsContent value=\"general\" className=\"space-y-4 sm:space-y-6 px-2 sm:px-0\">\n            {/* General Settings */}\n            <Card className=\"shadow-soft\">\n              <CardHeader className=\"pb-4\">\n                <CardTitle className=\"flex items-center gap-2 text-lg sm:text-xl\">\n                  <DollarSign className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                  <span className=\"truncate\">General Pricing Settings</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4 sm:space-y-6\">\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"defaultMarkup\">Default Markup Percentage</Label>\n                    <div className=\"flex items-center gap-2\">\n                      <Input id=\"defaultMarkup\" type=\"number\" value={settings.defaultMarkupPercentage} onChange={e => handleSettingsUpdate({\n                      defaultMarkupPercentage: Number(e.target.value)\n                    })} min=\"0\" max=\"100\" step=\"0.1\" />\n                      <Percent className=\"h-4 w-4 text-muted-foreground\" />\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Default Country & Currency</Label>\n                    <Select value={defaultCountryCode || 'TH'} onValueChange={async (value) => {\n                    if (!value) return;\n                    // Optimistically update UI state so selection works even if persistence fails\n                    setDefaultCountryCode(value);\n                    const selectedCountry = countries.find(c => c.code === value) || null;\n\n                    // Update local enhanced settings (no localStorage)\n                    if (selectedCountry) {\n                      setEnhancedSettings(prev => ({\n                        ...prev,\n                        defaultCountry: value,\n                        currencyConversion: {\n                          ...prev.currencyConversion,\n                          baseCurrency: selectedCountry.currency,\n                        },\n                      }));\n                    }\n\n                    // Try persisting to Supabase, but do not block UI\n                    try {\n                      if (selectedCountry) {\n                        const row = await PricingConfigurationService.setDefaultConfiguration(value, selectedCountry.currency);\n                        setDefaultConfigRow(row || null);\n\n                        toast({\n                          title: 'Country Updated',\n                          description: `Default country set to ${selectedCountry.name}. Currency: ${selectedCountry.currency}.`,\n                        });\n                      }\n                    } catch (err) {\n                      console.error('Failed to persist default country via Supabase', err);\n                      // Keep UI selection; inform user persistence failed but local settings updated\n                      toast({\n                        title: 'Saved Locally',\n                        description: 'Could not save default country to Supabase. Using local settings.',\n                      });\n                    }\n\n                    // Optionally add local country rule if not present (in-memory only)\n                    if (selectedCountry) {\n                      setEnhancedSettings(prev => {\n                        const exists = prev.countryRules.some(r => r.countryCode === value);\n                        if (exists) return prev;\n                        return {\n                          ...prev,\n                          countryRules: [\n                            ...prev.countryRules,\n                            {\n                              id: Date.now().toString(),\n                              countryCode: value,\n                              countryName: selectedCountry.name,\n                              currency: selectedCountry.currency,\n                              currencySymbol: selectedCountry.currency_symbol,\n                              defaultMarkup: settings.defaultMarkupPercentage,\n                              markupType: 'percentage',\n                              isActive: true,\n                              region: selectedCountry.region,\n                              tier: 'standard',\n                              conversionMargin: 2,\n                              createdAt: new Date().toISOString(),\n                              updatedAt: new Date().toISOString(),\n                            },\n                          ],\n                        };\n                      });\n                    }\n                  }}>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Select default country\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {countries.map(country => (\n                          <SelectItem key={country.code} value={country.code}>\n                            {country.name} ({country.currency})\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6\">\n                  <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 p-3 sm:p-4 rounded-lg border border-border bg-muted/30\">\n                    <div className=\"space-y-1\">\n                      <Label className=\"text-sm sm:text-base\">Slab-Based Pricing</Label>\n                      <p className=\"text-xs text-muted-foreground\">Use pricing tiers based on amount ranges</p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant={settings.useSlabPricing ? \"default\" : \"outline\"} className=\"text-xs\">\n                        {settings.useSlabPricing ? \"Active\" : \"Inactive\"}\n                      </Badge>\n                      <Switch checked={settings.useSlabPricing} onCheckedChange={async (checked) => {\n                      // Persist global slab pricing toggle\n                      await handleSettingsUpdate({ useSlabPricing: checked });\n\n                      // Ensure a default configuration id exists\n                      let configId: string | null = defaultConfigRow?.id ?? null;\n                      let configRow = defaultConfigRow;\n                      if (!configId) {\n                        try {\n                          const seeded = await PricingConfigurationService.setDefaultConfiguration(\n                            defaultCountryCode,\n                            defaultCurrency.code\n                          );\n                          setDefaultConfigRow(seeded || null);\n                          configRow = seeded || null;\n                          configId = seeded?.id ?? null;\n                        } catch (seedErr) {\n                          console.warn('Failed to seed default pricing configuration for slab toggle.', seedErr);\n                        }\n                      }\n\n                      // Bulk update all slabs' is_active to match the toggle\n                      if (configId) {\n                        try {\n                          const updatedCount = await PricingConfigurationService.updateAllMarkupSlabStatusForConfig(configId, checked);\n                          // Refresh settings from Supabase to reflect updated slab statuses\n                          const latestConfig = await PricingConfigurationService.getDefaultConfiguration();\n                          const refreshed = await PricingConfigurationService.toPricingSettings(latestConfig || configRow);\n                          if (refreshed) setSettings(refreshed);\n\n                          toast({\n                            title: checked ? 'Slab Pricing Enabled' : 'Slab Pricing Disabled',\n                            description: checked\n                              ? `All slabs marked active (${updatedCount} updated).`\n                              : `All slabs marked inactive (${updatedCount} updated).`,\n                          });\n                        } catch (err) {\n                          console.error('Failed to bulk update slab statuses via Supabase', err);\n                          toast({\n                            title: 'Update Failed',\n                            description: 'Could not update slab statuses. Please try again.',\n                            variant: 'destructive',\n                          });\n                        }\n                      } else {\n                        toast({\n                          title: checked ? 'Slab Pricing Enabled' : 'Slab Pricing Disabled',\n                          description: 'No configuration found; saved toggle only.',\n                        });\n                      }\n                    }} />\n                    </div>\n                  </div>\n\n                  <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 p-3 sm:p-4 rounded-lg border border-border bg-muted/30\">\n                    <div className=\"space-y-1\">\n                      <Label className=\"text-sm sm:text-base\">Country-Based Pricing</Label>\n                      <p className=\"text-xs text-muted-foreground\">Apply different markups per country</p>\n                    </div>\n                    <Switch checked={enhancedSettings.enableCountryBasedPricing} onCheckedChange={async (checked) => {\n                    try {\n                      setEnhancedSettings(prev => ({ ...prev, enableCountryBasedPricing: checked }));\n\n                      // Persist to pricing_configurations for the default configuration\n                      try {\n                        await PricingConfigurationService.upsertConfiguration({\n                          country_code: defaultCountryCode,\n                          enable_country_based_pricing: checked,\n                          is_active: true,\n                        });\n                      } catch (supErr) {\n                        console.warn('Supabase upsert enable_country_based_pricing failed.', supErr);\n                      }\n\n                      toast({\n                        title: checked ? 'Country Pricing Enabled' : 'Country Pricing Disabled',\n                        description: checked ? 'Pricing will consider country-specific rules' : 'Pricing will use standard rules only',\n                      });\n                    } catch (err) {\n                      console.error('Failed to persist country pricing toggle via Supabase', err);\n                      toast({\n                        title: 'Update Failed',\n                        description: 'Could not update country pricing toggle. Please try again.',\n                        variant: 'destructive',\n                      });\n                    }\n                  }} />\n                  </div>\n                </div>\n\n                {/* Hint when country-based pricing is disabled */}\n                {!enhancedSettings.enableCountryBasedPricing && (\n                  <div className=\"mt-2 text-sm text-amber-600\">\n                    Country-based pricing is currently disabled. Enable it above to configure country-specific pricing rules.\n                  </div>\n                )}\n\n                <Separator />\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4\">\n                  <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-card\">\n                    <Label className=\"text-sm\">Show Pricing to Agents</Label>\n                    <Switch checked={settings.showPricingToAgents} onCheckedChange={checked => handleSettingsUpdate({\n                    showPricingToAgents: checked\n                  })} />\n                  </div>\n\n                  <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-card\">\n                    <Label className=\"text-sm\">Show Pricing to Staff</Label>\n                    <Switch checked={settings.showPricingToStaff} onCheckedChange={checked => handleSettingsUpdate({\n                    showPricingToStaff: checked\n                  })} />\n                  </div>\n\n                  <div className=\"flex items-center justify-between p-3 rounded-lg border border-border bg-card\">\n                    <Label className=\"text-sm\">Allow Staff Pricing Edit</Label>\n                    <Switch checked={settings.allowStaffPricingEdit} onCheckedChange={checked => handleSettingsUpdate({\n                    allowStaffPricingEdit: checked\n                  })} />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Markup Slabs Section */}\n            <Card className=\"shadow-soft\">\n              <CardHeader className=\"pb-4\">\n                <CardTitle className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0\">\n                  <span className=\"flex items-center gap-2\">\n                    <Percent className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                    <span className=\"text-lg sm:text-xl\">Markup Slabs Configuration</span>\n                    {settings.useSlabPricing && <Badge variant=\"default\" className=\"ml-2 text-xs\">Active</Badge>}\n                    <Badge variant={pricingSupabaseOk ? 'success' : 'secondary'} className=\"ml-2 text-xs\">\n                      {pricingSupabaseOk ? `Supabase OK ${pricingSupabaseTs ?? ''}` : 'Supabase Error'}\n                    </Badge>\n                  </span>\n                  <Button onClick={() => setIsCreating(true)} disabled={isCreating || editingSlab !== null || isLoading} size=\"sm\" className=\"w-full sm:w-auto\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    <span className=\"hidden sm:inline\">Add Slab</span>\n                    <span className=\"sm:hidden\">Add</span>\n                  </Button>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {/* Supabase Source & Tables Indicator */}\n                <div className=\"p-3 sm:p-4 bg-muted/50 rounded-lg border\">\n                  <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm\">\n                    <div>\n                      <div className=\"font-medium\">Source</div>\n                      <div className=\"text-muted-foreground\">Supabase</div>\n                    </div>\n                    <div>\n                      <div className=\"font-medium\">Tables</div>\n                      <div className=\"text-muted-foreground\">public.pricing_configurations, public.markup_slabs</div>\n                    </div>\n                    <div>\n                      <div className=\"font-medium\">Location</div>\n                      <div className=\"text-muted-foreground\">src/integrations/supabase/services/pricingConfigurationService.ts</div>\n                    </div>\n                  </div>\n                </div>\n                {/* Enhanced Slab Application Mode Setting with Country-Based Pricing */}\n                {settings.useSlabPricing && <div className=\"space-y-4\">\n                    \n\n                    {/* Country-Based Slab Pricing Configuration */}\n                    {enhancedSettings.enableCountryBasedPricing && <div className=\"p-4 bg-blue-50/50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div className=\"flex items-center gap-2\">\n                            <Globe className=\"h-4 w-4 text-blue-600\" />\n                            <span className=\"font-medium text-sm\">Country-Based Slab Settings</span>\n                          </div>\n                          <Badge variant=\"outline\" className=\"border-blue-300 text-blue-700\">\n                            {enhancedSettings.countryRules.filter(rule => rule.isActive).length} Countries Active\n                          </Badge>\n                        </div>\n\n                        <div className=\"space-y-3\">\n                          {/* Per-Country Slab Application */}\n                          <div className=\"space-y-2\">\n                            <Label className=\"text-sm font-medium\">Per-Country Slab Application</Label>\n                            <div className=\"grid gap-2\">\n                              {enhancedSettings.countryRules.filter(rule => rule.isActive).slice(0, 3) // Show first 3 active countries\n                        .map(rule => <div key={rule.id} className=\"flex items-center justify-between p-2 bg-white dark:bg-slate-800 rounded border\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {rule.countryCode}\n                                    </Badge>\n                                    <span className=\"text-sm\">{rule.countryName}</span>\n                                    <span className=\"text-xs text-muted-foreground\">\n                                      ({rule.currencySymbol} {rule.currency})\n                                    </span>\n                                  </div>\n                                  \n                                  <div className=\"flex items-center gap-2\">\n                                    <Badge variant={rule.countryCode === 'TH' ? \"default\" : \"secondary\"} className=\"text-xs\">\n                                      {rule.countryCode === 'TH' ? 'Per Person' : rule.markupType === 'percentage' ? `${rule.defaultMarkup}%` : `${rule.currencySymbol}${rule.defaultMarkup}`}\n                                    </Badge>\n                                    \n                                    {rule.countryCode === 'TH' && <div className=\"flex items-center gap-1\">\n                                        <Users className=\"h-3 w-3 text-primary\" />\n                                        <span className=\"text-xs text-primary font-medium\">Per Person Applied</span>\n                                      </div>}\n                                  </div>\n                                </div>)}\n                            </div>\n                            \n                            {enhancedSettings.countryRules.filter(rule => rule.isActive).length > 3 && <div className=\"text-xs text-muted-foreground text-center\">\n                                ... and {enhancedSettings.countryRules.filter(rule => rule.isActive).length - 3} more countries\n                              </div>}\n                          </div>\n\n                          {/* Thailand Specific Settings */}\n                          {enhancedSettings.countryRules.some(rule => rule.countryCode === 'TH' && rule.isActive) && <div className=\"p-3 bg-green-50/50 dark:bg-green-950/20 rounded border border-green-200 dark:border-green-800\">\n                              <div className=\"flex items-center gap-2 mb-2\">\n                                <Badge className=\"bg-green-100 text-green-800 border-green-300\">\n                                  TH\n                                </Badge>\n                                <span className=\"text-sm font-medium text-green-800 dark:text-green-200\">\n                                  Thailand - Enhanced Per Person Pricing\n                                </span>\n                              </div>\n                              <div className=\"text-xs text-green-700 dark:text-green-300\">\n                                 Markup calculated per person basis<br />\n                                 Slab ranges applied to individual traveler amounts<br />\n                                 Optimal for group bookings and family packages\n                              </div>\n                            </div>}\n\n                          <div className=\"text-xs text-muted-foreground\">\n                             Country-specific rules override slab settings. For Thailand, markup is always applied per person for accurate group pricing.\n                          </div>\n                        </div>\n                      </div>}\n                  </div>}\n                \n                {!settings.useSlabPricing && <div className=\"p-3 sm:p-4 bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-lg\">\n                    <p className=\"text-sm text-amber-800 dark:text-amber-200\">\n                       Slab-based pricing is currently disabled. Enable it above to use these markup slabs for automatic pricing tiers.\n                    </p>\n                  </div>}\n\n                {settings.useSlabPricing && enhancedSettings.enableCountryBasedPricing && <div className=\"p-3 sm:p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n                    <p className=\"text-sm text-blue-800 dark:text-blue-200\">\n                       Both slab and country-based pricing are enabled. Country rules take precedence over markup slabs.\n                    </p>\n                  </div>}\n\n                {isCreating && <EnhancedMarkupSlabForm onSave={handleSaveSlab} onCancel={handleCancelEdit} existingSlabs={settings.markupSlabs} isEditing={false} />}\n\n                {editingSlab && <div className=\"p-4 border rounded-lg bg-muted/50\">\n                    <div className=\"flex items-center gap-2 mb-4\">\n                      <Edit className=\"h-4 w-4\" />\n                      <span className=\"font-medium\">Editing: {editingSlab.name}</span>\n                    </div>\n                    <EnhancedMarkupSlabForm slab={editingSlab} onSave={handleSaveSlab} onCancel={handleCancelEdit} existingSlabs={settings.markupSlabs} isEditing={true} />\n                  </div>}\n\n                <MarkupSlabsPagination slabs={settings.markupSlabs} onEdit={setEditingSlab} onDelete={confirmDeleteSlab} onToggleStatus={toggleSlabStatus} isLoading={isLoading} editingSlab={editingSlab} isCreating={isCreating} />\n              </CardContent>\n            </Card>\n\n            {/* Delete Confirmation Dialog */}\n            <AlertDialog open={deletingSlabId !== null} onOpenChange={open => !open && setDeletingSlabId(null)}>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Delete Markup Slab</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Are you sure you want to delete this markup slab? This action cannot be undone and may affect existing pricing calculations.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel disabled={isLoading}>Cancel</AlertDialogCancel>\n                  <AlertDialogAction onClick={() => deletingSlabId && handleDeleteSlab(deletingSlabId)} disabled={isLoading} className=\"bg-destructive hover:bg-destructive/90\">\n                    {isLoading ? 'Deleting...' : 'Delete'}\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </TabsContent>\n\n\n          <TabsContent value=\"countries\" className=\"px-2 sm:px-0\">\n            <CountryPricingManager onUpdate={handleRefresh} />\n          </TabsContent>\n\n          <TabsContent value=\"export\" className=\"px-2 sm:px-0\">\n            <MarkupExportPreview onSettingsChange={handleRefresh} />\n          </TabsContent>\n\n          <TabsContent value=\"tax\" className=\"px-2 sm:px-0\">\n            <TaxManagement onTaxUpdate={taxSettings => {\n            toast({\n              title: \"Tax Settings Updated\",\n              description: \"Tax configuration has been saved successfully.\"\n            });\n          }} />\n          </TabsContent>\n\n          <TabsContent value=\"advanced\" className=\"px-2 sm:px-0\">\n            <AdvancedPricingEngine onPricingUpdate={pricingData => {\n            console.log('Advanced pricing updated:', pricingData);\n          }} />\n          </TabsContent>\n\n          <TabsContent value=\"simulator\" className=\"px-2 sm:px-0\">\n            <PricingSimulator />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </PageLayout>;\n};\nexport default PricingSettings;","import React, { useState, useEffect } from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { useApp } from '@/contexts/AppContext';\nimport { emailTemplateService } from '@/services/emailTemplateService';\nimport { EmailTemplate, EmailTemplateVariable } from '@/types/query';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Separator } from '@/components/ui/separator';\nimport { toast } from 'sonner';\nimport { \n  Plus, \n  Edit, \n  Copy, \n  Trash2, \n  Eye, \n  Send, \n  Users, \n  Mail, \n  FileText, \n  Settings as SettingsIcon,\n  Play,\n  Search\n} from 'lucide-react';\n\nconst EmailTemplates: React.FC = () => {\n  const { translate } = useApp();\n  const [templates, setTemplates] = useState<EmailTemplate[]>([]);\n  const [variables, setVariables] = useState<EmailTemplateVariable[]>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<EmailTemplate | null>(null);\n  const [editingTemplate, setEditingTemplate] = useState<Partial<EmailTemplate> | null>(null);\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\n  const [isPreviewDialogOpen, setIsPreviewDialogOpen] = useState(false);\n  const [previewVariables, setPreviewVariables] = useState<Record<string, string>>({});\n  const [testEmail, setTestEmail] = useState('');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterCategory, setFilterCategory] = useState<string>('all');\n  const [loading, setLoading] = useState(false);\n\n  // Load templates and variables on component mount\n  useEffect(() => {\n    loadTemplates();\n    loadVariables();\n  }, []);\n\n  const loadTemplates = async () => {\n    try {\n      const templateList = await emailTemplateService.getTemplates();\n      setTemplates(templateList);\n    } catch (error) {\n      toast.error('Failed to load email templates');\n    }\n  };\n\n  const loadVariables = () => {\n    const variableList = emailTemplateService.getAvailableVariables();\n    setVariables(variableList);\n  };\n\n  // Filter templates based on search and category\n  const filteredTemplates = templates.filter(template => {\n    const matchesSearch = template.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         template.subject.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesCategory = filterCategory === 'all' || template.category === filterCategory;\n    return matchesSearch && matchesCategory;\n  });\n\n  const handleCreateTemplate = async () => {\n    if (!editingTemplate?.name || !editingTemplate?.subject || !editingTemplate?.content) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await emailTemplateService.createTemplate({\n        name: editingTemplate.name,\n        subject: editingTemplate.subject,\n        content: editingTemplate.content,\n        category: editingTemplate.category || 'lead',\n        role: editingTemplate.role || 'traveller',\n        trigger: editingTemplate.trigger || 'Manual',\n        language: editingTemplate.language || 'en',\n        variables: editingTemplate.variables || [],\n        isActive: editingTemplate.isActive ?? true,\n        isDefault: false,\n        createdBy: 'user'\n      });\n      \n      toast.success('Email template created successfully');\n      setIsCreateDialogOpen(false);\n      setEditingTemplate(null);\n      loadTemplates();\n    } catch (error) {\n      toast.error('Failed to create email template');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleUpdateTemplate = async () => {\n    if (!selectedTemplate || !editingTemplate?.name || !editingTemplate?.subject || !editingTemplate?.content) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await emailTemplateService.updateTemplate(selectedTemplate.id, editingTemplate);\n      toast.success('Email template updated successfully');\n      setIsEditDialogOpen(false);\n      setEditingTemplate(null);\n      setSelectedTemplate(null);\n      loadTemplates();\n    } catch (error) {\n      toast.error('Failed to update email template');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteTemplate = async (templateId: string) => {\n    try {\n      await emailTemplateService.deleteTemplate(templateId);\n      toast.success('Email template deleted successfully');\n      loadTemplates();\n    } catch (error) {\n      toast.error('Cannot delete default templates');\n    }\n  };\n\n  const handleDuplicateTemplate = async (templateId: string) => {\n    try {\n      await emailTemplateService.duplicateTemplate(templateId);\n      toast.success('Email template duplicated successfully');\n      loadTemplates();\n    } catch (error) {\n      toast.error('Failed to duplicate email template');\n    }\n  };\n\n  const handleToggleStatus = async (templateId: string) => {\n    try {\n      await emailTemplateService.toggleTemplateStatus(templateId);\n      toast.success('Template status updated');\n      loadTemplates();\n    } catch (error) {\n      toast.error('Failed to update template status');\n    }\n  };\n\n  const handlePreviewTemplate = (template: EmailTemplate) => {\n    setSelectedTemplate(template);\n    \n    // Set default values for preview variables\n    const defaultValues: Record<string, string> = {};\n    template.variables.forEach(variable => {\n      const variableInfo = variables.find(v => v.name === variable);\n      defaultValues[variable] = variableInfo?.example || `{${variable}}`;\n    });\n    setPreviewVariables(defaultValues);\n    setIsPreviewDialogOpen(true);\n  };\n\n  const handleSendTestEmail = async () => {\n    if (!selectedTemplate || !testEmail) {\n      toast.error('Please provide a test email address');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await emailTemplateService.sendTestEmail(selectedTemplate.id, testEmail, previewVariables);\n      toast.success('Test email sent successfully');\n    } catch (error) {\n      toast.error('Failed to send test email');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getPreview = () => {\n    if (!selectedTemplate) return { subject: '', content: '' };\n    return emailTemplateService.previewTemplate(selectedTemplate, previewVariables);\n  };\n\n  const openCreateDialog = () => {\n    setEditingTemplate({\n      name: '',\n      subject: '',\n      content: '',\n      category: 'lead',\n      role: 'traveller',\n      trigger: 'Manual',\n      language: 'en',\n      variables: [],\n      isActive: true\n    });\n    setIsCreateDialogOpen(true);\n  };\n\n  const openEditDialog = (template: EmailTemplate) => {\n    setSelectedTemplate(template);\n    setEditingTemplate({ ...template });\n    setIsEditDialogOpen(true);\n  };\n\n  const categories = ['all', 'lead', 'quotation', 'booking', 'payment', 'account', 'itinerary', 'reminder', 'feedback', 'support'];\n  const stats = emailTemplateService.getTemplateStats();\n\n  const getCategoryVariant = (category: string) => {\n    const variants: Record<string, \"default\" | \"secondary\" | \"destructive\" | \"outline\"> = {\n      lead: 'default',\n      quotation: 'secondary',\n      booking: 'default',\n      payment: 'destructive',\n      account: 'secondary',\n      itinerary: 'outline',\n      reminder: 'secondary',\n      feedback: 'outline',\n      support: 'destructive'\n    };\n    return variants[category] || 'outline';\n  };\n\n  return (\n    <PageLayout title=\"Email Templates\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n          {/* Email Templates content */}\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h2 className=\"text-2xl font-bold\">Email Templates</h2>\n                <p className=\"text-muted-foreground\">Manage automated email templates for your CRM</p>\n              </div>\n              <Button onClick={openCreateDialog}>\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Create Template\n              </Button>\n            </div>\n\n      {/* Statistics Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center\">\n              <FileText className=\"h-8 w-8 text-blue-500\" />\n              <div className=\"ml-4\">\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Templates</p>\n                <p className=\"text-2xl font-bold\">{stats.total}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center\">\n              <Play className=\"h-8 w-8 text-green-500\" />\n              <div className=\"ml-4\">\n                <p className=\"text-sm font-medium text-muted-foreground\">Active</p>\n                <p className=\"text-2xl font-bold\">{stats.active}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center\">\n              <Users className=\"h-8 w-8 text-purple-500\" />\n              <div className=\"ml-4\">\n                <p className=\"text-sm font-medium text-muted-foreground\">For Travellers</p>\n                <p className=\"text-2xl font-bold\">{stats.byRole.traveller || 0}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center\">\n              <SettingsIcon className=\"h-8 w-8 text-orange-500\" />\n              <div className=\"ml-4\">\n                <p className=\"text-sm font-medium text-muted-foreground\">For Agents</p>\n                <p className=\"text-2xl font-bold\">{stats.byRole.agent || 0}</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Category Statistics */}\n      <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\n        {Object.entries(stats.byCategory).map(([category, count]) => (\n          <Card key={category}>\n            <CardContent className=\"p-3\">\n              <div className=\"text-center\">\n                <p className=\"text-xs font-medium text-muted-foreground uppercase\">{category}</p>\n                <p className=\"text-xl font-bold\">{count}</p>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"Search templates...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n        <Select value={filterCategory} onValueChange={setFilterCategory}>\n          <SelectTrigger className=\"w-48\">\n            <SelectValue placeholder=\"Filter by category\" />\n          </SelectTrigger>\n          <SelectContent>\n            {categories.map(category => (\n              <SelectItem key={category} value={category}>\n                {category === 'all' ? 'All Categories' : category.charAt(0).toUpperCase() + category.slice(1)}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Templates List */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        {filteredTemplates.map((template) => (\n          <Card key={template.id} className=\"hover:shadow-md transition-shadow\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <CardTitle className=\"text-lg\">{template.name}</CardTitle>\n                  <CardDescription className=\"mt-1\">{template.subject}</CardDescription>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={template.isActive}\n                    onCheckedChange={() => handleToggleStatus(template.id)}\n                  />\n                </div>\n              </div>\n              <div className=\"flex gap-2 mt-2\">\n                <Badge variant={getCategoryVariant(template.category)}>\n                  {template.category}\n                </Badge>\n                <Badge variant=\"outline\">\n                  {template.role}\n                </Badge>\n                {template.isDefault && (\n                  <Badge variant=\"destructive\">Default</Badge>\n                )}\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex justify-between items-center\">\n                <div className=\"text-sm text-muted-foreground\">\n                  Variables: {template.variables.length}\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handlePreviewTemplate(template)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => openEditDialog(template)}\n                  >\n                    <Edit className=\"h-4 w-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDuplicateTemplate(template.id)}\n                  >\n                    <Copy className=\"h-4 w-4\" />\n                  </Button>\n                  {!template.isDefault && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => handleDeleteTemplate(template.id)}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Create Template Dialog */}\n      <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Create Email Template</DialogTitle>\n            <DialogDescription>\n              Create a new email template for automated communications\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"grid grid-cols-2 gap-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"name\">Template Name</Label>\n                <Input\n                  id=\"name\"\n                  value={editingTemplate?.name || ''}\n                  onChange={(e) => setEditingTemplate(prev => ({ ...prev, name: e.target.value }))}\n                  placeholder=\"Enter template name\"\n                />\n              </div>\n              \n              <div>\n                <Label htmlFor=\"subject\">Email Subject</Label>\n                <Input\n                  id=\"subject\"\n                  value={editingTemplate?.subject || ''}\n                  onChange={(e) => setEditingTemplate(prev => ({ ...prev, subject: e.target.value }))}\n                  placeholder=\"Enter email subject\"\n                />\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-2\">\n                <div>\n                  <Label htmlFor=\"category\">Category</Label>\n                  <Select\n                    value={editingTemplate?.category || 'lead'}\n                    onValueChange={(value) => setEditingTemplate(prev => ({ ...prev, category: value as any }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"lead\">Lead</SelectItem>\n                      <SelectItem value=\"quotation\">Quotation</SelectItem>\n                      <SelectItem value=\"booking\">Booking</SelectItem>\n                      <SelectItem value=\"payment\">Payment</SelectItem>\n                      <SelectItem value=\"account\">Account</SelectItem>\n                      <SelectItem value=\"itinerary\">Itinerary</SelectItem>\n                      <SelectItem value=\"reminder\">Reminder</SelectItem>\n                      <SelectItem value=\"feedback\">Feedback</SelectItem>\n                      <SelectItem value=\"support\">Support</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <Label htmlFor=\"role\">Target Role</Label>\n                  <Select\n                    value={editingTemplate?.role || 'traveller'}\n                    onValueChange={(value) => setEditingTemplate(prev => ({ ...prev, role: value as any }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"traveller\">Traveller</SelectItem>\n                      <SelectItem value=\"agent\">Agent</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n              \n              <div>\n                <Label htmlFor=\"trigger\">Trigger Event</Label>\n                <Input\n                  id=\"trigger\"\n                  value={editingTemplate?.trigger || ''}\n                  onChange={(e) => setEditingTemplate(prev => ({ ...prev, trigger: e.target.value }))}\n                  placeholder=\"e.g., Lead submission\"\n                />\n              </div>\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <Label>Available Variables</Label>\n                <div className=\"max-h-48 overflow-y-auto border rounded-md p-2 space-y-1\">\n                  {variables.map((variable) => (\n                    <div key={variable.name} className=\"text-xs\">\n                      <code className=\"bg-muted px-1 rounded\">{`{${variable.name}}`}</code>\n                      <span className=\"ml-2 text-muted-foreground\">{variable.description}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div>\n            <Label htmlFor=\"content\">Email Content</Label>\n            <Textarea\n              id=\"content\"\n              value={editingTemplate?.content || ''}\n              onChange={(e) => setEditingTemplate(prev => ({ ...prev, content: e.target.value }))}\n              placeholder=\"Enter email content with variables like {ClientName}, {TripName}, etc.\"\n              rows={8}\n            />\n          </div>\n          \n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsCreateDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleCreateTemplate} disabled={loading}>\n              Create Template\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Template Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Edit Email Template</DialogTitle>\n            <DialogDescription>\n              Modify the email template settings and content\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"grid grid-cols-2 gap-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"edit-name\">Template Name</Label>\n                <Input\n                  id=\"edit-name\"\n                  value={editingTemplate?.name || ''}\n                  onChange={(e) => setEditingTemplate(prev => ({ ...prev, name: e.target.value }))}\n                  placeholder=\"Enter template name\"\n                />\n              </div>\n              \n              <div>\n                <Label htmlFor=\"edit-subject\">Email Subject</Label>\n                <Input\n                  id=\"edit-subject\"\n                  value={editingTemplate?.subject || ''}\n                  onChange={(e) => setEditingTemplate(prev => ({ ...prev, subject: e.target.value }))}\n                  placeholder=\"Enter email subject\"\n                />\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-2\">\n                <div>\n                  <Label htmlFor=\"edit-category\">Category</Label>\n                  <Select\n                    value={editingTemplate?.category || 'lead'}\n                    onValueChange={(value) => setEditingTemplate(prev => ({ ...prev, category: value as any }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"lead\">Lead</SelectItem>\n                      <SelectItem value=\"quotation\">Quotation</SelectItem>\n                      <SelectItem value=\"booking\">Booking</SelectItem>\n                      <SelectItem value=\"payment\">Payment</SelectItem>\n                      <SelectItem value=\"account\">Account</SelectItem>\n                      <SelectItem value=\"itinerary\">Itinerary</SelectItem>\n                      <SelectItem value=\"reminder\">Reminder</SelectItem>\n                      <SelectItem value=\"feedback\">Feedback</SelectItem>\n                      <SelectItem value=\"support\">Support</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <Label htmlFor=\"edit-role\">Target Role</Label>\n                  <Select\n                    value={editingTemplate?.role || 'traveller'}\n                    onValueChange={(value) => setEditingTemplate(prev => ({ ...prev, role: value as any }))}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"traveller\">Traveller</SelectItem>\n                      <SelectItem value=\"agent\">Agent</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <Label>Available Variables</Label>\n                <div className=\"max-h-48 overflow-y-auto border rounded-md p-2 space-y-1\">\n                  {variables.map((variable) => (\n                    <div key={variable.name} className=\"text-xs\">\n                      <code className=\"bg-muted px-1 rounded\">{`{${variable.name}}`}</code>\n                      <span className=\"ml-2 text-muted-foreground\">{variable.description}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div>\n            <Label htmlFor=\"edit-content\">Email Content</Label>\n            <Textarea\n              id=\"edit-content\"\n              value={editingTemplate?.content || ''}\n              onChange={(e) => setEditingTemplate(prev => ({ ...prev, content: e.target.value }))}\n              placeholder=\"Enter email content with variables\"\n              rows={8}\n            />\n          </div>\n          \n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsEditDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleUpdateTemplate} disabled={loading}>\n              Update Template\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Preview Template Dialog */}\n      <Dialog open={isPreviewDialogOpen} onOpenChange={setIsPreviewDialogOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Preview Email Template</DialogTitle>\n            <DialogDescription>\n              Preview how the email will look with variable values\n            </DialogDescription>\n          </DialogHeader>\n          \n          <Tabs defaultValue=\"preview\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"preview\">Preview</TabsTrigger>\n              <TabsTrigger value=\"test\">Send Test</TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value=\"preview\" className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label>Variable Values</Label>\n                  <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                    {selectedTemplate?.variables.map((variable) => (\n                      <div key={variable}>\n                        <Label htmlFor={`var-${variable}`}>{variable}</Label>\n                        <Input\n                          id={`var-${variable}`}\n                          value={previewVariables[variable] || ''}\n                          onChange={(e) => setPreviewVariables(prev => ({\n                            ...prev,\n                            [variable]: e.target.value\n                          }))}\n                          placeholder={`Enter ${variable}`}\n                        />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                \n                <div>\n                  <Label>Email Preview</Label>\n                  <div className=\"border rounded-md p-4 bg-muted/50 space-y-4\">\n                    <div>\n                      <Label className=\"text-xs\">Subject:</Label>\n                      <p className=\"font-medium\">{getPreview().subject}</p>\n                    </div>\n                    <Separator />\n                    <div>\n                      <Label className=\"text-xs\">Content:</Label>\n                      <div className=\"whitespace-pre-wrap text-sm\">{getPreview().content}</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n            \n            <TabsContent value=\"test\" className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"test-email\">Test Email Address</Label>\n                <Input\n                  id=\"test-email\"\n                  type=\"email\"\n                  value={testEmail}\n                  onChange={(e) => setTestEmail(e.target.value)}\n                  placeholder=\"Enter email address to send test\"\n                />\n              </div>\n              <Button onClick={handleSendTestEmail} disabled={loading || !testEmail}>\n                <Send className=\"mr-2 h-4 w-4\" />\n                Send Test Email\n              </Button>\n            </TabsContent>\n          </Tabs>\n          \n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsPreviewDialogOpen(false)}>\n              Close\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n          </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default EmailTemplates;","import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { useToast } from '@/hooks/use-toast';\nimport { Plus, Info, RefreshCw, AlertTriangle, CheckCircle } from 'lucide-react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport CurrencyCalculator from '@/components/currency/CurrencyCalculator';\nimport ExchangeRateManager from '@/components/currency/ExchangeRateManager';\nimport CurrencyApiConfig from '@/components/currency/CurrencyApiConfig';\nimport { ExchangeRate, CurrencyService } from '@/services/currencyService';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { CurrencyApiService } from '@/services/currencyApiService';\nimport { CurrencyScheduler } from '@/services/currencyScheduler';\nimport { formatISTTime, getISTTime } from '@/utils/timezoneUtils';\n\ninterface CurrencyConverterSettings {\n  baseCurrency: string;\n  autoUpdateRates: boolean;\n  updateFrequency: 'hourly' | 'daily' | 'weekly';\n  customRates: ExchangeRate[];\n  defaultMargin: number;\n}\n\nconst currencies = [\n  { code: 'USD', name: 'US Dollar', symbol: '$' },\n  { code: 'EUR', name: 'Euro', symbol: '' },\n  { code: 'GBP', name: 'British Pound', symbol: '' },\n  { code: 'INR', name: 'Indian Rupee', symbol: '' },\n  { code: 'JPY', name: 'Japanese Yen', symbol: '' },\n  { code: 'AUD', name: 'Australian Dollar', symbol: 'A$' },\n  { code: 'CAD', name: 'Canadian Dollar', symbol: 'C$' },\n  { code: 'CHF', name: 'Swiss Franc', symbol: 'CHF' },\n  { code: 'CNY', name: 'Chinese Yuan', symbol: '' },\n  { code: 'SGD', name: 'Singapore Dollar', symbol: 'S$' },\n  { code: 'THB', name: 'Thai Baht', symbol: '' },\n  { code: 'AED', name: 'UAE Dirham', symbol: '.' },\n  { code: 'MYR', name: 'Malaysian Ringgit', symbol: 'RM' }\n];\n\nconst CurrencyConverter: React.FC = () => {\n  const { toast } = useToast();\n  const [settings, setSettings] = useState<CurrencyConverterSettings>({\n    baseCurrency: 'USD',\n    autoUpdateRates: true,\n    updateFrequency: 'daily',\n    customRates: CurrencyService.getDefaultRates(),\n    defaultMargin: 2.0\n  });\n\n  const [newRate, setNewRate] = useState({\n    fromCurrency: 'USD',\n    toCurrency: '',\n    rate: '',\n    margin: '',\n    additionalSurcharge: ''\n  });\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [apiUsage, setApiUsage] = useState({ used: 0, limit: 300, remaining: 300 });\n  const [isApiKeyConfigured, setIsApiKeyConfigured] = useState(false);\n  const [nextRefreshTime, setNextRefreshTime] = useState<string>('Not scheduled');\n  const [currentISTTime, setCurrentISTTime] = useState<string>('');\n\n  useEffect(() => {\n    const savedSettings = localStorage.getItem('currencyConverterSettings');\n    if (savedSettings) {\n      const parsed = JSON.parse(savedSettings);\n      setSettings({\n        ...parsed,\n        customRates: parsed.customRates || CurrencyService.getDefaultRates()\n      });\n    }\n\n    // Check if API key is configured\n    const apiKey = CurrencyApiService.getApiKey();\n    setIsApiKeyConfigured(!!apiKey);\n\n    // Update API usage stats\n    const usage = CurrencyService.getApiUsage();\n    setApiUsage({\n      used: usage.used,\n      limit: usage.limit,\n      remaining: Math.max(0, usage.limit - usage.used)\n    });\n\n    // Update current IST time every minute\n    const updateTime = () => {\n      setCurrentISTTime(formatISTTime(getISTTime()));\n      setNextRefreshTime(CurrencyScheduler.getNextRefreshTime());\n    };\n    \n    updateTime();\n    const timeInterval = setInterval(updateTime, 60000); // Update every minute\n\n    // Initialize scheduler if auto-update is enabled\n    if (settings.autoUpdateRates) {\n      CurrencyScheduler.scheduleDaily9AM(() => {\n        handleRefreshRates();\n      });\n    }\n\n    return () => {\n      clearInterval(timeInterval);\n    };\n  }, [settings.autoUpdateRates]);\n\n  const handleAddCustomRate = () => {\n    if (!newRate.rate || !newRate.margin) {\n      toast({ title: 'Please fill in all required fields', variant: 'destructive' });\n      return;\n    }\n\n    const additionalSurcharge = parseFloat(newRate.additionalSurcharge) || 0;\n\n    const customRate: ExchangeRate = {\n      id: Date.now().toString(),\n      from: newRate.fromCurrency,\n      to: newRate.toCurrency,\n      fromCurrency: newRate.fromCurrency,\n      toCurrency: newRate.toCurrency,\n      rate: parseFloat(newRate.rate),\n      margin: parseFloat(newRate.margin),\n      additionalSurcharge: additionalSurcharge > 0 ? additionalSurcharge : undefined,\n      isCustom: true,\n      isRealTime: false,\n      lastUpdated: new Date().toISOString()\n    };\n\n    setSettings(prev => ({\n      ...prev,\n      customRates: [...prev.customRates, customRate]\n    }));\n\n    setNewRate({\n      fromCurrency: 'USD',\n      toCurrency: 'EUR',\n      rate: '',\n      margin: '',\n      additionalSurcharge: ''\n    });\n\n    toast({ title: 'Custom rate added successfully', variant: 'default' });\n  };\n\n  const handleUpdateRates = (updatedRates: ExchangeRate[]) => {\n    setSettings(prev => ({\n      ...prev,\n      customRates: updatedRates\n    }));\n  };\n\n  const handleRefreshRates = async () => {\n    if (apiUsage.remaining < 5) {\n      toast({ \n        title: 'API limit nearly reached', \n        description: 'Cannot refresh rates to preserve remaining API requests',\n        variant: 'destructive' \n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // Try to fetch all rates at once to minimize API calls\n      const { rates: allRates, isRealTime } = await CurrencyService.fetchAllRealTimeRates();\n      \n      const updatedRates = settings.customRates.map((rate) => {\n        if (!rate.isFixed) {\n          const rateKey = `${rate.fromCurrency}_${rate.toCurrency}`;\n          const newRate = allRates[rateKey] || rate.rate;\n          \n          return {\n            ...rate,\n            rate: newRate,\n            isRealTime,\n            lastUpdated: new Date().toISOString()\n          };\n        }\n        return {\n          ...rate,\n          lastUpdated: new Date().toISOString()\n        };\n      });\n      \n      setSettings(prev => ({\n        ...prev,\n        customRates: updatedRates\n      }));\n\n      // Update usage stats\n      const newUsage = CurrencyService.getApiUsage();\n      setApiUsage({\n        used: newUsage.used,\n        limit: newUsage.limit,\n        remaining: Math.max(0, newUsage.limit - newUsage.used)\n      });\n      \n      const realTimeCount = updatedRates.filter(r => r.isRealTime).length;\n      const mockCount = updatedRates.length - realTimeCount;\n      \n      toast({ \n        title: 'Exchange rates updated successfully', \n        description: `${realTimeCount} live rates, ${mockCount} mock/fixed rates. ${apiUsage.remaining - 1} API requests remaining.`,\n        variant: 'default' \n      });\n    } catch (error) {\n      toast({ \n        title: 'Failed to update exchange rates', \n        description: error instanceof Error ? error.message : 'Unknown error occurred',\n        variant: 'destructive' \n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSaveSettings = () => {\n    localStorage.setItem('currencyConverterSettings', JSON.stringify(settings));\n    \n    // Update scheduler based on auto-update setting\n    if (settings.autoUpdateRates) {\n      CurrencyScheduler.scheduleDaily9AM(() => {\n        handleRefreshRates();\n      });\n      toast({ \n        title: 'Settings saved successfully', \n        description: `Auto-refresh scheduled for 9:00 AM IST daily. Next refresh: ${CurrencyScheduler.getNextRefreshTime()}`,\n        variant: 'default' \n      });\n    } else {\n      CurrencyScheduler.clearSchedule();\n      toast({ title: 'Settings saved successfully', variant: 'default' });\n    }\n  };\n\n  const isThbToInr = newRate.fromCurrency === 'THB' && newRate.toCurrency === 'INR';\n\n  return (\n    <PageLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-2xl font-bold\">Currency Converter</h1>\n          <p className=\"text-muted-foreground\">\n            Manage exchange rates and conversion settings. Configure your API key below for real-time rates.\n          </p>\n          <div className=\"mt-2 text-sm text-muted-foreground\">\n            <span className=\"font-medium\">Current IST Time:</span> {currentISTTime}\n          </div>\n        </div>\n\n        {/* API Configuration Status */}\n        {!isApiKeyConfigured && (\n          <Alert variant=\"warning\">\n            <AlertTriangle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>API Key Required:</strong> Configure your CurrencyAPI.com API key below to get real-time exchange rates. \n              Without it, you'll only have access to mock rates with simulated fluctuations.\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {isApiKeyConfigured && (\n          <Alert>\n            <CheckCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>API Connected:</strong> Real-time rates are enabled. \n              {apiUsage.remaining < 50 && ` Warning: Only ${apiUsage.remaining} API requests remaining this month.`}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Auto-refresh Schedule Status */}\n        {settings.autoUpdateRates && (\n          <Alert>\n            <CheckCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>Auto-refresh Active:</strong> Exchange rates will automatically refresh daily at 9:00 AM IST.\n              <br />\n              <span className=\"text-sm\">Next scheduled refresh: {nextRefreshTime}</span>\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* API Configuration */}\n        <CurrencyApiConfig />\n\n        {/* API Usage Alert */}\n        {apiUsage.remaining < 50 && isApiKeyConfigured && (\n          <Alert variant={apiUsage.remaining < 10 ? \"destructive\" : \"warning\"}>\n            <Info className=\"h-4 w-4\" />\n            <AlertDescription>\n              API Usage: {apiUsage.used}/{apiUsage.limit} requests used. {apiUsage.remaining} requests remaining this month.\n              {apiUsage.remaining < 10 && \" System will use cached rates to preserve remaining requests.\"}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Currency Calculator */}\n        <CurrencyCalculator \n          rates={settings.customRates}\n          currencies={currencies}\n        />\n\n        {/* General Settings */}\n        <Card>\n          <CardHeader>\n            <CardTitle>General Settings</CardTitle>\n            <CardDescription>\n              Configure base currency and automatic update preferences. Auto-refresh runs daily at 9:00 AM IST.\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"baseCurrency\">Base Currency</Label>\n                <Select\n                  value={settings.baseCurrency}\n                  onValueChange={(value) => setSettings(prev => ({ ...prev, baseCurrency: value }))}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {currencies.map(currency => (\n                      <SelectItem key={currency.code} value={currency.code}>\n                        {currency.symbol} {currency.name} ({currency.code})\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"defaultMargin\">Default Margin (%)</Label>\n                <Input\n                  id=\"defaultMargin\"\n                  type=\"number\"\n                  step=\"0.1\"\n                  value={settings.defaultMargin}\n                  onChange={(e) => setSettings(prev => ({ ...prev, defaultMargin: parseFloat(e.target.value) || 0 }))}\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-0.5\">\n                <Label>Auto-update Rates</Label>\n                <p className=\"text-sm text-muted-foreground\">\n                  Automatically refresh exchange rates daily at 9:00 AM IST using live APIs\n                </p>\n              </div>\n              <Switch\n                checked={settings.autoUpdateRates}\n                onCheckedChange={(checked) => setSettings(prev => ({ ...prev, autoUpdateRates: checked }))}\n              />\n            </div>\n\n            {settings.autoUpdateRates && (\n              <div className=\"p-3 bg-muted/50 rounded-lg\">\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-green-600\"> Scheduled Refresh Active</p>\n                  <p className=\"text-muted-foreground mt-1\">\n                    Daily automatic refresh at 9:00 AM IST (India Standard Time)\n                  </p>\n                  <p className=\"text-muted-foreground text-xs mt-1\">\n                    Next refresh: {nextRefreshTime}\n                  </p>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Exchange Rate Manager */}\n        <ExchangeRateManager\n          rates={settings.customRates}\n          onUpdateRates={handleUpdateRates}\n          isLoading={isLoading}\n          onRefreshRates={handleRefreshRates}\n        />\n\n        {/* Add Custom Rate */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Add Custom Rate</CardTitle>\n            <CardDescription>\n              Add a custom exchange rate with your preferred margin and optional surcharge. Custom rates can be updated to real-time later.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {isThbToInr && (\n              <Alert className=\"mb-4\">\n                <Info className=\"h-4 w-4\" />\n                <AlertDescription>\n                  For THB to INR conversion, you can add an additional surcharge (e.g., 0.18 Paise per THB) on top of the margin.\n                </AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n              <div className=\"space-y-2\">\n                <Label>From Currency</Label>\n                <Select\n                  value={newRate.fromCurrency}\n                  onValueChange={(value) => setNewRate(prev => ({ ...prev, fromCurrency: value }))}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {currencies.map(currency => (\n                      <SelectItem key={currency.code} value={currency.code}>\n                        {currency.code}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>To Currency</Label>\n                <Select\n                  value={newRate.toCurrency}\n                  onValueChange={(value) => setNewRate(prev => ({ ...prev, toCurrency: value }))}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {currencies.map(currency => (\n                      <SelectItem key={currency.code} value={currency.code}>\n                        {currency.code}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Exchange Rate</Label>\n                <Input\n                  type=\"number\"\n                  step=\"0.0001\"\n                  placeholder=\"1.2345\"\n                  value={newRate.rate}\n                  onChange={(e) => setNewRate(prev => ({ ...prev, rate: e.target.value }))}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Margin (%)</Label>\n                <Input\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"2.5\"\n                  value={newRate.margin}\n                  onChange={(e) => setNewRate(prev => ({ ...prev, margin: e.target.value }))}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Additional Surcharge (Optional)</Label>\n                <Input\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"0.18\"\n                  value={newRate.additionalSurcharge}\n                  onChange={(e) => setNewRate(prev => ({ ...prev, additionalSurcharge: e.target.value }))}\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  Fixed amount added per unit (e.g., 0.18 Paise per THB)\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end mt-4\">\n              <Button onClick={handleAddCustomRate}>\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Add Rate\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Save Settings */}\n        <div className=\"flex justify-end\">\n          <Button onClick={handleSaveSettings}>\n            Save Settings\n          </Button>\n        </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default CurrencyConverter;\n","import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport { \n  AlertCircle, \n  CheckCircle, \n  Mail, \n  Server, \n  Shield, \n  Plus, \n  Edit, \n  Trash2, \n  Send,\n  Star,\n  Loader2,\n  BarChart,\n} from 'lucide-react';\nimport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n} from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport { Textarea } from '@/components/ui/textarea';\nimport { useToast } from '@/components/ui/use-toast';\nimport {\n  emailConfigurationService,\n  EmailConfiguration,\n  EmailConfigurationResponse\n} from '@/services/emailConfigurationService';\nimport CountryEmailSettings from '@/components/settings/CountryEmailSettings';\n\ninterface EmailConfigFormData {\n  name: string;\n  smtp_host: string;\n  smtp_port: string;\n  smtp_secure: boolean;\n  smtp_user: string;\n  smtp_password: string;\n  from_email: string;\n  from_name: string;\n  is_active: boolean;\n  is_default: boolean;\n  daily_send_limit: number;\n}\n\nconst EmailConfigurationSettings: React.FC = () => {\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  \n  const [configurations, setConfigurations] = useState<EmailConfiguration[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [testing, setTesting] = useState<string | null>(null);\n  \n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingConfig, setEditingConfig] = useState<EmailConfiguration | null>(null);\n  const [testEmail, setTestEmail] = useState('');\n  const [showTestDialog, setShowTestDialog] = useState(false);\n  const [configToTest, setConfigToTest] = useState<string | null>(null);\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [configToDelete, setConfigToDelete] = useState<string | null>(null);\n  \n  const [formData, setFormData] = useState<EmailConfigFormData>({\n    name: '',\n    smtp_host: '',\n    smtp_port: '587',\n    smtp_secure: false,\n    smtp_user: '',\n    smtp_password: '',\n    from_email: '',\n    from_name: '',\n    is_active: true,\n    is_default: false,\n    daily_send_limit: 100,\n  });\n\n  useEffect(() => {\n    loadConfigurations();\n  }, []);\n\n  const loadConfigurations = async () => {\n    try {\n      setLoading(true);\n      const response = await emailConfigurationService.getEmailConfigurations();\n      \n      if (response.success) {\n        console.log('Loaded configurations:', response.data);\n        setConfigurations(response.data || []);\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to load email configurations',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error loading configurations:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to load email configurations',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setSaving(true);\n      \n      const configData = {\n        ...formData,\n        smtp_port: parseInt(formData.smtp_port, 10),\n      };\n\n      let response: EmailConfigurationResponse<any>;\n      \n      if (editingConfig) {\n        response = await emailConfigurationService.updateEmailConfiguration(\n          editingConfig.id!,\n          configData\n        );\n      } else {\n        response = await emailConfigurationService.createEmailConfiguration(configData);\n      }\n\n      if (response.success) {\n        toast({\n          title: 'Success',\n          description: editingConfig \n            ? 'Email configuration updated successfully'\n            : 'Email configuration created successfully',\n        });\n        \n        setIsDialogOpen(false);\n        resetForm();\n        loadConfigurations();\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to save configuration',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error saving configuration:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to save configuration',\n        variant: 'destructive',\n      });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleTest = async (configId: string) => {\n    console.log('handleTest called with configId:', configId);\n    if (!configId) {\n      console.error('Configuration ID is undefined in handleTest!');\n      toast({\n        title: 'Error',\n        description: 'Configuration ID is missing',\n        variant: 'destructive',\n      });\n      return;\n    }\n    if (!testEmail) {\n      toast({\n        title: 'Error',\n        description: 'Please enter a test email address',\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    try {\n      setTesting(configId);\n      console.log('Testing configuration with ID:', configId, 'and email:', testEmail);\n      const response = await emailConfigurationService.testEmailConfiguration(configId, testEmail);\n      \n      if (response.success) {\n        toast({\n          title: 'Success',\n          description: response.data?.previewUrl \n            ? 'Test email sent! Check the preview URL in the console.'\n            : 'Test email sent successfully!',\n        });\n        \n        if (response.data?.previewUrl) {\n          console.log('Email preview URL:', response.data.previewUrl);\n        }\n        \n        setShowTestDialog(false);\n        setTestEmail('');\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to send test email',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error testing configuration:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to test configuration',\n        variant: 'destructive',\n      });\n    } finally {\n      setTesting(null);\n    }\n  };\n\n  const handleDelete = async (configId: string) => {\n    setConfigToDelete(configId);\n    setDeleteDialogOpen(true);\n  };\n\n  const confirmDelete = async () => {\n    if (!configToDelete) return;\n\n    try {\n      const response = await emailConfigurationService.deleteEmailConfiguration(configToDelete);\n      \n      if (response.success) {\n        toast({\n          title: 'Success',\n          description: 'Email configuration deleted successfully',\n        });\n        loadConfigurations();\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to delete configuration',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error deleting configuration:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to delete configuration',\n        variant: 'destructive',\n      });\n    } finally {\n      setDeleteDialogOpen(false);\n      setConfigToDelete(null);\n    }\n  };\n\n  const handleToggleStatus = async (configId: string) => {\n    try {\n      const response = await emailConfigurationService.toggleEmailConfigurationStatus(configId);\n      \n      if (response.success) {\n        toast({\n          title: 'Success',\n          description: 'Configuration status updated',\n        });\n        loadConfigurations();\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to update status',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error toggling status:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to update status',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleSetDefault = async (configId: string) => {\n    try {\n      const response = await emailConfigurationService.setDefaultEmailConfiguration(configId);\n      \n      if (response.success) {\n        toast({\n          title: 'Success',\n          description: 'Default configuration updated',\n        });\n        loadConfigurations();\n      } else {\n        toast({\n          title: 'Error',\n          description: response.error || 'Failed to set default',\n          variant: 'destructive',\n        });\n      }\n    } catch (error) {\n      console.error('Error setting default:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to set default configuration',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const openEditDialog = (config: EmailConfiguration) => {\n    setEditingConfig(config);\n    setFormData({\n      name: config.name,\n      smtp_host: config.smtp_host,\n      smtp_port: config.smtp_port.toString(),\n      smtp_secure: config.smtp_secure,\n      smtp_user: config.smtp_user,\n      smtp_password: config.smtp_password,\n      from_email: config.from_email,\n      from_name: config.from_name,\n      is_active: config.is_active ?? true,\n      is_default: config.is_default ?? false,\n      daily_send_limit: config.daily_send_limit ?? 100,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const openCreateDialog = () => {\n    setEditingConfig(null);\n    resetForm();\n    setIsDialogOpen(true);\n  };\n\n  const resetForm = () => {\n    setFormData({\n      name: '',\n      smtp_host: '',\n      smtp_port: '587',\n      smtp_secure: false,\n      smtp_user: '',\n      smtp_password: '',\n      from_email: '',\n      from_name: '',\n      is_active: true,\n      is_default: false,\n      daily_send_limit: 100,\n    });\n  };\n\n  const openTestDialog = (configId: string, email?: string) => {\n    console.log('Opening test dialog for config ID:', configId);\n    if (!configId) {\n      console.error('Configuration ID is undefined!');\n      toast({\n        title: 'Error',\n        description: 'Configuration ID is missing',\n        variant: 'destructive',\n      });\n      return;\n    }\n    setConfigToTest(configId);\n    setTestEmail(email || '');\n    setShowTestDialog(true);\n    console.log('Set configToTest to:', configId);\n  };\n\n  if (loading) {\n    return (\n      <PageLayout title=\"Email Configuration\" description=\"Manage SMTP settings and email providers\">\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"h-8 w-8 animate-spin\" />\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout \n      title=\"Email Configuration\" \n      description=\"Manage SMTP settings and email providers\"\n      action={\n        <Button onClick={openCreateDialog}>\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Configuration\n        </Button>\n      }\n    >\n      {/* Enhanced Header Section - Dark Mode Compatible */}\n      <div className=\"bg-gradient-to-r from-blue-50/80 to-indigo-50/80 dark:from-blue-900/20 dark:to-indigo-900/20 backdrop-blur-sm rounded-xl p-6 shadow-sm border border-blue-100 dark:border-blue-800 mb-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-white/60 dark:bg-gray-800/60 rounded-lg\">\n                <Mail className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent\">\n                  Email Configuration\n                </h1>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300 font-medium\">\n                  Manage your SMTP settings, email providers, and country-specific configurations\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Button \n              onClick={openCreateDialog}\n              className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-200\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Add Configuration\n            </Button>\n          </div>\n        </div>\n        \n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-6\">\n          <div className=\"bg-white/60 dark:bg-gray-800/60 rounded-lg p-4 border border-white/80 dark:border-gray-700\">\n            <div className=\"flex items-center gap-2\">\n              <Server className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Total Configs</span>\n            </div>\n            <p className=\"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1\">{configurations.length}</p>\n          </div>\n          <div className=\"bg-white/60 dark:bg-gray-800/60 rounded-lg p-4 border border-white/80 dark:border-gray-700\">\n            <div className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Active</span>\n            </div>\n            <p className=\"text-2xl font-bold text-green-600 dark:text-green-400 mt-1\">\n              {configurations.filter(c => c.is_active).length}\n            </p>\n          </div>\n          <div className=\"bg-white/60 dark:bg-gray-800/60 rounded-lg p-4 border border-white/80 dark:border-gray-700\">\n            <div className=\"flex items-center gap-2\">\n              <Star className=\"h-4 w-4 text-yellow-600 dark:text-yellow-400\" />\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Default</span>\n            </div>\n            <p className=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400 mt-1\">\n              {configurations.filter(c => c.is_default).length}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"space-y-6\">\n        {configurations.length === 0 ? (\n          <Card className=\"bg-gradient-to-br from-gray-50 to-blue-50 dark:from-gray-800/50 dark:to-blue-900/30 border-2 border-dashed border-blue-200 dark:border-blue-700\">\n            <CardContent className=\"flex flex-col items-center justify-center py-16\">\n              <div className=\"p-4 bg-white/60 dark:bg-gray-800/60 rounded-full mb-6\">\n                <Mail className=\"h-16 w-16 text-blue-500 dark:text-blue-400\" />\n              </div>\n              <h3 className=\"text-xl font-bold text-gray-800 dark:text-gray-100 mb-3\">No Email Configurations</h3>\n              <p className=\"text-gray-600 dark:text-gray-300 text-center mb-6 max-w-md\">\n                You haven't configured any email providers yet. Add your first configuration to start sending emails from your application.\n              </p>\n              <Button \n                onClick={openCreateDialog}\n                className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl transition-all duration-200\"\n              >\n                <Plus className=\"h-5 w-5 mr-2\" />\n                Add Your First Configuration\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-4\">\n            {configurations.map((config) => {\n              console.log('Rendering config:', config.id, config.name);\n              return (\n              <Card key={config.id} className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200\">\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 bg-gradient-to-r from-gray-50/50 to-blue-50/50 dark:from-gray-800/50 dark:to-blue-900/30 rounded-t-lg\">\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-sm\">\n                      <Mail className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n                    </div>\n                    <div>\n                      <CardTitle className=\"text-lg font-bold text-gray-800 dark:text-gray-100\">{config.name}</CardTitle>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        {config.is_default && (\n                          <Badge variant=\"secondary\" className=\"gap-1 bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-300 dark:border-yellow-700\">\n                            <Star className=\"h-3 w-3\" />\n                            Default\n                          </Badge>\n                        )}\n                        <Badge variant={config.is_active ? \"default\" : \"secondary\"} className={config.is_active ? \"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/30 dark:text-green-300 dark:border-green-700\" : \"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-700/50 dark:text-gray-300 dark:border-gray-600\"}>\n                          {config.is_active ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => {\n                        console.log('Test button clicked, config.id:', config.id);\n                        openTestDialog(config.id!);\n                      }}\n                      disabled={!config.is_active}\n                      className=\"border-blue-200 text-blue-700 hover:bg-blue-50 hover:text-blue-800 transition-all duration-200\"\n                    >\n                      <Send className=\"h-4 w-4 mr-1\" />\n                      Test\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => openEditDialog(config)}\n                      className=\"border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-gray-800 transition-all duration-200\"\n                    >\n                      <Edit className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDelete(config.id!)}\n                      disabled={config.is_default}\n                      className=\"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800 transition-all duration-200\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-4\">\n                  <div className=\"grid grid-cols-2 gap-4 text-sm mb-6\">\n                    <div className=\"bg-gray-50/50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-100 dark:border-gray-600\">\n                      <Label className=\"text-muted-foreground dark:text-gray-400 flex items-center gap-1\">\n                        <Server className=\"h-3 w-3\" />\n                        SMTP Host\n                      </Label>\n                      <p className=\"font-medium text-gray-800 dark:text-gray-200 mt-1\">{config.smtp_host}</p>\n                    </div>\n                    <div className=\"bg-gray-50/50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-100 dark:border-gray-600\">\n                      <Label className=\"text-muted-foreground dark:text-gray-400 flex items-center gap-1\">\n                        <Shield className=\"h-3 w-3\" />\n                        SMTP Port\n                      </Label>\n                      <p className=\"font-medium text-gray-800 dark:text-gray-200 mt-1\">{config.smtp_port}</p>\n                    </div>\n                    <div className=\"bg-gray-50/50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-100 dark:border-gray-600\">\n                      <Label className=\"text-muted-foreground dark:text-gray-400 flex items-center gap-1\">\n                        <Mail className=\"h-3 w-3\" />\n                        From Email\n                      </Label>\n                      <p className=\"font-medium text-gray-800 dark:text-gray-200 mt-1\">{config.from_email}</p>\n                    </div>\n                    <div className=\"bg-gray-50/50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-100 dark:border-gray-600\">\n                      <Label className=\"text-muted-foreground dark:text-gray-400 flex items-center gap-1\">\n                        <CheckCircle className=\"h-3 w-3\" />\n                        From Name\n                      </Label>\n                      <p className=\"font-medium text-gray-800 dark:text-gray-200 mt-1\">{config.from_name}</p>\n                    </div>\n                    <div className=\"bg-gray-50/50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-100 dark:border-gray-600\">\n                      <Label className=\"text-muted-foreground dark:text-gray-400 flex items-center gap-1\">\n                        <BarChart className=\"h-3 w-3\" />\n                        Daily Usage\n                      </Label>\n                      <div className=\"mt-1\">\n                        <p className=\"font-medium text-gray-800 dark:text-gray-200\">\n                          {config.current_day_sent || 0} / {config.daily_send_limit || 100}\n                        </p>\n                        <div className=\"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mt-1\">\n                          <div \n                            className={`h-2 rounded-full ${\n                              ((config.current_day_sent || 0) / (config.daily_send_limit || 100)) >= 0.9 \n                                ? 'bg-red-500' \n                                : ((config.current_day_sent || 0) / (config.daily_send_limit || 100)) >= 0.7 \n                                ? 'bg-yellow-500' \n                                : 'bg-green-500'\n                            }`}\n                            style={{ \n                              width: `${Math.min(100, ((config.current_day_sent || 0) / (config.daily_send_limit || 100)) * 100)}%` \n                            }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-4\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Switch\n                        checked={config.is_active}\n                        onCheckedChange={() => handleToggleStatus(config.id!)}\n                        className=\"data-[state=checked]:bg-green-600\"\n                      />\n                      <Label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Active</Label>\n                    </div>\n                    {!config.is_default && (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleSetDefault(config.id!)}\n                        className=\"border-yellow-200 text-yellow-700 hover:bg-yellow-50 hover:text-yellow-800 dark:border-yellow-700 dark:text-yellow-400 dark:hover:bg-yellow-900/20 dark:hover:text-yellow-300 transition-all duration-200\"\n                      >\n                        <Star className=\"h-4 w-4 mr-1\" />\n                        Set as Default\n                      </Button>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )})}\n          </div>\n        )}\n\n        {/* Create/Edit Dialog */}\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>\n                {editingConfig ? 'Edit Email Configuration' : 'Add Email Configuration'}\n              </DialogTitle>\n              <DialogDescription className=\"text-gray-600 dark:text-gray-300\">\n                Configure your SMTP settings to send emails from your application.\n              </DialogDescription>\n            </DialogHeader>\n            <form onSubmit={handleSubmit}>\n              <div className=\"grid gap-4 py-4\">\n                <div className=\"grid gap-2\">\n                  <Label htmlFor=\"name\" className=\"text-gray-700 dark:text-gray-200\">Configuration Name</Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    placeholder=\"e.g., Primary SMTP\"\n                    required\n                  />\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"smtp_host\" className=\"text-gray-700 dark:text-gray-200\">SMTP Host</Label>\n                    <Input\n                      id=\"smtp_host\"\n                      value={formData.smtp_host}\n                      onChange={(e) => setFormData({ ...formData, smtp_host: e.target.value })}\n                      placeholder=\"smtp.gmail.com\"\n                      required\n                    />\n                  </div>\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"smtp_port\" className=\"text-gray-700 dark:text-gray-200\">SMTP Port</Label>\n                    <Input\n                      id=\"smtp_port\"\n                      type=\"number\"\n                      value={formData.smtp_port}\n                      onChange={(e) => setFormData({ ...formData, smtp_port: e.target.value })}\n                      placeholder=\"587\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"smtp_user\" className=\"text-gray-700 dark:text-gray-200\">SMTP Username</Label>\n                    <Input\n                      id=\"smtp_user\"\n                      value={formData.smtp_user}\n                      onChange={(e) => setFormData({ ...formData, smtp_user: e.target.value })}\n                      placeholder=\"your-email@gmail.com\"\n                      required\n                    />\n                  </div>\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"smtp_password\" className=\"text-gray-700 dark:text-gray-200\">SMTP Password</Label>\n                    <Input\n                      id=\"smtp_password\"\n                      type=\"password\"\n                      value={formData.smtp_password}\n                      onChange={(e) => setFormData({ ...formData, smtp_password: e.target.value })}\n                      placeholder=\"Your SMTP password\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"from_email\" className=\"text-gray-700 dark:text-gray-200\">From Email</Label>\n                    <Input\n                      id=\"from_email\"\n                      type=\"email\"\n                      value={formData.from_email}\n                      onChange={(e) => setFormData({ ...formData, from_email: e.target.value })}\n                      placeholder=\"noreply@yourdomain.com\"\n                      required\n                    />\n                  </div>\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"from_name\" className=\"text-gray-700 dark:text-gray-200\">From Name</Label>\n                    <Input\n                      id=\"from_name\"\n                      value={formData.from_name}\n                      onChange={(e) => setFormData({ ...formData, from_name: e.target.value })}\n                      placeholder=\"Your Company Name\"\n                      required\n                    />\n                  </div>\n                  <div className=\"grid gap-2\">\n                    <Label htmlFor=\"daily_send_limit\" className=\"text-gray-700 dark:text-gray-200\">Daily Send Limit</Label>\n                    <Input\n                      id=\"daily_send_limit\"\n                      type=\"number\"\n                      min=\"1\"\n                      max=\"10000\"\n                      value={formData.daily_send_limit}\n                      onChange={(e) => setFormData({ ...formData, daily_send_limit: parseInt(e.target.value) || 100 })}\n                      placeholder=\"100\"\n                      required\n                    />\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      Maximum emails this account can send per day (1-10,000)\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <Switch\n                      id=\"smtp_secure\"\n                      checked={formData.smtp_secure}\n                      onCheckedChange={(checked) => setFormData({ ...formData, smtp_secure: checked })}\n                    />\n                    <Label htmlFor=\"smtp_secure\" className=\"text-gray-700 dark:text-gray-200\">Use Secure Connection (SSL/TLS)</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Switch\n                      id=\"is_active\"\n                      checked={formData.is_active}\n                      onCheckedChange={(checked) => setFormData({ ...formData, is_active: checked })}\n                    />\n                    <Label htmlFor=\"is_active\" className=\"text-gray-700 dark:text-gray-200\">Active</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Switch\n                      id=\"is_default\"\n                      checked={formData.is_default}\n                      onCheckedChange={(checked) => setFormData({ ...formData, is_default: checked })}\n                    />\n                    <Label htmlFor=\"is_default\" className=\"text-gray-700 dark:text-gray-200\">Default</Label>\n                  </div>\n                </div>\n              </div>\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n                  Cancel\n                </Button>\n                <Button type=\"submit\" disabled={saving}>\n                  {saving && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\n                  {editingConfig ? 'Update' : 'Create'}\n                </Button>\n              </DialogFooter>\n            </form>\n          </DialogContent>\n        </Dialog>\n\n        {/* Test Dialog */}\n        <Dialog open={showTestDialog} onOpenChange={setShowTestDialog}>\n          <DialogContent>\n            {console.log('Test dialog rendered, configToTest:', configToTest, 'testEmail:', testEmail)}\n            <DialogHeader>\n              <DialogTitle>Test Email Configuration</DialogTitle>\n              <DialogDescription className=\"text-gray-600 dark:text-gray-300\">\n                Send a test email to verify your configuration is working correctly.\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"grid gap-4 py-4\">\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"test_email\" className=\"text-gray-700 dark:text-gray-200\">Test Email Address</Label>\n                <Input\n                  id=\"test_email\"\n                  type=\"email\"\n                  value={testEmail}\n                  onChange={(e) => setTestEmail(e.target.value)}\n                  placeholder=\"your-email@example.com\"\n                  required\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setShowTestDialog(false)}>\n                Cancel\n              </Button>\n              <Button \n                onClick={() => {\n                  console.log('Test button clicked, configToTest:', configToTest);\n                  configToTest && handleTest(configToTest);\n                }}\n                disabled={!testEmail || testing === configToTest}\n              >\n                {testing === configToTest && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\n                Send Test Email\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Enhanced Help Section with Better Spacing */}\n        <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50/50 to-indigo-50/50 dark:from-gray-800/50 dark:to-blue-900/30 rounded-t-lg pb-4\">\n            <CardTitle className=\"flex items-center gap-3 text-lg font-bold text-gray-800 dark:text-gray-100\">\n              <div className=\"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-sm\">\n                <AlertCircle className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n              </div>\n              Configuration Help\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"pt-6\">\n            <div className=\"space-y-6\">\n              <Alert className=\"bg-blue-50/50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700\">\n                <AlertCircle className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n                <AlertTitle className=\"text-blue-800 dark:text-blue-300 font-semibold\">Common SMTP Settings</AlertTitle>\n                <AlertDescription className=\"text-blue-700 dark:text-blue-400\">\n                  <div className=\"grid gap-3 text-sm\">\n                    <div className=\"flex items-start gap-2\">\n                      <span className=\"font-medium min-w-[60px]\">Gmail:</span>\n                      <span>smtp.gmail.com:587 (use app password)</span>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <span className=\"font-medium min-w-[60px]\">Outlook:</span>\n                      <span>smtp-mail.outlook.com:587</span>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <span className=\"font-medium min-w-[60px]\">SendGrid:</span>\n                      <span>smtp.sendgrid.net:587</span>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <span className=\"font-medium min-w-[60px]\">AWS SES:</span>\n                      <span>email-smtp.[region].amazonaws.com:587</span>\n                    </div>\n                  </div>\n                </AlertDescription>\n              </Alert>\n              \n              <Alert className=\"bg-green-50/50 dark:bg-green-900/20 border-green-200 dark:border-green-700\">\n                <Shield className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                <AlertTitle className=\"text-green-800 dark:text-green-300 font-semibold\">Security Notes</AlertTitle>\n                <AlertDescription className=\"text-green-700 dark:text-green-400\">\n                  Store your SMTP credentials securely. For Gmail, use app-specific passwords instead of your regular password.\n                </AlertDescription>\n              </Alert>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Added spacing between sections */}\n        <div className=\"h-8\"></div>\n      </div>\n\n      {/* Country-Based Email Settings */}\n      <CountryEmailSettings />\n\n      {/* Delete Confirmation Dialog */}\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Email Configuration</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this email configuration? This action cannot be undone.\n              All settings for this email provider will be permanently removed.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={confirmDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n    </PageLayout>\n  );\n};\n\nexport default EmailConfigurationSettings;","import PageLayout from '@/components/layout/PageLayout'\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card'\nimport { Label } from '@/components/ui/label'\nimport { Input } from '@/components/ui/input'\nimport { Button } from '@/components/ui/button'\nimport { Select, SelectTrigger, SelectValue, SelectContent, SelectItem } from '@/components/ui/select'\nimport { Switch } from '@/components/ui/switch'\nimport { Badge } from '@/components/ui/badge'\nimport { useEffect, useState } from 'react'\nimport { AppSettingsService, AppSettingsHelpers } from '@/services/appSettingsService_database'\nimport { sendOtp, verifyOtp, getSmsConfigStatus } from '@/services/smsService.ts'\nimport { supabase } from '@/lib/supabaseClient'\nimport { useToast } from '@/components/ui/use-toast'\n\nexport default function SmsOtpSettings() {\n  const { toast } = useToast()\n  const [provider, setProvider] = useState('2factor')\n  const [mode, setMode] = useState<'mock'|'live'>('mock')\n  const [apiKey, setApiKey] = useState('')\n  const [senderId, setSenderId] = useState('TRIPEX')\n  const [templateName, setTemplateName] = useState('SMSTemplate1otp')\n  const [companyName, setCompanyName] = useState('Heeya Travels')\n  const [companyWebsite, setCompanyWebsite] = useState('heeyatravels.com')\n  const [approvalStatus, setApprovalStatus] = useState('APPROVED')\n  const [nature, setNature] = useState('Transactional')\n  const [purpose, setPurpose] = useState('Sending OTP to customers')\n  const [isOpenTemplate, setIsOpenTemplate] = useState(false)\n  const [templateText, setTemplateText] = useState('Hi #VAR1#, Your one time password for phone verification is #VAR2#')\n  const [enabledSend, setEnabledSend] = useState(true)\n  const [enabledVerify, setEnabledVerify] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [health, setHealth] = useState<any>(null)\n  const [testPhone, setTestPhone] = useState('')\n  const [requestId, setRequestId] = useState('')\n  const [otp, setOtp] = useState('')\n  const [sending, setSending] = useState(false)\n  const [verifying, setVerifying] = useState(false)\n  const [logs, setLogs] = useState<any[]>([])\n\n  useEffect(() => {\n    ;(async () => {\n      const status = await getSmsConfigStatus()\n      if (status.ok && status.data) setHealth(status.data)\n      const cfg = await AppSettingsService.getSetting('Integrations','sms_otp_config')\n      if (cfg.success && cfg.data && cfg.data.setting_json) {\n        const j: any = cfg.data.setting_json\n        setProvider(String(j.provider || provider))\n        setMode(String(j.mode || mode) as any)\n        setApiKey(String(j.api_key || apiKey))\n        setSenderId(String(j.sender_id || senderId))\n        setTemplateName(String(j.template_name || templateName))\n        setCompanyName(String(j.company_name || companyName))\n        setCompanyWebsite(String(j.company_website || companyWebsite))\n        setApprovalStatus(String(j.approval_status || approvalStatus))\n        setNature(String(j.nature || nature))\n        setPurpose(String(j.purpose || purpose))\n        setIsOpenTemplate(!!j.is_open_template)\n        setTemplateText(String(j.template_text || templateText))\n        setEnabledSend(j.enabled_send !== false)\n        setEnabledVerify(j.enabled_verify !== false)\n      }\n      const { data } = await supabase.from('otp_logs').select('*').order('created_at',{ ascending: false }).limit(20)\n      setLogs(data || [])\n    })()\n  }, [])\n\n  const handleSave = async () => {\n    setSaving(true)\n    const payload = {\n      provider,\n      mode,\n      api_key: apiKey,\n      sender_id: senderId,\n      template_name: templateName,\n      company_name: companyName,\n      company_website: companyWebsite,\n      approval_status: approvalStatus,\n      nature,\n      purpose,\n      is_open_template: isOpenTemplate,\n      template_text: templateText,\n      enabled_send: enabledSend,\n      enabled_verify: enabledVerify,\n    }\n    await AppSettingsHelpers.upsertSetting({ category: 'Integrations', setting_key: 'sms_otp_config', setting_json: payload })\n    setSaving(false)\n  }\n\n  const handleSend = async () => {\n    setSending(true)\n    const r = await sendOtp(testPhone, 'login')\n    if (r.ok) {\n      setRequestId(r.data.request_id || '')\n      toast({ title: 'OTP sent', description: `Request ID: ${r.data.request_id || ''}` })\n    } else {\n      toast({ title: 'Send failed', description: String(r.data?.error || 'Unknown error') })\n    }\n    setSending(false)\n  }\n\n  const handleVerify = async () => {\n    setVerifying(true)\n    const r = await verifyOtp(testPhone, requestId, otp)\n    if (r.ok) {\n      toast({ title: 'OTP verified', description: 'Verification successful' })\n      setOtp('')\n    } else {\n      toast({ title: 'Verification failed', description: String(r.data?.error || 'Unknown error') })\n    }\n    setVerifying(false)\n  }\n\n  return (\n    <PageLayout>\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>SMS & OTP Configuration</CardTitle>\n            <CardDescription>Store provider credentials and control service behavior</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Provider</Label>\n                <Select value={provider} onValueChange={setProvider}>\n                  <SelectTrigger><SelectValue placeholder=\"Select\" /></SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"2factor\">2Factor</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Mode</Label>\n                <Select value={mode} onValueChange={(v) => setMode(v as any)}>\n                  <SelectTrigger><SelectValue placeholder=\"Select\" /></SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"mock\">Mock</SelectItem>\n                    <SelectItem value=\"live\">Live</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>API Key</Label>\n                <Input value={apiKey} onChange={(e) => setApiKey(e.target.value)} type=\"password\" placeholder=\"Enter API key\" />\n              </div>\n              <div>\n                <Label>Sender Id</Label>\n                <Input value={senderId} onChange={(e) => setSenderId(e.target.value)} placeholder=\"TRIPEX\" />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Template Name</Label>\n                <Input value={templateName} onChange={(e) => setTemplateName(e.target.value)} />\n              </div>\n              <div>\n                <Label>Company Name</Label>\n                <Input value={companyName} onChange={(e) => setCompanyName(e.target.value)} />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Company Website</Label>\n                <Input value={companyWebsite} onChange={(e) => setCompanyWebsite(e.target.value)} />\n              </div>\n              <div>\n                <Label>Approval Status</Label>\n                <Input value={approvalStatus} onChange={(e) => setApprovalStatus(e.target.value)} />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Nature</Label>\n                <Input value={nature} onChange={(e) => setNature(e.target.value)} />\n              </div>\n              <div>\n                <Label>Purpose</Label>\n                <Input value={purpose} onChange={(e) => setPurpose(e.target.value)} />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Template Text</Label>\n              <Input value={templateText} onChange={(e) => setTemplateText(e.target.value)} />\n            </div>\n            <div className=\"flex items-center gap-6\">\n              <div className=\"flex items-center gap-2\"><Switch checked={enabledSend} onCheckedChange={setEnabledSend} /><span>Enable Send</span></div>\n              <div className=\"flex items-center gap-2\"><Switch checked={enabledVerify} onCheckedChange={setEnabledVerify} /><span>Enable Verify</span></div>\n              <div className=\"flex items-center gap-2\"><Switch checked={isOpenTemplate} onCheckedChange={setIsOpenTemplate} /><span>Open Template</span></div>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <Button onClick={handleSave} disabled={saving}>{saving ? 'Saving' : 'Save Configuration'}</Button>\n              {health && (\n                <Badge variant=\"outline\">{health.provider || 'sms'}  {health.mode}</Badge>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Test Sender</CardTitle>\n            <CardDescription>Send and verify OTP</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Phone</Label>\n                <Input value={testPhone} onChange={(e) => setTestPhone(e.target.value)} placeholder=\"8104430753\" />\n              </div>\n              <div className=\"flex items-end\">\n                <Button onClick={handleSend} disabled={sending || !testPhone}>{sending ? 'Sending' : 'Send OTP'}</Button>\n              </div>\n            </div>\n            <div className=\"grid grid-cols-3 gap-4\">\n              <div>\n                <Label>Request ID</Label>\n                <Input value={requestId} onChange={(e) => setRequestId(e.target.value)} />\n              </div>\n              <div>\n                <Label>OTP</Label>\n                <Input value={otp} onChange={(e) => setOtp(e.target.value)} />\n              </div>\n              <div className=\"flex items-end\">\n                <Button onClick={handleVerify} disabled={verifying || !testPhone || !requestId || !otp}>{verifying ? 'Verifying' : 'Verify OTP'}</Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"md:col-span-2\">\n          <CardHeader>\n            <CardTitle>Recent OTP Logs</CardTitle>\n            <CardDescription>Latest events from Supabase</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-sm\">\n                <thead>\n                  <tr className=\"text-left\">\n                    <th className=\"p-2\">Time</th>\n                    <th className=\"p-2\">Phone</th>\n                    <th className=\"p-2\">Mode</th>\n                    <th className=\"p-2\">Status</th>\n                    <th className=\"p-2\">Provider</th>\n                    <th className=\"p-2\">Req ID</th>\n                    <th className=\"p-2\">Err</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {logs.map((r) => (\n                    <tr key={r.id} className=\"border-t\">\n                      <td className=\"p-2\">{new Date(r.created_at).toLocaleString()}</td>\n                      <td className=\"p-2\">{r.phone}</td>\n                      <td className=\"p-2\">{r.mode}</td>\n                      <td className=\"p-2\">{r.status}</td>\n                      <td className=\"p-2\">{r.provider}</td>\n                      <td className=\"p-2\">{r.request_id}</td>\n                      <td className=\"p-2\">{r.error_message || ''}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </PageLayout>\n  )\n}\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Settings,\n  Globe,\n  Palette,\n  Bell,\n  Users,\n  Shield,\n  Code,\n  Languages,\n  Mail,\n  DollarSign,\n  CreditCard,\n  FileText,\n  Image as ImageIcon,\n  Server,\n  MessageSquare,\n} from 'lucide-react';\n\ntype SubLink = { label: string; icon: React.ElementType; path: string };\ntype ModuleItem = {\n  id: string;\n  title: string;\n  description: string;\n  icon: React.ElementType;\n  path: string;\n  subLinks?: SubLink[];\n  adminOnly?: boolean;\n};\n\nconst modules: ModuleItem[] = [\n  {\n    id: 'general',\n    title: 'General',\n    description: 'Core app configuration and preferences',\n    icon: Settings,\n    path: '/settings/general',\n    subLinks: [\n      { label: 'General', icon: Settings, path: '/settings/general?category=general' },\n      { label: 'SEO', icon: Globe, path: '/settings/general?category=seo' },\n      { label: 'Branding', icon: Palette, path: '/settings/general?category=branding' },\n    ],\n  },\n  {\n    id: 'account',\n    title: 'Account',\n    description: 'User account and profile settings',\n    icon: Users,\n    path: '/settings/account',\n  },\n  {\n    id: 'notifications',\n    title: 'Notifications',\n    description: 'Email and push notifications preferences',\n    icon: Bell,\n    path: '/settings/notifications',\n  },\n  {\n    id: 'appearance',\n    title: 'Appearance & Branding',\n    description: 'Themes, colors, logos and layout',\n    icon: Palette,\n    path: '/settings/appearance',\n    subLinks: [\n      { label: 'Appearance', icon: Palette, path: '/settings/appearance' },\n      { label: 'Logo Test', icon: ImageIcon, path: '/settings/logo-test' },\n    ],\n  },\n  {\n    id: 'language',\n    title: 'Language',\n    description: 'Localization and language packs',\n    icon: Languages,\n    path: '/settings/language',\n  },\n  {\n    id: 'api',\n    title: 'API & Integrations',\n    description: 'API keys and platform integrations',\n    icon: Code,\n    path: '/settings/api',\n    subLinks: [\n      { label: 'API', icon: Code, path: '/settings/api' },\n      { label: 'Integrations', icon: Code, path: '/settings/general?category=integrations' },\n    ],\n  },\n  {\n    id: 'access',\n    title: 'Access Control',\n    description: 'Roles, permissions and policies',\n    icon: Shield,\n    path: '/settings/access',\n  },\n  {\n    id: 'agents',\n    title: 'Agent Management',\n    description: 'Manage field agents and access',\n    icon: Users,\n    path: '/settings/agents',\n  },\n  {\n    id: 'translation',\n    title: 'Translation Tool',\n    description: 'Translate and localize templates',\n    icon: Languages,\n    path: '/settings/translation',\n  },\n  {\n    id: 'pricing',\n    title: 'Pricing',\n    description: 'Configure pricing rules and taxes',\n    icon: DollarSign,\n    path: '/settings/pricing',\n  },\n  {\n    id: 'currency',\n    title: 'Currency Converter',\n    description: 'Exchange rates and currencies',\n    icon: CreditCard,\n    path: '/settings/currency-converter',\n  },\n  {\n    id: 'emails',\n    title: 'Email Templates',\n    description: 'Design and manage email templates',\n    icon: Mail,\n    path: '/settings/email-templates',\n    subLinks: [\n      { label: 'Manage Templates', icon: FileText, path: '/email-templates' },\n    ],\n  },\n  {\n    id: 'email-config',\n    title: 'Email Configuration',\n    description: 'Configure SMTP settings and email providers',\n    icon: Server,\n    path: '/settings/email-configuration',\n    adminOnly: true,\n  },\n  {\n    id: 'sms-otp',\n    title: 'SMS & OTP',\n    description: 'Manage SMS provider, API key, and OTP settings',\n    icon: MessageSquare,\n    path: '/settings/sms-otp',\n    subLinks: [\n      { label: 'Configuration', icon: MessageSquare, path: '/settings/sms-otp' },\n    ],\n    adminOnly: true,\n  },\n  {\n    id: 'app',\n    title: 'App Settings',\n    description: 'Administrative app configuration',\n    icon: Settings,\n    path: '/settings/app',\n    subLinks: [\n      { label: 'General', icon: Settings, path: '/settings/app' },\n    ],\n    adminOnly: true,\n  },\n];\n\nconst SettingsPage: React.FC = () => {\n  return (\n    <PageLayout title=\"Settings\" description=\"System Configuration\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\n            {modules.map((m) => {\n              const Icon = m.icon;\n              return (\n                <Card key={m.id} className=\"hover:shadow-md transition-shadow\">\n                  <CardHeader className=\"flex flex-row items-center gap-3\">\n                    <div className=\"p-2 rounded-md bg-muted\">\n                      <Icon className=\"h-5 w-5\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg flex items-center gap-2\">\n                        {m.title}\n                        {m.adminOnly && <Badge variant=\"secondary\">Admin</Badge>}\n                      </CardTitle>\n                      <p className=\"text-sm text-muted-foreground\">{m.description}</p>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"flex items-center gap-3 mb-4\">\n                      <Link to={m.path}>\n                        <Button size=\"sm\">Open {m.title}</Button>\n                      </Link>\n                    </div>\n                    {m.subLinks && m.subLinks.length > 0 && (\n                      <div className=\"flex flex-wrap gap-2\">\n                        {m.subLinks.map((s) => {\n                          const SIcon = s.icon;\n                          return (\n                            <Link to={s.path} key={s.path}>\n                              <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n                                <SIcon className=\"h-4 w-4\" />\n                                {s.label}\n                              </Button>\n                            </Link>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              );\n            })}\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default SettingsPage;\n","import React from 'react';\nimport { LogoDebug } from '@/components/settings/LogoDebug';\nimport { ThemeTestSuite } from '@/components/settings/ThemeTestSuite';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { useTheme } from 'next-themes';\nimport { Sun, Moon, ArrowLeft, Settings, TestTube } from 'lucide-react';\nimport { Link } from 'react-router-dom';\n\n/**\n * Logo Test Page - Helps verify dark/light logo functionality\n * This page provides a comprehensive test of the logo switching functionality\n */\nconst LogoTestPage: React.FC = () => {\n  const { theme, setTheme } = useTheme();\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto py-8 px-4 max-w-4xl\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <Link to=\"/settings\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Back to Settings\n              </Button>\n            </Link>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}\n            >\n              {theme === 'dark' ? (\n                <>\n                  <Sun className=\"h-4 w-4 mr-2\" />\n                  Switch to Light\n                </>\n              ) : (\n                <>\n                  <Moon className=\"h-4 w-4 mr-2\" />\n                  Switch to Dark\n                </>\n              )}\n            </Button>\n          </div>\n          \n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-2xl flex items-center gap-3\">\n                <TestTube className=\"h-6 w-6\" />\n                Logo & Theme Test Suite\n              </CardTitle>\n              <CardDescription>\n                Comprehensive testing for dark/light logo switching, theme management, and accessibility features\n              </CardDescription>\n            </CardHeader>\n          </Card>\n        </div>\n\n        {/* Logo Debug Component */}\n        <LogoDebug />\n\n        {/* Comprehensive Theme Test Suite */}\n        <ThemeTestSuite />\n\n        {/* Enhanced Instructions */}\n        <Card className=\"mt-6\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Settings className=\"h-5 w-5\" />\n              Testing Instructions\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium flex items-center gap-2\">\n                    <span className=\"w-6 h-6 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-bold\">1</span>\n                    Upload Logo Assets\n                  </h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Navigate to Settings  Branding  Application Logo to upload both light and dark versions of your logo. \n                    The system supports PNG, JPG, and SVG formats.\n                  </p>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium flex items-center gap-2\">\n                    <span className=\"w-6 h-6 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center text-green-600 dark:text-green-400 text-sm font-bold\">2</span>\n                    Test Theme Switching\n                  </h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use the theme toggle buttons above or the system theme switcher to test automatic logo transitions. \n                    The system detects OS-level theme changes in real-time.\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium flex items-center gap-2\">\n                    <span className=\"w-6 h-6 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center text-purple-600 dark:text-purple-400 text-sm font-bold\">3</span>\n                    Run Automated Tests\n                  </h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Use the \"Run All Tests\" button in the Theme Test Suite above to validate theme switching, \n                    logo caching, accessibility features, and performance metrics.\n                  </p>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium flex items-center gap-2\">\n                    <span className=\"w-6 h-6 bg-orange-100 dark:bg-orange-900 rounded-full flex items-center justify-center text-orange-600 dark:text-orange-400 text-sm font-bold\">4</span>\n                    Monitor Performance\n                  </h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Check the performance metrics to ensure smooth theme transitions, fast logo loading, \n                    and optimal caching behavior across different network conditions.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n              <h4 className=\"font-medium text-blue-800 dark:text-blue-200 mb-3 flex items-center gap-2\">\n                <Settings className=\"h-4 w-4\" />\n                Enhanced Features:\n              </h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                <ul className=\"space-y-2 text-blue-700 dark:text-blue-300\">\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />\n                    Real-time theme detection with system preference monitoring\n                  </li>\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />\n                    Smooth CSS transitions between themes (300ms duration)\n                  </li>\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />\n                    Supabase Storage integration for logo asset management\n                  </li>\n                </ul>\n                <ul className=\"space-y-2 text-purple-700 dark:text-purple-300\">\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-purple-500 rounded-full\" />\n                    Intelligent logo caching with cache busting\n                  </li>\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-purple-500 rounded-full\" />\n                    Comprehensive accessibility attributes (ARIA)\n                  </li>\n                  <li className=\"flex items-center gap-2\">\n                    <div className=\"w-2 h-2 bg-purple-500 rounded-full\" />\n                    Network condition simulation for testing\n                  </li>\n                </ul>\n              </div>\n            </div>\n\n            <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4\">\n              <h4 className=\"font-medium text-yellow-800 dark:text-yellow-200 mb-2\">Expected Behavior Summary:</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-yellow-700 dark:text-yellow-300\">\n                <div>\n                  <div className=\"font-medium mb-2\">Light Mode:</div>\n                  <ul className=\"space-y-1\">\n                    <li> Displays light logo (if uploaded)</li>\n                    <li> Shows company initial fallback if no logo</li>\n                    <li> Smooth transition from dark mode</li>\n                  </ul>\n                </div>\n                <div>\n                  <div className=\"font-medium mb-2\">Dark Mode:</div>\n                  <ul className=\"space-y-1\">\n                    <li> Displays dark logo (if configured)</li>\n                    <li> Falls back to light logo if no dark version</li>\n                    <li> Automatic system preference detection</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default LogoTestPage;"],"file":"app-settings-D1meDWfP.js"}