{"version":3,"file":"app-management-BdgIBIzo.js","sources":["../../src/pages/management/staff/hr/PayrollManagement.tsx","../../src/pages/management/staff/hr/LeaveManagement.tsx","../../src/pages/management/staff/hr/AttendanceManagement.tsx","../../src/pages/management/staff/hr/SalaryStructureManager.tsx","../../src/pages/management/staff/hr/ActiveStaffList.tsx","../../src/pages/management/staff/HRDashboard.tsx","../../src/pages/management/hr/HRSidebar.tsx","../../src/pages/management/hr/HRLayout.tsx","../../src/pages/management/hr/PayrollPage.tsx","../../src/pages/management/hr/LeavesPage.tsx","../../src/pages/management/hr/StaffDocsVerification.tsx","../../src/pages/management/hr/BankVerification.tsx","../../src/pages/management/hr/Onboarding.tsx","../../src/pages/management/hr/Offboarding.tsx","../../src/pages/management/hr/ComplianceCenter.tsx","../../src/pages/management/AgentManagement.tsx","../../src/pages/management/agents/AddAgent.tsx","../../src/pages/management/agents/components/StaffAssignmentTab.tsx","../../src/pages/management/agents/AgentProfile.tsx","../../src/pages/management/agents/EditAgent.tsx","../../src/pages/management/StaffManagement.tsx","../../src/pages/management/staff/AddStaff.tsx","../../src/pages/management/staff/Departments.tsx","../../src/pages/management/staff/StaffProfile.tsx","../../src/pages/management/staff/EditStaff.tsx","../../src/pages/management/AdminManagement.tsx","../../src/pages/management/AppSettingsAdmin.tsx","../../src/pages/management/AdminUsers.tsx","../../src/pages/management/admin-role-manager/components/CreateAdminForm.tsx","../../src/pages/management/admin-role-manager/components/AdminList.tsx","../../src/pages/management/admin-role-manager/AdminRoleManager.tsx"],"sourcesContent":["\nimport React, { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  DollarSign, \n  Play, \n  CheckCircle, \n  XCircle, \n  Eye, \n  Download,\n  Users,\n  TrendingUp,\n  Clock\n} from \"lucide-react\";\nimport { PayrollRun, PayrollEntry } from \"@/types/staff\";\nimport { toast } from \"@/components/ui/sonner\";\n\ninterface PayrollManagementProps {\n  payrollRuns: PayrollRun[];\n  setPayrollRuns: React.Dispatch<React.SetStateAction<PayrollRun[]>>;\n}\n\nconst PayrollManagement: React.FC<PayrollManagementProps> = ({ payrollRuns, setPayrollRuns }) => {\n  const [selectedRun, setSelectedRun] = useState<PayrollRun | null>(null);\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  // Mock payroll entries\n  const [payrollEntries] = useState<PayrollEntry[]>([\n    {\n      id: '1',\n      payrollRunId: '1',\n      employeeId: 'EMP001',\n      employeeName: 'John Doe',\n      department: 'Sales',\n      basicSalary: 5000,\n      totalAllowances: 1200,\n      totalDeductions: 800,\n      totalVariablePay: 500,\n      grossSalary: 6700,\n      netSalary: 5900,\n      overtimePay: 200,\n      taxDeductions: 600,\n      pfDeduction: 150,\n      esiDeduction: 50,\n      loanDeductions: 0,\n      advanceDeductions: 0,\n      componentBreakdown: []\n    }\n  ]);\n\n  const handleRunPayroll = (runId: string) => {\n    setPayrollRuns(prev => \n      prev.map(run => \n        run.id === runId \n          ? { ...run, status: 'processing' }\n          : run\n      )\n    );\n    toast.success(\"Payroll run started successfully!\");\n  };\n\n  const handleApproveRun = (runId: string) => {\n    setPayrollRuns(prev => \n      prev.map(run => \n        run.id === runId \n          ? { ...run, status: 'approved' }\n          : run\n      )\n    );\n    toast.success(\"Payroll run approved!\");\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'approved': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'paid': return <CheckCircle className=\"h-4 w-4 text-blue-600\" />;\n      case 'processing': return <Clock className=\"h-4 w-4 text-orange-600\" />;\n      case 'cancelled': return <XCircle className=\"h-4 w-4 text-red-600\" />;\n      default: return <Clock className=\"h-4 w-4 text-gray-600\" />;\n    }\n  };\n\n  const filteredRuns = payrollRuns.filter(run => {\n    const matchesStatus = filterStatus === \"all\" || run.status === filterStatus;\n    const matchesSearch = searchTerm === \"\" || \n      run.period.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    return matchesStatus && matchesSearch;\n  });\n\n  // Calculate payroll statistics\n  const totalRuns = payrollRuns.length;\n  const pendingRuns = payrollRuns.filter(r => r.status === 'draft' || r.status === 'processing').length;\n  const approvedRuns = payrollRuns.filter(r => r.status === 'approved').length;\n  const totalPayrollAmount = payrollRuns.reduce((sum, r) => sum + r.totalAmount, 0);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Payroll Management</h2>\n          <p className=\"text-muted-foreground\">Manage employee payroll and salary processing</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button>\n            <Play className=\"mr-2 h-4 w-4\" />\n            Run New Payroll\n          </Button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Payroll Runs</p>\n                <p className=\"text-2xl font-bold\">{totalRuns}</p>\n              </div>\n              <Users className=\"h-8 w-8 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Pending Processing</p>\n                <p className=\"text-2xl font-bold\">{pendingRuns}</p>\n              </div>\n              <Clock className=\"h-8 w-8 text-orange-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Approved</p>\n                <p className=\"text-2xl font-bold\">{approvedRuns}</p>\n              </div>\n              <CheckCircle className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Amount</p>\n                <p className=\"text-2xl font-bold\">${(totalPayrollAmount / 1000).toFixed(0)}K</p>\n              </div>\n              <DollarSign className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <Input\n          placeholder=\"Search by period...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"sm:w-64\"\n        />\n        <Select value={filterStatus} onValueChange={setFilterStatus}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder=\"Filter by status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Status</SelectItem>\n            <SelectItem value=\"draft\">Draft</SelectItem>\n            <SelectItem value=\"processing\">Processing</SelectItem>\n            <SelectItem value=\"approved\">Approved</SelectItem>\n            <SelectItem value=\"paid\">Paid</SelectItem>\n            <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Payroll Runs Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Payroll Runs</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Period</TableHead>\n                <TableHead>Employees</TableHead>\n                <TableHead>Total Amount</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Created Date</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredRuns.map((run) => (\n                <TableRow key={run.id}>\n                  <TableCell className=\"font-medium\">{run.period}</TableCell>\n                  <TableCell>{run.employeesCount}</TableCell>\n                  <TableCell>${run.totalAmount.toLocaleString()}</TableCell>\n                  <TableCell>\n                    <div className=\"flex items-center gap-2\">\n                      {getStatusIcon(run.status)}\n                      <Badge \n                        variant={\n                          run.status === 'approved' || run.status === 'paid' ? 'default' : \n                          run.status === 'processing' ? 'secondary' : 'outline'\n                        }\n                      >\n                        {run.status}\n                      </Badge>\n                    </div>\n                  </TableCell>\n                  <TableCell>{new Date(run.createdDate).toLocaleDateString()}</TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex justify-end gap-2\">\n                      <Dialog>\n                        <DialogTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\" onClick={() => setSelectedRun(run)}>\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                        </DialogTrigger>\n                        <DialogContent className=\"max-w-4xl\">\n                          <DialogHeader>\n                            <DialogTitle>Payroll Run Details - {run.period}</DialogTitle>\n                            <DialogDescription>\n                              Review payroll run details and employee entries\n                            </DialogDescription>\n                          </DialogHeader>\n                          {selectedRun && (\n                            <div className=\"space-y-6\">\n                              <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                  <label className=\"text-sm font-medium\">Period</label>\n                                  <p className=\"text-lg\">{selectedRun.period}</p>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Status</label>\n                                  <Badge variant=\"outline\">{selectedRun.status}</Badge>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Employees</label>\n                                  <p>{selectedRun.employeesCount}</p>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Total Amount</label>\n                                  <p>${selectedRun.totalAmount.toLocaleString()}</p>\n                                </div>\n                              </div>\n                              \n                              <div>\n                                <h4 className=\"font-medium mb-2\">Employee Entries</h4>\n                                <Table>\n                                  <TableHeader>\n                                    <TableRow>\n                                      <TableHead>Employee</TableHead>\n                                      <TableHead>Department</TableHead>\n                                      <TableHead>Gross Salary</TableHead>\n                                      <TableHead>Net Salary</TableHead>\n                                    </TableRow>\n                                  </TableHeader>\n                                  <TableBody>\n                                    {payrollEntries.map((entry) => (\n                                      <TableRow key={entry.id}>\n                                        <TableCell>{entry.employeeName}</TableCell>\n                                        <TableCell>{entry.department}</TableCell>\n                                        <TableCell>${entry.grossSalary.toLocaleString()}</TableCell>\n                                        <TableCell>${entry.netSalary.toLocaleString()}</TableCell>\n                                      </TableRow>\n                                    ))}\n                                  </TableBody>\n                                </Table>\n                              </div>\n\n                              {selectedRun.status === 'draft' && (\n                                <div className=\"flex gap-2 pt-4\">\n                                  <Button \n                                    onClick={() => handleRunPayroll(selectedRun.id)}\n                                    className=\"flex-1\"\n                                  >\n                                    <Play className=\"mr-2 h-4 w-4\" />\n                                    Process Payroll\n                                  </Button>\n                                </div>\n                              )}\n\n                              {selectedRun.status === 'processing' && (\n                                <div className=\"flex gap-2 pt-4\">\n                                  <Button \n                                    onClick={() => handleApproveRun(selectedRun.id)}\n                                    className=\"flex-1\"\n                                  >\n                                    <CheckCircle className=\"mr-2 h-4 w-4\" />\n                                    Approve Payroll\n                                  </Button>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </DialogContent>\n                      </Dialog>\n                      \n                      <Button variant=\"ghost\" size=\"icon\">\n                        <Download className=\"h-4 w-4\" />\n                      </Button>\n                      \n                      {run.status === 'draft' && (\n                        <Button \n                          size=\"sm\"\n                          onClick={() => handleRunPayroll(run.id)}\n                        >\n                          Process\n                        </Button>\n                      )}\n                      \n                      {run.status === 'processing' && (\n                        <Button \n                          size=\"sm\"\n                          onClick={() => handleApproveRun(run.id)}\n                        >\n                          Approve\n                        </Button>\n                      )}\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default PayrollManagement;\n","\nimport React, { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  CheckCircle, \n  XCircle, \n  Eye, \n  Calendar, \n  Clock,\n  Users,\n  TrendingUp\n} from \"lucide-react\";\nimport { LeaveApplication, LeaveBalance } from \"@/types/staff\";\nimport { toast } from \"@/components/ui/sonner\";\n\ninterface LeaveManagementProps {\n  leaves: LeaveApplication[];\n  setLeaves: React.Dispatch<React.SetStateAction<LeaveApplication[]>>;\n}\n\nconst LeaveManagement: React.FC<LeaveManagementProps> = ({ leaves, setLeaves }) => {\n  const [selectedLeave, setSelectedLeave] = useState<LeaveApplication | null>(null);\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [rejectionReason, setRejectionReason] = useState(\"\");\n\n  // Mock leave balances\n  const [leaveBalances] = useState<LeaveBalance[]>([\n    {\n      employeeId: 'EMP001',\n      annualLeave: 18,\n      sickLeave: 8,\n      casualLeave: 5,\n      maternityPaternityLeave: 84,\n      compensatoryOff: 2,\n      year: 2025,\n      lastUpdated: '2025-05-26'\n    }\n  ]);\n\n  const handleLeaveAction = (leaveId: string, action: 'approve' | 'reject', reason?: string) => {\n    setLeaves(prevLeaves => \n      prevLeaves.map(leave => {\n        if (leave.id === leaveId) {\n          return {\n            ...leave,\n            status: action === 'approve' ? 'approved' : 'rejected',\n            approvedBy: action === 'approve' ? 'HR Manager' : undefined,\n            approvedDate: action === 'approve' ? new Date().toISOString() : undefined,\n            rejectionReason: reason\n          };\n        }\n        return leave;\n      })\n    );\n    toast.success(`Leave application ${action}d successfully!`);\n  };\n\n  const getLeaveTypeColor = (type: string) => {\n    switch (type) {\n      case 'annual': return 'bg-blue-100 text-blue-800';\n      case 'sick': return 'bg-red-100 text-red-800';\n      case 'casual': return 'bg-green-100 text-green-800';\n      case 'maternity':\n      case 'paternity': return 'bg-purple-100 text-purple-800';\n      case 'emergency': return 'bg-orange-100 text-orange-800';\n      case 'comp-off': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'approved': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'rejected': return <XCircle className=\"h-4 w-4 text-red-600\" />;\n      case 'pending': return <Clock className=\"h-4 w-4 text-orange-600\" />;\n      default: return <Clock className=\"h-4 w-4 text-gray-600\" />;\n    }\n  };\n\n  const filteredLeaves = leaves.filter(leave => {\n    const matchesSearch = searchTerm === \"\" || \n      leave.employeeName.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesStatus = filterStatus === \"all\" || leave.status === filterStatus;\n    const matchesType = filterType === \"all\" || leave.leaveType === filterType;\n    \n    return matchesSearch && matchesStatus && matchesType;\n  });\n\n  // Calculate leave statistics\n  const totalLeaves = leaves.length;\n  const pendingLeaves = leaves.filter(l => l.status === 'pending').length;\n  const approvedLeaves = leaves.filter(l => l.status === 'approved').length;\n  const rejectedLeaves = leaves.filter(l => l.status === 'rejected').length;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Leave Management</h2>\n          <p className=\"text-muted-foreground\">Manage employee leave applications and balances</p>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Applications</p>\n                <p className=\"text-2xl font-bold\">{totalLeaves}</p>\n              </div>\n              <Calendar className=\"h-8 w-8 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Pending Approval</p>\n                <p className=\"text-2xl font-bold\">{pendingLeaves}</p>\n              </div>\n              <Clock className=\"h-8 w-8 text-orange-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Approved</p>\n                <p className=\"text-2xl font-bold\">{approvedLeaves}</p>\n              </div>\n              <CheckCircle className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Rejected</p>\n                <p className=\"text-2xl font-bold\">{rejectedLeaves}</p>\n              </div>\n              <XCircle className=\"h-8 w-8 text-red-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <Input\n          placeholder=\"Search by employee name...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"sm:w-64\"\n        />\n        <Select value={filterStatus} onValueChange={setFilterStatus}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder=\"Filter by status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Status</SelectItem>\n            <SelectItem value=\"pending\">Pending</SelectItem>\n            <SelectItem value=\"approved\">Approved</SelectItem>\n            <SelectItem value=\"rejected\">Rejected</SelectItem>\n          </SelectContent>\n        </Select>\n        <Select value={filterType} onValueChange={setFilterType}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder=\"Filter by type\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Types</SelectItem>\n            <SelectItem value=\"annual\">Annual Leave</SelectItem>\n            <SelectItem value=\"sick\">Sick Leave</SelectItem>\n            <SelectItem value=\"casual\">Casual Leave</SelectItem>\n            <SelectItem value=\"maternity\">Maternity Leave</SelectItem>\n            <SelectItem value=\"paternity\">Paternity Leave</SelectItem>\n            <SelectItem value=\"emergency\">Emergency Leave</SelectItem>\n            <SelectItem value=\"comp-off\">Comp Off</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Leave Applications Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Leave Applications</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Employee</TableHead>\n                <TableHead>Leave Type</TableHead>\n                <TableHead>Date Range</TableHead>\n                <TableHead>Days</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Applied Date</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredLeaves.map((leave) => (\n                <TableRow key={leave.id}>\n                  <TableCell className=\"font-medium\">{leave.employeeName}</TableCell>\n                  <TableCell>\n                    <Badge className={getLeaveTypeColor(leave.leaveType)}>\n                      {leave.leaveType}\n                    </Badge>\n                  </TableCell>\n                  <TableCell>\n                    {new Date(leave.startDate).toLocaleDateString()} - {new Date(leave.endDate).toLocaleDateString()}\n                  </TableCell>\n                  <TableCell>{leave.days}</TableCell>\n                  <TableCell>\n                    <div className=\"flex items-center gap-2\">\n                      {getStatusIcon(leave.status)}\n                      <Badge \n                        variant={\n                          leave.status === 'approved' ? 'default' : \n                          leave.status === 'pending' ? 'secondary' : 'destructive'\n                        }\n                      >\n                        {leave.status}\n                      </Badge>\n                    </div>\n                  </TableCell>\n                  <TableCell>{new Date(leave.appliedDate).toLocaleDateString()}</TableCell>\n                  <TableCell className=\"text-right\">\n                    <div className=\"flex justify-end gap-2\">\n                      <Dialog>\n                        <DialogTrigger asChild>\n                          <Button variant=\"ghost\" size=\"icon\" onClick={() => setSelectedLeave(leave)}>\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                        </DialogTrigger>\n                        <DialogContent className=\"max-w-2xl\">\n                          <DialogHeader>\n                            <DialogTitle>Leave Application Details</DialogTitle>\n                            <DialogDescription>\n                              Review and manage leave application\n                            </DialogDescription>\n                          </DialogHeader>\n                          {selectedLeave && (\n                            <div className=\"space-y-6\">\n                              <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                  <label className=\"text-sm font-medium\">Employee</label>\n                                  <p className=\"text-lg\">{selectedLeave.employeeName}</p>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Leave Type</label>\n                                  <Badge className={getLeaveTypeColor(selectedLeave.leaveType)}>\n                                    {selectedLeave.leaveType}\n                                  </Badge>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Date Range</label>\n                                  <p>{new Date(selectedLeave.startDate).toLocaleDateString()} - {new Date(selectedLeave.endDate).toLocaleDateString()}</p>\n                                </div>\n                                <div>\n                                  <label className=\"text-sm font-medium\">Total Days</label>\n                                  <p>{selectedLeave.days} day(s)</p>\n                                </div>\n                              </div>\n                              \n                              <div>\n                                <label className=\"text-sm font-medium\">Reason</label>\n                                <p className=\"mt-1 p-3 bg-gray-50 rounded-lg\">{selectedLeave.reason}</p>\n                              </div>\n\n                              {selectedLeave.status === 'pending' && (\n                                <div className=\"flex gap-2 pt-4\">\n                                  <Button \n                                    onClick={() => handleLeaveAction(selectedLeave.id, 'approve')}\n                                    className=\"flex-1\"\n                                  >\n                                    <CheckCircle className=\"mr-2 h-4 w-4\" />\n                                    Approve\n                                  </Button>\n                                  <Dialog>\n                                    <DialogTrigger asChild>\n                                      <Button variant=\"destructive\" className=\"flex-1\">\n                                        <XCircle className=\"mr-2 h-4 w-4\" />\n                                        Reject\n                                      </Button>\n                                    </DialogTrigger>\n                                    <DialogContent>\n                                      <DialogHeader>\n                                        <DialogTitle>Reject Leave Application</DialogTitle>\n                                        <DialogDescription>\n                                          Please provide a reason for rejection\n                                        </DialogDescription>\n                                      </DialogHeader>\n                                      <div className=\"space-y-4\">\n                                        <Textarea\n                                          placeholder=\"Enter rejection reason...\"\n                                          value={rejectionReason}\n                                          onChange={(e) => setRejectionReason(e.target.value)}\n                                        />\n                                        <div className=\"flex gap-2\">\n                                          <Button \n                                            variant=\"destructive\"\n                                            onClick={() => {\n                                              handleLeaveAction(selectedLeave.id, 'reject', rejectionReason);\n                                              setRejectionReason(\"\");\n                                            }}\n                                            disabled={!rejectionReason.trim()}\n                                          >\n                                            Confirm Rejection\n                                          </Button>\n                                        </div>\n                                      </div>\n                                    </DialogContent>\n                                  </Dialog>\n                                </div>\n                              )}\n\n                              {selectedLeave.status === 'rejected' && selectedLeave.rejectionReason && (\n                                <div>\n                                  <label className=\"text-sm font-medium text-red-600\">Rejection Reason</label>\n                                  <p className=\"mt-1 p-3 bg-red-50 border border-red-200 rounded-lg text-red-800\">\n                                    {selectedLeave.rejectionReason}\n                                  </p>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </DialogContent>\n                      </Dialog>\n                      \n                      {leave.status === 'pending' && (\n                        <>\n                          <Button \n                            size=\"sm\" \n                            onClick={() => handleLeaveAction(leave.id, 'approve')}\n                          >\n                            Approve\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"destructive\"\n                            onClick={() => handleLeaveAction(leave.id, 'reject', 'Rejected by HR')}\n                          >\n                            Reject\n                          </Button>\n                        </>\n                      )}\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default LeaveManagement;\n","\nimport React, { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { \n  Clock, \n  CheckCircle, \n  XCircle, \n  Calendar as CalendarIcon,\n  Users,\n  TrendingUp,\n  Coffee\n} from \"lucide-react\";\nimport { AttendanceRecord, BreakRecord } from \"@/types/staff\";\n\nconst AttendanceManagement: React.FC = () => {\n  const [selectedDate, setSelectedDate] = useState<Date | undefined>(new Date());\n  const [filterDepartment, setFilterDepartment] = useState<string>(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  // Mock attendance data\n  const [attendanceRecords] = useState<AttendanceRecord[]>([\n    {\n      id: '1',\n      employeeId: 'EMP001',\n      date: '2025-05-26',\n      clockIn: '09:00',\n      clockOut: '18:00',\n      totalHours: 8,\n      overtime: 0,\n      status: 'present',\n      breaks: [\n        { startTime: '13:00', endTime: '14:00', duration: 60, type: 'lunch' },\n        { startTime: '15:30', endTime: '15:45', duration: 15, type: 'tea' }\n      ],\n      location: 'Office',\n      notes: ''\n    },\n    {\n      id: '2',\n      employeeId: 'EMP002',\n      date: '2025-05-26',\n      clockIn: '09:15',\n      clockOut: '18:30',\n      totalHours: 8.25,\n      overtime: 0.25,\n      status: 'late',\n      breaks: [\n        { startTime: '13:00', endTime: '14:00', duration: 60, type: 'lunch' }\n      ],\n      location: 'Office',\n      notes: 'Late due to traffic'\n    },\n    {\n      id: '3',\n      employeeId: 'EMP003',\n      date: '2025-05-26',\n      clockIn: '09:00',\n      clockOut: '13:00',\n      totalHours: 4,\n      overtime: 0,\n      status: 'half-day',\n      breaks: [],\n      location: 'Office',\n      notes: 'Medical appointment in afternoon'\n    }\n  ]);\n\n  // Mock employee data for attendance\n  const employees = [\n    { id: 'EMP001', name: 'John Doe', department: 'Sales' },\n    { id: 'EMP002', name: 'Jane Smith', department: 'Operations' },\n    { id: 'EMP003', name: 'Mike Johnson', department: 'Customer Support' },\n    { id: 'EMP004', name: 'Sarah Wilson', department: 'Finance' },\n    { id: 'EMP005', name: 'David Brown', department: 'HR' }\n  ];\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'present': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'absent': return <XCircle className=\"h-4 w-4 text-red-600\" />;\n      case 'late': return <Clock className=\"h-4 w-4 text-orange-600\" />;\n      case 'half-day': return <Clock className=\"h-4 w-4 text-blue-600\" />;\n      case 'on-leave': return <CalendarIcon className=\"h-4 w-4 text-purple-600\" />;\n      default: return <Clock className=\"h-4 w-4 text-gray-600\" />;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'present': return 'default';\n      case 'absent': return 'destructive';\n      case 'late': return 'secondary';\n      case 'half-day': return 'outline';\n      case 'on-leave': return 'secondary';\n      default: return 'outline';\n    }\n  };\n\n  // Calculate attendance statistics\n  const totalEmployees = employees.length;\n  const presentToday = attendanceRecords.filter(r => r.status === 'present' || r.status === 'late').length;\n  const lateToday = attendanceRecords.filter(r => r.status === 'late').length;\n  const absentToday = totalEmployees - attendanceRecords.length;\n  const attendanceRate = Math.round((presentToday / totalEmployees) * 100);\n\n  const filteredRecords = attendanceRecords.filter(record => {\n    const employee = employees.find(emp => emp.id === record.employeeId);\n    if (!employee) return false;\n\n    const matchesSearch = searchTerm === \"\" || \n      employee.name.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesDepartment = filterDepartment === \"all\" || employee.department === filterDepartment;\n    \n    return matchesSearch && matchesDepartment;\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Attendance Management</h2>\n          <p className=\"text-muted-foreground\">Monitor and manage employee attendance</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button>Export Report</Button>\n          <Button variant=\"outline\">Bulk Actions</Button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Present Today</p>\n                <p className=\"text-2xl font-bold\">{presentToday}/{totalEmployees}</p>\n                <Progress value={attendanceRate} className=\"h-2 mt-2\" />\n              </div>\n              <CheckCircle className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Late Arrivals</p>\n                <p className=\"text-2xl font-bold\">{lateToday}</p>\n                <p className=\"text-xs text-orange-600\">\n                  {totalEmployees > 0 ? Math.round((lateToday / totalEmployees) * 100) : 0}% of total\n                </p>\n              </div>\n              <Clock className=\"h-8 w-8 text-orange-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Absent Today</p>\n                <p className=\"text-2xl font-bold\">{absentToday}</p>\n                <p className=\"text-xs text-red-600\">\n                  {totalEmployees > 0 ? Math.round((absentToday / totalEmployees) * 100) : 0}% of total\n                </p>\n              </div>\n              <XCircle className=\"h-8 w-8 text-red-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Attendance Rate</p>\n                <p className=\"text-2xl font-bold\">{attendanceRate}%</p>\n                <p className=\"text-xs text-green-600\">+2% from yesterday</p>\n              </div>\n              <TrendingUp className=\"h-8 w-8 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters and Search */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <Input\n          placeholder=\"Search by employee name...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"sm:w-64\"\n        />\n        <Select value={filterDepartment} onValueChange={setFilterDepartment}>\n          <SelectTrigger className=\"w-[200px]\">\n            <SelectValue placeholder=\"Filter by department\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Departments</SelectItem>\n            <SelectItem value=\"Sales\">Sales</SelectItem>\n            <SelectItem value=\"Operations\">Operations</SelectItem>\n            <SelectItem value=\"Customer Support\">Customer Support</SelectItem>\n            <SelectItem value=\"Finance\">Finance</SelectItem>\n            <SelectItem value=\"HR\">HR</SelectItem>\n            <SelectItem value=\"Field Sales\">Field Sales</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n        {/* Calendar */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Select Date</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <Calendar\n              mode=\"single\"\n              selected={selectedDate}\n              onSelect={setSelectedDate}\n              className=\"rounded-md border\"\n            />\n          </CardContent>\n        </Card>\n\n        {/* Attendance Records */}\n        <Card className=\"lg:col-span-3\">\n          <CardHeader>\n            <CardTitle>Today's Attendance - {selectedDate?.toLocaleDateString()}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Employee</TableHead>\n                  <TableHead>Department</TableHead>\n                  <TableHead>Clock In</TableHead>\n                  <TableHead>Clock Out</TableHead>\n                  <TableHead>Total Hours</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead>Breaks</TableHead>\n                  <TableHead>Notes</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredRecords.map((record) => {\n                  const employee = employees.find(emp => emp.id === record.employeeId);\n                  return (\n                    <TableRow key={record.id}>\n                      <TableCell className=\"font-medium\">{employee?.name}</TableCell>\n                      <TableCell>{employee?.department}</TableCell>\n                      <TableCell>{record.clockIn || '-'}</TableCell>\n                      <TableCell>{record.clockOut || '-'}</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <span>{record.totalHours}h</span>\n                          {record.overtime > 0 && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              +{record.overtime}h OT\n                            </Badge>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          {getStatusIcon(record.status)}\n                          <Badge variant={getStatusColor(record.status)}>\n                            {record.status}\n                          </Badge>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <Coffee className=\"h-3 w-3\" />\n                          <span className=\"text-sm\">{record.breaks.length}</span>\n                          {record.breaks.length > 0 && (\n                            <span className=\"text-xs text-muted-foreground\">\n                              ({record.breaks.reduce((sum, b) => sum + b.duration, 0)}m)\n                            </span>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <span className=\"text-sm text-muted-foreground\">\n                          {record.notes || '-'}\n                        </span>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n                \n                {/* Show absent employees */}\n                {employees\n                  .filter(emp => !attendanceRecords.some(record => record.employeeId === emp.id))\n                  .filter(emp => {\n                    const matchesSearch = searchTerm === \"\" || \n                      emp.name.toLowerCase().includes(searchTerm.toLowerCase());\n                    const matchesDepartment = filterDepartment === \"all\" || emp.department === filterDepartment;\n                    return matchesSearch && matchesDepartment;\n                  })\n                  .map((employee) => (\n                    <TableRow key={employee.id} className=\"bg-red-50\">\n                      <TableCell className=\"font-medium\">{employee.name}</TableCell>\n                      <TableCell>{employee.department}</TableCell>\n                      <TableCell>-</TableCell>\n                      <TableCell>-</TableCell>\n                      <TableCell>0h</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <XCircle className=\"h-4 w-4 text-red-600\" />\n                          <Badge variant=\"destructive\">absent</Badge>\n                        </div>\n                      </TableCell>\n                      <TableCell>-</TableCell>\n                      <TableCell>\n                        <span className=\"text-sm text-red-600\">No attendance record</span>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n              </TableBody>\n            </Table>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n};\n\nexport default AttendanceManagement;\n","\nimport React, { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  DollarSign, \n  Plus, \n  Edit, \n  Eye, \n  Trash2,\n  CheckCircle,\n  XCircle,\n  Calculator\n} from \"lucide-react\";\nimport { SalaryStructure, SalaryComponent } from \"@/types/staff\";\nimport { toast } from \"@/components/ui/sonner\";\n\nconst SalaryStructureManager: React.FC = () => {\n  const [selectedStructure, setSelectedStructure] = useState<SalaryStructure | null>(null);\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n\n  // Mock salary structures\n  const [salaryStructures, setSalaryStructures] = useState<SalaryStructure[]>([\n    {\n      id: '1',\n      employeeId: 'EMP001',\n      basicSalary: 5000,\n      allowances: [\n        { id: '1', name: 'House Rent Allowance', type: 'allowance', amount: 2000, isPercentage: false, isFixed: true, taxable: true },\n        { id: '2', name: 'Medical Allowance', type: 'allowance', amount: 500, isPercentage: false, isFixed: true, taxable: false },\n        { id: '3', name: 'Transport Allowance', type: 'allowance', amount: 300, isPercentage: false, isFixed: true, taxable: false }\n      ],\n      deductions: [\n        { id: '4', name: 'Provident Fund', type: 'deduction', amount: 12, isPercentage: true, isFixed: false, taxable: false },\n        { id: '5', name: 'ESI', type: 'deduction', amount: 1.75, isPercentage: true, isFixed: false, taxable: false }\n      ],\n      variablePay: [\n        { id: '6', name: 'Performance Bonus', type: 'variable', amount: 1000, isPercentage: false, isFixed: false, taxable: true }\n      ],\n      currency: 'USD',\n      effectiveDate: '2025-01-01',\n      lastUpdated: '2025-05-26',\n      approvalStatus: 'approved',\n      approvedBy: 'HR Manager'\n    }\n  ]);\n\n  // Mock employee data\n  const employees = [\n    { id: 'EMP001', name: 'John Doe', department: 'Sales' },\n    { id: 'EMP002', name: 'Jane Smith', department: 'Operations' },\n    { id: 'EMP003', name: 'Mike Johnson', department: 'Customer Support' }\n  ];\n\n  const handleCreateStructure = () => {\n    // Logic to create new salary structure\n    toast.success(\"New salary structure created!\");\n    setIsCreateDialogOpen(false);\n  };\n\n  const handleApproveStructure = (structureId: string) => {\n    setSalaryStructures(prev => \n      prev.map(structure => \n        structure.id === structureId \n          ? { ...structure, approvalStatus: 'approved', approvedBy: 'HR Manager' }\n          : structure\n      )\n    );\n    toast.success(\"Salary structure approved!\");\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'approved': return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'rejected': return <XCircle className=\"h-4 w-4 text-red-600\" />;\n      case 'pending': return <Calculator className=\"h-4 w-4 text-orange-600\" />;\n      default: return <Calculator className=\"h-4 w-4 text-gray-600\" />;\n    }\n  };\n\n  const calculateGrossSalary = (structure: SalaryStructure) => {\n    const allowancesTotal = structure.allowances.reduce((sum, allowance) => {\n      return sum + (allowance.isPercentage ? (structure.basicSalary * allowance.amount / 100) : allowance.amount);\n    }, 0);\n    \n    const variableTotal = structure.variablePay.reduce((sum, variable) => {\n      return sum + (variable.isPercentage ? (structure.basicSalary * variable.amount / 100) : variable.amount);\n    }, 0);\n    \n    return structure.basicSalary + allowancesTotal + variableTotal;\n  };\n\n  const calculateDeductions = (structure: SalaryStructure) => {\n    const grossSalary = calculateGrossSalary(structure);\n    return structure.deductions.reduce((sum, deduction) => {\n      return sum + (deduction.isPercentage ? (grossSalary * deduction.amount / 100) : deduction.amount);\n    }, 0);\n  };\n\n  const filteredStructures = salaryStructures.filter(structure => {\n    const employee = employees.find(emp => emp.id === structure.employeeId);\n    const matchesStatus = filterStatus === \"all\" || structure.approvalStatus === filterStatus;\n    const matchesSearch = searchTerm === \"\" || \n      (employee && employee.name.toLowerCase().includes(searchTerm.toLowerCase()));\n    \n    return matchesStatus && matchesSearch;\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Salary Structure Management</h2>\n          <p className=\"text-muted-foreground\">Configure and manage employee salary structures</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n            <DialogTrigger asChild>\n              <Button>\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Create Structure\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-2xl\">\n              <DialogHeader>\n                <DialogTitle>Create New Salary Structure</DialogTitle>\n                <DialogDescription>\n                  Configure salary components for an employee\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"employee\">Employee</Label>\n                    <Select>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Select employee\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {employees.map((emp) => (\n                          <SelectItem key={emp.id} value={emp.id}>\n                            {emp.name} - {emp.department}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <Label htmlFor=\"basicSalary\">Basic Salary</Label>\n                    <Input id=\"basicSalary\" placeholder=\"Enter basic salary\" />\n                  </div>\n                </div>\n                \n                <div className=\"flex gap-2 pt-4\">\n                  <Button onClick={handleCreateStructure} className=\"flex-1\">\n                    Create Structure\n                  </Button>\n                  <Button variant=\"outline\" onClick={() => setIsCreateDialogOpen(false)}>\n                    Cancel\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Total Structures</p>\n                <p className=\"text-2xl font-bold\">{salaryStructures.length}</p>\n              </div>\n              <Calculator className=\"h-8 w-8 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Pending Approval</p>\n                <p className=\"text-2xl font-bold\">\n                  {salaryStructures.filter(s => s.approvalStatus === 'pending').length}\n                </p>\n              </div>\n              <Calculator className=\"h-8 w-8 text-orange-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Approved</p>\n                <p className=\"text-2xl font-bold\">\n                  {salaryStructures.filter(s => s.approvalStatus === 'approved').length}\n                </p>\n              </div>\n              <CheckCircle className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-muted-foreground\">Avg. Gross Salary</p>\n                <p className=\"text-2xl font-bold\">\n                  ${Math.round(salaryStructures.reduce((sum, s) => sum + calculateGrossSalary(s), 0) / salaryStructures.length).toLocaleString()}\n                </p>\n              </div>\n              <DollarSign className=\"h-8 w-8 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-4\">\n        <Input\n          placeholder=\"Search by employee name...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          className=\"sm:w-64\"\n        />\n        <Select value={filterStatus} onValueChange={setFilterStatus}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder=\"Filter by status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Status</SelectItem>\n            <SelectItem value=\"draft\">Draft</SelectItem>\n            <SelectItem value=\"pending\">Pending</SelectItem>\n            <SelectItem value=\"approved\">Approved</SelectItem>\n            <SelectItem value=\"rejected\">Rejected</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Salary Structures Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Salary Structures</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Employee</TableHead>\n                <TableHead>Basic Salary</TableHead>\n                <TableHead>Gross Salary</TableHead>\n                <TableHead>Deductions</TableHead>\n                <TableHead>Net Salary</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead>Effective Date</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {filteredStructures.map((structure) => {\n                const employee = employees.find(emp => emp.id === structure.employeeId);\n                const grossSalary = calculateGrossSalary(structure);\n                const totalDeductions = calculateDeductions(structure);\n                const netSalary = grossSalary - totalDeductions;\n                \n                return (\n                  <TableRow key={structure.id}>\n                    <TableCell className=\"font-medium\">\n                      <div>\n                        <p>{employee?.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{employee?.department}</p>\n                      </div>\n                    </TableCell>\n                    <TableCell>${structure.basicSalary.toLocaleString()}</TableCell>\n                    <TableCell>${Math.round(grossSalary).toLocaleString()}</TableCell>\n                    <TableCell>${Math.round(totalDeductions).toLocaleString()}</TableCell>\n                    <TableCell className=\"font-medium\">${Math.round(netSalary).toLocaleString()}</TableCell>\n                    <TableCell>\n                      <div className=\"flex items-center gap-2\">\n                        {getStatusIcon(structure.approvalStatus)}\n                        <Badge \n                          variant={\n                            structure.approvalStatus === 'approved' ? 'default' : \n                            structure.approvalStatus === 'pending' ? 'secondary' : 'destructive'\n                          }\n                        >\n                          {structure.approvalStatus}\n                        </Badge>\n                      </div>\n                    </TableCell>\n                    <TableCell>{new Date(structure.effectiveDate).toLocaleDateString()}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex justify-end gap-2\">\n                        <Dialog>\n                          <DialogTrigger asChild>\n                            <Button variant=\"ghost\" size=\"icon\" onClick={() => setSelectedStructure(structure)}>\n                              <Eye className=\"h-4 w-4\" />\n                            </Button>\n                          </DialogTrigger>\n                          <DialogContent className=\"max-w-4xl\">\n                            <DialogHeader>\n                              <DialogTitle>Salary Structure Details - {employee?.name}</DialogTitle>\n                              <DialogDescription>\n                                View and manage salary structure components\n                              </DialogDescription>\n                            </DialogHeader>\n                            {selectedStructure && (\n                              <div className=\"space-y-6\">\n                                <div className=\"grid grid-cols-2 gap-4\">\n                                  <div>\n                                    <label className=\"text-sm font-medium\">Employee</label>\n                                    <p className=\"text-lg\">{employee?.name}</p>\n                                    <p className=\"text-sm text-muted-foreground\">{employee?.department}</p>\n                                  </div>\n                                  <div>\n                                    <label className=\"text-sm font-medium\">Basic Salary</label>\n                                    <p className=\"text-lg\">${selectedStructure.basicSalary.toLocaleString()}</p>\n                                  </div>\n                                </div>\n                                \n                                <div className=\"grid grid-cols-3 gap-6\">\n                                  <div>\n                                    <h4 className=\"font-medium mb-3 text-green-700\">Allowances</h4>\n                                    <div className=\"space-y-2\">\n                                      {selectedStructure.allowances.map((allowance) => (\n                                        <div key={allowance.id} className=\"flex justify-between text-sm\">\n                                          <span>{allowance.name}</span>\n                                          <span>${allowance.amount.toLocaleString()}</span>\n                                        </div>\n                                      ))}\n                                    </div>\n                                  </div>\n                                  \n                                  <div>\n                                    <h4 className=\"font-medium mb-3 text-red-700\">Deductions</h4>\n                                    <div className=\"space-y-2\">\n                                      {selectedStructure.deductions.map((deduction) => (\n                                        <div key={deduction.id} className=\"flex justify-between text-sm\">\n                                          <span>{deduction.name}</span>\n                                          <span>\n                                            {deduction.isPercentage ? `${deduction.amount}%` : `$${deduction.amount.toLocaleString()}`}\n                                          </span>\n                                        </div>\n                                      ))}\n                                    </div>\n                                  </div>\n                                  \n                                  <div>\n                                    <h4 className=\"font-medium mb-3 text-blue-700\">Variable Pay</h4>\n                                    <div className=\"space-y-2\">\n                                      {selectedStructure.variablePay.map((variable) => (\n                                        <div key={variable.id} className=\"flex justify-between text-sm\">\n                                          <span>{variable.name}</span>\n                                          <span>${variable.amount.toLocaleString()}</span>\n                                        </div>\n                                      ))}\n                                    </div>\n                                  </div>\n                                </div>\n                                \n                                <div className=\"border-t pt-4\">\n                                  <div className=\"grid grid-cols-3 gap-4 text-center\">\n                                    <div>\n                                      <p className=\"text-sm text-muted-foreground\">Gross Salary</p>\n                                      <p className=\"text-xl font-bold\">${Math.round(calculateGrossSalary(selectedStructure)).toLocaleString()}</p>\n                                    </div>\n                                    <div>\n                                      <p className=\"text-sm text-muted-foreground\">Total Deductions</p>\n                                      <p className=\"text-xl font-bold text-red-600\">-${Math.round(calculateDeductions(selectedStructure)).toLocaleString()}</p>\n                                    </div>\n                                    <div>\n                                      <p className=\"text-sm text-muted-foreground\">Net Salary</p>\n                                      <p className=\"text-xl font-bold text-green-600\">${Math.round(calculateGrossSalary(selectedStructure) - calculateDeductions(selectedStructure)).toLocaleString()}</p>\n                                    </div>\n                                  </div>\n                                </div>\n\n                                {selectedStructure.approvalStatus === 'pending' && (\n                                  <div className=\"flex gap-2 pt-4\">\n                                    <Button \n                                      onClick={() => handleApproveStructure(selectedStructure.id)}\n                                      className=\"flex-1\"\n                                    >\n                                      <CheckCircle className=\"mr-2 h-4 w-4\" />\n                                      Approve Structure\n                                    </Button>\n                                  </div>\n                                )}\n                              </div>\n                            )}\n                          </DialogContent>\n                        </Dialog>\n                        \n                        <Button variant=\"ghost\" size=\"icon\">\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        \n                        {structure.approvalStatus === 'pending' && (\n                          <Button \n                            size=\"sm\"\n                            onClick={() => handleApproveStructure(structure.id)}\n                          >\n                            Approve\n                          </Button>\n                        )}\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                );\n              })}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default SalaryStructureManager;\n","import React, { useEffect, useMemo, useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Link } from \"react-router-dom\";\nimport { supabase } from \"@/lib/supabaseClient\";\nimport { Search, ChevronLeft, ChevronRight, User } from \"lucide-react\";\n\n// Use a relaxed Supabase client to avoid deep generic instantiation issues\nconst sb = supabase as any;\n\ntype ActiveStaff = {\n  id: string;\n  name: string;\n  email?: string;\n  department?: string;\n  role?: string;\n  status: string;\n  avatar?: string | null;\n  position?: string | null;\n};\n\ninterface ActiveStaffListProps {\n  searchTerm?: string;\n}\n\nconst PAGE_SIZE = 10;\n\nconst ActiveStaffList: React.FC<ActiveStaffListProps> = ({ searchTerm: externalSearchTerm }) => {\n  const [items, setItems] = useState<ActiveStaff[]>([]);\n  const [page, setPage] = useState(1);\n  const [totalCount, setTotalCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState(externalSearchTerm || \"\");\n\n  const appliedSearchTerm = useMemo(() => externalSearchTerm ?? searchTerm, [externalSearchTerm, searchTerm]);\n\n  useEffect(() => {\n    // Reset to first page when search changes\n    setPage(1);\n  }, [appliedSearchTerm]);\n\n  useEffect(() => {\n    const fetchActiveStaff = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const from = (page - 1) * PAGE_SIZE;\n        const to = from + PAGE_SIZE - 1;\n\n        // Query profiles table which is present in typed schema\n        // Avoid complex generic overloads by using a relaxed client\n        let query = sb\n          .from(\"profiles\" as any)\n          .select(\"id,name,email,department,role,status,position\", { count: \"exact\" })\n          .eq(\"status\", \"active\")\n          .order(\"name\", { ascending: true })\n          .range(from, to);\n\n        if (appliedSearchTerm && appliedSearchTerm.trim().length > 0) {\n          const term = `%${appliedSearchTerm.trim()}%`;\n          query = query.or(`name.ilike.${term},department.ilike.${term},position.ilike.${term}`);\n        }\n\n        const { data, error, count } = (await query) as {\n          data: any[] | null;\n          error: any;\n          count: number | null;\n        };\n\n        if (error) throw error;\n        const mapped = (data || []).map((row: any): ActiveStaff => ({\n          id: row.id,\n          name: row.name || \"Unknown\",\n          email: row.email,\n          department: row.department,\n          role: row.role,\n          status: row.status || \"active\",\n          // profiles may not have avatar; keep optional for UI fallback\n          avatar: row.avatar,\n          position: row.position,\n        }));\n        setItems(mapped);\n        setTotalCount(count || 0);\n      } catch (err: any) {\n        const msg = String(err?.message || err || \"Unknown error\");\n        const lower = msg.toLowerCase();\n        const isAuthOrPermission = lower.includes(\"permission denied\") || lower.includes(\"row level security\") || lower.includes(\"rls\") || lower.includes(\"not authenticated\") || lower.includes(\"auth\");\n        setError(isAuthOrPermission ? \"You do not have permission to view active staff. Please check your role or sign in.\" : msg);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchActiveStaff();\n  }, [page, appliedSearchTerm]);\n\n  const totalPages = Math.max(1, Math.ceil(totalCount / PAGE_SIZE));\n  const canPrev = page > 1;\n  const canNext = page < totalPages;\n\n  return (\n    <Card>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <CardTitle className=\"text-lg\">Active Staff</CardTitle>\n          <div className=\"relative w-64 max-w-full\">\n            <Search className=\"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search by name, department, position\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-8 h-9\"\n            />\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        {error && (\n          <Alert variant=\"destructive\" className=\"mb-3\">\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        )}\n\n        {loading ? (\n          <div className=\"flex items-center justify-center h-40\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\" />\n          </div>\n        ) : (\n          <>\n            <ScrollArea className=\"h-96\">\n              <div className=\"space-y-2\">\n                {items.length === 0 && (\n                  <div className=\"text-sm text-muted-foreground p-4 text-center\">No active staff found.</div>\n                )}\n                {items.map((s) => (\n                  <div key={s.id} className=\"flex items-center justify-between p-3 border rounded-md\">\n                    <div className=\"flex items-center gap-3 min-w-0\">\n                      <Avatar className=\"h-9 w-9\">\n                        {s.avatar ? (\n                          <AvatarImage src={s.avatar} />\n                        ) : (\n                          <AvatarFallback>{s.name?.charAt(0) || \"S\"}</AvatarFallback>\n                        )}\n                      </Avatar>\n                      <div className=\"min-w-0\">\n                        <div className=\"flex items-center gap-2\">\n                          <p className=\"font-medium text-sm truncate\">{s.name || \"Unknown\"}</p>\n                          {s.department && <Badge variant=\"outline\" className=\"text-xs\">{s.department}</Badge>}\n                        </div>\n                        <p className=\"text-xs text-muted-foreground truncate\">\n                          {[s.position, s.role].filter(Boolean).join(\"  \") || \"Staff\"}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2 shrink-0\">\n                      {s.email && (\n                        <span className=\"hidden md:inline text-xs text-muted-foreground truncate max-w-[200px]\">{s.email}</span>\n                      )}\n                      <Button asChild variant=\"secondary\" size=\"sm\">\n                        <Link to={`/management/staff/${s.id}`}>\n                          <User className=\"h-3 w-3 mr-1\" /> View\n                        </Link>\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </ScrollArea>\n\n            {/* Pagination */}\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-between mt-3\">\n                <div className=\"text-xs text-muted-foreground\">\n                  Page {page} of {totalPages}\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Button variant=\"outline\" size=\"sm\" disabled={!canPrev} onClick={() => setPage((p) => Math.max(1, p - 1))}>\n                    <ChevronLeft className=\"h-3 w-3 mr-1\" /> Prev\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" disabled={!canNext} onClick={() => setPage((p) => Math.min(totalPages, p + 1))}>\n                    Next <ChevronRight className=\"h-3 w-3 ml-1\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default ActiveStaffList;","\nimport React, { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Users,\n  DollarSign,\n  Calendar,\n  Clock,\n  TrendingUp,\n  AlertTriangle,\n  Gift,\n  FileText,\n  CheckCircle,\n  XCircle,\n  PlusCircle\n} from \"lucide-react\";\nimport { HRAnalytics, LeaveApplication, PayrollRun, AttendanceRecord } from \"@/types/staff\";\nimport PayrollManagement from \"./hr/PayrollManagement\";\nimport LeaveManagement from \"./hr/LeaveManagement\";\nimport AttendanceManagement from \"./hr/AttendanceManagement\";\nimport SalaryStructureManager from \"./hr/SalaryStructureManager\";\nimport ActiveStaffList from \"./hr/ActiveStaffList\";\n// Removed PageLayout to avoid nested layouts when rendered under HRLayout\n\nconst HRDashboard: React.FC = () => {\n  const [analytics, setAnalytics] = useState<HRAnalytics>({\n    totalEmployees: 45,\n    activeEmployees: 42,\n    departmentWiseCount: {\n      'Sales': 15,\n      'Operations': 12,\n      'Customer Support': 8,\n      'Finance': 6,\n      'Field Sales': 3,\n      'HR': 1\n    },\n    averageSalary: 65000,\n    totalPayrollCost: 2925000,\n    leaveUtilization: 68,\n    attendanceRate: 94,\n    pendingLeaves: 7,\n    pendingPayrollApprovals: 2,\n    upcomingBirthdays: [\n      { employeeId: '1', name: 'John Doe', department: 'Sales', date: '2025-06-01', daysUntil: 5 },\n      { employeeId: '2', name: 'Jane Smith', department: 'Operations', date: '2025-06-03', daysUntil: 7 }\n    ],\n    complianceAlerts: [\n      {\n        id: '1',\n        type: 'tax_filing',\n        title: 'Monthly TDS Filing Due',\n        description: 'Submit TDS returns for May 2025',\n        dueDate: '2025-06-07',\n        priority: 'high'\n      },\n      {\n        id: '2',\n        type: 'pf_return',\n        title: 'PF Return Filing',\n        description: 'Monthly PF contribution return',\n        dueDate: '2025-06-15',\n        priority: 'medium'\n      }\n    ]\n  });\n\n  const [recentLeaves, setRecentLeaves] = useState<LeaveApplication[]>([\n    {\n      id: '1',\n      employeeId: 'EMP001',\n      employeeName: 'John Doe',\n      leaveType: 'annual',\n      startDate: '2025-06-10',\n      endDate: '2025-06-12',\n      days: 3,\n      reason: 'Family vacation',\n      status: 'pending',\n      appliedDate: '2025-05-26'\n    },\n    {\n      id: '2',\n      employeeId: 'EMP002',\n      employeeName: 'Sarah Wilson',\n      leaveType: 'sick',\n      startDate: '2025-05-28',\n      endDate: '2025-05-28',\n      days: 1,\n      reason: 'Medical checkup',\n      status: 'approved',\n      appliedDate: '2025-05-27',\n      approvedBy: 'HR Manager',\n      approvedDate: '2025-05-27'\n    }\n  ]);\n\n  const [payrollRuns, setPayrollRuns] = useState<PayrollRun[]>([\n    {\n      id: '1',\n      period: '05-2025',\n      status: 'approved',\n      employeesCount: 45,\n      totalAmount: 2925000,\n      createdBy: 'HR Manager',\n      createdDate: '2025-05-25',\n      approvalWorkflow: [\n        { level: 1, approverRole: 'HR Manager', status: 'approved', approvedDate: '2025-05-25' },\n        { level: 2, approverRole: 'Finance Manager', status: 'approved', approvedDate: '2025-05-26' }\n      ],\n      currency: 'USD'\n    }\n  ]);\n\n  return (\n    <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">HR Management System</h1>\n            <p className=\"text-muted-foreground\">Comprehensive human resources management</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button>\n              <PlusCircle className=\"mr-2 h-4 w-4\" />\n              Quick Actions\n            </Button>\n          </div>\n        </div>\n\n        {/* Key Metrics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Total Employees</p>\n                  <p className=\"text-2xl font-bold\">{analytics.totalEmployees}</p>\n                  <p className=\"text-xs text-green-600\">+2 this month</p>\n                </div>\n                <Users className=\"h-8 w-8 text-blue-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Monthly Payroll</p>\n                  <p className=\"text-2xl font-bold\">${(analytics.totalPayrollCost / 1000).toFixed(0)}K</p>\n                  <p className=\"text-xs text-blue-600\">Average: ${analytics.averageSalary.toLocaleString()}</p>\n                </div>\n                <DollarSign className=\"h-8 w-8 text-green-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Attendance Rate</p>\n                  <p className=\"text-2xl font-bold\">{analytics.attendanceRate}%</p>\n                  <Progress value={analytics.attendanceRate} className=\"h-2 mt-2\" />\n                </div>\n                <Clock className=\"h-8 w-8 text-purple-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-muted-foreground\">Pending Actions</p>\n                  <p className=\"text-2xl font-bold\">{analytics.pendingLeaves + analytics.pendingPayrollApprovals}</p>\n                  <p className=\"text-xs text-orange-600\">{analytics.pendingLeaves} leaves, {analytics.pendingPayrollApprovals} payroll</p>\n                </div>\n                <AlertTriangle className=\"h-8 w-8 text-orange-600\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Quick Overview Cards */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Recent Leave Applications */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex justify-between items-center\">\n                <CardTitle className=\"text-lg\">Recent Leave Applications</CardTitle>\n                <Badge variant=\"outline\">{analytics.pendingLeaves} pending</Badge>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {recentLeaves.slice(0, 3).map((leave) => (\n                <div key={leave.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">{leave.employeeName}</p>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {leave.leaveType}  {leave.days} day(s)\n                    </p>\n                  </div>\n                  <Badge \n                    variant={leave.status === 'approved' ? 'default' : leave.status === 'pending' ? 'secondary' : 'destructive'}\n                    className=\"text-xs\"\n                  >\n                    {leave.status === 'approved' && <CheckCircle className=\"w-3 h-3 mr-1\" />}\n                    {leave.status === 'rejected' && <XCircle className=\"w-3 h-3 mr-1\" />}\n                    {leave.status}\n                  </Badge>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n\n          {/* Upcoming Birthdays */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex justify-between items-center\">\n                <CardTitle className=\"text-lg\">Upcoming Birthdays</CardTitle>\n                <Gift className=\"h-5 w-5 text-pink-600\" />\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {analytics.upcomingBirthdays.map((birthday) => (\n                <div key={birthday.employeeId} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <p className=\"font-medium text-sm\">{birthday.name}</p>\n                    <p className=\"text-xs text-muted-foreground\">{birthday.department}</p>\n                  </div>\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {birthday.daysUntil} days\n                  </Badge>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n\n          {/* Compliance Alerts */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex justify-between items-center\">\n                <CardTitle className=\"text-lg\">Compliance Alerts</CardTitle>\n                <AlertTriangle className=\"h-5 w-5 text-orange-600\" />\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {analytics.complianceAlerts.map((alert) => (\n                <div key={alert.id} className=\"p-3 border rounded-lg\">\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <p className=\"font-medium text-sm\">{alert.title}</p>\n                    <Badge \n                      variant={alert.priority === 'high' ? 'destructive' : alert.priority === 'medium' ? 'secondary' : 'outline'}\n                      className=\"text-xs\"\n                    >\n                      {alert.priority}\n                    </Badge>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground mb-2\">{alert.description}</p>\n                  <p className=\"text-xs font-medium\">Due: {new Date(alert.dueDate).toLocaleDateString()}</p>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Department Distribution */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Department-wise Employee Distribution</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4\">\n              {Object.entries(analytics.departmentWiseCount).map(([dept, count]) => (\n                <div key={dept} className=\"text-center p-4 border rounded-lg\">\n                  <p className=\"text-2xl font-bold text-primary\">{count}</p>\n                  <p className=\"text-sm text-muted-foreground\">{dept}</p>\n                  <Progress \n                    value={(count / analytics.totalEmployees) * 100} \n                    className=\"h-2 mt-2\" \n                  />\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Active Staff Section */}\n        <ActiveStaffList />\n\n        {/* Main HR Modules */}\n        <Tabs defaultValue=\"payroll\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"payroll\">Payroll Management</TabsTrigger>\n            <TabsTrigger value=\"leaves\">Leave Management</TabsTrigger>\n            <TabsTrigger value=\"attendance\">Attendance</TabsTrigger>\n            <TabsTrigger value=\"salary\">Salary Structure</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"payroll\" className=\"space-y-4 mt-6\">\n            <PayrollManagement payrollRuns={payrollRuns} setPayrollRuns={setPayrollRuns} />\n          </TabsContent>\n          \n          <TabsContent value=\"leaves\" className=\"space-y-4 mt-6\">\n            <LeaveManagement leaves={recentLeaves} setLeaves={setRecentLeaves} />\n          </TabsContent>\n          \n          <TabsContent value=\"attendance\" className=\"space-y-4 mt-6\">\n            <AttendanceManagement />\n          </TabsContent>\n          \n          <TabsContent value=\"salary\" className=\"space-y-4 mt-6\">\n            <SalaryStructureManager />\n          </TabsContent>\n        </Tabs>\n      </div>\n    );\n  };\n\nexport default HRDashboard;\n","import React from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { cn } from \"@/lib/utils\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  LayoutDashboard,\n  DollarSign,\n  CalendarDays,\n  Clock,\n  Layers,\n  FileText,\n  ShieldCheck,\n  UserPlus,\n  UserMinus,\n  AlertTriangle,\n} from \"lucide-react\";\n\ntype MenuItem = {\n  id: string;\n  title: string;\n  description?: string;\n  path: string;\n  icon: React.ComponentType<{ className?: string }>;\n  badge?: string | number;\n};\n\nconst menuItems: MenuItem[] = [\n  { id: \"overview\", title: \"Overview\", path: \"/management/hr\", icon: LayoutDashboard, description: \"HR dashboard overview\" },\n  { id: \"payroll\", title: \"Payroll\", path: \"/management/hr/payroll\", icon: DollarSign, description: \"Run and approve payroll\" },\n  { id: \"leaves\", title: \"Leaves\", path: \"/management/hr/leaves\", icon: CalendarDays, description: \"Manage leave applications\" },\n  { id: \"attendance\", title: \"Attendance\", path: \"/management/hr/attendance\", icon: Clock, description: \"Track attendance records\" },\n  { id: \"salary\", title: \"Salary Structure\", path: \"/management/hr/salary\", icon: Layers, description: \"Configure salary components\" },\n  { id: \"docs\", title: \"Staff Docs\", path: \"/management/hr/staff-docs\", icon: FileText, description: \"Verify staff documents\" },\n  { id: \"bank\", title: \"Bank Verification\", path: \"/management/hr/bank-verification\", icon: ShieldCheck, description: \"Verify bank details\" },\n  { id: \"onboarding\", title: \"Onboarding\", path: \"/management/hr/onboarding\", icon: UserPlus, description: \"Onboard new employees\" },\n  { id: \"offboarding\", title: \"Offboarding\", path: \"/management/hr/offboarding\", icon: UserMinus, description: \"Offboard employees\" },\n  { id: \"compliance\", title: \"Compliance\", path: \"/management/hr/compliance\", icon: AlertTriangle, description: \"HR compliance center\" },\n];\n\nconst HRSidebar: React.FC = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const isActive = (path: string) => {\n    const current = location.pathname.endsWith(\"/\")\n      ? location.pathname.slice(0, -1)\n      : location.pathname;\n    const target = path.endsWith(\"/\") ? path.slice(0, -1) : path;\n    return current === target || current.startsWith(target + \"/\");\n  };\n\n  return (\n    <div className={cn(\"flex flex-col h-full bg-card border-r w-full lg:w-80\")}> \n      <div className=\"p-4 border-b\">\n        <div className=\"flex items-center space-x-2 mb-3\">\n          <LayoutDashboard className=\"h-5 w-5 text-primary\" />\n          <h2 className=\"font-semibold\">HR Center</h2>\n        </div>\n        <div className=\"text-xs text-muted-foreground\">\n          Manage HR workflows and verification tasks\n        </div>\n      </div>\n\n      <ScrollArea className=\"flex-1\">\n        <div className=\"p-2 space-y-1\">\n          {menuItems.map((item) => {\n            const active = isActive(item.path);\n            return (\n              <Button\n                key={item.id}\n                variant={active ? \"secondary\" : \"ghost\"}\n                className={cn(\"w-full justify-start h-auto p-3 font-normal\", active && \"bg-secondary\")}\n                onClick={() => navigate(item.path)}\n              >\n                <item.icon className=\"h-4 w-4 mr-3 flex-shrink-0\" />\n                <div className=\"flex-1 text-left\">\n                  <div className=\"font-medium\">{item.title}</div>\n                  {item.description && (\n                    <div className=\"text-xs text-muted-foreground mt-1\">{item.description}</div>\n                  )}\n                </div>\n                {item.badge && (\n                  <Badge variant={typeof item.badge === \"number\" ? \"destructive\" : \"secondary\"} className=\"ml-2 text-xs\">\n                    {item.badge}\n                  </Badge>\n                )}\n              </Button>\n            );\n          })}\n        </div>\n      </ScrollArea>\n\n      <div className=\"p-4 border-t\">\n        <div className=\"text-xs text-muted-foreground space-y-1\">\n          <div>HR actions auto-save enabled</div>\n          <div>Last updated: just now</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default HRSidebar;","import React from \"react\";\nimport { Outlet } from \"react-router-dom\";\nimport PageLayout from \"@/components/layout/PageLayout\";\nimport HRSidebar from \"./HRSidebar\";\n\nconst HRLayout: React.FC = () => {\n  return (\n    <PageLayout\n      hideGlobalSidebar\n      headerVariant=\"hr\"\n      title=\"HR Center\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n        { title: \"HR\", href: \"/management/hr\" },\n      ]}\n    >\n      <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n        <div className=\"lg:col-span-3\">\n          <HRSidebar />\n        </div>\n        <div className=\"lg:col-span-9\">\n          <Outlet />\n        </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default HRLayout;","import React, { useState } from \"react\";\nimport PayrollManagement from \"@/pages/management/staff/hr/PayrollManagement\";\nimport { PayrollRun } from \"@/types/staff\";\n\nconst PayrollPage: React.FC = () => {\n  const [payrollRuns, setPayrollRuns] = useState<PayrollRun[]>([\n    {\n      id: '1',\n      period: '05-2025',\n      status: 'approved',\n      employeesCount: 45,\n      totalAmount: 2925000,\n      createdBy: 'HR Manager',\n      createdDate: '2025-05-25',\n      approvalWorkflow: [\n        { level: 1, approverRole: 'HR Manager', status: 'approved', approvedDate: '2025-05-25' },\n        { level: 2, approverRole: 'Finance Manager', status: 'approved', approvedDate: '2025-05-26' }\n      ],\n      currency: 'USD'\n    }\n  ]);\n\n  return <PayrollManagement payrollRuns={payrollRuns} setPayrollRuns={setPayrollRuns} />;\n};\n\nexport default PayrollPage;","import React, { useState } from \"react\";\nimport LeaveManagement from \"@/pages/management/staff/hr/LeaveManagement\";\nimport { LeaveApplication } from \"@/types/staff\";\n\nconst LeavesPage: React.FC = () => {\n  const [leaves, setLeaves] = useState<LeaveApplication[]>([\n    {\n      id: '1',\n      employeeId: 'EMP001',\n      employeeName: 'John Doe',\n      leaveType: 'annual',\n      startDate: '2025-06-10',\n      endDate: '2025-06-12',\n      days: 3,\n      reason: 'Family vacation',\n      status: 'pending',\n      appliedDate: '2025-05-26'\n    },\n    {\n      id: '2',\n      employeeId: 'EMP002',\n      employeeName: 'Sarah Wilson',\n      leaveType: 'sick',\n      startDate: '2025-05-28',\n      endDate: '2025-05-28',\n      days: 1,\n      reason: 'Medical checkup',\n      status: 'approved',\n      appliedDate: '2025-05-27',\n      approvedBy: 'HR Manager',\n      approvedDate: '2025-05-27'\n    }\n  ]);\n\n  return <LeaveManagement leaves={leaves} setLeaves={setLeaves} />;\n};\n\nexport default LeavesPage;","import React from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { FileText, CheckCircle2, XCircle } from \"lucide-react\";\n\nconst StaffDocsVerification: React.FC = () => {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Staff Documents Verification</h2>\n          <p className=\"text-muted-foreground\">Review and verify uploaded documents</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <FileText className=\"h-5 w-5\" /> Pending Verifications\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {[1,2,3].map((i) => (\n            <div key={i} className=\"flex items-center justify-between p-3 border rounded-lg\">\n              <div>\n                <p className=\"font-medium text-sm\">EMP00{i}  ID Proof.pdf</p>\n                <p className=\"text-xs text-muted-foreground\">Uploaded 2 days ago</p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Badge variant=\"outline\" className=\"text-xs\">pending</Badge>\n                <Button size=\"sm\" variant=\"outline\"><CheckCircle2 className=\"h-4 w-4 mr-1\" /> Approve</Button>\n                <Button size=\"sm\" variant=\"destructive\"><XCircle className=\"h-4 w-4 mr-1\" /> Reject</Button>\n              </div>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default StaffDocsVerification;","import React from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { ShieldCheck, XCircle, CheckCircle2 } from \"lucide-react\";\n\nconst BankVerification: React.FC = () => {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Bank Account Verification</h2>\n          <p className=\"text-muted-foreground\">Review and verify staff bank details</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <ShieldCheck className=\"h-5 w-5\" /> Pending Bank Accounts\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {[\n            { id: \"EMP001\", name: \"John Doe\", bank: \"HDFC Bank\", last4: \"1234\" },\n            { id: \"EMP002\", name: \"Sarah Wilson\", bank: \"ICICI Bank\", last4: \"9876\" }\n          ].map((rec) => (\n            <div key={rec.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n              <div>\n                <p className=\"font-medium text-sm\">{rec.name}  {rec.bank}</p>\n                <p className=\"text-xs text-muted-foreground\">Account  {rec.last4}</p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Badge variant=\"outline\" className=\"text-xs\">pending</Badge>\n                <Button size=\"sm\" variant=\"outline\"><CheckCircle2 className=\"h-4 w-4 mr-1\" /> Verify</Button>\n                <Button size=\"sm\" variant=\"destructive\"><XCircle className=\"h-4 w-4 mr-1\" /> Reject</Button>\n              </div>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default BankVerification;","import React from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserPlus } from \"lucide-react\";\n\nconst Onboarding: React.FC = () => {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Employee Onboarding</h2>\n          <p className=\"text-muted-foreground\">Guide for adding new employees</p>\n        </div>\n        <Button>\n          <UserPlus className=\"h-4 w-4 mr-2\" /> New Onboarding\n        </Button>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Checklist</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <ul className=\"list-disc pl-5 text-sm space-y-1\">\n            <li>Create staff profile and assign department</li>\n            <li>Collect and verify documents</li>\n            <li>Set salary structure and bank details</li>\n            <li>Assign manager and targets</li>\n            <li>Setup access and training</li>\n          </ul>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default Onboarding;","import React from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserMinus } from \"lucide-react\";\n\nconst Offboarding: React.FC = () => {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Employee Offboarding</h2>\n          <p className=\"text-muted-foreground\">Checklist for offboarding employees</p>\n        </div>\n        <Button variant=\"outline\">\n          <UserMinus className=\"h-4 w-4 mr-2\" /> New Offboarding\n        </Button>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Checklist</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <ul className=\"list-disc pl-5 text-sm space-y-1\">\n            <li>Collect company assets</li>\n            <li>Disable access and credentials</li>\n            <li>Finalize payroll and dues</li>\n            <li>Exit interview and feedback</li>\n            <li>Archive documents and handover</li>\n          </ul>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default Offboarding;","import React from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { AlertTriangle } from \"lucide-react\";\n\nconst ComplianceCenter: React.FC = () => {\n  const alerts = [\n    { id: \"C1\", title: \"Monthly TDS Filing\", due: \"2025-06-07\", priority: \"high\" },\n    { id: \"C2\", title: \"PF Contribution Return\", due: \"2025-06-15\", priority: \"medium\" },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold\">Compliance Center</h2>\n          <p className=\"text-muted-foreground\">Track HR compliance tasks and filings</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <AlertTriangle className=\"h-5 w-5 text-orange-600\" /> Active Alerts\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          {alerts.map((a) => (\n            <div key={a.id} className=\"p-3 border rounded-lg\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"font-medium text-sm\">{a.title}</p>\n                  <p className=\"text-xs text-muted-foreground\">Due: {new Date(a.due).toLocaleDateString()}</p>\n                </div>\n                <Badge variant={a.priority === \"high\" ? \"destructive\" : \"secondary\"} className=\"text-xs\">\n                  {a.priority}\n                </Badge>\n              </div>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default ComplianceCenter;","import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport PageLayout from '../../components/layout/PageLayout';\nimport { Button } from '../../components/ui/button';\nimport { Input } from '../../components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../../components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '../../components/ui/badge';\nimport { Card, CardContent, CardHeader, CardTitle } from '../../components/ui/card';\nimport { Table, TableHeader, TableRow, TableHead, TableBody, TableCell } from '../../components/ui/table';\nimport { \n  Search, \n  Plus, \n  Users, \n  TrendingUp, \n  Clock, \n  CheckCircle,\n  XCircle,\n  AlertCircle,\n  UserPlus,\n  Shield,\n  QrCode,\n  Eye,\n  FileText,\n  Edit,\n  PauseCircle,\n  Trash\n} from 'lucide-react';\nimport { AgentManagementService } from '../../services/agentManagementService';\nimport AgentApprovalModal from '@/components/modals/AgentApprovalModal';\nimport type { ManagedAgent, StaffMember, AgentStatus } from '@/types/agentManagement';\nimport { toast } from '../../hooks/use-toast';\nimport { useApp } from '@/contexts/AppContext';\nimport { supabase } from '@/lib/supabaseClient';\nimport { getStoredStaff } from '@/services/staffStorageService';\nimport { QRCodeCanvas } from 'qrcode.react';\nimport { Sheet, SheetContent, SheetHeader, SheetTitle, SheetDescription, SheetTrigger } from '@/components/ui/sheet';\nimport { getDeterministicStaffReferralLink, getStaffReferralLink, decodeReferralCodeToStaffId } from '@/services/staffReferralService';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Tooltip, TooltipContent, TooltipTrigger, TooltipProvider } from '@/components/ui/tooltip';\n\ninterface Agent {\n  id: string;\n  user_id?: string;\n  name: string;\n  email: string;\n  phone: string;\n  department: string;\n  role: string;\n  status: 'active' | 'inactive' | 'pending' | 'suspended' | 'rejected';\n  performance_score: number;\n  total_bookings: number;\n  revenue_generated: number;\n  join_date: string;\n  last_active: string;\n  avatar?: string;\n  location?: string;\n  specializations?: string[];\n  languages?: string[];\n  rating?: number;\n  commission_rate?: number;\n  // Display-only: human-readable creator name or descriptor\n  source?: string;\n  // Detailed attribution text (e.g., \"Created by Admin: Jane Doe\")\n  source_details?: string;\n  source_type?: string;\n  created_by?: string;\n  // Suspension metadata (for tooltip)\n  suspension_reason?: string;\n}\n\ninterface AgentStats {\n  total: number;\n  active: number;\n  inactive: number;\n  pending: number;\n  totalRevenue: number;\n  averageRating: number;\n}\n\nexport default function AgentManagement() {\n  const navigate = useNavigate();\n  const { currentUser, hasPermission } = useApp();\n  const isStaff = (currentUser?.role || '').toLowerCase() === 'staff';\n  const [agents, setAgents] = useState<Agent[]>([]);\n  const [filteredAgents, setFilteredAgents] = useState<Agent[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [sourceFilter, setSourceFilter] = useState('all');\n  const [referralFilter, setReferralFilter] = useState<'all' | 'mine' | 'staff'>('all');\n  const [referralStaffId, setReferralStaffId] = useState<string>('');\n  const [staffMembers, setStaffMembers] = useState<StaffMember[]>([]);\n  const [approvalModalOpen, setApprovalModalOpen] = useState(false);\n  const [selectedAgent, setSelectedAgent] = useState<ManagedAgent | null>(null);\n  const [stats, setStats] = useState<AgentStats>({\n    total: 0,\n    active: 0,\n    inactive: 0,\n    pending: 0,\n    totalRevenue: 0,\n    averageRating: 0\n  });\n\n  // Pagination state and derived slice\n  const [pageSize, setPageSize] = useState<number>(10);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n  const totalPages = Math.max(1, Math.ceil(filteredAgents.length / pageSize));\n  const paginatedAgents = React.useMemo(() => {\n    const start = (currentPage - 1) * pageSize;\n    return filteredAgents.slice(start, start + pageSize);\n  }, [filteredAgents, currentPage, pageSize]);\n\n  useEffect(() => {\n    setCurrentPage(1);\n  }, [searchTerm, statusFilter, sourceFilter, referralFilter, referralStaffId]);\n\n  // QR Module state\n  const [qrMode, setQrMode] = useState<'staff' | 'event'>('staff');\n  const [staffIdInput, setStaffIdInput] = useState('');\n  const [eventCodeInput, setEventCodeInput] = useState('');\n  const [qrLink, setQrLink] = useState('');\n  const [qrSize, setQrSize] = useState(300);\n  const qrCanvasRef = useRef<HTMLCanvasElement | null>(null);\n\n  // Suspend dialog state\n  const [suspendDialogOpen, setSuspendDialogOpen] = useState(false);\n  const [suspendReason, setSuspendReason] = useState('');\n  const [suspendTarget, setSuspendTarget] = useState<Agent | null>(null);\n  const [isSuspending, setIsSuspending] = useState(false);\n  const canSuspend = (hasPermission ? hasPermission('agents.manage.all') : false) || (currentUser?.role === 'super_admin') || (currentUser?.role === 'manager');\n\n  // Helper: resolve staff name by ID from loaded staff members\n  const resolveStaffNameById = (id?: string | null) => {\n    if (!id) return undefined;\n    const member = staffMembers.find(m => String(m.id) === String(id));\n    return member?.name;\n  };\n\n  // Helper: best-effort current staff ID resolution\n  const getCurrentStaffId = (): string | null => {\n    const id = currentUser?.id ? String(currentUser.id) : null;\n    if (id) return id;\n    // fallback by email\n    const email = (currentUser as any)?.email;\n    if (email) {\n      const byEmail = staffMembers.find((m: any) => m?.email && String(m.email).toLowerCase() === String(email).toLowerCase());\n      if (byEmail?.id) return String(byEmail.id);\n    }\n    // fallback by name\n    const name = currentUser?.name;\n    if (name) {\n      const byName = staffMembers.find(m => m?.name && String(m.name).toLowerCase() === String(name).toLowerCase());\n      if (byName?.id) return String(byName.id);\n    }\n    return null;\n  };\n\n  // Helper: get referral owner staff ID from source_details\n  const getReferralOwnerId = (a: Agent): string | null => {\n    const raw = (a.source_details || '').trim();\n    if (!raw) return null;\n    // try to decode referral code\n    try {\n      const decoded = decodeReferralCodeToStaffId(raw);\n      if (decoded) return String(decoded);\n    } catch {}\n    // fallback: raw is staff UUID\n    const uuidLike = /^[0-9a-fA-F-]{36}$/;\n    if (uuidLike.test(raw)) return raw;\n    // fallback: matches a known staff id\n    const match = staffMembers.find(m => String(m.id) === raw);\n    if (match) return String(match.id);\n    return null;\n  };\n\n  // Helper: render source type/details with staff name decoding\n  const renderSourceTypeDetails = (a: Agent) => {\n    const type = (a.source_type || '').toLowerCase();\n    const raw = a.source_details || '';\n    if (!type && !raw) return '';\n\n    switch (type) {\n      case 'staff_referral': {\n        const ownerId = getReferralOwnerId(a);\n        const staffName = resolveStaffNameById(ownerId);\n        const myId = getCurrentStaffId();\n        const isMine = ownerId && myId && String(ownerId) === String(myId);\n        if (isMine) {\n          const myName = currentUser?.name || staffName;\n          return myName ? `Referral: ${myName}` : 'Referral: You';\n        }\n        if (staffName) return `Referral: ${staffName}`;\n        if (ownerId) return `Referral: ${ownerId}`;\n        return raw ? `Referral: ${raw}` : 'Referral';\n      }\n      case 'event':\n        return raw ? `Event: ${raw}` : 'Event';\n      case 'ad_campaign':\n        return raw ? `Campaign: ${raw}` : 'Campaign';\n      case 'organic':\n        return 'Organic signup';\n      default:\n        return type ? `Source: ${type}${raw ? ` (${raw})` : ''}` : (raw ? `Source: ${raw}` : '');\n    }\n  };\n\n  // Helper: render created-by details if admin-created\n  const renderCreatedByLine = (a: Agent) => {\n    if (a.source === 'admin') {\n      const name = resolveStaffNameById(a.created_by) || 'Admin/Staff';\n      return `Created by: ${name}`;\n    }\n    if (a.source === 'self-registered') {\n      return 'Public Self-Registration';\n    }\n    return undefined;\n  };\n\n  const getSignupBase = () => {\n    const publicUrl = (import.meta as any)?.env?.VITE_PUBLIC_SITE_URL || (import.meta as any)?.env?.VITE_SITE_URL;\n    const origin = typeof window !== 'undefined' && window?.location?.origin ? window.location.origin : (publicUrl || '');\n    const base = (publicUrl || origin || '').replace(/\\/$/, '');\n    return `${base}/signup/agent`;\n  };\n\n  const generateStaffQR = async () => {\n    const id = staffIdInput.trim();\n    if (!id) return;\n    const link = await getStaffReferralLink(id);\n    setQrLink(link);\n  };\n\n  const handleSelectStaff = async (val: string) => {\n    setStaffIdInput(val);\n    const link = await getStaffReferralLink(val);\n    setQrLink(link);\n  };\n\n  const generateEventQR = () => {\n    const code = eventCodeInput.trim();\n    if (!code) return;\n    const link = `${getSignupBase()}?event=${encodeURIComponent(code)}`;\n    setQrLink(link);\n  };\n\n  const copyLinkToClipboard = async () => {\n    if (!qrLink) return;\n    try {\n      await navigator.clipboard.writeText(qrLink);\n    } catch (err) {\n      console.error('Failed to copy link:', err);\n    }\n  };\n\n  const downloadPng = () => {\n    try {\n      const canvas = document.getElementById('agent-qr-canvas') as HTMLCanvasElement | null;\n      if (!canvas) return;\n      const url = canvas.toDataURL('image/png');\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'agent_referral_qr.png';\n      a.click();\n    } catch (err) {\n      console.error('Failed to download PNG:', err);\n    }\n  };\n\n  const normalizeStatus = (status: AgentStatus): 'active' | 'inactive' | 'pending' | 'suspended' | 'rejected' => {\n    switch (status) {\n      case 'active': return 'active';\n      case 'inactive': return 'inactive';\n      case 'pending': return 'pending';\n      case 'suspended': return 'suspended';\n      case 'rejected': return 'rejected';\n      default: return 'inactive';\n    }\n  };\n\n  useEffect(() => {\n    loadAgents();\n  }, []);\n\n  useEffect(() => {\n    filterAgents();\n  }, [agents, searchTerm, statusFilter, sourceFilter, referralFilter, referralStaffId]);\n\n  useEffect(() => {\n    // Preload staff members for assignment in modal\n    (async () => {\n      const { data } = await AgentManagementService.getStaffMembers();\n      setStaffMembers(data || []);\n    })();\n  }, []);\n\n  const loadAgents = async () => {\n    try {\n      setLoading(true);\n      const { data, error } = await AgentManagementService.getAgents();\n      if (error) {\n        setError('Failed to load agents');\n        console.error('Error loading agents:', error);\n      } else {\n        const agentData: Agent[] = (data || []).map((agent: ManagedAgent) => ({\n          id: agent.id,\n          user_id: (agent as any).user_id,\n          name: agent.name,\n          email: agent.email,\n          phone: agent.phone || '',\n          department: 'General',\n          role: agent.role,\n          status: normalizeStatus(agent.status),\n          performance_score: 0,\n          total_bookings: 0,\n          revenue_generated: 0,\n          join_date: agent.created_at || new Date().toISOString(),\n          last_active: agent.updated_at || new Date().toISOString(),\n          source_type: agent.source_type,\n          source_details: agent.source_details,\n          source: agent.created_by ? 'admin' : 'self-registered',\n          created_by: agent.created_by,\n          suspension_reason: (agent as any)?.suspension_reason\n        }));\n        // Enrich with local storage creator/assignment info and enforce staff-only visibility\n        const getLocalAccessMaps = (): { creatorMap: Map<string, string>; assignedMap: Map<string, Set<string>> } => {\n          const creatorMap = new Map<string, string>();\n          const assignedMap = new Map<string, Set<string>>();\n\n          // Source 1: staff-managed local agents store\n          try {\n            const rawStaffAgents = localStorage.getItem('agents');\n            const staffAgents = rawStaffAgents ? JSON.parse(rawStaffAgents) : [];\n            (staffAgents || []).forEach((a: any) => {\n              const id = String(a?.id ?? '');\n              if (!id) return;\n              const creatorId = a?.createdBy?.staffId;\n              if (creatorId != null) {\n                creatorMap.set(id, String(creatorId));\n              }\n              const assignments = Array.isArray(a?.staffAssignments) ? a.staffAssignments : [];\n              const set = assignedMap.get(id) || new Set<string>();\n              assignments.forEach((asgn: any) => {\n                const sid = asgn?.staffId;\n                if (sid != null) set.add(String(sid));\n              });\n              if (set.size > 0) assignedMap.set(id, set);\n            });\n          } catch {}\n\n          // Source 2: managed agents fallback store\n          try {\n            const rawFallback = localStorage.getItem('managed_agents_fallback');\n            const fallbackAgents = rawFallback ? JSON.parse(rawFallback) : [];\n            (fallbackAgents || []).forEach((a: any) => {\n              const id = String(a?.id ?? '');\n              if (!id) return;\n              const creatorId = a?.created_by;\n              if (creatorId != null) {\n                creatorMap.set(id, String(creatorId));\n              }\n              const assignments = Array.isArray(a?.assigned_staff) ? a.assigned_staff : [];\n              const set = assignedMap.get(id) || new Set<string>();\n              assignments.forEach((sid: any) => {\n                if (sid != null) set.add(String(sid));\n              });\n              if (set.size > 0) assignedMap.set(id, set);\n            });\n          } catch {}\n\n          return { creatorMap, assignedMap };\n        };\n\n        const { creatorMap, assignedMap } = getLocalAccessMaps();\n        const enrichedAgents = agentData.map(a => ({\n          ...a,\n          created_by: creatorMap.get(String(a.id)) ?? a.created_by\n        }));\n\n        let finalAgents = isStaff && (currentUser?.id || staffMembers.length > 0)\n          ? enrichedAgents.filter(a => {\n              const me = getCurrentStaffId();\n              const id = String(a.id);\n              const isCreator = me ? String(creatorMap.get(id) || '') === String(me) : false;\n              const isAssigned = me ? (assignedMap.get(id)?.has(String(me)) || false) : false;\n              const type = (a.source_type || '').toLowerCase();\n              const refOwnerId = type === 'staff_referral' ? getReferralOwnerId(a) : null;\n              const isMyReferral = me && refOwnerId && String(refOwnerId) === String(me);\n              return isCreator || isAssigned || isMyReferral;\n            })\n          : enrichedAgents;\n\n        // Resolve creator names (Source) from profiles or local staff storage\n        const creatorIds = Array.from(new Set(\n          finalAgents.map(a => String(a.created_by || '')).filter(Boolean)\n        ));\n\n        const creatorNameMap = new Map<string, string>();\n\n        // Try Supabase profiles first\n        if (creatorIds.length > 0) {\n          try {\n            const { data } = await supabase\n              .from('profiles')\n              .select('id,name')\n              .in('id', creatorIds);\n            (data || []).forEach((row: any) => {\n              if (row?.id && row?.name) {\n                creatorNameMap.set(String(row.id), String(row.name));\n              }\n            });\n          } catch (err) {\n            console.warn('Failed to resolve creator names from DB, will use local storage:', err);\n          }\n        }\n\n        // Fallback: local staff storage\n        try {\n          const staff = await getStoredStaff();\n          (staff || []).forEach(member => {\n            if (member?.id && member?.name) {\n              creatorNameMap.set(String(member.id), String(member.name));\n            }\n          });\n        } catch {}\n\n        // Additional fallback: use current user name if applicable\n        if (currentUser?.id && currentUser?.name) {\n          creatorNameMap.set(String(currentUser.id), String(currentUser.name));\n        }\n\n        // Map Source classification and include source_details for display\n        finalAgents = finalAgents.map(a => {\n          const createdBy = String(a.created_by || '');\n          const isAdminOrStaffCreated = !!createdBy && createdBy !== 'public_signup';\n          const sourceLabel = isAdminOrStaffCreated ? 'admin' : 'self-registered';\n          const details = a.source_details\n            || (createdBy === 'public_signup'\n                  ? 'Public Self-Registration'\n                  : isAdminOrStaffCreated\n                    ? `Created by: ${creatorNameMap.get(createdBy) || 'Admin/Staff'}`\n                    : 'Created internally');\n          return { ...a, source: sourceLabel, source_details: details };\n        });\n\n        const hydratedAgents = await computeBookingsAndRevenue(finalAgents);\n        setAgents(hydratedAgents);\n        calculateStats(hydratedAgents);\n      }\n    } catch (err) {\n      setError('Failed to load agents');\n      console.error('Error loading agents:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Compute total bookings and revenue per agent using sales_bookings\n  const computeBookingsAndRevenue = async (agentList: Agent[]): Promise<Agent[]> => {\n    try {\n      const userIds = Array.from(new Set(\n        agentList.map(a => a.user_id).filter((id): id is string => !!id)\n      ));\n\n      if (userIds.length === 0) {\n        return agentList.map(a => ({ ...a, total_bookings: 0, revenue_generated: 0 }));\n      }\n\n      const { data, error } = await supabase\n        .from('sales_bookings')\n        .select('created_by,total_amount,status')\n        .in('created_by', userIds);\n\n      if (error) {\n        console.warn('Failed to fetch bookings for aggregation:', error);\n        return agentList;\n      }\n\n      const statsMap = new Map<string, { count: number; revenue: number }>();\n      (data || []).forEach((row: any) => {\n        const createdBy = row?.created_by as string | null;\n        if (!createdBy) return;\n        const status = String(row?.status || '').toLowerCase();\n        // Count only realized bookings\n        if (status !== 'confirmed' && status !== 'completed') return;\n        const entry = statsMap.get(createdBy) || { count: 0, revenue: 0 };\n        entry.count += 1;\n        const amt = Number(row?.total_amount ?? 0) || 0;\n        entry.revenue += amt;\n        statsMap.set(createdBy, entry);\n      });\n\n      return agentList.map(a => {\n        const stat = a.user_id ? statsMap.get(a.user_id) : undefined;\n        return {\n          ...a,\n          total_bookings: stat?.count || 0,\n          revenue_generated: stat?.revenue || 0,\n        };\n      });\n    } catch (err) {\n      console.warn('Aggregation failed, returning original agent list:', err);\n      return agentList;\n    }\n  };\n\n  const calculateStats = (agentData: Agent[]) => {\n    const total = agentData.length;\n    const active = agentData.filter(agent => agent.status === 'active').length;\n    const inactive = agentData.filter(agent => agent.status === 'inactive').length;\n    const pending = 0;\n    const totalRevenue = agentData.reduce((sum, agent) => sum + agent.revenue_generated, 0);\n    const averageRating = agentData.length > 0 \n      ? agentData.reduce((sum, agent) => sum + (agent.rating || 0), 0) / agentData.length \n      : 0;\n\n    setStats({\n      total,\n      active,\n      inactive,\n      pending,\n      totalRevenue,\n      averageRating\n    });\n  };\n\n  const filterAgents = () => {\n    let filtered = agents;\n\n    if (searchTerm) {\n      filtered = filtered.filter(agent =>\n        agent.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        agent.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        agent.department.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    if (statusFilter !== 'all') {\n      filtered = filtered.filter(agent => agent.status === statusFilter);\n    }\n\n    if (sourceFilter !== 'all') {\n      filtered = filtered.filter(agent => agent.source === sourceFilter);\n    }\n\n    if (referralFilter === 'mine') {\n      const meId = getCurrentStaffId();\n      filtered = filtered.filter(agent => {\n        const type = (agent.source_type || '').toLowerCase();\n        if (type !== 'staff_referral') return false;\n        const refOwnerId = getReferralOwnerId(agent);\n        return meId && refOwnerId && String(refOwnerId) === String(meId);\n      });\n    } else if (referralFilter === 'staff' && referralStaffId) {\n      filtered = filtered.filter(agent => {\n        const type = (agent.source_type || '').toLowerCase();\n        if (type !== 'staff_referral') return false;\n        const refOwnerId = getReferralOwnerId(agent);\n        return refOwnerId && String(refOwnerId) === String(referralStaffId);\n      });\n    }\n\n    setFilteredAgents(filtered);\n  };\n\n  const handleViewAgent = (id: string) => {\n    navigate(`/management/agents/${id}`);\n  };\n\n  const handleEditAgent = (id: string) => {\n    navigate(`/management/agents/${id}/edit`);\n  };\n\n  const handleDeleteAgent = async (id: string) => {\n    const { error } = await AgentManagementService.deleteAgent(id);\n    if (!error) {\n      loadAgents();\n      toast.success({\n        title: 'Agent deleted',\n        description: 'The agent has been removed successfully.'\n      });\n    } else {\n      console.error('Failed to delete agent', error);\n      toast.error({\n        title: 'Delete failed',\n        description: 'Could not delete the agent. Please try again.'\n      });\n    }\n  };\n\n  const handleApproveAgent = async (id: string) => {\n    try {\n      // Load full managed agent details and open modal for approval actions\n      const { data, error } = await AgentManagementService.getAgentById(id);\n      if (error || !data) {\n        console.error('Failed to load agent for approval', error);\n        toast.error({ title: 'Load failed', description: 'Could not load agent details.' });\n        return;\n      }\n      setSelectedAgent(data);\n      setApprovalModalOpen(true);\n    } catch (err) {\n      console.error('Error opening approval modal:', err);\n    }\n  };\n\n  const handleStatusChange = async (id: string, newStatus: 'active' | 'inactive') => {\n    try {\n      const { error } = await AgentManagementService.updateAgent({ id, status: newStatus });\n      if (!error) {\n        setAgents(prev => prev.map(a => a.id === id ? { ...a, status: newStatus } : a));\n      } else {\n        console.error('Failed to update status', error);\n      }\n    } catch (err) {\n      console.error('Error updating agent status:', err);\n    }\n  };\n\n  const handleOpenSuspendDialog = (agent: Agent) => {\n    if (!canSuspend) {\n      toast.error({ title: 'Access denied', description: \"You don't have permission to suspend agents.\" });\n      return;\n    }\n    setSuspendTarget(agent);\n    setSuspendReason('');\n    setSuspendDialogOpen(true);\n  };\n\n  const handleConfirmSuspend = async () => {\n    if (!suspendTarget) return;\n    const reason = suspendReason.trim();\n    if (!reason) {\n      toast.error({ title: 'Reason required', description: 'Please enter a reason for suspension.' });\n      return;\n    }\n    try {\n      setIsSuspending(true);\n      const idForUpdate = suspendTarget.user_id || suspendTarget.id;\n      const { error } = await AgentManagementService.suspendAgent(idForUpdate, reason);\n      if (!error) {\n        await loadAgents();\n        toast.success({ title: 'Agent suspended', description: 'The agent has been suspended.' });\n        setSuspendDialogOpen(false);\n        setSuspendTarget(null);\n        setSuspendReason('');\n      } else {\n        toast.error({ title: 'Suspend failed', description: 'Could not suspend the agent.' });\n      }\n    } catch (err) {\n      console.error('Error suspending agent:', err);\n      toast.error({ title: 'Suspend failed', description: 'Unexpected error occurred.' });\n    } finally {\n      setIsSuspending(false);\n    }\n  };\n\n  const getStatusBadgeVariant = (status: string) => {\n    switch (status) {\n      case 'active':\n        return 'default';\n      case 'inactive':\n        return 'secondary';\n      case 'pending':\n        return 'outline';\n      case 'suspended':\n        return 'secondary';\n      case 'rejected':\n        return 'destructive';\n      default:\n        return 'secondary';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'active':\n        return <CheckCircle className=\"h-4 w-4\" />;\n      case 'inactive':\n        return <XCircle className=\"h-4 w-4\" />;\n      case 'pending':\n        return <Clock className=\"h-4 w-4\" />;\n      case 'suspended':\n        return <AlertCircle className=\"h-4 w-4\" />;\n      case 'rejected':\n        return <AlertCircle className=\"h-4 w-4\" />;\n      default:\n        return <AlertCircle className=\"h-4 w-4\" />;\n    }\n  };\n\n  if (loading) {\n    return (\n      <PageLayout title=\"Agent Management\">\n        <div className=\"flex justify-center items-center h-64\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  if (error) {\n    return (\n      <PageLayout title=\"Agent Management\">\n        <div className=\"text-center py-12\">\n          <AlertCircle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Error Loading Agents</h3>\n          <p className=\"text-gray-500 mb-4\">{error}</p>\n          <Button onClick={loadAgents} className=\"mt-4\">\n            Try Again\n          </Button>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout title=\"Agent Management\">\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Agents</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.total}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              +2 from last month\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active Agents</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.active}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {stats.total > 0 ? Math.round((stats.active / stats.total) * 100) : 0}% of total\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Revenue</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">${stats.totalRevenue.toLocaleString()}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              +12% from last month\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Average Rating</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-yellow-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{stats.averageRating.toFixed(1)}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              Out of 5.0 stars\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters and Search */}\n      <div className=\"flex flex-col sm:flex-row gap-4 mb-6\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n          <Input\n            placeholder=\"Search agents...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n        \n        <Select value={statusFilter} onValueChange={setStatusFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\">\n            <SelectValue placeholder=\"Filter by status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Status</SelectItem>\n            <SelectItem value=\"active\">Active</SelectItem>\n            <SelectItem value=\"inactive\">Inactive</SelectItem>\n            <SelectItem value=\"suspended\">Suspended</SelectItem>\n            <SelectItem value=\"rejected\">Rejected</SelectItem>\n          </SelectContent>\n        </Select>\n\n        <Select value={sourceFilter} onValueChange={setSourceFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\">\n            <SelectValue placeholder=\"Filter by source\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Sources</SelectItem>\n            <SelectItem value=\"admin\">Admin Created</SelectItem>\n            <SelectItem value=\"self-registered\">Self Registered</SelectItem>\n          </SelectContent>\n        </Select>\n\n        <Select value={referralFilter} onValueChange={(val) => setReferralFilter(val as 'all' | 'mine' | 'staff')}>\n          <SelectTrigger className=\"w-full sm:w-48\">\n            <SelectValue placeholder=\"Referrals\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">All Referrals</SelectItem>\n            <SelectItem value=\"mine\" disabled={!isStaff}>{`My Referrals${(currentUser?.name || resolveStaffNameById(getCurrentStaffId())) ? ` (${currentUser?.name || resolveStaffNameById(getCurrentStaffId())})` : ''}`}</SelectItem>\n            <SelectItem value=\"staff\">By Staff</SelectItem>\n          </SelectContent>\n        </Select>\n\n        <Select value={referralStaffId} onValueChange={(val) => setReferralStaffId(val)} disabled={referralFilter !== 'staff'}>\n          <SelectTrigger className=\"w-full sm:w-56\">\n            <SelectValue placeholder=\"Select staff\" />\n          </SelectTrigger>\n          <SelectContent>\n            {staffMembers.map((m) => (\n              <SelectItem key={m.id} value={String(m.id)}>{m.name}</SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n\n        <Button onClick={() => navigate('/management/agents/add')}>\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Agent\n        </Button>\n\n        {/* QR sheet trigger remains */}\n      </div>\n\n      <Sheet>\n        <SheetTrigger asChild>\n          <Button variant=\"outline\" size=\"sm\">\n            <QrCode className=\"h-4 w-4 mr-2\" />\n            QR Codes\n          </Button>\n        </SheetTrigger>\n        <SheetContent side=\"right\" className=\"sm:w-[480px]\">\n          <SheetHeader>\n            <SheetTitle>QR Code Generation (Event or Staff)</SheetTitle>\n            <SheetDescription>Generate QR codes for staff or events.</SheetDescription>\n          </SheetHeader>\n          <div className=\"mt-4 grid grid-cols-1 gap-6\">\n            {/* Controls */}\n            <div className=\"space-y-4\">\n              <Select value={qrMode} onValueChange={(val) => setQrMode(val as any)}>\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder=\"Select mode\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"staff\">Staff Referral</SelectItem>\n                  <SelectItem value=\"event\">Event Referral</SelectItem>\n                </SelectContent>\n              </Select>\n\n              {qrMode === 'staff' ? (\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm text-muted-foreground\">Select Staff</label>\n                  <Select value={staffIdInput} onValueChange={handleSelectStaff}>\n                    <SelectTrigger className=\"w-full\">\n                      <SelectValue placeholder=\"Choose a staff member\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {staffMembers.map((m) => (\n                        <SelectItem key={m.id} value={m.id}>{m.name}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <label className=\"text-sm text-muted-foreground\">Staff ID</label>\n                  <Input\n                    placeholder=\"Paste staff UUID\"\n                    value={staffIdInput}\n                    onChange={(e) => setStaffIdInput(e.target.value)}\n                  />\n                  <Button onClick={generateStaffQR} className=\"w-full\">Generate Staff QR</Button>\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm text-muted-foreground\">Event Code</label>\n                  <Input\n                    placeholder=\"e.g. OTM2025, SATTE2025\"\n                    value={eventCodeInput}\n                    onChange={(e) => setEventCodeInput(e.target.value)}\n                  />\n                  <Button onClick={generateEventQR} className=\"w-full\">Generate Event QR</Button>\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm text-muted-foreground\">QR Size (px)</label>\n                <Input\n                  type=\"number\"\n                  value={qrSize}\n                  min={120}\n                  max={1024}\n                  onChange={(e) => setQrSize(Number(e.target.value))}\n                />\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" onClick={copyLinkToClipboard} disabled={!qrLink}>Copy Link</Button>\n                <Button variant=\"outline\" onClick={downloadPng} disabled={!qrLink}>Download PNG</Button>\n              </div>\n            </div>\n\n            {/* Preview */}\n            <div className=\"flex flex-col items-center justify-center gap-3\">\n              <div className=\"text-sm text-muted-foreground\">Referral URL</div>\n              <div className=\"text-xs break-all border rounded p-2 w-full bg-muted/30\">\n                {qrLink || 'No link generated yet'}\n              </div>\n              <div className=\"mt-2\">\n                {qrLink ? (\n                  <QRCodeCanvas\n                    id=\"agent-qr-canvas\"\n                    ref={qrCanvasRef}\n                    value={qrLink}\n                    size={qrSize}\n                    level=\"H\"\n                    includeMargin\n                  />\n                ) : (\n                  <div className=\"text-sm text-muted-foreground\">Generate a QR to preview</div>\n                )}\n              </div>\n            </div>\n\n            {/* Tips */}\n            <div className=\"text-sm text-muted-foreground\">\n              <ul className=\"list-disc ml-6 space-y-2\">\n                <li>Staff QR links embed a short, decodable ref tied to the staff ID.</li>\n                <li>Event QR links use the source parameter like <code>qr_OTM2025</code>.</li>\n                <li>Use the PNG download for printing at booths and kiosks.</li>\n              </ul>\n            </div>\n          </div>\n        </SheetContent>\n      </Sheet>\n\n      {filteredAgents.length === 0 && (\n        <div className=\"text-center py-12\">\n          <Users className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No agents found</h3>\n          <p className=\"text-gray-500 mb-4\">\n            {searchTerm || statusFilter !== 'all'\n              ? 'Try adjusting your filters to see more results.'\n              : 'Get started by adding your first agent.'}\n          </p>\n          <Button onClick={() => navigate('/management/agents/add')}>\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Add Agent\n          </Button>\n        </div>\n      )}\n\n      {/* Agents Table */}\n      {filteredAgents.length > 0 && (\n        <div className=\"mt-10\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Agents List</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <TooltipProvider>\n              <Table hoverable>\n                <TableHeader sticky>\n                  <TableRow>\n                    <TableHead>Name</TableHead>\n                    <TableHead>Email</TableHead>\n                    <TableHead>Phone</TableHead>\n                    <TableHead>Role</TableHead>\n                    <TableHead>Source</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Bookings</TableHead>\n                    <TableHead align=\"right\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {paginatedAgents.map((agent) => (\n                    <TableRow key={`row-${agent.id}`}>\n                      <TableCell truncate>\n                        <div className=\"font-medium\">{agent.name}</div>\n                      </TableCell>\n                      <TableCell truncate>{agent.email}</TableCell>\n                      <TableCell truncate>{agent.phone}</TableCell>\n                      <TableCell>{agent.role}</TableCell>\n                      <TableCell>\n                        <div className=\"flex flex-col\">\n                          <Badge\n                            variant={agent.source === 'admin' ? 'default' : 'secondary'}\n                            className=\"flex items-center gap-1 w-fit\"\n                            title={agent.source_details || ''}\n                          >\n                            {agent.source === 'admin' ? (\n                              <Shield className=\"h-3 w-3\" />\n                            ) : (\n                              <UserPlus className=\"h-3 w-3\" />\n                            )}\n                            {agent.source === 'admin' ? 'Admin' : 'Self-Reg'}\n                          </Badge>\n                          {renderSourceTypeDetails(agent) && (\n                            <div className=\"text-xs text-muted-foreground mt-1\" data-testid=\"source-details\">\n                              {renderSourceTypeDetails(agent)}\n                            </div>\n                          )}\n                          {renderCreatedByLine(agent) && (\n                            <div className=\"text-xs text-muted-foreground mt-1\">\n                              {renderCreatedByLine(agent)}\n                            </div>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <Switch\n                            checked={agent.status === 'active'}\n                            onCheckedChange={(checked) => handleStatusChange(agent.id, (checked ? 'active' : 'inactive') as any)}\n                            disabled={!(agent.status === 'active' || agent.status === 'inactive')}\n                            aria-label=\"Toggle agent status\"\n                          />\n                          <span className=\"text-sm capitalize\">\n                            {agent.status === 'active' ? 'Active' : agent.status === 'inactive' ? 'Inactive' : agent.status}\n                          </span>\n                          {agent.status === 'suspended' && agent.suspension_reason && (\n                            <Tooltip>\n                              <TooltipTrigger asChild>\n                                <span className=\"inline-flex\">\n                                  <AlertCircle className=\"h-4 w-4 text-muted-foreground\" aria-label=\"Suspended reason\" />\n                                </span>\n                              </TooltipTrigger>\n                              <TooltipContent>\n                                Suspended: {agent.suspension_reason}\n                              </TooltipContent>\n                            </Tooltip>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>{agent.total_bookings}</TableCell>\n                      <TableCell align=\"right\">\n                        <div className=\"flex justify-end gap-2\">\n                          <Button size=\"icon\" variant=\"outline\" onClick={() => handleViewAgent(agent.id)} title=\"Profile\" aria-label=\"View profile\">\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                          <Button size=\"icon\" variant=\"outline\" onClick={() => navigate(`/reports?type=agent&id=${agent.id}`)} title=\"Report\" aria-label=\"View report\">\n                            <FileText className=\"h-4 w-4\" />\n                          </Button>\n                          <Button size=\"icon\" variant=\"outline\" onClick={() => handleEditAgent(agent.id)} title=\"Edit\" aria-label=\"Edit agent\">\n                            <Edit className=\"h-4 w-4\" />\n                          </Button>\n                          {/* Pending status removed from DB-supported states; approval flow disabled */}\n                          {agent.status === 'active' && canSuspend && (\n                            <Button\n                              size=\"icon\"\n                              variant=\"outline\"\n                              onClick={() => handleOpenSuspendDialog(agent)}\n                              title=\"Suspend\"\n                              aria-label=\"Suspend agent\"\n                            >\n                              <PauseCircle className=\"h-4 w-4\" />\n                            </Button>\n                          )}\n                          {(agent.status === 'suspended' || agent.status === 'rejected') && (\n                            <Button\n                              size=\"icon\"\n                              variant=\"default\"\n                              onClick={async () => {\n                                const { error } = await AgentManagementService.reactivateAgent(agent.id);\n                                if (!error) {\n                                  await loadAgents();\n                                  toast.success({ title: 'Agent reactivated', description: 'The agent is now active.' });\n                                } else {\n                                  toast.error({ title: 'Reactivate failed', description: 'Could not reactivate the agent.' });\n                                }\n                              }}\n                              title=\"Reactivate\"\n                              aria-label=\"Reactivate agent\"\n                            >\n                              <CheckCircle className=\"h-4 w-4\" />\n                            </Button>\n                          )}\n                          {/* <Button size=\"icon\" variant=\"destructive\" onClick={() => handleDeleteAgent(agent.id)} title=\"Delete\" aria-label=\"Delete agent\">\n                            <Trash className=\"h-4 w-4\" />\n                          </Button> */}\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n              </TooltipProvider>\n              <div className=\"flex items-center justify-between mt-4\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">Rows per page:</span>\n                  <Select value={String(pageSize)} onValueChange={(val) => { setPageSize(Number(val)); setCurrentPage(1); }}>\n                    <SelectTrigger className=\"w-24\">\n                      <SelectValue placeholder={`${pageSize}`} />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"10\">10</SelectItem>\n                      <SelectItem value=\"25\">25</SelectItem>\n                      <SelectItem value=\"50\">50</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">Page {currentPage} of {totalPages}</span>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setCurrentPage((p) => Math.max(1, p - 1))} disabled={currentPage === 1}>Prev</Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))} disabled={currentPage >= totalPages}>Next</Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n      {/* Suspend Confirmation Dialog */}\n      <AlertDialog open={suspendDialogOpen} onOpenChange={setSuspendDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Suspend Agent</AlertDialogTitle>\n            <AlertDialogDescription>\n              Suspending this agent will restrict their access. Please enter a reason.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <div className=\"space-y-3\">\n            {suspendTarget && (\n              <div className=\"text-sm text-muted-foreground\">\n                Agent: <span className=\"font-medium text-foreground\">{suspendTarget.name}</span> ({suspendTarget.email})\n              </div>\n            )}\n            <Textarea\n              placeholder=\"Enter suspension reason\"\n              value={suspendReason}\n              onChange={(e) => setSuspendReason(e.target.value)}\n            />\n          </div>\n          <AlertDialogFooter>\n            <AlertDialogCancel onClick={() => setSuspendDialogOpen(false)} disabled={isSuspending}>Cancel</AlertDialogCancel>\n            <AlertDialogAction onClick={handleConfirmSuspend} disabled={isSuspending || !suspendReason.trim()}>\n              {isSuspending ? 'Suspending' : 'Suspend'}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n      {/* Approval/Reject Modal */}\n      {selectedAgent && (\n        <AgentApprovalModal\n          agent={selectedAgent}\n          isOpen={approvalModalOpen}\n          onClose={() => {\n            setApprovalModalOpen(false);\n            setSelectedAgent(null);\n          }}\n          onAgentUpdated={() => {\n            loadAgents();\n          }}\n          staffMembers={staffMembers}\n        />\n      )}\n    </PageLayout>\n  );\n}\n\n\n\n/* DUPLICATE BLOCK REMOVED */\n","import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Switch } from '@/components/ui/switch';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { ArrowLeft, Save, UserPlus, Users, AlertCircle, CheckCircle, Mail, Phone, Building } from 'lucide-react';\nimport { AgentManagementService } from '@/services/agentManagementService';\nimport { AgentStatus, StaffMember } from '@/types/agentManagement';\nimport { toast } from 'sonner';\nimport { useApp } from '@/contexts/AppContext';\nimport { useAccessControl } from '@/hooks/use-access-control';\nimport { agentWelcomeTemplate } from '@/email/templates';\nimport { storeAgentCredentials } from '@/utils/agentAuth';\nimport { authHelpers } from '@/lib/supabaseClient';\nimport { AuthService } from '@/services/authService';\nimport { supabase } from '@/integrations/supabase/client';\n\nconst AddAgent: React.FC = () => {\n  const navigate = useNavigate();\n  const { currentUser } = useApp();\n  const { hasAdminAccess } = useAccessControl();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [staffMembers, setStaffMembers] = useState<StaffMember[]>([]);\n  const [loadingStaff, setLoadingStaff] = useState(false);\n  const [formErrors, setFormErrors] = useState<Record<string, string>>({});\n  const [showCredentialsModal, setShowCredentialsModal] = useState(false);\n  const [modalCredentials, setModalCredentials] = useState<{ email: string; password: string }>({ email: '', password: '' });\n  const [autoAssignStaffId, setAutoAssignStaffId] = useState<string | null>(null);\n  const [emailExists, setEmailExists] = useState(false);\n  const [phoneExists, setPhoneExists] = useState(false);\n  const [existingProfile, setExistingProfile] = useState<{ id: string; name?: string; phone?: string; email: string; company_name?: string } | null>(null);\n\n  const [formData, setFormData] = useState({\n    name: '',\n    email: '',\n    phone: '',\n    company_name: '',\n    status: 'inactive' as AgentStatus,\n    assigned_staff: [] as string[],\n    notes: '',\n    // Account access\n    sendMagicLinkEmail: true,\n    trackLoginActivity: true\n  });\n\n  // Fetch staff members for assignment\n  useEffect(() => {\n    const fetchStaffMembers = async () => {\n      if (hasAdminAccess) {\n        setLoadingStaff(true);\n        try {\n          const { data, error } = await AgentManagementService.getStaffMembers();\n          if (error) {\n            console.error('Error fetching staff members:', error);\n            toast.error('Failed to load staff members');\n          } else {\n            setStaffMembers(data || []);\n          }\n        } catch (error) {\n          console.error('Error fetching staff members:', error);\n          toast.error('Failed to load staff members');\n        } finally {\n          setLoadingStaff(false);\n        }\n      }\n    };\n\n    fetchStaffMembers();\n  }, [hasAdminAccess]);\n\n  // Detect staffId in URL and validate against profiles; preselect and mark for primary assignment\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const sid = params.get('staffId') || params.get('staff_id');\n    if (!sid) return;\n\n    (async () => {\n      try {\n        const { data, error } = await supabase\n          .from('profiles')\n          .select('id,name,role')\n          .eq('id', sid)\n          .in('role', ['staff', 'admin', 'super_admin'])\n          .maybeSingle();\n\n        if (!error && data?.id) {\n          const validId = String(data.id);\n          setAutoAssignStaffId(validId);\n          setFormData(prev => ({\n            ...prev,\n            assigned_staff: prev.assigned_staff.includes(validId)\n              ? prev.assigned_staff\n              : [...prev.assigned_staff, validId]\n          }));\n          if (data?.name) {\n            toast.info(`Auto-assignment queued: ${data.name} will be set as primary.`);\n          } else {\n            toast.info('Auto-assignment queued: selected staff will be set as primary.');\n          }\n        }\n      } catch (e) {\n        console.warn('Failed validating staffId from URL:', e);\n      }\n    })();\n  }, []);\n\n  // Form validation\n  const validateForm = () => {\n    const errors: Record<string, string> = {};\n\n    if (!formData.name.trim()) {\n      errors.name = 'Full name is required';\n    }\n\n    if (!formData.email.trim()) {\n      errors.email = 'Email address is required';\n    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      errors.email = 'Please enter a valid email address';\n    }\n\n    // Require phone (consistent with signup) and validate digits length\n    if (!formData.phone.trim()) {\n      errors.phone = 'Phone number is required';\n    } else {\n      const digits = formData.phone.replace(/\\D/g, '');\n      if (digits.length < 7) {\n        errors.phone = 'Please enter a valid phone number';\n      }\n    }\n\n    // Duplicate checks (match signup rules)\n    if (emailExists) {\n      errors.email = 'Email already exists. Please login.';\n    }\n    if (phoneExists) {\n      errors.phone = 'Phone number already exists. Please login.';\n    }\n\n    // No password validation needed for magic link authentication\n\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleInputChange = (field: string, value: string | string[] | boolean) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Clear error for this field when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({\n        ...prev,\n        [field]: ''\n      }));\n    }\n  };\n\n  // Debounced email existence check and Supabase profile prefill\n  useEffect(() => {\n    const t = setTimeout(async () => {\n      try {\n        const email = formData.email.trim();\n        if (!email) {\n          setEmailExists(false);\n          setExistingProfile(null);\n          return;\n        }\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n          setEmailExists(false);\n          setExistingProfile(null);\n          return;\n        }\n        const { exists } = await AuthService.userExistsByEmail(email);\n        setEmailExists(!!exists);\n\n        // Prefill profile details if record exists (show complete Supabase data)\n        const { data, error } = await supabase\n          .from('profiles')\n          .select('id,name,phone,email,company_name')\n          .eq('email', email)\n          .maybeSingle();\n        if (!error && data) {\n          setExistingProfile({\n            id: String(data.id),\n            name: data.name || undefined,\n            phone: data.phone || undefined,\n            email: data.email,\n            company_name: (data as any).company_name || undefined\n          });\n          setFormData(prev => ({\n            ...prev,\n            name: prev.name || data.name || '',\n            phone: prev.phone || data.phone || '',\n            company_name: prev.company_name || (data as any).company_name || ''\n          }));\n        } else {\n          setExistingProfile(null);\n        }\n      } catch {\n        setEmailExists(false);\n        setExistingProfile(null);\n      }\n    }, 400);\n    return () => clearTimeout(t);\n  }, [formData.email]);\n\n  // Debounced phone existence check (digits-only)\n  useEffect(() => {\n    const t = setTimeout(async () => {\n      try {\n        const phone = formData.phone.trim();\n        const digits = phone.replace(/\\D/g, '');\n        if (!digits || digits.length < 7) {\n          setPhoneExists(false);\n          return;\n        }\n        const { exists } = await AuthService.userExistsByPhone(phone);\n        setPhoneExists(!!exists);\n      } catch {\n        setPhoneExists(false);\n      }\n    }, 400);\n    return () => clearTimeout(t);\n  }, [formData.phone]);\n\n  const handleStaffAssignment = (staffId: string, checked: boolean) => {\n    setFormData(prev => ({\n      ...prev,\n      assigned_staff: checked \n        ? [...prev.assigned_staff, staffId]\n        : prev.assigned_staff.filter(id => id !== staffId)\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validate form\n    if (!validateForm()) {\n      toast.error('Please fix the errors in the form');\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      // Sign up agent via Supabase Auth; records for agents are auto-managed\n      const signupRequest: any = {\n        name: formData.name.trim(),\n        email: formData.email.trim().toLowerCase(),\n        phone: formData.phone?.trim() || undefined,\n        company_name: formData.company_name?.trim() || undefined,\n        notes: formData.notes || '',\n        source_type: 'staff_created',\n        source_details: 'management_add_agent'\n      };\n\n      const { data, error } = await AgentManagementService.signupAgent(signupRequest);\n      \n      if (error) {\n        console.error('Error creating agent:', error);\n        // Handle string error returned by service (e.g., duplicate email)\n        if (typeof error === 'string') {\n          toast.error(error);\n        } else if ((error as any)?.code === '23505') {\n          toast.error('An agent with this email already exists');\n        } else {\n          toast.error((error as any)?.message || 'Failed to create agent');\n        }\n      } else if (data) {\n        // Success toast\n        toast.success(`Agent \"${data.name}\" created successfully!`);\n\n        // Post-signup staff assignment (primary + additional)\n        try {\n          const agentId = String(data.id);\n          const selectedStaff = formData.assigned_staff || [];\n          const primaryStaffId = autoAssignStaffId || (selectedStaff.length > 0 ? String(selectedStaff[0]) : undefined);\n\n          if (primaryStaffId) {\n            const { error: primaryAssignErr } = await AgentManagementService.addStaffAssignmentToAgent(agentId, String(primaryStaffId), { isPrimary: true, notes: formData.notes });\n            if (!primaryAssignErr) {\n              toast.success('Primary staff assigned.');\n            } else {\n              console.warn('Primary staff assignment failed:', primaryAssignErr);\n            }\n          }\n\n          const additionalStaff = selectedStaff.filter(sid => String(sid) !== String(primaryStaffId || ''));\n          for (const sid of additionalStaff) {\n            const { error: secondaryAssignErr } = await AgentManagementService.addStaffAssignmentToAgent(agentId, String(sid), { isPrimary: false, notes: formData.notes });\n            if (secondaryAssignErr) {\n              console.warn(`Secondary staff assignment failed for ${sid}:`, secondaryAssignErr);\n            }\n          }\n        } catch (assignFlowErr) {\n          console.warn('Staff assignment flow failed:', assignFlowErr);\n        }\n\n        // Persist Track Login Activity preference\n        try {\n          await AgentManagementService.patchAgentSettingsPreferences(String(data.id), {\n            security: { trackLoginActivity: !!formData.trackLoginActivity },\n          });\n        } catch (prefsErr) {\n          console.warn('Persisting trackLoginActivity failed:', prefsErr);\n        }\n\n        // Send magic link for passwordless authentication or generate credentials\n        if (formData.sendMagicLinkEmail) {\n          try {\n            const { error: magicLinkError } = await authHelpers.signInWithMagicLink(formData.email.trim().toLowerCase());\n            \n            if (magicLinkError) {\n              console.warn('Magic link error:', magicLinkError);\n              toast.warning('Agent created, but magic link email could not be sent.');\n            } else {\n              toast.success('Magic link sent to agent\\'s email for secure login access.');\n            }\n          } catch (e) {\n            console.error('Magic link error:', e);\n            toast.warning('Agent created, but magic link sending failed.');\n          }\n\n          // Navigate back to agents list after successful creation\n          setTimeout(() => {\n            navigate('/management/agents');\n          }, 2000);\n        } else {\n          // Generate credentials and show modal when not using magic link\n          try {\n            const { data: credsData, error: genError } = await AgentManagementService.generateCredentials(String(data.id));\n            if (genError) {\n              console.error('Credential generation error:', genError);\n              toast.error('Failed to generate temporary credentials.');\n            } else if (credsData) {\n              try {\n                const creator = {\n                  staffId: (currentUser?.id ? String(currentUser.id) : 'system'),\n                  staffName: ((currentUser as any)?.name || (currentUser as any)?.user_metadata?.name || 'System') as string,\n                };\n\n                storeAgentCredentials({\n                  agentId: String(data.id),\n                  email: formData.email.trim().toLowerCase(),\n                  username: credsData.username,\n                  password: credsData.temporaryPassword,\n                  forcePasswordChange: true,\n                  isTemporary: true,\n                  createdAt: new Date().toISOString(),\n                  createdBy: creator,\n                });\n              } catch (storeErr) {\n                console.warn('Local credentials store failed:', storeErr);\n              }\n\n              setModalCredentials({\n                email: formData.email.trim().toLowerCase(),\n                password: credsData.temporaryPassword,\n              });\n              setShowCredentialsModal(true);\n            } else {\n              toast.warning('Credentials could not be generated for the agent.');\n            }\n          } catch (genErr) {\n            console.error('Credential generation error:', genErr);\n            toast.error('Failed to generate temporary credentials.');\n          }\n        }\n\n        // Stay on page to allow admin to review credentials; optionally navigate later\n      } else {\n        toast.error('Failed to create agent');\n      }\n    } catch (error) {\n      console.error('Error creating agent:', error);\n      toast.error('Failed to create agent. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <PageLayout\n      title=\"Add New Agent\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Agent Management\", href: \"/management/agents\" },\n        { title: \"Add Agent\", href: \"/management/agents/add\" }\n      ]}\n    >\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <Button variant=\"ghost\" onClick={() => navigate('/management/agents')}>\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\n              Back to Agents\n            </Button>\n          </div>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Basic Information */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center\">\n                <UserPlus className=\"mr-2 h-5 w-5\" />\n                Basic Information\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\" className=\"flex items-center\">\n                    <UserPlus className=\"mr-1 h-4 w-4\" />\n                    Full Name *\n                  </Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => handleInputChange('name', e.target.value)}\n                    placeholder=\"Enter agent's full name\"\n                    className={formErrors.name ? 'border-red-500' : ''}\n                  />\n                  {formErrors.name && (\n                    <p className=\"text-sm text-red-500 flex items-center\">\n                      <AlertCircle className=\"mr-1 h-3 w-3\" />\n                      {formErrors.name}\n                    </p>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\" className=\"flex items-center\">\n                    <Mail className=\"mr-1 h-4 w-4\" />\n                    Email Address *\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => handleInputChange('email', e.target.value)}\n                    placeholder=\"Enter email address\"\n                    className={formErrors.email ? 'border-red-500' : ''}\n                  />\n                  {formErrors.email && (\n                    <p className=\"text-sm text-red-500 flex items-center\">\n                      <AlertCircle className=\"mr-1 h-3 w-3\" />\n                      {formErrors.email}\n                    </p>\n                  )}\n                  {emailExists && (\n                    <div className=\"mt-2 text-sm\">\n                      <span className=\"text-red-600\">This email is already registered.</span>{' '}\n                      <Button\n                        type=\"button\"\n                        variant=\"link\"\n                        className=\"p-0 h-auto\"\n                        onClick={() => navigate(`/login?email=${encodeURIComponent(formData.email.trim())}`)}\n                      >\n                        Login Instead\n                      </Button>\n                    </div>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"phone\" className=\"flex items-center\">\n                    <Phone className=\"mr-1 h-4 w-4\" />\n                    Phone Number *\n                  </Label>\n                  <Input\n                    id=\"phone\"\n                    value={formData.phone}\n                    onChange={(e) => handleInputChange('phone', e.target.value)}\n                    placeholder=\"Enter phone number\"\n                    className={formErrors.phone ? 'border-red-500' : ''}\n                  />\n                  {formErrors.phone && (\n                    <p className=\"text-sm text-red-500 flex items-center\">\n                      <AlertCircle className=\"mr-1 h-3 w-3\" />\n                      {formErrors.phone}\n                    </p>\n                  )}\n                  {phoneExists && (\n                    <div className=\"mt-2 text-sm\">\n                      <span className=\"text-red-600\">This phone number is already registered.</span>{' '}\n                      <Button\n                        type=\"button\"\n                        variant=\"link\"\n                        className=\"p-0 h-auto\"\n                        onClick={() => navigate(`/login?email=${encodeURIComponent(formData.email.trim())}`)}\n                      >\n                        Login Instead\n                      </Button>\n                    </div>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"company_name\" className=\"flex items-center\">\n                    <Building className=\"mr-1 h-4 w-4\" />\n                    Company Name\n                  </Label>\n                  <Input\n                    id=\"company_name\"\n                    value={formData.company_name}\n                    onChange={(e) => handleInputChange('company_name', e.target.value)}\n                    placeholder=\"Enter company name\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"status\">Initial Status</Label>\n                  <Select value={formData.status} onValueChange={(value: AgentStatus) => handleInputChange('status', value)}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"inactive\">Inactive</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"notes\">Notes (Optional)</Label>\n                  <Textarea\n                    id=\"notes\"\n                    value={formData.notes}\n                    onChange={(e) => handleInputChange('notes', e.target.value)}\n                    placeholder=\"Add any additional notes about this agent...\"\n                    rows={3}\n                  />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Account Access & Security */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Account Access & Security</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Authentication Method</Label>\n                  <div className=\"p-4 border rounded-lg bg-blue-50 dark:bg-blue-950\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Mail className=\"h-5 w-5 text-blue-600\" />\n                      <div>\n                        <p className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">Magic Link Authentication</p>\n                        <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                          Agents will receive a secure login link via email. No password required.\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Login Email</Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    The agent will use their email address to receive magic login links.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 gap-4\">\n                <div className=\"flex items-center justify-between rounded-lg border p-3 shadow-sm\">\n                  <div>\n                    <p className=\"text-sm font-medium\">Send magic link email</p>\n                    <p className=\"text-xs text-muted-foreground\">Send login link to agent's email after creation</p>\n                  </div>\n                  <Switch checked={formData.sendMagicLinkEmail} onCheckedChange={(checked) => handleInputChange('sendMagicLinkEmail', checked ? true : false)} />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"flex items-center justify-between rounded-lg border p-3 shadow-sm\">\n                  <div>\n                    <p className=\"text-sm font-medium\">Track login activity</p>\n                    <p className=\"text-xs text-muted-foreground\">Monitor login attempts and activity</p>\n                  </div>\n                  <Switch checked={formData.trackLoginActivity} onCheckedChange={(checked) => handleInputChange('trackLoginActivity', checked ? true : false)} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Staff Assignment */}\n          {hasAdminAccess && (\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center\">\n                  <Users className=\"mr-2 h-5 w-5\" />\n                  Staff Assignment\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {loadingStaff ? (\n                  <div className=\"flex items-center justify-center py-4\">\n                    <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\n                    <span className=\"ml-2\">Loading staff members...</span>\n                  </div>\n                ) : staffMembers.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    <p className=\"text-sm text-muted-foreground\">\n                      Select staff members to assign to this agent:\n                    </p>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                      {staffMembers.map((staff) => (\n                        <div key={staff.id} className=\"flex items-center space-x-2 p-3 border rounded-lg\">\n                          <Checkbox\n                            id={`staff-${staff.id}`}\n                            checked={formData.assigned_staff.includes(staff.id)}\n                            onCheckedChange={(checked) => handleStaffAssignment(staff.id, checked as boolean)}\n                          />\n                          <div className=\"flex-1\">\n                            <Label htmlFor={`staff-${staff.id}`} className=\"font-medium cursor-pointer\">\n                              {staff.name}\n                            </Label>\n                            <p className=\"text-sm text-muted-foreground\">{staff.email}</p>\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {staff.role}\n                            </Badge>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                    {formData.assigned_staff.length > 0 && (\n                      <Alert>\n                        <CheckCircle className=\"h-4 w-4\" />\n                        <AlertDescription>\n                          {formData.assigned_staff.length} staff member(s) will be assigned to this agent.\n                        </AlertDescription>\n                      </Alert>\n                    )}\n                  </div>\n                ) : (\n                  <Alert>\n                    <AlertCircle className=\"h-4 w-4\" />\n                    <AlertDescription>\n                      No staff members available for assignment.\n                    </AlertDescription>\n                  </Alert>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Submit Button */}\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4\">\n                <div className=\"flex items-center text-sm text-muted-foreground\">\n                  <CheckCircle className=\"mr-2 h-4 w-4\" />\n                  All data is securely stored and encrypted\n                </div>\n                <div className=\"flex space-x-3\">\n                  <Button \n                    type=\"button\" \n                    variant=\"outline\" \n                    onClick={() => navigate('/management/agents')}\n                    disabled={isSubmitting}\n                    className=\"min-w-[100px]\"\n                  >\n                    <ArrowLeft className=\"mr-2 h-4 w-4\" />\n                    Cancel\n                  </Button>\n                  <Button \n                    type=\"submit\" \n                    disabled={\n                      isSubmitting ||\n                      !formData.name ||\n                      !formData.email ||\n                      !formData.phone ||\n                      emailExists ||\n                      phoneExists\n                    }\n                    className=\"min-w-[140px]\"\n                  >\n                    {isSubmitting ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                        Creating...\n                      </>\n                    ) : (\n                      <>\n                        <UserPlus className=\"mr-2 h-4 w-4\" />\n                        Create Agent\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </form>\n\n        {/* Credentials Modal */}\n        <Dialog open={showCredentialsModal} onOpenChange={setShowCredentialsModal}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <UserPlus className=\"h-4 w-4\" />\n                Agent Credentials\n              </DialogTitle>\n              <DialogDescription>\n                Credentials have been activated. Share securely with the agent.\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between rounded-md border p-3\">\n                <div>\n                  <p className=\"text-sm\">Email</p>\n                  <p className=\"font-mono text-sm\">{modalCredentials.email}</p>\n                </div>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigator.clipboard.writeText(modalCredentials.email)}\n                >\n                  Copy\n                </Button>\n              </div>\n              <div className=\"flex items-center justify-between rounded-md border p-3\">\n                <div>\n                  <p className=\"text-sm\">Password</p>\n                  <p className=\"font-mono text-sm\">{modalCredentials.password}</p>\n                </div>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigator.clipboard.writeText(modalCredentials.password)}\n                >\n                  Copy\n                </Button>\n              </div>\n              <Alert>\n                <AlertDescription className=\"text-xs\">\n                  For security, advise the agent to change the password after first login.\n                </AlertDescription>\n              </Alert>\n            </div>\n            <DialogFooter>\n              <Button type=\"button\" onClick={() => { setShowCredentialsModal(false); navigate('/management/agents'); }}>Done</Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AddAgent;","\nimport React, { useState } from \"react\";\nimport { format } from \"date-fns\";\nimport {\n  BadgeCheck,\n  Calendar,\n  Edit,\n  Info,\n  MapPin,\n  Plus,\n  Trash,\n  User,\n} from \"lucide-react\";\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { toast } from \"sonner\";\n\nimport { Agent, AgentSource } from \"@/types/agent\";\nimport { AgentManagementService } from \"@/services/agentManagementService\";\n\ninterface StaffAssignmentTabProps {\n  agent: Agent;\n  agentId?: string;\n  onAssignmentChange?: () => void;\n}\n\n// Local UI assignment type uses string-based staffId consistent with Supabase profile IDs\ntype UiAssignment = {\n  staffId: string;\n  staffName: string;\n  role: string;\n  email?: string;\n  isPrimary: boolean;\n  assignedAt: string;\n  assignedBy?: string;\n  assignedByName?: string;\n  assignedByRole?: string;\n  notes?: string;\n};\n\nconst StaffAssignmentTab: React.FC<StaffAssignmentTabProps> = ({ agent, agentId, onAssignmentChange }) => {\n  const [assignments, setAssignments] = useState<UiAssignment[]>([]);\n  const [isAddDialogOpen, setIsAddDialogOpen] = useState<boolean>(false);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState<boolean>(false);\n  const [currentAssignment, setCurrentAssignment] = useState<UiAssignment | null>(null);\n  const [isRemoveDialogOpen, setIsRemoveDialogOpen] = useState<boolean>(false);\n  const [availableStaff, setAvailableStaff] = useState<{ id: string; name: string; role: string }[]>([]);\n\n  // Form states\n  const [selectedStaffId, setSelectedStaffId] = useState<string | null>(null);\n  const [isPrimary, setIsPrimary] = useState<boolean>(false);\n  const [notes, setNotes] = useState<string>(\"\");\n\n  const effectiveAgentId = agentId ? String(agentId) : String(agent.id);\n\n  const formatDate = (dateStr: string) => {\n    try {\n      return format(new Date(dateStr), \"dd MMM yyyy, HH:mm\");\n    } catch (e) {\n      return dateStr;\n    }\n  };\n\n  React.useEffect(() => {\n    const load = async () => {\n      try {\n        const staffRes = await AgentManagementService.getStaffMembers();\n        setAvailableStaff(staffRes.data || []);\n      } catch {}\n      try {\n        const res = await AgentManagementService.getAgentStaffAssignments(effectiveAgentId);\n        setAssignments((res.data || []) as UiAssignment[]);\n      } catch {}\n    };\n    load();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [agentId, agent.id]);\n\n  const handleAddAssignment = async () => {\n    if (!selectedStaffId) {\n      toast.error(\"Please select a staff member\");\n      return;\n    }\n\n    const staffMember: any = availableStaff.find((s) => String(s.id) === String(selectedStaffId));\n    if (!staffMember) {\n      toast.error(\"Selected staff member not found\");\n      return;\n    }\n\n    const { error } = await AgentManagementService.addStaffAssignmentToAgent(\n      effectiveAgentId,\n      String(selectedStaffId),\n      { isPrimary, notes, role: staffMember.role }\n    );\n\n    if (!error) {\n      toast.success(`Staff member ${staffMember.name} assigned successfully`);\n      const res = await AgentManagementService.getAgentStaffAssignments(effectiveAgentId);\n      setAssignments((res.data || []) as UiAssignment[]);\n      setIsAddDialogOpen(false);\n      resetForm();\n      if (onAssignmentChange) onAssignmentChange();\n    } else {\n      toast.error(\"Failed to assign staff member\");\n    }\n  };\n\n  const handleUpdateAssignment = async () => {\n    if (!currentAssignment) {\n      toast.error(\"No assignment selected for update\");\n      return;\n    }\n\n    const { error } = await AgentManagementService.updateStaffAssignmentForAgent(\n      effectiveAgentId,\n      String(currentAssignment.staffId),\n      {\n        isPrimary,\n        notes,\n      }\n    );\n\n    if (!error) {\n      toast.success(`Assignment updated successfully`);\n      const res = await AgentManagementService.getAgentStaffAssignments(effectiveAgentId);\n      setAssignments((res.data || []) as UiAssignment[]);\n      setIsEditDialogOpen(false);\n      resetForm();\n      if (onAssignmentChange) onAssignmentChange();\n    } else {\n      toast.error(\"Failed to update assignment\");\n    }\n  };\n\n  const handleRemoveAssignment = async () => {\n    if (!currentAssignment) {\n      toast.error(\"No assignment selected for removal\");\n      return;\n    }\n\n    const { error } = await AgentManagementService.removeStaffAssignmentFromAgent(\n      effectiveAgentId,\n      String(currentAssignment.staffId)\n    );\n\n    if (!error) {\n      toast.success(`Assignment removed successfully`);\n      const res = await AgentManagementService.getAgentStaffAssignments(effectiveAgentId);\n      setAssignments((res.data || []) as UiAssignment[]);\n      setIsRemoveDialogOpen(false);\n      if (onAssignmentChange) onAssignmentChange();\n    } else {\n      toast.error(\"Failed to remove assignment\");\n    }\n  };\n\n  const resetForm = () => {\n    setSelectedStaffId(null);\n    setIsPrimary(false);\n    setNotes(\"\");\n    setCurrentAssignment(null);\n  };\n\n  const openEditDialog = (assignment: UiAssignment) => {\n    setCurrentAssignment(assignment);\n    setIsPrimary(assignment.isPrimary);\n    setNotes(assignment.notes || \"\");\n    setIsEditDialogOpen(true);\n  };\n\n  const openRemoveDialog = (assignment: UiAssignment) => {\n    setCurrentAssignment(assignment);\n    setIsRemoveDialogOpen(true);\n  };\n\n  const renderSourceBadge = (source?: AgentSource) => {\n    if (!source) return null;\n\n    const colorMap = {\n      event: \"bg-purple-100 text-purple-800\",\n      lead: \"bg-blue-100 text-blue-800\",\n      referral: \"bg-green-100 text-green-800\",\n      website: \"bg-yellow-100 text-yellow-800\",\n      other: \"bg-gray-100 text-gray-800\",\n    };\n\n    return (\n      <span className={`text-xs px-2 py-1 rounded-full ${colorMap[source.type]}`}>\n        {source.type.charAt(0).toUpperCase() + source.type.slice(1)}\n      </span>\n    );\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg font-medium\">Agent Creation Details</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {agent.createdBy && (\n              <div className=\"flex items-center gap-2\">\n                <User className=\"h-4 w-4 text-muted-foreground\" />\n                <span className=\"text-sm\">Created by: </span>\n                <span className=\"font-medium\">{agent.createdBy.staffName}</span>\n              </div>\n            )}\n\n            <div className=\"flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n              <span className=\"text-sm\">Created on: </span>\n              <span className=\"font-medium\">{formatDate(agent.createdAt)}</span>\n            </div>\n\n            {agent.source && (\n              <div className=\"flex items-center gap-2\">\n                <Info className=\"h-4 w-4 text-muted-foreground\" />\n                <span className=\"text-sm\">Source: </span>\n                <div>\n                  {renderSourceBadge(agent.source)}\n                  <span className=\"ml-2 text-sm\">{agent.source.details}</span>\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader className=\"pb-2 flex flex-row items-center justify-between\">\n          <CardTitle className=\"text-lg font-medium\">Staff Assignments</CardTitle>\n          <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\n            <DialogTrigger asChild>\n              <Button size=\"sm\" className=\"ml-auto\">\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Assign Staff\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Assign Staff to Agent</DialogTitle>\n                <DialogDescription>\n                  Select a staff member to assign to this agent.\n                </DialogDescription>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"staff\">Select Staff Member</Label>\n                  <Select\n                    value={selectedStaffId || \"\"}\n                    onValueChange={(value) => setSelectedStaffId(value)}\n                  >\n                    <SelectTrigger id=\"staff\">\n                      <SelectValue placeholder=\"Select a staff member\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {availableStaff.map((staff) => (\n                        <SelectItem key={staff.id} value={String(staff.id)}>\n                          {staff.name} - {staff.role}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"flex items-center space-x-2\">\n                  <Switch\n                    id=\"primary\"\n                    checked={isPrimary}\n                    onCheckedChange={setIsPrimary}\n                  />\n                  <Label htmlFor=\"primary\">Set as Primary Contact</Label>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"notes\">Notes</Label>\n                  <Textarea\n                    id=\"notes\"\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    placeholder=\"Add any notes about this assignment\"\n                    className=\"min-h-[80px]\"\n                  />\n                </div>\n\n                <div className=\"flex justify-end\">\n                  <Button onClick={handleAddAssignment} disabled={!selectedStaffId}>\n                    Assign\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </CardHeader>\n        <CardContent>\n          {assignments.length > 0 ? (\n            <div className=\"space-y-4\">\n              {assignments.map((assignment) => (\n                <div\n                  key={`${assignment.staffId}-${assignment.assignedAt}`}\n                  className=\"flex items-center justify-between p-4 border rounded-lg\"\n                >\n                  <div className=\"flex items-center gap-4\">\n                    <BadgeCheck className=\"h-5 w-5 text-green-600\" />\n                    <div>\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"font-medium\">{assignment.staffName}</span>\n                        {assignment.isPrimary && (\n                          <Badge variant=\"success\">Primary</Badge>\n                        )}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        Role: {assignment.role}\n                      </div>\n                      {assignment?.email && (\n                        <div className=\"text-sm text-muted-foreground\">\n                          Email: {assignment.email}\n                        </div>\n                      )}\n                      {assignment.notes && (\n                        <div className=\"text-sm text-muted-foreground mt-1\">\n                          Notes: {assignment.notes}\n                        </div>\n                      )}\n                      <div className=\"text-xs text-muted-foreground mt-1 flex items-center gap-1\">\n                        <MapPin className=\"h-3 w-3\" />\n                        Assigned on {formatDate(assignment.assignedAt)}\n                      </div>\n                      {assignment.assignedByName && (\n                        <div className=\"text-xs text-muted-foreground mt-1\">\n                          Assigned by {assignment.assignedByName}{assignment.assignedByRole ? ` (${assignment.assignedByRole})` : ''}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => openEditDialog(assignment)}\n                    >\n                      <Edit className=\"h-4 w-4 mr-1\" /> Edit\n                    </Button>\n                    <Button\n                      variant=\"destructive\"\n                      size=\"sm\"\n                      onClick={() => openRemoveDialog(assignment)}\n                    >\n                      <Trash className=\"h-4 w-4 mr-1\" /> Remove\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <User className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n              <p>No staff assigned to this agent yet</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Edit Assignment Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Assignment</DialogTitle>\n            <DialogDescription>\n              Update primary contact status or add notes.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"flex items-center space-x-2\">\n              <Switch\n                id=\"edit-primary\"\n                checked={isPrimary}\n                onCheckedChange={setIsPrimary}\n              />\n              <Label htmlFor=\"edit-primary\">Primary Contact</Label>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"edit-notes\">Notes</Label>\n              <Textarea\n                id=\"edit-notes\"\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                placeholder=\"Add any notes about this assignment\"\n                className=\"min-h-[80px]\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsEditDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleUpdateAssignment}>Update</Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* Remove Assignment Dialog */}\n      <Dialog open={isRemoveDialogOpen} onOpenChange={setIsRemoveDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Remove Staff Assignment</DialogTitle>\n            <DialogDescription>\n              Are you sure you want to remove {currentAssignment?.staffName} from this agent?\n              This action cannot be undone.\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setIsRemoveDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button variant=\"destructive\" onClick={handleRemoveAssignment}>\n              Remove\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default StaffAssignmentTab;\n","\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport { \n  BarChart3, \n  Calendar, \n  CheckCheck, \n  Clock, \n  FileText, \n  Globe, \n  Mail, \n  MapPin, \n  Phone, \n  PieChart, \n  Star, \n  Users, \n  Building, \n  User,\n  Upload,\n  Trash2\n} from 'lucide-react';\nimport { Switch } from '@/components/ui/switch';\n\nimport { supabase, adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Select, SelectTrigger, SelectContent, SelectItem, SelectValue } from '@/components/ui/select';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { \n  getQueriesByAgentId, \n  getBookingsByAgentId,\n  getCustomersByAgentId,\n  getRecentActivity,\n  getStaffAssignmentsForAgent\n} from '@/data/agentData';\nimport { AgentManagementService } from '@/services/agentManagementService';\nimport { Agent, AgentActivity, Customer } from '@/types/agent';\nimport { Query } from '@/types/query';\nimport StaffAssignmentTab from './components/StaffAssignmentTab';\nimport { useToast } from '@/hooks/use-toast';\nimport type { Agent as UiAgent } from '@/types/agent';\nimport { useAccessControl } from '@/hooks/use-access-control';\n\nconst AgentProfile: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const { isAdmin, isManager, isStaff, hasAdminAccess } = useAccessControl();\n  const canEdit = hasAdminAccess || isStaff;\n  const canDelete = hasAdminAccess;\n  const [agent, setAgent] = useState<UiAgent | null>(null);\n  const [queries, setQueries] = useState<Query[]>([]);\n  const [bookings, setBookings] = useState<any[]>([]);\n  const [customers, setCustomers] = useState<Customer[]>([]);\n  const [recentActivity, setRecentActivity] = useState<AgentActivity[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isEditingDetails, setIsEditingDetails] = useState(false);\n  const [detailsForm, setDetailsForm] = useState({\n    name: '',\n    email: '',\n    phone: '',\n    company_name: '',\n    agency_code: '',\n    city: '',\n    country: '',\n    status: 'active' as 'active' | 'inactive' | 'suspended',\n    type: 'individual' as 'individual' | 'company',\n    commission_type: 'percentage' as 'percentage' | 'flat',\n    commission_value: '' as string | number,\n    // extended optional fields\n    alternate_email: '',\n    business_phone: '',\n    mobile_numbers_text: '',\n    website: '',\n    partnership: '',\n    business_address: '',\n    license_number: '',\n    iata_number: '',\n    specializations_text: ''\n  });\n  const [taxRecords, setTaxRecords] = useState<any[]>([]);\n  const [taxLoading, setTaxLoading] = useState(false);\n  const [editingTax, setEditingTax] = useState<any | null>(null);\n  const { toast } = useToast();\n  const [statusUpdating, setStatusUpdating] = useState(false);\n  const [brandingFiles, setBrandingFiles] = useState<{ name: string; publicUrl: string }[]>([]);\n  const [brandingLoading, setBrandingLoading] = useState(false);\n  const [uploadingDocs, setUploadingDocs] = useState(false);\n  const brandingInputRef = useRef<HTMLInputElement>(null);\n  const profileImageInputRef = useRef<HTMLInputElement>(null);\n  const taxCertInputRef = useRef<HTMLInputElement>(null);\n  const [certTargetRecordId, setCertTargetRecordId] = useState<string | null>(null);\n  const [uploadingTaxCert, setUploadingTaxCert] = useState(false);\n  const [creatorProfile, setCreatorProfile] = useState<{ name?: string; email?: string } | null>(null);\n  const [previewOpen, setPreviewOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<{ name: string; publicUrl: string } | null>(null);\n\n  const loadAgentData = async () => {\n    if (!id) return;\n    setLoading(true);\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { data: agentRow, error } = await client\n        .from('agents')\n        .select('*, agent_tax_info(*)')\n        .eq('id', id)\n        .single();\n      if (error) throw error;\n\n      const a: any = agentRow || {};\n      const uiAgent: UiAgent = {\n        id: Number.isNaN(parseInt(id)) ? 0 : parseInt(id),\n        name: a.name || a.agency_name || '',\n        email: a.email || '',\n        country: a.country || '',\n        city: a.city || '',\n        type: (a.business_type === 'company' ? 'company' : 'individual'),\n        status: (a.status === 'active' ? 'active' : a.status === 'inactive' ? 'inactive' : 'suspended') as any,\n        commissionType: (a?.commission_structure?.type === 'flat' ? 'flat' : 'percentage'),\n        commissionValue: (a?.commission_structure?.value !== undefined && a?.commission_structure?.value !== null) ? String(a.commission_structure.value) : '',\n        profileImage: a.profile_image || undefined,\n        contact: {\n          email: a.email || '',\n          phone: a.business_phone || '',\n          website: a.website || '',\n          address: a.business_address || ''\n        },\n        joinDate: a.created_at || new Date().toISOString(),\n        createdAt: a.created_at || new Date().toISOString(),\n        source: { type: a.source_type || 'website', details: a.source_details || '' },\n        stats: { totalQueries: 0, totalBookings: 0, conversionRate: 0, revenueGenerated: 0, averageBookingValue: 0, activeCustomers: 0 },\n        recentActivity: [],\n        staffAssignments: []\n      };\n      setAgent(uiAgent);\n\n      setDetailsForm(prev => ({\n        ...prev,\n        name: a.name || '',\n        email: a.email || '',\n        phone: a.business_phone || '',\n        company_name: a.agency_name || '',\n        agency_code: a.agency_code || '',\n        city: a.city || '',\n        country: a.country || '',\n        status: (a.status === 'active' ? 'active' : a.status === 'inactive' ? 'inactive' : 'suspended') as any,\n        type: (a.business_type === 'company' ? 'company' : 'individual'),\n        commission_type: (a?.commission_structure?.type === 'flat' ? 'flat' : 'percentage'),\n        commission_value: (a?.commission_structure?.value ?? ''),\n        alternate_email: a.alternate_email || '',\n        business_phone: a.business_phone || '',\n        mobile_numbers_text: Array.isArray(a.mobile_numbers) ? (a.mobile_numbers as string[]).join(', ') : '',\n        website: a.website || '',\n        partnership: a.partnership || '',\n        business_address: a.business_address || '',\n        license_number: a.license_number || '',\n        iata_number: a.iata_number || '',\n        specializations_text: Array.isArray(a.specializations) ? (a.specializations as string[]).join(', ') : ''\n      }));\n\n      const taxRecords = Array.isArray(a.agent_tax_info) ? a.agent_tax_info : a.agent_tax_info ? [a.agent_tax_info] : [];\n      setTaxRecords(taxRecords);\n\n      if (a.created_by) {\n        const { data: creator } = await client.from('profiles').select('name,email').eq('id', a.created_by).single();\n        if (creator) setCreatorProfile(creator as any);\n      } else {\n        setCreatorProfile(null);\n      }\n\n      if (Array.isArray(a.documents) && a.documents.length) {\n        setBrandingFiles(a.documents.map((url: string) => ({ name: url.split('/').pop() || url, publicUrl: url })));\n      } else {\n        await loadBrandingFiles();\n      }\n\n      const agentIdNum = Number.isNaN(parseInt(id)) ? 0 : parseInt(id);\n      setQueries(getQueriesByAgentId(agentIdNum));\n      setBookings(getBookingsByAgentId(agentIdNum));\n      setCustomers(getCustomersByAgentId(agentIdNum));\n      setRecentActivity(getRecentActivity(agentIdNum));\n    } catch (err) {\n      const { data, error } = await AgentManagementService.getAgentById(String(id));\n      if (error) {\n        console.error('Failed to load agent', error);\n      }\n      if (data) {\n        const a = data as any;\n        const uiAgent: UiAgent = {\n          id: Number.isNaN(parseInt(id)) ? 0 : parseInt(id),\n          name: a.name || '',\n          email: a.email || '',\n          country: a.country || '',\n          city: a.city || '',\n          type: (a.type === 'company' ? 'company' : 'individual'),\n          status: (a.status === 'active' ? 'active' : a.status === 'inactive' ? 'inactive' : 'suspended') as any,\n          commissionType: (a.commission_type === 'flat' ? 'flat' : 'percentage'),\n          commissionValue: (a.commission_value !== undefined && a.commission_value !== null) ? String(a.commission_value) : '',\n          profileImage: a.profile_image || undefined,\n          contact: { email: a.email || '', phone: a.phone || '', website: (a as any).website || '', address: (a as any).business_address || '' },\n          joinDate: a.created_at || new Date().toISOString(),\n          createdAt: a.created_at || new Date().toISOString(),\n          source: { type: (a.source_type || 'website'), details: a.source_details || '' },\n          stats: { totalQueries: 0, totalBookings: 0, conversionRate: 0, revenueGenerated: 0, averageBookingValue: 0, activeCustomers: 0 },\n          recentActivity: [],\n          staffAssignments: []\n        };\n        setAgent(uiAgent);\n        const agentIdNum = Number.isNaN(parseInt(id)) ? 0 : parseInt(id);\n        setQueries(getQueriesByAgentId(agentIdNum));\n        setBookings(getBookingsByAgentId(agentIdNum));\n        setCustomers(getCustomersByAgentId(agentIdNum));\n        setRecentActivity(getRecentActivity(agentIdNum));\n        setDetailsForm(prev => ({\n          ...prev,\n          name: a.name || '',\n          email: a.email || '',\n          phone: a.phone || '',\n          company_name: a.company_name || a.agency_name || '',\n          city: a.city || '',\n          country: a.country || '',\n          status: (a.status === 'active' ? 'active' : a.status === 'inactive' ? 'inactive' : 'suspended') as any,\n          type: a.type === 'company' ? 'company' : 'individual',\n          commission_type: a.commission_type === 'flat' ? 'flat' : 'percentage',\n          commission_value: a.commission_value ?? '',\n          alternate_email: (a as any).alternate_email || '',\n          business_phone: (a as any).business_phone || '',\n          mobile_numbers_text: Array.isArray((a as any).mobile_numbers) ? ((a as any).mobile_numbers as string[]).join(', ') : '',\n          website: (a as any).website || '',\n          partnership: (a as any).partnership || '',\n          business_address: (a as any).business_address || '',\n          license_number: (a as any).license_number || '',\n          iata_number: (a as any).iata_number || '',\n          specializations_text: Array.isArray((a as any).specializations) ? ((a as any).specializations as string[]).join(', ') : ''\n        }));\n        try {\n          setTaxLoading(true);\n          const { data: tx } = await AgentManagementService.getAgentTaxInfo(String(id));\n          setTaxRecords(tx || []);\n        } catch {} finally { setTaxLoading(false); }\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadAgentData();\n  }, [id]);\n\n  useEffect(() => {\n    if (id) {\n      loadBrandingFiles();\n    }\n  }, [id]);\n\n  // Handler for when staff assignments change\n  const handleAssignmentChange = () => {\n    loadAgentData();\n  };\n\n  // Branding documents storage helpers\n  const storageClient = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n  const brandingBucket = 'agent_branding';\n  const brandingPrefix = id ? `agents/${id}/docs` : '';\n\n  async function loadBrandingFiles() {\n    if (!id) return;\n    setBrandingLoading(true);\n    try {\n      const { data, error } = await storageClient.storage.from(brandingBucket).list(brandingPrefix, { limit: 100, offset: 0 });\n      if (error) throw error;\n      const files = (data || []).filter((item: any) => item && !String(item.name || '').endsWith('/')).map((item: any) => {\n        const path = `${brandingPrefix}/${item.name}`;\n        const { data: pub } = storageClient.storage.from(brandingBucket).getPublicUrl(path);\n        return { name: item.name as string, publicUrl: pub?.publicUrl as string };\n      });\n      setBrandingFiles(files);\n    } catch (err) {\n      console.error('Failed to load branding files', err);\n    } finally {\n      setBrandingLoading(false);\n    }\n  }\n\n\n\n  if (loading) {\n    return (\n      <PageLayout title=\"Agent Profile\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-gray-500\">Loading agent profile...</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  if (!agent) {\n    return (\n      <PageLayout title=\"Agent Profile\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-red-500\">Agent not found</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  const formatDate = (dateStr: string) => {\n    try {\n      return format(new Date(dateStr), 'dd MMM yyyy');\n    } catch (e) {\n      return dateStr;\n    }\n  };\n\n  const formatDateTime = (dateTimeStr: string) => {\n    try {\n      return format(new Date(dateTimeStr), 'dd MMM yyyy, HH:mm');\n    } catch (e) {\n      return dateTimeStr;\n    }\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);\n  };\n\n  const updateDetailsField = (field: keyof typeof detailsForm, value: any) => {\n    setDetailsForm(prev => ({ ...prev, [field]: value }));\n  };\n\n  const saveDetails = async () => {\n    if (!id) return;\n    const mobileNumbersArray = detailsForm.mobile_numbers_text\n      ? detailsForm.mobile_numbers_text.split(',').map(s => s.trim()).filter(s => s.length > 0)\n      : [];\n    const specializationsArray = detailsForm.specializations_text\n      ? detailsForm.specializations_text.split(',').map(s => s.trim()).filter(s => s.length > 0)\n      : [];\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client.from('agents').update({\n        name: detailsForm.name,\n        email: detailsForm.email,\n        business_phone: detailsForm.business_phone || detailsForm.phone,\n        agency_name: detailsForm.company_name,\n        agency_code: detailsForm.agency_code,\n        country: detailsForm.country,\n        city: detailsForm.city,\n        status: detailsForm.status,\n        business_type: detailsForm.type,\n        commission_type: detailsForm.commission_type,\n        commission_value: detailsForm.commission_value,\n        commission_structure: { type: detailsForm.commission_type, value: Number(detailsForm.commission_value || 0) },\n        alternate_email: detailsForm.alternate_email,\n        website: detailsForm.website,\n        partnership: detailsForm.partnership,\n        business_address: detailsForm.business_address,\n        license_number: detailsForm.license_number,\n        iata_number: detailsForm.iata_number,\n        mobile_numbers: mobileNumbersArray,\n        specializations: specializationsArray,\n        updated_at: new Date().toISOString()\n      }).eq('id', id);\n      if (error) throw error;\n      setIsEditingDetails(false);\n      await loadAgentData();\n    } catch (err) {\n      const { error } = await AgentManagementService.updateAgent({\n        id: String(id),\n        name: detailsForm.name,\n        email: detailsForm.email,\n        phone: detailsForm.phone,\n        company_name: detailsForm.company_name,\n        country: detailsForm.country,\n        city: detailsForm.city,\n        status: detailsForm.status as any,\n        type: detailsForm.type as any,\n        commission_type: detailsForm.commission_type as any,\n        commission_value: detailsForm.commission_value,\n        alternate_email: detailsForm.alternate_email,\n        business_phone: detailsForm.business_phone,\n        website: detailsForm.website,\n        partnership: detailsForm.partnership,\n        business_address: detailsForm.business_address,\n        license_number: detailsForm.license_number,\n        iata_number: detailsForm.iata_number,\n        mobile_numbers: mobileNumbersArray,\n        specializations: specializationsArray,\n      } as any);\n      if (!error) {\n        setIsEditingDetails(false);\n        await loadAgentData();\n      } else {\n        console.error('Failed to save agent details', error);\n      }\n    }\n  };\n\n  const saveTaxRecord = async () => {\n    if (!id || !editingTax) return;\n    const payload = { ...editingTax, agent_id: String(id) };\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      if (editingTax.id) {\n        const { error } = await client.from('agent_tax_info').update({\n          tax_country: editingTax.tax_country,\n          tax_type: editingTax.tax_type,\n          tax_number: editingTax.tax_number,\n          pan_number: editingTax.pan_number,\n          gst_number: editingTax.gst_number,\n          vat_number: editingTax.vat_number,\n          tax_certificate_url: editingTax.tax_certificate_url,\n          tax_registered: editingTax.tax_registered,\n          tax_verified: editingTax.tax_verified,\n          tax_notes: editingTax.tax_notes,\n          updated_at: new Date().toISOString()\n        }).eq('id', editingTax.id);\n        if (error) throw error;\n      } else {\n        const { error } = await client.from('agent_tax_info').insert(payload);\n        if (error) throw error;\n      }\n      const { data } = await AgentManagementService.getAgentTaxInfo(String(id));\n      setTaxRecords(data || []);\n      setEditingTax(null);\n    } catch (err) {\n      const { error } = await AgentManagementService.upsertAgentTaxInfo(String(id), payload);\n      if (!error) {\n        const { data } = await AgentManagementService.getAgentTaxInfo(String(id));\n        setTaxRecords(data || []);\n        setEditingTax(null);\n      } else {\n        console.error('Failed to save tax info', error);\n      }\n    }\n  };\n\n  const handleStatusChange = async (newStatus: 'active' | 'inactive' | 'suspended') => {\n    if (!id) return;\n    try {\n      setStatusUpdating(true);\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client.from('agents').update({ status: newStatus, updated_at: new Date().toISOString() }).eq('id', id);\n      if (error) throw error;\n      setAgent(prev => prev ? { ...prev, status: newStatus as any } : prev);\n      setDetailsForm(prev => ({ ...prev, status: newStatus as any }));\n      toast({ title: 'Status updated', description: `Agent is now ${newStatus}` });\n    } catch (err) {\n      const { error } = await AgentManagementService.updateAgent({ id: String(id), status: newStatus } as any);\n      if (error) {\n        console.error('Failed to update status', error);\n        toast({ title: 'Status update failed', description: String((error as any)?.message || error), variant: 'destructive' });\n      } else {\n        setAgent(prev => prev ? { ...prev, status: newStatus as any } : prev);\n        setDetailsForm(prev => ({ ...prev, status: newStatus as any }));\n        toast({ title: 'Status updated', description: `Agent is now ${newStatus}` });\n      }\n    } finally {\n      setStatusUpdating(false);\n    }\n  };\n\n  const handleDeleteAgent = async () => {\n    if (!id || !canDelete) return;\n    const confirmed = window.confirm('This will permanently delete the agent. Continue?');\n    if (!confirmed) return;\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client.from('agents').delete().eq('id', id);\n      if (error) throw error;\n      toast({ title: 'Agent deleted' });\n      navigate('/management/agents');\n    } catch (err) {\n      console.error('Delete failed', err);\n      toast({ title: 'Delete failed', description: (err as any)?.message || 'Could not delete agent', variant: 'destructive' });\n    }\n  };\n\n  const handleUploadProfileImage = async (file: File) => {\n    if (!id) return;\n    setUploadingDocs(true);\n    try {\n      const storage = (isAdminClientConfigured && adminSupabase) ? adminSupabase.storage : supabase.storage;\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const safeName = `${crypto.randomUUID()}-${file.name}`.replace(/\\s+/g, '_');\n      const path = `agents/${id}/logo/${safeName}`;\n      // Resolve content type from file or extension\n      const ext = file.name.split('.').pop()?.toLowerCase() || '';\n      let contentType = file.type || '';\n      if (!contentType) {\n        if (ext === 'png') contentType = 'image/png';\n        else if (ext === 'jpg' || ext === 'jpeg') contentType = 'image/jpeg';\n        else if (ext === 'webp') contentType = 'image/webp';\n        else contentType = 'image/png';\n      }\n      const res = await storage.from(brandingBucket).upload(path, file, { upsert: true, contentType });\n      if (res.error) throw res.error;\n      const { data: pub } = storage.from(brandingBucket).getPublicUrl(path);\n      const { error } = await client.from('agents').update({ profile_image: pub.publicUrl, updated_at: new Date().toISOString() }).eq('id', id);\n      if (error) throw error;\n      toast({ title: 'Profile image updated' });\n      await loadAgentData();\n    } catch (err) {\n      console.error('Profile image upload failed', err);\n      toast({ title: 'Upload failed', description: (err as any)?.message || 'Could not upload profile image', variant: 'destructive' });\n    } finally {\n      setUploadingDocs(false);\n    }\n  };\n\n  const handleRemoveProfileImage = async () => {\n    if (!id) return;\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const currentUrl = agent?.profileImage || '';\n      if (currentUrl) {\n        try {\n          const marker = '/storage/v1/object/public/';\n          const idx = currentUrl.indexOf(marker);\n          if (idx >= 0) {\n            const after = currentUrl.substring(idx + marker.length);\n            const [bucket, ...rest] = after.split('/');\n            const key = rest.join('/');\n            if (bucket === brandingBucket && key.startsWith(`agents/${id}/logo/`)) {\n              await storageClient.storage.from(bucket).remove([key]);\n            }\n          }\n        } catch (parseErr) {\n          console.warn('Logo delete parse error:', parseErr);\n        }\n      }\n      const { error } = await client.from('agents').update({ profile_image: null, updated_at: new Date().toISOString() }).eq('id', id);\n      if (error) throw error;\n      await loadAgentData();\n      toast({ title: 'Logo removed' });\n    } catch (err) {\n      console.error('Remove logo failed', err);\n      toast({ title: 'Remove failed', description: (err as any)?.message || 'Could not remove logo', variant: 'destructive' });\n    }\n  };\n\n  async function handleUploadDocuments(e: React.ChangeEvent<HTMLInputElement>) {\n    const files = e.target.files;\n    if (!id || !files || files.length === 0) return;\n    setUploadingDocs(true);\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const newUrls: string[] = [];\n      for (const file of Array.from(files)) {\n        const safeName = `${crypto.randomUUID()}-${file.name}`.replace(/\\s+/g, '_');\n        const fullPath = `${brandingPrefix}/${safeName}`;\n        // Resolve content type from file or extension\n        const ext = file.name.split('.').pop()?.toLowerCase() || '';\n        let contentType = file.type || '';\n        if (!contentType) {\n          if (ext === 'pdf') contentType = 'application/pdf';\n          else if (ext === 'png') contentType = 'image/png';\n          else if (ext === 'jpg' || ext === 'jpeg') contentType = 'image/jpeg';\n          else if (ext === 'webp') contentType = 'image/webp';\n          else contentType = 'application/octet-stream';\n        }\n        const { error } = await storageClient.storage.from(brandingBucket).upload(fullPath, file, { upsert: true, contentType });\n        if (error) throw error;\n        const { data: pub } = storageClient.storage.from(brandingBucket).getPublicUrl(fullPath);\n        if (pub?.publicUrl) newUrls.push(pub.publicUrl);\n      }\n      // Sync agents.documents array with newly uploaded public URLs\n      const { data: docRow } = await client.from('agents').select('documents').eq('id', id).single();\n      const existingDocs: string[] = Array.isArray(docRow?.documents) ? (docRow!.documents as string[]) : [];\n      const updatedDocs = Array.from(new Set([ ...existingDocs, ...newUrls ]));\n      const { error: updErr } = await client.from('agents').update({ documents: updatedDocs, updated_at: new Date().toISOString() }).eq('id', id);\n      if (updErr) throw updErr;\n      await loadBrandingFiles();\n      toast({ title: 'Documents uploaded', description: `${newUrls.length} file(s) added.` });\n    } catch (err: any) {\n      console.error('Upload failed', err);\n      const msg = String(err?.message || '').toLowerCase();\n      if (msg.includes('bucket') || msg.includes('not found')) {\n        toast({ title: 'Branding bucket missing', description: 'Create bucket \"agent_branding\" or run migrations.', variant: 'destructive' });\n      } else if (msg.includes('policy')) {\n        toast({ title: 'Storage write blocked', description: 'Configure admin client or adjust RLS to allow writes.', variant: 'destructive' });\n      } else {\n        toast({ title: 'Upload failed', description: err?.message || 'Could not upload documents', variant: 'destructive' });\n      }\n    } finally {\n      setUploadingDocs(false);\n      if (brandingInputRef.current) brandingInputRef.current.value = '';\n    }\n  }\n\n  async function handleDeleteDocument(name: string) {\n    if (!id) return;\n    try {\n      const path = `${brandingPrefix}/${name}`;\n      const { error } = await storageClient.storage.from(brandingBucket).remove([path]);\n      if (error) throw error;\n      // Remove from agents.documents\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { data: pub } = storageClient.storage.from(brandingBucket).getPublicUrl(path);\n      const publicUrl = pub?.publicUrl;\n      const { data: docRow } = await client.from('agents').select('documents').eq('id', id).single();\n      const existingDocs: string[] = Array.isArray(docRow?.documents) ? (docRow!.documents as string[]) : [];\n      const filteredDocs = existingDocs.filter(u => {\n        const tail = u.split('/').pop();\n        return tail !== name && u !== publicUrl;\n      });\n      const { error: updErr } = await client.from('agents').update({ documents: filteredDocs, updated_at: new Date().toISOString() }).eq('id', id);\n      if (updErr) throw updErr;\n      await loadBrandingFiles();\n      toast({ title: 'Document deleted' });\n    } catch (err) {\n      console.error('Delete failed', err);\n      toast({ title: 'Delete failed', description: (err as any)?.message || 'Could not delete document', variant: 'destructive' });\n    }\n  }\n\n  // === Tax Certificate Upload/Delete Helpers ===\n  async function onTaxCertFileSelected(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    try {\n      setUploadingTaxCert(true);\n      const taxBucket = brandingBucket;\n      const taxPrefix = id ? `agents/${id}/tax` : '';\n      const fileName = `${Date.now()}-${file.name}`;\n      const fullPath = `${taxPrefix}/${fileName}`;\n      // Resolve content type to prevent ORB issues on images/PDFs\n      const ext = file.name.split('.').pop()?.toLowerCase() || '';\n      let contentType = file.type || '';\n      if (!contentType) {\n        if (ext === 'pdf') contentType = 'application/pdf';\n        else if (ext === 'png') contentType = 'image/png';\n        else if (ext === 'jpg' || ext === 'jpeg') contentType = 'image/jpeg';\n        else if (ext === 'webp') contentType = 'image/webp';\n        else contentType = 'application/octet-stream';\n      }\n      const { error: upErr } = await storageClient.storage.from(taxBucket).upload(fullPath, file, { upsert: true, contentType });\n      if (upErr) throw upErr;\n      const { data: pub } = storageClient.storage.from(taxBucket).getPublicUrl(fullPath);\n      const publicUrl = pub?.publicUrl as string;\n      // If we have a specific record target, update that record immediately\n      if (certTargetRecordId) {\n        const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n        const { error } = await client\n          .from('agent_tax_info')\n          .update({ tax_certificate_url: publicUrl, updated_at: new Date().toISOString() })\n          .eq('id', certTargetRecordId);\n        if (error) throw error;\n        const { data } = await AgentManagementService.getAgentTaxInfo(String(id));\n        setTaxRecords(data || []);\n        toast({ title: 'Certificate updated' });\n      } else if (editingTax) {\n        // Otherwise, attach to the editing record (persisted on Save)\n        setEditingTax({ ...editingTax, tax_certificate_url: publicUrl });\n        toast({ title: 'Certificate uploaded', description: 'Save to persist changes' });\n      }\n    } catch (err) {\n      console.error('Certificate upload failed', err);\n      toast({ title: 'Upload failed', description: (err as any)?.message || 'Could not upload certificate', variant: 'destructive' });\n    } finally {\n      setUploadingTaxCert(false);\n      if (taxCertInputRef.current) taxCertInputRef.current.value = '';\n      setCertTargetRecordId(null);\n    }\n  }\n\n  async function handleDeleteTaxCertificate(rec: any) {\n    if (!id || !rec?.id || !rec?.tax_certificate_url) return;\n    try {\n      // Try to parse bucket/path from public URL\n      const url = String(rec.tax_certificate_url);\n      let bucket = brandingBucket;\n      let path = '';\n      const marker = '/object/public/';\n      const idx = url.indexOf(marker);\n      if (idx >= 0) {\n        const rest = url.slice(idx + marker.length);\n        const firstSlash = rest.indexOf('/');\n        if (firstSlash > 0) {\n          bucket = rest.slice(0, firstSlash);\n          path = rest.slice(firstSlash + 1);\n        }\n      }\n      // If path couldn't be parsed, fallback to expected tax path prefix\n      if (!path) {\n        const name = url.split('/').pop() as string;\n        path = `agents/${id}/tax/${name}`;\n      }\n      const { error: rmErr } = await storageClient.storage.from(bucket).remove([path]);\n      if (rmErr) throw rmErr;\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client\n        .from('agent_tax_info')\n        .update({ tax_certificate_url: null, updated_at: new Date().toISOString() })\n        .eq('id', rec.id);\n      if (error) throw error;\n      const { data } = await AgentManagementService.getAgentTaxInfo(String(id));\n      setTaxRecords(data || []);\n      toast({ title: 'Certificate deleted' });\n    } catch (err) {\n      console.error('Certificate delete failed', err);\n      toast({ title: 'Delete failed', description: (err as any)?.message || 'Could not delete certificate', variant: 'destructive' });\n    }\n  }\n\n  async function handleToggleTaxVerified(rec: any, value: boolean) {\n    if (!id || !rec?.id) return;\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client\n        .from('agent_tax_info')\n        .update({ tax_verified: value, updated_at: new Date().toISOString() })\n        .eq('id', rec.id);\n      if (error) throw error;\n      setTaxRecords(prev => prev.map(r => (String(r.id) === String(rec.id) ? { ...r, tax_verified: value } : r)));\n      toast({ title: 'Verification updated', description: value ? 'Marked as VERIFIED' : 'Marked as UNVERIFIED' });\n    } catch (err) {\n      console.error('Toggle verify failed', err);\n      toast({ title: 'Update failed', description: (err as any)?.message || 'Could not update verification', variant: 'destructive' });\n    }\n  }\n\n  async function verifyLatestTaxRecord() {\n    if (!id || taxRecords.length === 0) return;\n    const latest = taxRecords[0];\n    try {\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const { error } = await client.from('agent_tax_info').update({ tax_verified: true, updated_at: new Date().toISOString() }).eq('id', latest.id);\n      if (error) throw error;\n      const { data } = await AgentManagementService.getAgentTaxInfo(String(id));\n      setTaxRecords(data || []);\n      toast({ title: 'Tax Info verified' });\n    } catch (err) {\n      toast({ title: 'Verify failed', description: (err as any)?.message || 'Could not verify tax info', variant: 'destructive' });\n    }\n  }\n\n  if (loading) {\n    return (\n      <PageLayout title=\"Agent Profile\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-gray-500\">Loading agent profile...</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  if (!agent) {\n    return (\n      <PageLayout title=\"Agent Profile\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-red-500\">Agent not found</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout\n      title=\"Agent Profile\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Agent Management\", href: \"/management/agents\" },\n        { title: agent.name, href: `/management/agents/${id}` },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        {/* Agent Header */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex flex-col md:flex-row gap-6 items-start md:items-center\">\n              {agent.type === 'company' && agent.profileImage ? (\n                <div className=\"h-24 w-24 border rounded bg-white flex items-center justify-center overflow-hidden\">\n                  <img src={agent.profileImage} alt={`${agent.name} logo`} className=\"max-h-full max-w-full object-contain\" />\n                </div>\n              ) : (\n                <Avatar className=\"h-24 w-24 border\">\n                  {agent.profileImage ? (\n                    <AvatarImage src={agent.profileImage} alt={agent.name} />\n                  ) : (\n                    <AvatarFallback className=\"text-3xl\">\n                      {agent.type === 'company' ? \n                        <Building className=\"h-12 w-12\" /> : \n                        <User className=\"h-12 w-12\" />\n                      }\n                    </AvatarFallback>\n                  )}\n                </Avatar>\n              )}\n              <div className=\"flex-1\">\n                <div className=\"flex flex-col md:flex-row justify-between\">\n                  <div>\n                    <h2 className=\"text-2xl font-bold\">{agent.name}</h2>\n                    <div className=\"flex items-center gap-2 text-muted-foreground mt-1\">\n                      <Globe className=\"h-4 w-4\" />\n                      <span>{agent.city}, {agent.country}</span>\n                    </div>\n                    <div className=\"text-xs text-muted-foreground mt-1\">\n                      Created: {formatDateTime(agent.createdAt)}\n                    </div>\n                    {creatorProfile && (\n                      <div className=\"text-xs text-muted-foreground mt-1\">\n                        Created by {creatorProfile.name || creatorProfile.email}\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex flex-col items-start md:items-end mt-2 md:mt-0 space-y-2\">\n                    <Badge variant={agent.status === 'active' ? 'success' : 'secondary'}>\n                      {agent.status === 'active' ? 'Active' : agent.status === 'inactive' ? 'Inactive' : 'Suspended'}\n                    </Badge>\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-xs text-muted-foreground\">Status</span>\n                      <Switch\n                        checked={agent.status === 'active'}\n                        onCheckedChange={(checked) => handleStatusChange(checked ? 'active' : 'inactive')}\n                        disabled={statusUpdating}\n                      />\n                      <span className=\"text-xs\">{agent.status === 'active' ? 'Active' : 'Inactive'}</span>\n                      {statusUpdating && <span className=\"text-xs text-muted-foreground\">Updating...</span>}\n                    </div>\n                    <div className=\"text-sm text-muted-foreground flex items-center\">\n                      <Calendar className=\"h-4 w-4 mr-1\" />\n                      <span>Joined: {formatDate(agent.joinDate)}</span>\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <Mail className=\"h-4 w-4 text-muted-foreground\" />\n                      <a href={`mailto:${agent.contact.email}`} className=\"text-sm hover:underline\">\n                        {agent.contact.email}\n                      </a>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Phone className=\"h-4 w-4 text-muted-foreground\" />\n                      <a href={`tel:${agent.contact.phone}`} className=\"text-sm hover:underline\">\n                        {agent.contact.phone}\n                      </a>\n                    </div>\n                    {agent.contact.website && (\n                      <div className=\"flex items-center gap-2\">\n                        <Globe className=\"h-4 w-4 text-muted-foreground\" />\n                        <a href={`https://${agent.contact.website}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-sm hover:underline\">\n                          {agent.contact.website}\n                        </a>\n                      </div>\n                    )}\n                  </div>\n                  <div>\n                    {agent.contact.address && (\n                      <div className=\"flex items-start gap-2\">\n                        <MapPin className=\"h-4 w-4 text-muted-foreground mt-1\" />\n                        <span className=\"text-sm\">{agent.contact.address}</span>\n                      </div>\n                    )}\n                    <div className=\"flex items-center gap-2 mt-2\">\n                      <Star className=\"h-4 w-4 text-muted-foreground\" />\n                      <span className=\"text-sm\">\n                        Commission: {agent.commissionValue} ({agent.commissionType})\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-2 mt-2\">\n                      <Users className=\"h-4 w-4 text-muted-foreground\" />\n                      <span className=\"text-sm capitalize\">\n                        Type: {agent.type}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Performance Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Performance Overview</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-muted-foreground\">Conversion Rate</span>\n                    <span className=\"text-sm font-medium\">{agent.stats.conversionRate}%</span>\n                  </div>\n                  <Progress value={agent.stats.conversionRate} className=\"h-2 mt-1\" />\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-muted-foreground\">Total Queries</span>\n                    <span className=\"text-2xl font-bold\">{agent.stats.totalQueries}</span>\n                  </div>\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-muted-foreground\">Confirmed Bookings</span>\n                    <span className=\"text-2xl font-bold\">{agent.stats.totalBookings}</span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Revenue Generated</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-col\">\n                <span className=\"text-3xl font-bold\">\n                  {formatCurrency(agent.stats.revenueGenerated)}\n                </span>\n                <span className=\"text-sm text-muted-foreground mt-2\">\n                  Avg. Booking Value: {formatCurrency(agent.stats.averageBookingValue)}\n                </span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Customer Base</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-col\">\n                <span className=\"text-3xl font-bold\">{agent.stats.activeCustomers}</span>\n                <span className=\"text-sm text-muted-foreground mt-2\">Active customers</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tabs */}\n        <Tabs defaultValue=\"queries\">\n          <TabsList>\n            <TabsTrigger value=\"details\">Details</TabsTrigger>\n            <TabsTrigger value=\"tax\">Tax Info</TabsTrigger>\n            <TabsTrigger value=\"queries\">Queries</TabsTrigger>\n            <TabsTrigger value=\"bookings\">Bookings</TabsTrigger>\n            <TabsTrigger value=\"customers\">Customers</TabsTrigger>\n            <TabsTrigger value=\"activity\">Recent Activity</TabsTrigger>\n            <TabsTrigger value=\"staff\">Staff Assignment</TabsTrigger>\n            <TabsTrigger value=\"preview\">Preview</TabsTrigger>\n          </TabsList>\n\n          {/* Preview Tab */}\n          <TabsContent value=\"preview\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Profile Preview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex items-start gap-4\">\n                  <Avatar className=\"h-16 w-16\">\n                    <AvatarImage src={agent.profileImage || ''} alt={agent.name} />\n                    <AvatarFallback>\n                      {agent.type === 'company' ? <Building className=\"h-6 w-6\" /> : <User className=\"h-6 w-6\" />}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <h3 className=\"text-xl font-semibold\">{agent.name}</h3>\n                      <Badge variant=\"outline\" className=\"capitalize\">{agent.status}</Badge>\n                    </div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {agent.city && agent.country ? `${agent.city}, ${agent.country}` : (agent.country || agent.city || '')}\n                    </div>\n                    <div className=\"mt-3 grid grid-cols-1 md:grid-cols-2 gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Mail className=\"h-4 w-4 text-muted-foreground\" />\n                        <span className=\"text-sm\">{agent.contact.email}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Phone className=\"h-4 w-4 text-muted-foreground\" />\n                        <span className=\"text-sm\">{agent.contact.phone}</span>\n                      </div>\n                    </div>\n                    <div className=\"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Building className=\"h-4 w-4 text-muted-foreground\" />\n                        <span className=\"text-sm\">{agent.type === 'company' ? (agent.contact.website || 'Company') : 'Individual'}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Star className=\"h-4 w-4 text-muted-foreground\" />\n                        <span className=\"text-sm\">Commission: {agent.commissionValue} ({agent.commissionType})</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Details Tab */}\n          <TabsContent value=\"details\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2 flex flex-row items-center justify-between\">\n                <CardTitle>Agent Details</CardTitle>\n                <div className=\"flex gap-2\">\n                  {!isEditingDetails ? (\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => setIsEditingDetails(true)}>\n                      Edit\n                    </Button>\n                  ) : (\n                    <>\n                      <Button size=\"sm\" onClick={saveDetails}>Save</Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setIsEditingDetails(false)}>Cancel</Button>\n                    </>\n                  )}\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <Label>Name</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.name} onChange={e => updateDetailsField('name', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.name || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Email</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.email} onChange={e => updateDetailsField('email', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.email || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Phone</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.phone} onChange={e => updateDetailsField('phone', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.phone || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Company Name</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.company_name} onChange={e => updateDetailsField('company_name', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.company_name || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>City</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.city} onChange={e => updateDetailsField('city', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.city || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Country</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.country} onChange={e => updateDetailsField('country', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.country || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Status</Label>\n                    {isEditingDetails ? (\n                      <Select value={detailsForm.status} onValueChange={(v) => updateDetailsField('status', v as any)}>\n                        <SelectTrigger className=\"w-full\">\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"active\">Active</SelectItem>\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    ) : <div className=\"mt-2 capitalize\">{detailsForm.status}</div>}\n                  </div>\n                  <div>\n                    <Label>Type</Label>\n                    {isEditingDetails ? (\n                      <Select value={detailsForm.type} onValueChange={(v) => updateDetailsField('type', v as any)}>\n                        <SelectTrigger className=\"w-full\">\n                          <SelectValue placeholder=\"Select type\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"individual\">Individual</SelectItem>\n                          <SelectItem value=\"company\">Company</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    ) : <div className=\"mt-2 capitalize\">{detailsForm.type}</div>}\n                  </div>\n                  <div>\n                    <Label>Commission Type</Label>\n                    {isEditingDetails ? (\n                      <Select value={detailsForm.commission_type} onValueChange={(v) => updateDetailsField('commission_type', v as any)}>\n                        <SelectTrigger className=\"w-full\">\n                          <SelectValue placeholder=\"Select commission type\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"percentage\">Percentage</SelectItem>\n                          <SelectItem value=\"flat\">Flat</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    ) : <div className=\"mt-2 capitalize\">{detailsForm.commission_type}</div>}\n                  </div>\n                  <div>\n                    <Label>Commission Value</Label>\n                    {isEditingDetails ? (\n                      <Input type=\"number\" step=\"0.01\" min=\"0\" value={String(detailsForm.commission_value || '')} onChange={e => updateDetailsField('commission_value', e.target.value)} />\n                    ) : <div className=\"mt-2\">{String(detailsForm.commission_value || '')}</div>}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Personal & Business Details</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <Label>Alternate Email</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.alternate_email} onChange={e => updateDetailsField('alternate_email', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.alternate_email || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Business Phone</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.business_phone} onChange={e => updateDetailsField('business_phone', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.business_phone || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Mobile Numbers</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.mobile_numbers_text} onChange={e => updateDetailsField('mobile_numbers_text', e.target.value)} placeholder=\"Comma-separated\" />\n                    ) : <div className=\"mt-2\">{detailsForm.mobile_numbers_text || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Website</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.website} onChange={e => updateDetailsField('website', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.website || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>Partnership</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.partnership} onChange={e => updateDetailsField('partnership', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.partnership || '-'}</div>}\n                  </div>\n                  <div className=\"md:col-span-2\">\n                    <Label>Business Address</Label>\n                    {isEditingDetails ? (\n                      <Textarea value={detailsForm.business_address} onChange={e => updateDetailsField('business_address', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.business_address || '-'}</div>}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Business Information</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <Label>Agency Code</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.agency_code} onChange={e => updateDetailsField('agency_code', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.agency_code || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>License Number</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.license_number} onChange={e => updateDetailsField('license_number', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.license_number || '-'}</div>}\n                  </div>\n                  <div>\n                    <Label>IATA Number</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.iata_number} onChange={e => updateDetailsField('iata_number', e.target.value)} />\n                    ) : <div className=\"mt-2\">{detailsForm.iata_number || '-'}</div>}\n                  </div>\n                  <div className=\"md:col-span-2\">\n                    <Label>Specializations</Label>\n                    {isEditingDetails ? (\n                      <Input value={detailsForm.specializations_text} onChange={e => updateDetailsField('specializations_text', e.target.value)} placeholder=\"Comma-separated (e.g., flights, hotels)\" />\n                    ) : <div className=\"mt-2\">{detailsForm.specializations_text || '-'}</div>}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"pb-2 flex items-center justify-between\">\n                <CardTitle>Branding & Company Documents</CardTitle>\n                <div className=\"flex items-center gap-3\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={agent.profileImage || ''} alt={agent.name} />\n                    <AvatarFallback>{agent.type === 'company' ? <Building className=\"h-4 w-4\" /> : <User className=\"h-4 w-4\" />}</AvatarFallback>\n                  </Avatar>\n                  {isEditingDetails && (\n                    <>\n                      <input ref={profileImageInputRef} type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={e => { const f = e.target.files?.[0]; if (f) handleUploadProfileImage(f); }} />\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => profileImageInputRef.current?.click()} disabled={uploadingDocs}>\n                        Update Logo\n                      </Button>\n                      <Button size=\"sm\" variant=\"destructive\" onClick={handleRemoveProfileImage} disabled={uploadingDocs}>\n                        Remove Logo\n                      </Button>\n                    </>\n                  )}\n                  <input ref={brandingInputRef} type=\"file\" multiple className=\"hidden\" onChange={handleUploadDocuments} />\n                  <Button size=\"sm\" onClick={() => brandingInputRef.current?.click()} disabled={uploadingDocs}>\n                    <Upload className=\"h-4 w-4 mr-1\" />\n                    {uploadingDocs ? 'Uploading...' : 'Upload'}\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {brandingLoading ? (\n                  <div className=\"text-sm text-muted-foreground\">Loading documents...</div>\n                ) : brandingFiles.length === 0 ? (\n                  <div className=\"text-sm text-muted-foreground\">No branding documents uploaded.</div>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {brandingFiles.map((f) => (\n                      <div key={f.name} className=\"flex items-center justify-between p-2 border rounded\">\n                        <div className=\"flex items-center gap-2\">\n                          <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                          <a href={f.publicUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-sm hover:underline\">{f.name}</a>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"secondary\"\n                            size=\"sm\"\n                            onClick={() => {\n                              setPreviewItem(f);\n                              setPreviewOpen(true);\n                            }}\n                          >\n                            Preview\n                          </Button>\n                          <Button variant=\"outline\" size=\"sm\" onClick={() => handleDeleteDocument(f.name)}>\n                            Delete\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n              {/* Preview Dialog */}\n              <Dialog open={previewOpen} onOpenChange={setPreviewOpen}>\n                <DialogContent className=\"max-w-3xl\">\n                  <DialogHeader>\n                    <DialogTitle className=\"truncate\">\n                      {previewItem?.name || 'Preview'}\n                    </DialogTitle>\n                    <DialogDescription>\n                      Preview of the selected branding file\n                    </DialogDescription>\n                  </DialogHeader>\n                  <div className=\"mt-2\">\n                    {(() => {\n                      const name = previewItem?.name || '';\n                      const url = previewItem?.publicUrl || '';\n                      const ext = name.split('.').pop()?.toLowerCase() || '';\n                      const isImage = ['png', 'jpg', 'jpeg', 'gif', 'webp'].includes(ext);\n                      const isPdf = ext === 'pdf';\n                      if (isImage) {\n                        return (\n                          <img\n                            src={url}\n                            alt={name}\n                            className=\"max-h-[70vh] w-auto mx-auto rounded border\"\n                          />\n                        );\n                      }\n                      if (isPdf) {\n                        return (\n                          <iframe\n                            src={url}\n                            title={name}\n                            className=\"w-full h-[70vh] rounded border\"\n                          />\n                        );\n                      }\n                      return (\n                        <div className=\"text-sm text-muted-foreground\">\n                          Preview not available for this file type.{' '}\n                          <a\n                            href={url}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"underline\"\n                          >\n                            Open in new tab\n                          </a>\n                        </div>\n                      );\n                    })()}\n                  </div>\n                </DialogContent>\n              </Dialog>\n            </Card>\n          </TabsContent>\n\n          {/* Tax Info Tab */}\n          <TabsContent value=\"tax\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2 flex items-center justify-between\">\n                <CardTitle>Tax Information</CardTitle>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setEditingTax(taxRecords[0] || { agent_id: id })}>\n                    {taxRecords.length > 0 ? 'Edit Latest' : 'Add New'}\n                  </Button>\n                  {taxRecords.length > 0 && !editingTax && (\n                    <Button variant=\"secondary\" size=\"sm\" onClick={verifyLatestTaxRecord}>\n                      Verify Latest\n                    </Button>\n                  )}\n                  {editingTax && (\n                    <>\n                      <Button size=\"sm\" onClick={saveTaxRecord}>Save</Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => setEditingTax(null)}>Cancel</Button>\n                    </>\n                  )}\n                </div>\n              </CardHeader>\n              <CardContent>\n                {/* Hidden input used for certificate uploads (both edit and per-card update) */}\n                <input ref={taxCertInputRef} type=\"file\" className=\"hidden\" accept=\".pdf,image/*\" onChange={onTaxCertFileSelected} />\n                {editingTax ? (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label>Tax Country</Label>\n                      <Input value={editingTax.tax_country || ''} onChange={e => setEditingTax({ ...editingTax, tax_country: e.target.value })} />\n                    </div>\n                    <div>\n                      <Label>Tax Type</Label>\n                      <Input value={editingTax.tax_type || ''} onChange={e => setEditingTax({ ...editingTax, tax_type: e.target.value })} />\n                    </div>\n                    <div>\n                      <Label>Tax Number</Label>\n                      <Input value={editingTax.tax_number || ''} onChange={e => setEditingTax({ ...editingTax, tax_number: e.target.value })} />\n                    </div>\n                    <div>\n                      <Label>GST Number</Label>\n                      <Input value={editingTax.gst_number || ''} onChange={e => setEditingTax({ ...editingTax, gst_number: e.target.value })} />\n                    </div>\n                    <div>\n                      <Label>PAN Number</Label>\n                      <Input value={editingTax.pan_number || ''} onChange={e => setEditingTax({ ...editingTax, pan_number: e.target.value })} />\n                    </div>\n                    <div>\n                      <Label>VAT Number</Label>\n                      <Input value={editingTax.vat_number || ''} onChange={e => setEditingTax({ ...editingTax, vat_number: e.target.value })} />\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label>Notes</Label>\n                      <Textarea value={editingTax.tax_notes || ''} onChange={e => setEditingTax({ ...editingTax, tax_notes: e.target.value })} />\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label>Tax Certificate</Label>\n                      {editingTax.tax_certificate_url ? (\n                        <div className=\"flex items-center justify-between p-2 border rounded mt-2\">\n                          <div className=\"flex items-center gap-2\">\n                            <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                            <a href={editingTax.tax_certificate_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-sm hover:underline\">View Certificate</a>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Button variant=\"outline\" size=\"sm\" onClick={() => { setCertTargetRecordId(editingTax.id || null); taxCertInputRef.current?.click(); }} disabled={uploadingTaxCert}>\n                              {uploadingTaxCert ? 'Uploading...' : 'Update'}\n                            </Button>\n                            <Button variant=\"outline\" size=\"sm\" onClick={() => handleDeleteTaxCertificate(editingTax)}>\n                              Delete\n                            </Button>\n                          </div>\n                        </div>\n                      ) : (\n                        <div className=\"mt-2\">\n                          <Button variant=\"outline\" size=\"sm\" onClick={() => { setCertTargetRecordId(null); taxCertInputRef.current?.click(); }} disabled={uploadingTaxCert}>\n                            {uploadingTaxCert ? 'Uploading...' : 'Upload Certificate'}\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    {taxLoading && <div className=\"text-sm text-muted-foreground\">Loading tax records...</div>}\n                    {!taxLoading && taxRecords.length === 0 && (\n                      <div className=\"text-sm text-muted-foreground\">No tax records found.</div>\n                    )}\n                    {!taxLoading && taxRecords.length > 0 && (\n                      <div className=\"space-y-4\">\n                        {taxRecords.map((rec, idx) => (\n                          <Card key={rec.id || idx}>\n                            <CardHeader className=\"pb-2\">\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"flex items-center gap-3\">\n                                  <Badge variant={rec.tax_verified ? 'success' : 'secondary'}>\n                                    {rec.tax_verified ? 'Verified' : 'Unverified'}\n                                  </Badge>\n                                  <div className=\"flex items-center gap-2 text-sm\">\n                                    <span>Verified</span>\n                                    <Switch checked={!!rec.tax_verified} onCheckedChange={(v) => handleToggleTaxVerified(rec, v)} />\n                                  </div>\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                  {rec.tax_certificate_url ? (\n                                    <>\n                                      <a href={rec.tax_certificate_url} target=\"_blank\" rel=\"noopener noreferrer\">\n                                        <Button variant=\"outline\" size=\"sm\">\n                                          Preview\n                                        </Button>\n                                      </a>\n                                      <Button variant=\"outline\" size=\"sm\" onClick={() => { setCertTargetRecordId(rec.id || null); taxCertInputRef.current?.click(); }} disabled={uploadingTaxCert}>\n                                        {uploadingTaxCert ? 'Uploading...' : 'Update'}\n                                      </Button>\n                                      <Button variant=\"outline\" size=\"sm\" onClick={() => handleDeleteTaxCertificate(rec)}>\n                                        Delete\n                                      </Button>\n                                    </>\n                                  ) : (\n                                    <Button variant=\"outline\" size=\"sm\" onClick={() => { setCertTargetRecordId(rec.id || null); taxCertInputRef.current?.click(); }} disabled={uploadingTaxCert}>\n                                      {uploadingTaxCert ? 'Uploading...' : 'Upload Certificate'}\n                                    </Button>\n                                  )}\n                                  <Button variant=\"secondary\" size=\"sm\" onClick={() => setEditingTax(rec)}>\n                                    Edit\n                                  </Button>\n                                </div>\n                              </div>\n                              {rec.updated_at && <span className=\"text-xs text-muted-foreground\">Updated: {formatDateTime(rec.updated_at)}</span>}\n                            </CardHeader>\n                            <CardContent>\n                              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n                                <div><span className=\"text-xs text-muted-foreground\">Tax Country</span><div>{rec.tax_country || '-'}</div></div>\n                                <div><span className=\"text-xs text-muted-foreground\">Tax Type</span><div>{rec.tax_type || '-'}</div></div>\n                                <div><span className=\"text-xs text-muted-foreground\">Tax Number</span><div>{rec.tax_number || '-'}</div></div>\n                                <div><span className=\"text-xs text-muted-foreground\">GST Number</span><div>{rec.gst_number || '-'}</div></div>\n                                <div><span className=\"text-xs text-muted-foreground\">PAN Number</span><div>{rec.pan_number || '-'}</div></div>\n                                <div><span className=\"text-xs text-muted-foreground\">VAT Number</span><div>{rec.vat_number || '-'}</div></div>\n                                <div className=\"md:col-span-2\"><span className=\"text-xs text-muted-foreground\">Notes</span><div>{rec.tax_notes || '-'}</div></div>\n                                {rec.tax_certificate_url && (\n                                  <div className=\"md:col-span-2 mt-2\">\n                                    {/* Inline preview for images, link-only for PDFs */}\n                                    {/\\.(png|jpg|jpeg|gif|webp)$/i.test(rec.tax_certificate_url) ? (\n                                      <img src={rec.tax_certificate_url} alt=\"Tax Certificate\" className=\"max-h-48 object-contain border rounded\" />\n                                    ) : (\n                                      <a href={rec.tax_certificate_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-sm hover:underline\">\n                                        Open Certificate\n                                      </a>\n                                    )}\n                                  </div>\n                                )}\n                              </div>\n                            </CardContent>\n                          </Card>\n                        ))}\n                      </div>\n                    )}\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Queries Tab */}\n          <TabsContent value=\"queries\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Enquiries & Queries</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {queries.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full border-collapse\">\n                      <thead>\n                        <tr className=\"border-b\">\n                          <th className=\"text-left p-2\">ID</th>\n                          <th className=\"text-left p-2\">Destination</th>\n                          <th className=\"text-left p-2\">Travel Dates</th>\n                          <th className=\"text-left p-2\">Status</th>\n                          <th className=\"text-left p-2\">Created At</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {queries.map((query) => (\n                          <tr key={query.id} className=\"border-b hover:bg-muted/50\">\n                            <td className=\"p-2\">{query.id}</td>\n                            <td className=\"p-2\">\n                              {query.destination.country} ({query.destination.cities.join(', ')})\n                            </td>\n                            <td className=\"p-2\">\n                              {formatDate(query.travelDates.from)} to {formatDate(query.travelDates.to)}\n                            </td>\n                            <td className=\"p-2\">\n                              <Badge variant={\n                                query.status === 'new' ? 'default' :\n                                query.status === 'confirmed' ? 'success' : 'secondary'\n                              }>\n                                {query.status}\n                              </Badge>\n                            </td>\n                            <td className=\"p-2\">\n                              {formatDateTime(query.createdAt)}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <FileText className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n                    <p>No queries found for this agent</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Bookings Tab */}\n          <TabsContent value=\"bookings\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Confirmed Bookings</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {bookings.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full border-collapse\">\n                      <thead>\n                        <tr className=\"border-b\">\n                          <th className=\"text-left p-2\">Booking ID</th>\n                          <th className=\"text-left p-2\">Customer</th>\n                          <th className=\"text-left p-2\">Destination</th>\n                          <th className=\"text-left p-2\">Travel Dates</th>\n                          <th className=\"text-left p-2\">Amount</th>\n                          <th className=\"text-left p-2\">Status</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {bookings.map((booking) => (\n                          <tr key={booking.id} className=\"border-b hover:bg-muted/50\">\n                            <td className=\"p-2\">{booking.id}</td>\n                            <td className=\"p-2\">{booking.customerName}</td>\n                            <td className=\"p-2\">{booking.destination}</td>\n                            <td className=\"p-2\">\n                              {formatDate(booking.travelDates.from)} to {formatDate(booking.travelDates.to)}\n                            </td>\n                            <td className=\"p-2\">{formatCurrency(booking.totalAmount)}</td>\n                            <td className=\"p-2\">\n                              <Badge variant={\n                                booking.status === 'confirmed' ? 'success' : 'secondary'\n                              }>\n                                {booking.status}\n                              </Badge>\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Calendar className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n                    <p>No bookings found for this agent</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Customers Tab */}\n          <TabsContent value=\"customers\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Top Customers</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {customers.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full border-collapse\">\n                      <thead>\n                        <tr className=\"border-b\">\n                          <th className=\"text-left p-2\">Customer</th>\n                          <th className=\"text-left p-2\">Contact</th>\n                          <th className=\"text-left p-2\">Bookings</th>\n                          <th className=\"text-left p-2\">Total Spent</th>\n                          <th className=\"text-left p-2\">Last Booking</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {customers.map((customer) => (\n                          <tr key={customer.id} className=\"border-b hover:bg-muted/50\">\n                            <td className=\"p-2\">{customer.name}</td>\n                            <td className=\"p-2\">\n                              <div>{customer.email}</div>\n                              {customer.phone && <div className=\"text-xs text-muted-foreground\">{customer.phone}</div>}\n                            </td>\n                            <td className=\"p-2\">{customer.bookingsCount}</td>\n                            <td className=\"p-2\">{formatCurrency(customer.totalSpent)}</td>\n                            <td className=\"p-2\">\n                              {customer.lastBookingDate ? formatDate(customer.lastBookingDate) : 'N/A'}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Users className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n                    <p>No customers data available</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Activity Tab */}\n          <TabsContent value=\"activity\" className=\"space-y-4 mt-4\">\n            <Card>\n              <CardHeader className=\"pb-2\">\n                <CardTitle>Recent Activity</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {recentActivity.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    {recentActivity.map((activity, index) => (\n                      <div key={index} className=\"flex gap-4 pb-4 border-b last:border-0\">\n                        <div className=\"min-w-8 mt-1\">\n                          {activity.action.includes('Query') && <FileText className=\"h-6 w-6 text-blue-500\" />}\n                          {activity.action.includes('Booking') && <CheckCheck className=\"h-6 w-6 text-green-500\" />}\n                          {activity.action.includes('Customer') && <Users className=\"h-6 w-6 text-purple-500\" />}\n                          {activity.action.includes('Proposal') && <PieChart className=\"h-6 w-6 text-orange-500\" />}\n                          {!activity.action.includes('Query') && \n                           !activity.action.includes('Booking') && \n                           !activity.action.includes('Customer') && \n                           !activity.action.includes('Proposal') && \n                           <Clock className=\"h-6 w-6 text-gray-500\" />}\n                        </div>\n                        <div>\n                          <div className=\"font-medium\">{activity.action}</div>\n                          <div className=\"text-sm text-muted-foreground\">{activity.details}</div>\n                          <div className=\"text-xs text-muted-foreground mt-1\">\n                            {formatDateTime(activity.date)}\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <BarChart3 className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n                    <p>No recent activity recorded</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Staff Assignment Tab */}\n          <TabsContent value=\"staff\" className=\"space-y-4 mt-4\">\n            <StaffAssignmentTab agent={agent} agentId={id} onAssignmentChange={handleAssignmentChange} />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AgentProfile;\n","\nimport React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport * as z from \"zod\";\nimport PageLayout from \"@/components/layout/PageLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ArrowLeft, Save, Mail, RefreshCw, User, AlertCircle, Copy, Key } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { useAccessControl } from \"@/hooks/use-access-control\";\nimport { useApp } from \"@/contexts/AppContext\";\nimport { generateSecurePassword } from \"@/utils/credentialGenerator\";\nimport { storeAgentCredentials } from \"@/utils/agentAuth\";\nimport { agentWelcomeTemplate } from \"@/email/templates\";\nimport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n} from \"@/components/ui/alert\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\n\nimport { ManagedAgent } from \"@/types/agentManagement\";\nimport { AgentManagementService } from \"@/services/agentManagementService\";\n\n// Updated agent form schema matching AddAgent structure\nconst agentFormSchema = z.object({\n  // Basic Information - MANDATORY\n  name: z.string().min(3, { message: \"Agent name must be at least 3 characters.\" }),\n  email: z.string().email({ message: \"Please enter a valid email address.\" }),\n  mobile: z.string().min(10, { message: \"Please enter a valid mobile number.\" }),\n  agentType: z.enum([\"individual\", \"company\"], { \n    required_error: \"Please select an agent type.\"\n  }),\n  company: z.string().optional(),\n  \n  // Account Access & Security - MANDATORY\n  password: z.string().min(8, { message: \"Password must be at least 8 characters.\" }),\n  confirmPassword: z.string().min(8, { message: \"Password must be at least 8 characters.\" }),\n  forcePasswordChange: z.boolean().default(true),\n  sendCredentialsEmail: z.boolean().default(false),\n  trackLoginActivity: z.boolean().default(true),\n  isActive: z.boolean().default(true),\n  \n  // All other fields are now OPTIONAL\n  profileImage: z.string().optional(),\n  countries: z.array(z.string()).optional().default([]),\n  cities: z.array(z.string()).optional().default([]),\n  staffAssignments: z.array(z.string()).optional().default([]),\n  commissionType: z.enum([\"flat\", \"percentage\"]).optional(),\n  commissionValue: z.string().optional(),\n  language: z.string().optional().default(\"English\"),\n  currency: z.string().optional().default(\"USD\"),\n  sourceType: z.enum([\"event\", \"lead\", \"referral\", \"website\", \"other\"]).optional(),\n  sourceDetails: z.string().optional(),\n  documents: z.any().optional(),\n  remarks: z.string().optional(),\n  termsAgreed: z.boolean().default(false)\n}).refine(data => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype AgentFormValues = z.infer<typeof agentFormSchema>;\n\nconst EditAgent: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const { currentUser } = useApp();\n  const { isStaff, hasAdminAccess } = useAccessControl();\n  const [agent, setAgent] = useState<ManagedAgent | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [logoUrl, setLogoUrl] = useState<string>('');\n  const [isGeneratingCredentials, setIsGeneratingCredentials] = useState(false);\n  const [showCredentialsModal, setShowCredentialsModal] = useState(false);\n  const [generatedCredentials, setGeneratedCredentials] = useState<{ email: string; password: string } | null>(null);\n\n  // Removed location, staff, and source option data per requirement\n\n  const form = useForm<AgentFormValues>({\n    resolver: zodResolver(agentFormSchema),\n    defaultValues: {\n      name: \"\",\n      email: \"\",\n      mobile: \"\",\n      company: \"\",\n      profileImage: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      countries: [],\n      cities: [],\n      staffAssignments: [],\n      agentType: \"individual\",\n      isActive: true,\n      commissionType: \"percentage\",\n      commissionValue: \"\",\n      language: \"English\",\n      currency: \"USD\",\n      sourceType: \"website\",\n      sourceDetails: \"\",\n      forcePasswordChange: true,\n      sendCredentialsEmail: false,\n      trackLoginActivity: true,\n      remarks: \"\",\n      termsAgreed: false,\n    },\n  });\n\n  const agentType = form.watch(\"agentType\");\n  const email = form.watch(\"email\");\n  const name = form.watch(\"name\");\n\n  // Initialize form with agent data (service-based by UUID)\n  useEffect(() => {\n    let isMounted = true;\n    const load = async () => {\n      if (!id) return;\n      setLoading(true);\n      const { data, error } = await AgentManagementService.getAgentById(id);\n      if (!isMounted) return;\n      if (error || !data) {\n        setAgent(null);\n        setLoading(false);\n        return;\n      }\n\n      setAgent(data);\n      setLogoUrl(data.profile_image || '');\n\n      // Set form values from managed agent data\n      form.reset({\n        name: data.name || \"\",\n        email: data.email || \"\",\n        mobile: (data.business_phone || data.phone || \"\") as string,\n        company: (data.type === \"company\" ? (data.company_name || \"\") : \"\"),\n        profileImage: data.profile_image || \"\",\n        password: \"********\", // Placeholder for existing password\n        confirmPassword: \"********\",\n        countries: data.country ? [data.country] : [],\n        cities: data.city ? [data.city] : [],\n        staffAssignments: [],\n        agentType: (data.type as \"individual\" | \"company\") || \"individual\",\n        isActive: data.status === \"active\",\n        commissionType: (data.commission_type as \"flat\" | \"percentage\") || \"percentage\",\n        commissionValue: typeof data.commission_value === 'number' ? String(data.commission_value) : (data.commission_value || \"\"),\n        language: (data.preferred_language || \"English\") as string,\n        currency: \"USD\",\n        sourceType: (data.source_type as any) || \"website\",\n        sourceDetails: data.source_details || \"\",\n        forcePasswordChange: false,\n        sendCredentialsEmail: false,\n        trackLoginActivity: true,\n        remarks: \"\",\n        termsAgreed: false,\n      });\n\n      // Removed selected lists initialization since sections are hidden\n      setLoading(false);\n    };\n    load();\n    return () => { isMounted = false; };\n  }, [id, form]);\n\n  const generateCredentials = () => {\n    setIsGeneratingCredentials(true);\n    \n    // Generate secure password\n    const generatedPassword = generateSecurePassword(12);\n    \n    form.setValue(\"password\", generatedPassword);\n    form.setValue(\"confirmPassword\", generatedPassword);\n    \n    setGeneratedCredentials({ email: email, password: generatedPassword });\n    setShowCredentialsModal(true);\n    toast.success(\"New credentials generated successfully! Credentials will activate after Save.\");\n    setIsGeneratingCredentials(false);\n  };\n\n  // Removed country/city/staff handlers per requirement\n\n  const sendPasswordResetEmail = () => {\n    const agentEmail = form.getValues(\"email\");\n    if (!agentEmail) {\n      toast.error(\"Please enter agent email first\");\n      return;\n    }\n    \n    // In real app, this would call an API to send reset email\n    console.log(\"Sending password reset email to:\", agentEmail);\n    toast.success(`Password reset email sent to ${agentEmail}`);\n  };\n\n  // Removed logo handlers since logo section is hidden\n\n  // Removed dependent city lookup helper\n\n  const onSubmit = async (values: AgentFormValues) => {\n    const idStr = (id ? String(id) : (agent ? String(agent.id) : \"\"));\n    if (!idStr) {\n      toast.error('Invalid agent ID');\n      return;\n    }\n    const updatePayload = {\n      id: idStr,\n      name: values.name,\n      email: values.email,\n      business_phone: values.mobile,\n      company_name: values.company,\n      status: values.isActive ? 'active' : 'inactive',\n      profile_image: logoUrl || undefined,\n      preferred_language: values.language || undefined,\n      country: values.countries && values.countries.length > 0 ? values.countries[0] : undefined,\n      city: values.cities && values.cities.length > 0 ? values.cities[0] : undefined,\n      type: values.agentType as 'individual' | 'company',\n      commission_type: values.commissionType,\n      commission_value: values.commissionValue,\n      source_type: values.sourceType,\n      source_details: values.sourceDetails,\n    } as any;\n\n    const { data, error } = await AgentManagementService.updateAgent(updatePayload);\n    if (error) {\n      console.error('Update agent error:', error);\n      toast.error('Failed to update agent profile.');\n      return;\n    }\n\n    // Sync email to Supabase Auth and profiles if changed\n    try {\n      const emailChanged = values.email !== (agent?.email || \"\");\n      if (emailChanged) {\n        const { error: syncErr } = await AgentManagementService.syncAgentEmailAcrossAuth(idStr, values.email);\n        if (syncErr) {\n          console.warn('Email sync to Auth/profiles failed:', syncErr);\n          toast.warning('Saved, but could not sync email to authentication.');\n        }\n      }\n    } catch (e) {\n      console.warn('Email sync encountered an error:', e);\n    }\n\n    // Persist Track Login Activity preference\n    try {\n      const { error: prefsErr } = await AgentManagementService.patchAgentSettingsPreferences(idStr, {\n        security: { trackLoginActivity: !!values.trackLoginActivity },\n      });\n      if (prefsErr) {\n        console.warn('Persisting trackLoginActivity failed:', prefsErr);\n      }\n    } catch (e) {\n      console.warn('Persisting trackLoginActivity encountered an error:', e);\n    }\n\n    // Persist generated credentials via secure RPC\n    try {\n      const isTemporary = !!values.forcePasswordChange;\n      const { error: credErr } = await AgentManagementService.setAgentCredentials(idStr, values.email, values.password, isTemporary);\n      if (credErr) {\n        console.warn('setAgentCredentials error:', credErr);\n        toast.warning('Profile saved, but activating credentials failed.');\n      } else {\n        toast.success(`Agent \"${values.name}\" updated. Credentials activated.`);\n\n        // Store credentials locally for login fallback (username or email)\n        try {\n          storeAgentCredentials({\n            agentId: idStr,\n            username: values.email,\n            password: values.password,\n            email: values.email,\n            forcePasswordChange: isTemporary,\n            isTemporary,\n            createdAt: new Date().toISOString(),\n            createdBy: {\n              staffId: 'self',\n              staffName: 'Admin'\n            }\n          });\n        } catch (e) {\n          console.warn('Failed to store credentials locally:', e);\n        }\n\n        // Optionally send updated credentials email\n        if (values.sendCredentialsEmail) {\n          try {\n            const emailServerUrl = (import.meta as any).env?.VITE_EMAIL_SERVER_URL || 'http://localhost:3001';\n            const loginUrl = `${window.location.origin}/login`;\n            const html = agentWelcomeTemplate({\n              companyName: 'Triplexa',\n              recipientName: values.name,\n              actionUrl: loginUrl,\n            }) + `\n              <div style=\"margin-top:12px;padding:10px;border:1px dashed #ccc;border-radius:6px\">\n                <p><strong>Login Credentials</strong></p>\n                <p>Email: <code>${values.email}</code></p>\n                <p>Password: <code>${values.password}</code></p>\n                <p style=\"font-size:12px;color:#666\">For security, please change your password after first login.</p>\n              </div>\n            `;\n\n            const res = await fetch(`${emailServerUrl}/send-email`, {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({\n                to: values.email,\n                subject: 'Your updated agent credentials',\n                html\n              })\n            });\n            const json = await res.json().catch(() => ({ success: false }));\n            if (json && json.success) {\n              toast.success(\"Updated credentials emailed to the agent\");\n            } else {\n              toast.warning(\"Saved, but email could not be sent (server not running?)\");\n            }\n          } catch (e) {\n            console.warn('Send credentials email error:', e);\n            toast.warning(\"Saved, but emailing credentials failed\");\n          }\n        }\n      }\n    } catch (e) {\n      console.error('Credentials activation error:', e);\n      toast.warning('Profile saved, but credentials activation encountered an error.');\n    }\n\n    navigate(`/management/agents/${idStr}`);\n  };\n\n  const handleCancel = () => {\n    navigate(-1);\n  };\n\n  if (loading) {\n    return (\n      <PageLayout title=\"Edit Agent\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-gray-500\">Loading agent data...</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  if (!agent) {\n    return (\n      <PageLayout title=\"Edit Agent\">\n        <Alert variant=\"destructive\" className=\"mb-6\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertTitle>Error</AlertTitle>\n          <AlertDescription>\n            Agent not found. The requested agent may have been deleted or doesn't exist.\n          </AlertDescription>\n        </Alert>\n        <Button onClick={() => navigate(\"/management/agents\")}>\n          <ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to Agents\n        </Button>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout\n      title=\"Edit Agent\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Agent Management\", href: \"/management/agents\" },\n        { title: agent.name, href: `/management/agents/${agent.id}` },\n        { title: \"Edit\", href: `/management/agents/${agent.id}/edit` },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between items-center\">\n          <Button variant=\"outline\" size=\"sm\" asChild>\n            <Link to=\"/management/agents\">\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Agent List\n            </Link>\n          </Button>\n          \n          {isStaff && (\n            <Badge variant=\"secondary\" className=\"flex items-center\">\n              <User className=\"mr-1 h-3 w-3\" />\n              Staff Access\n            </Badge>\n          )}\n        </div>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\n            {/* Basic Information section removed per requirement */}\n\n            {/* Account Access & Security - MANDATORY */}\n            <Card className=\"border-red-200\">\n              <CardHeader className=\"bg-red-50\">\n                <CardTitle className=\"text-red-700 flex items-center\">\n                  Account Access & Security\n                  <Badge variant=\"destructive\" className=\"ml-2\">Required</Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"flex justify-between items-center mb-4\">\n                  <h4 className=\"text-sm font-medium\">Login Credentials</h4>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={generateCredentials}\n                    disabled={isGeneratingCredentials}\n                  >\n                    <RefreshCw className={`mr-2 h-4 w-4 ${isGeneratingCredentials ? 'animate-spin' : ''}`} />\n                    Generate New Credentials\n                  </Button>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <FormLabel>Login Email</FormLabel>\n                    <p className=\"text-sm text-muted-foreground\">Login uses the agent's email address.</p>\n                  </div>\n\n                  <div className=\"flex gap-2\">\n                    <FormField\n                      control={form.control}\n                      name=\"password\"\n                      render={({ field }) => (\n                        <FormItem className=\"flex-1\">\n                          <FormLabel>Password*</FormLabel>\n                          <FormControl>\n                            <Input type=\"password\" placeholder=\"\" {...field} />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"mt-6\"\n                      onClick={sendPasswordResetEmail}\n                    >\n                      <Mail className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Confirm Password*</FormLabel>\n                        <FormControl>\n                          <Input type=\"password\" placeholder=\"\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"forcePasswordChange\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                        <div className=\"space-y-0.5\">\n                          <FormLabel className=\"text-sm\">Force Password Change</FormLabel>\n                          <FormDescription className=\"text-xs\">\n                            Require password change on next login\n                          </FormDescription>\n                        </div>\n                        <FormControl>\n                          <Switch checked={field.value} onCheckedChange={field.onChange} />\n                        </FormControl>\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"sendCredentialsEmail\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                        <div className=\"space-y-0.5\">\n                          <FormLabel className=\"text-sm\">Send Updated Credentials</FormLabel>\n                          <FormDescription className=\"text-xs\">\n                            Email updated login details to agent\n                          </FormDescription>\n                        </div>\n                        <FormControl>\n                          <Switch checked={field.value} onCheckedChange={field.onChange} />\n                        </FormControl>\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"trackLoginActivity\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                        <div className=\"space-y-0.5\">\n                          <FormLabel className=\"text-sm\">Track Login Activity</FormLabel>\n                          <FormDescription className=\"text-xs\">\n                            Monitor login attempts and activity\n                          </FormDescription>\n                        </div>\n                        <FormControl>\n                          <Switch checked={field.value} onCheckedChange={field.onChange} />\n                        </FormControl>\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <FormField\n                  control={form.control}\n                  name=\"isActive\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm\">\n                      <div className=\"space-y-0.5\">\n                        <FormLabel>Account Status</FormLabel>\n                        <FormDescription>\n                          Set whether this account is active or inactive\n                        </FormDescription>\n                      </div>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            {/* Optional sections removed per requirement */}\n\n            {/* Submit Buttons */}\n            <div className=\"flex justify-end space-x-4\">\n              <Button type=\"button\" variant=\"outline\" onClick={handleCancel}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" className=\"flex items-center\">\n                <Save className=\"mr-2 h-4 w-4\" />\n                Update Agent\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </div>\n    {/* Credentials Modal */}\n    <Dialog open={showCredentialsModal} onOpenChange={setShowCredentialsModal}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Key className=\"h-5 w-5\" />\n            Login Credentials Generated\n          </DialogTitle>\n          <DialogDescription>\n            Copy and share securely. These credentials activate after you click Save.\n          </DialogDescription>\n        </DialogHeader>\n        {generatedCredentials && (\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium\">Email:</span>\n                <code className=\"bg-muted px-2 py-1 rounded text-sm\">{generatedCredentials.email}</code>\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => navigator.clipboard.writeText(generatedCredentials.email)}\n                >\n                  <Copy className=\"h-3 w-3\" />\n                </Button>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm font-medium\">Password:</span>\n                <code className=\"bg-muted px-2 py-1 rounded text-sm\">{generatedCredentials.password}</code>\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => navigator.clipboard.writeText(generatedCredentials.password)}\n                >\n                  <Copy className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            </div>\n            <p className=\"text-sm text-muted-foreground\">\n              Tip: Enable \"Send Updated Credentials\" above to email these after Save.\n            </p>\n          </div>\n        )}\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => setShowCredentialsModal(false)}>Close</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n    </PageLayout>\n  );\n};\n\nexport default EditAgent;\n","import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { \n  Plus, \n  Search, \n  Filter, \n  Users, \n  UserPlus, \n  Building2,\n  TrendingUp,\n  UserCheck,\n  UserX,\n  Coffee,\n  Mail,\n  Phone,\n  Building,\n  CheckCircle,\n  XCircle,\n  Trash2\n} from \"lucide-react\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport PageLayout from \"@/components/layout/PageLayout\";\nimport { EnhancedStaffMember } from \"@/types/staff\";\nimport { initialCountries } from \"@/pages/inventory/countries/data/countryData\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { supabase, adminSupabase, isAdminClientConfigured } from \"@/lib/supabaseClient\";\n\nconst StaffManagement: React.FC = () => {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [staffData, setStaffData] = useState<EnhancedStaffMember[]>([]);\n\n  // Load staff data on component mount\n  useEffect(() => {\n    // Map a Supabase profiles row to EnhancedStaffMember with safe defaults\n    const mapProfileToEnhancedStaff = (p: any): EnhancedStaffMember => {\n      const today = new Date().toISOString().slice(0, 10);\n      const defaultWorkingHours = {\n        monday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        tuesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        wednesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        thursday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        friday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        saturday: { isWorking: false },\n        sunday: { isWorking: false },\n      };\n\n      const defaultPerformance = {\n        daily: {\n          date: today,\n          tasksCompleted: 0,\n          responseTime: 0,\n          customerSatisfaction: 0,\n        },\n        monthly: {\n          month: today.slice(0, 7),\n          totalTasks: 0,\n          averageResponseTime: 0,\n          averageCustomerSatisfaction: 0,\n          targetAchievement: 0,\n        },\n        quarterly: {\n          quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`,\n          performanceRating: 0,\n          goalsAchieved: 0,\n          totalGoals: 0,\n          growthPercentage: 0,\n        },\n        overall: {\n          totalExperience: '0 years',\n          performanceScore: 0,\n          ranking: 0,\n          badges: [],\n        },\n      };\n\n      const status = ['active', 'inactive', 'on-leave'].includes(p?.status) ? p.status : 'active';\n\n      return {\n        id: p.id,\n        name: p.name || (p.email ? String(p.email).split('@')[0] : 'Staff Member'),\n        email: p.email || '',\n        phone: p.phone || '',\n        department: p.department || 'General',\n        role: p.role || 'staff',\n        status,\n        avatar: p.avatar || undefined,\n        joinDate: (p.created_at ? String(p.created_at).slice(0, 10) : today),\n        dateOfBirth: undefined,\n        skills: [],\n        certifications: [],\n        performance: defaultPerformance,\n        targets: [],\n        permissions: [],\n        workingHours: defaultWorkingHours,\n        reportingManager: undefined,\n        teamMembers: undefined,\n        employeeId: p.employee_id || '',\n        operationalCountries: [],\n        salaryStructure: undefined,\n        leaveBalance: undefined,\n        attendanceRecord: undefined,\n      };\n    };\n\n    const loadStaffData = async () => {\n      let allStaff: EnhancedStaffMember[] = [];\n\n      try {\n        const client: any = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n        if (client) {\n          const { data, error } = await client\n            .from('profiles')\n            .select('id, name, email, phone, department, role, status, employee_id, created_at, avatar')\n            .eq('role', 'staff');\n\n          if (error) {\n            console.warn('Supabase profiles fetch failed:', error);\n          } else if (data && Array.isArray(data)) {\n            allStaff = data.map(mapProfileToEnhancedStaff);\n          }\n        }\n      } catch (err) {\n        console.warn('Error fetching staff profiles from Supabase:', err);\n      }\n\n      // Use only Supabase data\n      setStaffData(allStaff);\n    };\n\n    loadStaffData();\n    // No localStorage source; no storage listeners needed\n    return () => {};\n  }, []);\n\n  const filteredStaff = staffData.filter(staff => {\n    const matchesSearch = staff.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         staff.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         staff.department.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesFilter = filterStatus === \"all\" || staff.status === filterStatus;\n    \n    return matchesSearch && matchesFilter;\n  });\n\n  const activeStaff = staffData.filter(staff => staff.status === \"active\").length;\n  const onLeaveStaff = staffData.filter(staff => staff.status === \"on-leave\").length;\n  const inactiveStaff = staffData.filter(staff => staff.status === \"inactive\").length;\n\n  const handleStatusUpdate = async (staffId: string, newStatus: 'active' | 'inactive') => {\n    try {\n      const staffMember = staffData.find(staff => staff.id === staffId);\n      \n      // Update in Supabase if available\n      const client: any = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      if (client) {\n        const { error: supabaseError } = await client\n          .from('profiles')\n          .update({\n            status: newStatus,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', staffId);\n\n        if (supabaseError) {\n          console.warn('Supabase update failed:', supabaseError);\n        } else {\n          console.log(`Staff ${staffMember?.name} status updated in Supabase to: ${newStatus}`);\n        }\n      }\n\n      // Update local state\n      setStaffData(prevData => \n        prevData.map(staff => \n          staff.id === staffId ? { ...staff, status: newStatus } : staff\n        )\n      );\n\n      toast({\n        title: \"Status Updated\",\n        description: `${staffMember?.name} is now ${newStatus}`,\n      });\n\n      console.log(`Staff ${staffMember?.name} status updated to: ${newStatus}`);\n    } catch (error) {\n      console.error('Error updating staff status:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to update staff status\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDeleteStaff = async (staffId: string) => {\n    try {\n      const staffMember = staffData.find(staff => staff.id === staffId);\n      \n      // Delete from Supabase if available\n      if (supabase) {\n        const { error: supabaseError } = await supabase\n          .from('profiles')\n          .delete()\n          .eq('id', staffId);\n\n        if (supabaseError) {\n          console.warn('Supabase delete failed:', supabaseError);\n        } else {\n          console.log(`Staff ${staffMember?.name} deleted from Supabase`);\n        }\n      }\n      \n      // Remove from local state\n      setStaffData(prevData => prevData.filter(staff => staff.id !== staffId));\n\n      toast({\n        title: \"Staff Deleted\",\n        description: `${staffMember?.name} has been removed`,\n      });\n\n      console.log(`Staff ${staffMember?.name} deleted`);\n    } catch (error) {\n      console.error('Error deleting staff:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete staff member\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const getStatusBadgeVariant = (status: string) => {\n    switch (status) {\n      case \"active\":\n        return \"default\";\n      case \"inactive\":\n        return \"secondary\";\n      case \"on-leave\":\n        return \"outline\";\n      default:\n        return \"secondary\";\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"active\":\n        return <UserCheck className=\"h-3 w-3 text-green-600\" />;\n      case \"inactive\":\n        return <UserX className=\"h-3 w-3 text-red-600\" />;\n      case \"on-leave\":\n        return <Coffee className=\"h-3 w-3 text-orange-600\" />;\n      default:\n        return <Users className=\"h-3 w-3 text-gray-600\" />;\n    }\n  };\n\n  // Function to get country name by ID\n  const getCountryNameById = (countryId: string) => {\n    const country = initialCountries.find(c => c.id === countryId);\n    return country ? country.name : countryId;\n  };\n\n  return (\n    <PageLayout\n      title=\"Staff Management\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Management\", href: \"/management\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n      ]}\n    >\n      <div className=\"space-y-4 md:space-y-6\">\n        {/* Staff Management Heading */}\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 md:p-6\">\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\n            <div className=\"flex-1\">\n              <h1 className=\"text-2xl md:text-3xl font-bold text-blue-900 dark:text-blue-100 mb-2\">Staff Management</h1>\n              <p className=\"text-sm md:text-base text-blue-700 dark:text-blue-300\">Manage your team members, track performance, and oversee operations</p>\n            </div>\n            <div className=\"flex items-center space-x-2 shrink-0\">\n              <Users className=\"h-6 w-6 md:h-8 md:w-8 text-blue-600 dark:text-blue-400\" />\n              <Building2 className=\"h-6 w-6 md:h-8 md:w-8 text-blue-600 dark:text-blue-400\" />\n            </div>\n          </div>\n        </div>\n\n        {/* Navigation Tabs */}\n        <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-4 border-b border-gray-200 dark:border-gray-700 pb-4\">\n          <Button variant=\"default\" className=\"justify-start\">\n            <Users className=\"mr-2 h-4 w-4\" />\n            Staff Members\n          </Button>\n          <Button variant=\"outline\" asChild className=\"justify-start\">\n            <Link to=\"/management/staff/departments\">\n              <Building className=\"mr-2 h-4 w-4\" />\n              Departments\n            </Link>\n          </Button>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4\">\n          <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Total Staff</CardTitle>\n              <Users className=\"h-3 w-3 md:h-4 md:w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100\">{staffData.length}</div>\n              <p className=\"text-xs text-muted-foreground flex items-center mt-1\">\n                <TrendingUp className=\"inline h-3 w-3 mr-1\" />\n                Total members\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Active</CardTitle>\n              <UserCheck className=\"h-3 w-3 md:h-4 md:w-4 text-green-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-xl md:text-2xl font-bold text-green-600\">{activeStaff}</div>\n              <p className=\"text-xs text-muted-foreground\">Currently working</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">On Leave</CardTitle>\n              <Coffee className=\"h-3 w-3 md:h-4 md:w-4 text-orange-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-xl md:text-2xl font-bold text-orange-600\">{onLeaveStaff}</div>\n              <p className=\"text-xs text-muted-foreground\">Away</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Inactive</CardTitle>\n              <UserX className=\"h-3 w-3 md:h-4 md:w-4 text-red-500\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-xl md:text-2xl font-bold text-red-600\">{inactiveStaff}</div>\n              <p className=\"text-xs text-muted-foreground\">Not active</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Controls */}\n        <div className=\"flex flex-col gap-3 md:gap-4\">\n          <div className=\"flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-center\">\n            <div className=\"flex flex-1 gap-2 sm:gap-3 max-w-full sm:max-w-md\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                <Input\n                  placeholder=\"Search staff...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10 h-10 text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600\"\n                />\n              </div>\n              <select\n                value={filterStatus}\n                onChange={(e) => setFilterStatus(e.target.value)}\n                className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm min-w-[100px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\n              >\n                <option value=\"all\">All</option>\n                <option value=\"active\">Active</option>\n                <option value=\"inactive\">Inactive</option>\n                <option value=\"on-leave\">On Leave</option>\n              </select>\n            </div>\n            \n            <Button asChild className=\"w-full sm:w-auto\">\n              <Link to=\"/management/staff/add\">\n                <UserPlus className=\"mr-2 h-4 w-4\" />\n                <span className=\"hidden sm:inline\">Add Staff Member</span>\n                <span className=\"sm:hidden\">Add Staff</span>\n              </Link>\n            </Button>\n          </div>\n        </div>\n\n        {/* Staff Grid - Improved responsive layout */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4 md:gap-6\">\n          {filteredStaff.map((staff) => (\n            <Card key={staff.id} className=\"hover:shadow-lg transition-all duration-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-blue-200 dark:hover:border-blue-600\">\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start space-x-3\">\n                  <Avatar className=\"h-12 w-12 shrink-0\">\n                    <AvatarImage src={staff.avatar} alt={staff.name} />\n                    <AvatarFallback className=\"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 font-medium\">\n                      {staff.name.split(' ').map(n => n[0]).join('')}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className=\"flex-1 min-w-0\">\n                    <CardTitle className=\"text-base md:text-lg font-semibold text-gray-900 dark:text-gray-100 truncate\">\n                      {staff.name}\n                    </CardTitle>\n                    <p className=\"text-sm font-medium text-gray-600 dark:text-gray-300 truncate\">{staff.role}</p>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">{staff.department}</p>\n                  </div>\n                  <div className=\"flex flex-col gap-1\">\n                    <Badge \n                      variant={getStatusBadgeVariant(staff.status)} \n                      className={`flex items-center gap-1 text-xs shrink-0 ${\n                        staff.status === 'active' ? 'bg-green-100 text-green-800 border-green-200 dark:bg-green-900 dark:text-green-300 dark:border-green-700' :\n                        staff.status === 'inactive' ? 'bg-red-100 text-red-800 border-red-200 dark:bg-red-900 dark:text-red-300 dark:border-red-700' :\n                        'bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-orange-300 dark:border-orange-700'\n                      }`}\n                    >\n                      {getStatusIcon(staff.status)}\n                      <span className=\"hidden sm:inline font-medium\">\n                        {staff.status === \"on-leave\" ? \"On Leave\" : staff.status.charAt(0).toUpperCase() + staff.status.slice(1)}\n                      </span>\n                    </Badge>\n                    {staff.status !== \"on-leave\" && (\n                      <div className=\"flex gap-1\">\n                        <Select\n                          value={staff.status}\n                          onValueChange={(value: 'active' | 'inactive') => handleStatusUpdate(staff.id, value)}\n                        >\n                          <SelectTrigger className=\"w-20 h-6 text-xs\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"active\" className=\"text-xs\">\n                              <div className=\"flex items-center gap-1\">\n                                <CheckCircle className=\"h-3 w-3 text-green-500\" />\n                                Active\n                              </div>\n                            </SelectItem>\n                            <SelectItem value=\"inactive\" className=\"text-xs\">\n                              <div className=\"flex items-center gap-1\">\n                                <XCircle className=\"h-3 w-3 text-gray-500\" />\n                                Inactive\n                              </div>\n                            </SelectItem>\n                          </SelectContent>\n                        </Select>\n                        \n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleDeleteStaff(staff.id)}\n                          className=\"h-6 w-6 p-0 border-red-300 dark:border-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-700 dark:text-red-400\"\n                        >\n                          <Trash2 className=\"h-3 w-3\" />\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-xs md:text-sm\">\n                    <span className=\"text-gray-600 dark:text-gray-300\">Employee ID:</span>\n                    <span className=\"font-medium font-mono text-gray-900 dark:text-gray-100\">{staff.employeeId}</span>\n                  </div>\n                  <div className=\"flex justify-between text-xs md:text-sm\">\n                    <span className=\"text-gray-600 dark:text-gray-300\">Join Date:</span>\n                    <span className=\"font-medium text-gray-900 dark:text-gray-100\">{staff.joinDate}</span>\n                  </div>\n                  <div className=\"flex justify-between text-xs md:text-sm\">\n                    <span className=\"text-gray-600 dark:text-gray-300\">Performance:</span>\n                    <span className=\"font-medium text-blue-600 dark:text-blue-400\">\n                      {staff.performance.overall.performanceScore}\n                    </span>\n                  </div>\n                  \n                  {/* Contact Info - Mobile friendly */}\n                  <div className=\"flex flex-col sm:flex-row gap-1 sm:gap-2 text-xs text-gray-500 dark:text-gray-400 pt-1\">\n                    <div className=\"flex items-center gap-1\">\n                      <Mail className=\"h-3 w-3\" />\n                      <span className=\"truncate\">{staff.email}</span>\n                    </div>\n                    {staff.phone && (\n                      <div className=\"flex items-center gap-1\">\n                        <Phone className=\"h-3 w-3\" />\n                        <span>{staff.phone}</span>\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Operational Countries */}\n                  {staff.operationalCountries && staff.operationalCountries.length > 0 && (\n                    <div className=\"mt-3\">\n                      <span className=\"text-xs text-gray-600 dark:text-gray-300\">Operational Countries:</span>\n                      <div className=\"flex flex-wrap gap-1 mt-1\">\n                        {staff.operationalCountries.slice(0, 2).map((countryId) => (\n                          <Badge key={countryId} variant=\"outline\" className=\"text-xs\">\n                            {getCountryNameById(countryId)}\n                          </Badge>\n                        ))}\n                        {staff.operationalCountries.length > 2 && (\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            +{staff.operationalCountries.length - 2} more\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                  \n                  <div className=\"flex flex-col sm:flex-row gap-2 mt-4 pt-2 border-t border-gray-100 dark:border-gray-700\">\n                    <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 text-xs\">\n                      <Link to={`/management/staff/profile/${staff.id}`}>\n                        View Profile\n                      </Link>\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 text-xs\">\n                      <Link to={`/management/staff/edit/${staff.id}`}>\n                        Edit\n                      </Link>\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {filteredStaff.length === 0 && (\n          <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n            <CardContent className=\"text-center py-8 md:py-12\">\n              <Users className=\"h-12 w-12 md:h-16 md:w-16 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg md:text-xl font-medium text-gray-900 dark:text-gray-100 mb-2\">No staff members found</h3>\n              <p className=\"text-sm md:text-base text-gray-600 dark:text-gray-300 mb-4 max-w-md mx-auto\">\n                {searchTerm ? \"Try adjusting your search criteria\" : \"Get started by adding your first team member\"}\n              </p>\n              <Button asChild>\n                <Link to=\"/management/staff/add\">\n                  <UserPlus className=\"mr-2 h-4 w-4\" />\n                  Add Staff Member\n                </Link>\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default StaffManagement;\n","import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { format } from 'date-fns';\nimport { Save, X, Plus, Trash2, Target, ArrowLeft, Calendar as CalendarIcon } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { EnhancedStaffMember, Target as TargetType, Department } from '@/types/staff';\nimport { departmentService } from '@/services/departmentService';\nimport { toast } from '@/hooks/use-toast';\nimport { v4 as uuidv4 } from 'uuid';\nimport EmployeeCodeField from '@/components/staff/EmployeeCodeField';\nimport OperationalCountriesSelector from '@/components/staff/OperationalCountriesSelector';\nimport ReportingManagerSelector from '@/components/staff/ReportingManagerSelector';\nimport TargetSettings from '@/components/staff/TargetSettings';\nimport WorkingHoursSection from '@/components/staff/WorkingHoursSection';\nimport LoginCredentials from '@/components/staff/LoginCredentials';\nimport { validateEmployeeCode, isEmployeeCodeUnique } from '@/utils/employeeCodeGenerator';\nimport { validatePasswordStrength, checkUsernameUniqueness } from '@/utils/credentialGenerator';\nimport { syncStaffWithAuthSystem } from '@/services/credentialService';\nimport { ensureReferralExistsForStaff } from '@/services/staffReferralService';\nimport { staffWorkingHoursService } from '@/services/staffWorkingHoursService';\nimport { staffTargetService } from '@/services/staffTargetService';\n\nconst staffSchema = z.object({\n  name: z.string().min(2, 'Name must be at least 2 characters'),\n  email: z.string().email('Invalid email address'),\n  phone: z.string().min(10, 'Phone number must be at least 10 characters'),\n  department: z.string().min(1, 'Department is required'),\n  role: z.enum(['manager', 'staff', 'hr_manager'], {\n    required_error: 'Role is required'\n  }),\n  position: z.string().min(1, 'Position/Designation is required'),\n  status: z.enum(['active', 'inactive', 'on-leave']),\n  employeeId: z.string()\n    .min(1, \"Employee code must be at least 1 digit\")\n    .max(10, \"Employee code must be at most 10 digits\")\n    .refine(validateEmployeeCode, \"Employee code must be digits only\"),\n  operationalCountries: z.array(z.string()).min(1, \"Please select at least one operational country\"),\n  skills: z.array(z.string()),\n  certifications: z.array(z.string()),\n  reportingManager: z.string(),\n  joinDate: z.date({\n    required_error: \"Joining date is required\",\n  }),\n  dateOfBirth: z.date({\n    required_error: \"Date of birth is required\",\n  }),\n  // Login credentials fields\n  username: z.string()\n    .min(3, 'Username must be at least 3 characters')\n    .refine((val) => checkUsernameUniqueness(val), \"Username already exists\"),\n  password: z.string()\n    .min(8, 'Password must be at least 8 characters')\n    .refine((val) => validatePasswordStrength(val).isValid, \"Password does not meet security requirements\"),\n  confirmPassword: z.string(),\n  mustChangePassword: z.boolean().default(true)\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype StaffFormData = z.infer<typeof staffSchema>;\n\nconst AddStaff: React.FC = () => {\n  const navigate = useNavigate();\n  const [newSkill, setNewSkill] = useState('');\n  const [newCertification, setNewCertification] = useState('');\n  const [workingHours, setWorkingHours] = useState<any>({\n    monday: { isWorking: false, shifts: [] },\n    tuesday: { isWorking: false, shifts: [] },\n    wednesday: { isWorking: false, shifts: [] },\n    thursday: { isWorking: false, shifts: [] },\n    friday: { isWorking: false, shifts: [] },\n    saturday: { isWorking: false, shifts: [] },\n    sunday: { isWorking: false, shifts: [] }\n  });\n  const [targets, setTargets] = useState<TargetType[]>([]);\n  const [dobInput, setDobInput] = useState('');\n  const [departmentList, setDepartmentList] = useState<Department[]>([]);\n  const [loadingDepartments, setLoadingDepartments] = useState<boolean>(false);\n\n  const form = useForm<StaffFormData>({\n    resolver: zodResolver(staffSchema),\n    defaultValues: {\n      name: '',\n      email: '',\n      phone: '',\n      department: '',\n      role: 'staff',\n      position: '',\n      status: 'active',\n      employeeId: '',\n      skills: [],\n      certifications: [],\n      operationalCountries: [],\n      reportingManager: '',\n      joinDate: new Date(),\n      username: '',\n      password: '',\n      confirmPassword: '',\n      mustChangePassword: true,\n    }\n  });\n\n  const watchedEmail = form.watch('email');\n  const watchedName = form.watch('name');\n  const watchedDOB = form.watch('dateOfBirth');\n  const selectedDeptCode = form.watch('department');\n  const selectedDept = React.useMemo(() => {\n    return departmentList.find((d) => d.code === selectedDeptCode);\n  }, [departmentList, selectedDeptCode]);\n  const selectedDeptName = selectedDept?.name || selectedDeptCode;\n\n  React.useEffect(() => {\n    setDobInput(watchedDOB ? format(watchedDOB, 'dd/MM/yyyy') : '');\n  }, [watchedDOB]);\n\n  // Load departments from Supabase (public.departments)\n  React.useEffect(() => {\n    let mounted = true;\n    (async () => {\n      try {\n        setLoadingDepartments(true);\n        const { data, source } = await departmentService.getDepartments();\n        if (!mounted) return;\n        if (source === 'db' && Array.isArray(data)) {\n          setDepartmentList(data);\n        } else {\n          setDepartmentList([]);\n        }\n      } catch (err) {\n        console.warn('Failed to load departments', err);\n        if (mounted) setDepartmentList([]);\n      } finally {\n        if (mounted) setLoadingDepartments(false);\n      }\n    })();\n    return () => { mounted = false; };\n  }, []);\n\n  const onSubmit = async (data: StaffFormData) => {\n    const newStaff: EnhancedStaffMember = {\n      id: uuidv4(),\n      name: data.name,\n      email: data.email,\n      phone: data.phone,\n      department: data.department,\n      role: data.role,\n      position: data.position,\n      status: data.status,\n      employeeId: data.employeeId,\n      operationalCountries: data.operationalCountries,\n      skills: data.skills,\n      certifications: data.certifications,\n      dateOfBirth: data.dateOfBirth.toISOString().slice(0, 10),\n      performance: {\n        daily: {\n          date: new Date().toISOString().slice(0, 10),\n          tasksCompleted: 0,\n          responseTime: 0,\n          customerSatisfaction: 0,\n          revenue: 0,\n          enquiriesHandled: 0,\n          conversions: 0\n        },\n        monthly: {\n          month: new Date().toISOString().slice(0, 7),\n          totalTasks: 0,\n          averageResponseTime: 0,\n          averageCustomerSatisfaction: 0,\n          totalRevenue: 0,\n          totalEnquiries: 0,\n          conversionRate: 0,\n          targetAchievement: 0\n        },\n        quarterly: {\n          quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`,\n          performanceRating: 0,\n          goalsAchieved: 0,\n          totalGoals: 0,\n          growthPercentage: 0\n        },\n        overall: {\n          totalExperience: \"0 years\",\n          totalRevenue: 0,\n          clientRetentionRate: 0,\n          performanceScore: 0,\n          ranking: 0,\n          badges: []\n        }\n      },\n      targets: targets,\n      permissions: [],\n      workingHours: workingHours,\n      avatar: `/avatars/avatar-${Math.floor(Math.random() * 5) + 1}.png`,\n      joinDate: data.joinDate.toISOString().slice(0, 10),\n      reportingManager: data.reportingManager\n    };\n\n    // Create login credentials and sync with auth system first\n    // This will create the auth user and let the `handle_new_user` trigger\n    // populate the profiles row, avoiding RLS violations from direct inserts.\n    const authUserId = await syncStaffWithAuthSystem(newStaff, data.username, data.password, data.mustChangePassword);\n\n    // Generate and persist staff referral link using Supabase auth user ID\n    if (authUserId) {\n      ensureReferralExistsForStaff(authUserId).catch((err) => console.warn('Referral generation failed:', err));\n\n      // Persist Working Hours & Shifts\n      try {\n        const upsertWH = await staffWorkingHoursService.upsertWorkingHours(authUserId, workingHours);\n        if (upsertWH.error) console.warn('Working hours upsert error:', upsertWH.error);\n      } catch (err) {\n        console.warn('Working hours upsert failed:', err);\n      }\n\n      // Persist Performance Targets\n      try {\n        const replaceTargets = await staffTargetService.replaceTargetsForStaff(authUserId, targets || []);\n        if (replaceTargets.error) console.warn('Targets replace error:', replaceTargets.error);\n      } catch (err) {\n        console.warn('Targets replace failed:', err);\n      }\n    } else {\n      console.warn('Referral generation skipped: missing Supabase auth user ID.');\n    }\n\n    console.log('New staff member created with login credentials:', { \n      staff: newStaff.name, \n      username: data.username,\n      email: newStaff.email,\n      mustChangePassword: data.mustChangePassword,\n      loginMethods: ['username', 'email']\n    });\n    \n    toast({\n      title: \"Staff profile created successfully!\",\n      description: `${data.name} can now login with username \"${data.username}\" or email \"${data.email}\"`,\n    });\n    navigate('/management/staff');\n  };\n\n  const addSkill = () => {\n    if (newSkill.trim()) {\n      const currentSkills = form.getValues('skills');\n      form.setValue('skills', [...currentSkills, newSkill.trim()]);\n      setNewSkill('');\n    }\n  };\n\n  const removeSkill = (skillToRemove: string) => {\n    const currentSkills = form.getValues('skills');\n    form.setValue('skills', currentSkills.filter(skill => skill !== skillToRemove));\n  };\n\n  const addCertification = () => {\n    if (newCertification.trim()) {\n      const currentCerts = form.getValues('certifications');\n      form.setValue('certifications', [...currentCerts, newCertification.trim()]);\n      setNewCertification('');\n    }\n  };\n\n  const removeCertification = (certToRemove: string) => {\n    const currentCerts = form.getValues('certifications');\n    form.setValue('certifications', currentCerts.filter(cert => cert !== certToRemove));\n  };\n\n  const updateWorkingHours = (day: string, field: string, value: any) => {\n    setWorkingHours((prev: any) => ({\n      ...prev,\n      [day]: {\n        ...prev[day],\n        [field]: value\n      }\n    }));\n  };\n\n  const weekDays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\n\n  return (\n    <PageLayout\n      title=\"Add New Staff Member\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n        { title: \"Add Staff\", href: \"/management/staff/add\" },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Add New Staff Member</h2>\n            <p className=\"text-muted-foreground\">Create a new staff profile with login credentials</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={() => navigate('/management/staff')}>\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Staff\n            </Button>\n            <Button variant=\"outline\" onClick={() => navigate('/management/staff')}>\n              <X className=\"mr-2 h-4 w-4\" />\n              Cancel\n            </Button>\n          </div>\n        </div>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Basic Information */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Basic Information</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Full Name</FormLabel>\n                        <FormControl>\n                          <Input {...field} className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"employeeId\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Employee Code</FormLabel>\n                        <FormControl>\n                          <EmployeeCodeField\n                            value={field.value}\n                            onChange={field.onChange}\n                            error={form.formState.errors.employeeId?.message}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Email</FormLabel>\n                        <FormControl>\n                          <Input {...field} type=\"email\" className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"phone\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Phone</FormLabel>\n                        <FormControl>\n                          <Input {...field} className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"dateOfBirth\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Date of Birth</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"DD/MM/YYYY\"\n                            className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\"\n                            value={dobInput}\n                            onChange={(e) => setDobInput(e.target.value)}\n                            onBlur={() => {\n                              const v = dobInput.trim();\n                              const parts = v.split('/');\n                              if (parts.length === 3) {\n                                const [d, m, y] = parts;\n                                const day = Number(d);\n                                const month = Number(m);\n                                const year = Number(y);\n                                if (!Number.isNaN(year) && !Number.isNaN(month) && !Number.isNaN(day)) {\n                                  const candidate = new Date(year, month - 1, day);\n                                  const today = new Date();\n                                  const eighteenYearsAgo = new Date(\n                                    today.getFullYear() - 18,\n                                    today.getMonth(),\n                                    today.getDate()\n                                  );\n                                  const minDate = new Date('1900-01-01');\n                                  if (candidate <= eighteenYearsAgo && candidate >= minDate) {\n                                    form.clearErrors('dateOfBirth');\n                                    field.onChange(candidate);\n                                    return;\n                                  }\n                                }\n                              }\n                              form.setError('dateOfBirth', {\n                                type: 'manual',\n                                message: 'Enter valid date DD/MM/YYYY and must be 18+',\n                              });\n                            }}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"joinDate\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Joining Date</FormLabel>\n                        <Popover>\n                          <PopoverTrigger asChild>\n                            <FormControl>\n                              <Button\n                                variant={\"outline\"}\n                                className={cn(\n                                  \"w-full pl-3 text-left font-normal bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\",\n                                  !field.value && \"text-muted-foreground\"\n                                )}\n                              >\n                                {field.value ? (\n                                  format(field.value, \"PPP\")\n                                ) : (\n                                  <span>Pick a date</span>\n                                )}\n                                <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                              </Button>\n                            </FormControl>\n                          </PopoverTrigger>\n                          <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                            <Calendar\n                              mode=\"single\"\n                              selected={field.value}\n                              onSelect={field.onChange}\n                              disabled={(date) =>\n                                date > new Date(new Date().setDate(new Date().getDate() + 365)) || \n                                date < new Date(\"2020-01-01\")\n                              }\n                              initialFocus\n                            />\n                          </PopoverContent>\n                        </Popover>\n                        <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          <FormField\n            control={form.control}\n            name=\"department\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-gray-900 dark:text-gray-100\">Department</FormLabel>\n                <Select onValueChange={field.onChange} value={field.value || undefined}>\n                  <FormControl>\n                    <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                      <SelectValue placeholder=\"Select department\" />\n                    </SelectTrigger>\n                  </FormControl>\n                  <SelectContent>\n                    {loadingDepartments && (\n                      <div className=\"px-2 py-1 text-sm text-muted-foreground\">Loading departments</div>\n                    )}\n                    {!loadingDepartments && departmentList.length === 0 && (\n                      <SelectItem value=\"__no_departments__\" disabled>\n                        No departments available\n                      </SelectItem>\n                    )}\n                    {departmentList.map((dept) => (\n                      <SelectItem key={dept.id} value={dept.code}>\n                        {dept.name} \n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n          <FormField\n            control={form.control}\n            name=\"position\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel className=\"text-gray-900 dark:text-gray-100\">Position / Designation</FormLabel>\n                <FormControl>\n                  <Input {...field} placeholder=\"e.g., Sales Executive\" className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n\n                  <FormField\n                    control={form.control}\n                    name=\"role\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Role</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || undefined}>\n                          <FormControl>\n                            <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                              <SelectValue placeholder=\"Select role\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"staff\">Staff</SelectItem>\n                            <SelectItem value=\"manager\">Manager</SelectItem>\n                            <SelectItem value=\"hr_manager\">HR Manager</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"status\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Status</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || undefined}>\n                          <FormControl>\n                            <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                              <SelectValue placeholder=\"Select status\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"active\">Active</SelectItem>\n                            <SelectItem value=\"inactive\">Inactive</SelectItem>\n                           \n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"reportingManager\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormControl>\n                          <ReportingManagerSelector\n                            value={field.value || ''}\n                            onChange={field.onChange}\n                            label=\"Reporting Manager\"\n                            placeholder=\"Select reporting manager...\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Login Credentials */}\n            <LoginCredentials\n              control={form.control}\n              watchedEmail={watchedEmail}\n              watchedName={watchedName}\n              formErrors={form.formState.errors}\n            />\n\n            {/* Operational Countries */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Operational Countries</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <FormField\n                  control={form.control}\n                  name=\"operationalCountries\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormControl>\n                        <OperationalCountriesSelector\n                          selectedCountries={field.value}\n                          onCountriesChange={field.onChange}\n                          placeholder=\"Select countries this staff member manages...\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            {/* Skills */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Skills</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add new skill\"\n                    value={newSkill}\n                    onChange={(e) => setNewSkill(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addSkill())}\n                    className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\"\n                  />\n                  <Button type=\"button\" onClick={addSkill}>\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {form.watch('skills').map((skill, index) => (\n                    <Badge key={index} variant=\"secondary\" className=\"flex items-center gap-1\">\n                      {skill}\n                      <button\n                        type=\"button\"\n                        onClick={() => removeSkill(skill)}\n                        className=\"ml-1 hover:text-red-500\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Certifications */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Certifications</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add new certification\"\n                    value={newCertification}\n                    onChange={(e) => setNewCertification(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addCertification())}\n                    className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\"\n                  />\n                  <Button type=\"button\" onClick={addCertification}>\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {form.watch('certifications').map((cert, index) => (\n                    <Badge key={index} variant=\"secondary\" className=\"flex items-center gap-1\">\n                      {cert}\n                      <button\n                        type=\"button\"\n                        onClick={() => removeCertification(cert)}\n                        className=\"ml-1 hover:text-red-500\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Performance Targets */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Performance Targets</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {form.watch('department') && form.watch('role') && (\n                  <TargetSettings\n                    department={selectedDeptName}\n                    role={form.watch('role')}\n                    targets={targets}\n                    onTargetsChange={setTargets}\n                  />\n                )}\n                {(!form.watch('department') || !form.watch('role')) && (\n                  <div className=\"text-center text-muted-foreground py-8\">\n                    <Target className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>Please select department and role first to configure targets</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Working Hours */}\n            <WorkingHoursSection\n              workingHours={workingHours}\n              onWorkingHoursChange={setWorkingHours}\n            />\n\n            {/* Submit Button */}\n            <div className=\"flex justify-end\">\n              <Button type=\"submit\" className=\"min-w-32\">\n                <Save className=\"mr-2 h-4 w-4\" />\n                Create Staff Profile\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AddStaff;\n","\nimport React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport * as z from \"zod\";\nimport { Link } from \"react-router-dom\";\nimport PageLayout from \"@/components/layout/PageLayout\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { ArrowLeft, Edit, Plus, Trash, Settings, Users, TrendingUp, Target } from \"lucide-react\";\nimport { toast } from \"@/components/ui/sonner\";\n// Enforce Supabase-only loading: remove local sample data imports\n// import { departments, enhancedStaffMembers } from \"@/data/departmentData\";\nimport { Department, DepartmentFeature } from \"@/types/staff\";\nimport { departmentService } from \"@/services/departmentService\";\nimport { useApp } from \"@/contexts/AppContext\";\n\n// Department form schema\nconst departmentFormSchema = z.object({\n  name: z.string().min(2, { message: \"Department name must be at least 2 characters.\" }),\n  code: z.string().min(2, { message: \"Department code must be at least 2 characters.\" }),\n  description: z.string().optional(),\n});\n\ntype DepartmentFormValues = z.infer<typeof departmentFormSchema>;\n\nconst Departments = () => {\n  const { currentUser } = useApp();\n  const isAdmin = currentUser?.role === 'super_admin' || currentUser?.role === 'manager';\n  const [departmentList, setDepartmentList] = useState<Department[]>([]);\n  const [staffCounts, setStaffCounts] = useState<Record<string, number>>({});\n  const [loading, setLoading] = useState<boolean>(false);\nconst [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\nconst [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\nconst [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\nconst [selectedDepartment, setSelectedDepartment] = useState<Department | null>(null);\nconst [isAddFeatureDialogOpen, setIsAddFeatureDialogOpen] = useState(false);\nconst [featureTargetDepartment, setFeatureTargetDepartment] = useState<Department | null>(null);\nconst [newFeature, setNewFeature] = useState<DepartmentFeature>({ id: '', name: '', description: '', enabled: true, config: {} });\n\n  const form = useForm<DepartmentFormValues>({\n    resolver: zodResolver(departmentFormSchema),\n    defaultValues: {\n      name: \"\",\n      code: \"\",\n      description: \"\",\n    },\n  });\n\n  const editForm = useForm<DepartmentFormValues>({\n    resolver: zodResolver(departmentFormSchema),\n    defaultValues: {\n      name: selectedDepartment?.name || \"\",\n      code: selectedDepartment?.code || \"\",\n      description: selectedDepartment?.description || \"\",\n    },\n  });\n\n  React.useEffect(() => {\n    if (selectedDepartment) {\n      editForm.reset({\n        name: selectedDepartment.name,\n        code: selectedDepartment.code,\n        description: selectedDepartment.description,\n      });\n    }\n  }, [selectedDepartment, editForm]);\n\n  // Load departments from Supabase only\n  React.useEffect(() => {\n    let mounted = true;\n    (async () => {\n      try {\n        setLoading(true);\n        const { data, source, error } = await departmentService.getDepartments();\n        if (mounted) {\n          if (source === 'db' && Array.isArray(data)) {\n            setDepartmentList(data);\n          } else {\n            // Supabase-only: do not load local fallback\n            setDepartmentList([]);\n            if (error) toast.error('Failed to load departments from Supabase');\n          }\n        }\n        const counts = await departmentService.getStaffCountsByDepartment();\n        if (mounted) {\n          setStaffCounts(counts || {});\n        }\n      } catch (err) {\n        console.warn('Failed loading departments from Supabase', err);\n        if (mounted) setDepartmentList([]);\n        toast.error('Failed loading departments from Supabase');\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    })();\n    return () => { mounted = false; };\n  }, []);\n\n  // Removed localStorage migration to keep data strictly from Supabase\n\n  const onSubmit = async (values: DepartmentFormValues) => {\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to add departments\");\n      return;\n    }\n    const payload = {\n      id: values.code.toLowerCase().replace(/\\s+/g, '-'),\n      name: values.name,\n      code: values.code,\n      description: values.description || \"\",\n    };\n    const { data, error } = await departmentService.createDepartment(payload as any);\n    if (error) {\n      toast.error(typeof error === 'string' ? error : 'Failed to create department');\n      return;\n    }\n    if (data) {\n      setDepartmentList(prev => [...prev, data]);\n      toast.success(\"Department added successfully!\");\n      setIsAddDialogOpen(false);\n      form.reset();\n    }\n  };\n\n  const onEdit = async (values: DepartmentFormValues) => {\n    if (!selectedDepartment) return;\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to update departments\");\n      return;\n    }\n    const updates = {\n      name: values.name,\n      code: values.code,\n      description: values.description || \"\",\n    };\n    const { error } = await departmentService.updateDepartment(selectedDepartment.id, updates);\n    if (error) {\n      toast.error(typeof error === 'string' ? error : 'Failed to update department');\n      return;\n    }\n    setDepartmentList(prev => prev.map((d) => d.id === selectedDepartment.id ? { ...d, ...updates } : d));\n    toast.success(\"Department updated successfully!\");\n    setIsEditDialogOpen(false);\n  };\n\n  const onDelete = async () => {\n    if (!selectedDepartment) return;\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to delete departments\");\n      return;\n    }\n    const { error } = await departmentService.deleteDepartment(selectedDepartment.id);\n    if (error) {\n      toast.error(typeof error === 'string' ? error : 'Failed to delete department');\n      return;\n    }\n    setDepartmentList(prev => prev.filter((dept) => dept.id !== selectedDepartment.id));\n    toast.success(\"Department deleted successfully!\");\n    setIsDeleteDialogOpen(false);\n  };\n\n  const toggleFeature = async (departmentId: string, featureId: string, enabled: boolean) => {\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to change features\");\n      return;\n    }\n    const target = departmentList.find(d => d.id === departmentId);\n    if (!target) return;\n    const updatedFeatures = (target.features || []).map(f => f.id === featureId ? { ...f, enabled } : f);\n    const { error } = await departmentService.updateDepartment(departmentId, { features: updatedFeatures });\n    if (error) {\n      toast.error('Failed to update feature');\n      return;\n    }\n    setDepartmentList(prev => prev.map(d => d.id === departmentId ? { ...d, features: updatedFeatures } : d));\n  };\n\n  const removeFeature = async (departmentId: string, featureId: string) => {\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to remove features\");\n      return;\n    }\n    const target = departmentList.find(d => d.id === departmentId);\n    if (!target) return;\n    try {\n      setLoading(true);\n      const { error } = await departmentService.removeFeatureFromDepartment(departmentId, featureId);\n      if (error) {\n        toast.error(typeof error === 'string' ? error : 'Failed to remove feature');\n        return;\n      }\n      setDepartmentList(prev => prev.map(d => d.id === departmentId ? { ...d, features: (d.features || []).filter(f => f.id !== featureId) } : d));\n      toast.success('Feature removed');\n    } catch (err) {\n      console.warn('Remove feature failed', err);\n      toast.error('Remove feature failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const initializeFeatures = async (departmentId: string) => {\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to initialize features\");\n      return;\n    }\n    try {\n      setLoading(true);\n      const { error } = await departmentService.initializeDepartmentFeatures(departmentId);\n      if (error) {\n        toast.error(typeof error === 'string' ? error : 'Failed to initialize features');\n        return;\n      }\n      const { data, source } = await departmentService.getDepartments();\n      setDepartmentList(source === 'db' && Array.isArray(data) ? data : departmentList);\n      toast.success('Features initialized from defaults');\n    } catch (err) {\n      console.warn('Initialize features failed', err);\n      toast.error('Initialize features failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Build a simple feature catalog from current Supabase-loaded departments\n  const featureCatalog: DepartmentFeature[] = React.useMemo(() => {\n    const map = new Map<string, DepartmentFeature>();\n    for (const dept of departmentList) {\n      for (const f of dept.features || []) {\n        if (!map.has(String(f.id))) map.set(String(f.id), f);\n      }\n    }\n    return Array.from(map.values());\n  }, [departmentList]);\n\n  const openAddFeatureDialog = (dept: Department) => {\n    setFeatureTargetDepartment(dept);\n    setNewFeature({ id: '', name: '', description: '', enabled: true, config: {} });\n    setIsAddFeatureDialogOpen(true);\n  };\n\n  const pickCatalogFeature = (featureId: string) => {\n    const f = featureCatalog.find((c) => c.id === featureId);\n    if (f) setNewFeature({ ...f });\n  };\n\n  const submitAddFeature = async () => {\n    if (!isAdmin) {\n      toast.error(\"You don't have permission to add features\");\n      return;\n    }\n    if (!featureTargetDepartment) return;\n    const name = (newFeature.name || '').trim();\n    const description = (newFeature.description || '').trim();\n    if (name.length < 2) {\n      toast.error('Feature name must be at least 2 characters');\n      return;\n    }\n    const id = (newFeature.id || name.toLowerCase().replace(/\\s+/g, '-')).trim();\n    let config: Record<string, any> | undefined = undefined;\n    if (newFeature.config && typeof newFeature.config === 'object') {\n      config = newFeature.config;\n    }\n\n    const featurePayload: DepartmentFeature = {\n      id,\n      name,\n      description,\n      enabled: Boolean(newFeature.enabled),\n      ...(config ? { config } : {})\n    } as DepartmentFeature;\n\n    try {\n      setLoading(true);\n      const { error } = await departmentService.addFeatureToDepartment(featureTargetDepartment.id, featurePayload);\n      if (error) {\n        toast.error(typeof error === 'string' ? error : 'Failed to add feature');\n        return;\n      }\n      setDepartmentList(prev => prev.map(d => d.id === featureTargetDepartment.id ? { ...d, features: [...(d.features || []), featurePayload] } : d));\n      setIsAddFeatureDialogOpen(false);\n      toast.success('Feature added');\n    } catch (err) {\n      console.warn('Add feature failed', err);\n      toast.error('Add feature failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Calculate department statistics (Supabase-only: basic counts)\n  const getDepartmentStats = (deptId: string) => {\n    const count = staffCounts[deptId];\n    const totalStaff = typeof count === 'number' ? count : 0;\n    const active = totalStaff; // Without status from DB, treat all as active for display\n    return {\n      totalStaff,\n      activeStaff: active,\n      avgPerformance: 0,\n      totalRevenue: 0\n    };\n  };\n\n  return (\n    <PageLayout\n      title=\"Enhanced Departments\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n        { title: \"Departments\", href: \"/management/staff/departments\" },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between\">\n          <Button variant=\"outline\" size=\"sm\" asChild>\n            <Link to=\"/management/staff\">\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Staff List\n            </Link>\n          </Button>\n          \n          {isAdmin && (\n          <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\n            <DialogTrigger asChild>\n              <Button>\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Add Department\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Add New Department</DialogTitle>\n                <DialogDescription>\n                  Create a new department with advanced features and workflows.\n                </DialogDescription>\n              </DialogHeader>\n              \n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Department Name*</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"E.g., Advanced Sales, Field Operations\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"code\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Department Code*</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"E.g., ASLS, FOPS\" {...field} />\n                        </FormControl>\n                        <FormDescription>\n                          A unique code to identify this department\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"description\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Description</FormLabel>\n                        <FormControl>\n                          <Textarea\n                            placeholder=\"Detailed description of department functions and responsibilities\"\n                            className=\"min-h-[100px]\"\n                            {...field}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"flex justify-end gap-2 pt-4\">\n                    <Button type=\"button\" variant=\"outline\" onClick={() => setIsAddDialogOpen(false)}>\n                      Cancel\n                    </Button>\n                    <Button type=\"submit\">Create Department</Button>\n                  </div>\n                </form>\n              </Form>\n            </DialogContent>\n          </Dialog>\n          )}\n        </div>\n\n        {/* Selection Tracker */}\n        <div className=\"rounded-md border p-4 bg-muted/20\">\n          <div className=\"text-sm font-medium\">Selected Area</div>\n          {selectedDepartment ? (\n            <div className=\"mt-2 flex items-center justify-between\">\n              <div>\n                <div className=\"font-semibold\">{selectedDepartment.name}</div>\n                <div className=\"text-xs text-muted-foreground\">{selectedDepartment.code}</div>\n              </div>\n              <div className=\"text-xs text-muted-foreground max-w-md truncate\">{selectedDepartment.description}</div>\n            </div>\n          ) : (\n            <div className=\"mt-2 text-xs text-muted-foreground\">No department selected</div>\n          )}\n        </div>\n\n        {/* Department Cards Overview */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {departmentList.map((department) => {\n            const stats = getDepartmentStats(department.id);\n            return (\n              <Card\n                key={department.id}\n                className={`hover:shadow-lg transition-shadow ${selectedDepartment?.id === department.id ? 'border-2 border-blue-500' : ''}`}\n                onClick={() => setSelectedDepartment(department)}\n              >\n                <CardHeader>\n                  <div className=\"flex justify-between items-start\">\n                    <div>\n                      <CardTitle className=\"text-lg\">{department.name}</CardTitle>\n                      <Badge variant=\"outline\" className=\"mt-1\">{department.code}</Badge>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      {isAdmin && (\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => {\n                          setSelectedDepartment(department);\n                          setIsEditDialogOpen(true);\n                        }}\n                      >\n                        <Settings className=\"h-4 w-4\" />\n                      </Button>\n                      )}\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-muted-foreground\">{department.description}</p>\n                  \n                  {/* Department Stats */}\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Users className=\"h-4 w-4 text-blue-500\" />\n                      <div>\n                        <div className=\"font-medium\">{stats.activeStaff}/{stats.totalStaff}</div>\n                        <div className=\"text-xs text-muted-foreground\">Active Staff</div>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <TrendingUp className=\"h-4 w-4 text-green-500\" />\n                      <div>\n                        <div className=\"font-medium\">{stats.avgPerformance}/100</div>\n                        <div className=\"text-xs text-muted-foreground\">Avg Performance</div>\n                      </div>\n                    </div>\n                  </div>\n\n                  {stats.totalRevenue > 0 && (\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <Target className=\"h-4 w-4 text-purple-500\" />\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium\">${(stats.totalRevenue / 1000).toFixed(0)}K</div>\n                        <div className=\"text-xs text-muted-foreground\">Monthly Revenue</div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Performance Bar */}\n                  <div className=\"space-y-1\">\n                    <div className=\"flex justify-between text-xs\">\n                      <span>Department Performance</span>\n                      <span>{stats.avgPerformance}%</span>\n                    </div>\n                    <Progress value={stats.avgPerformance} className=\"h-2\" />\n                  </div>\n\n                  {/* Features */}\n                  <div className=\"space-y-2\">\n                    <span className=\"text-sm font-medium\">Active Features:</span>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {department.features.filter(f => f.enabled).map((feature) => (\n                        <Badge key={feature.id} variant=\"secondary\" className=\"text-xs\">\n                          {feature.name}\n                        </Badge>\n                      ))}\n                      {department.features.filter(f => f.enabled).length === 0 && (\n                        <span className=\"text-xs text-muted-foreground\">No active features</span>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Feature Toggles for existing departments */}\n                  {department.features.length > 0 && (\n                    <div className=\"space-y-2 pt-2 border-t\">\n                      <span className=\"text-sm font-medium\">Feature Settings:</span>\n                      {department.features.map((feature) => (\n                        <div key={feature.id} className=\"flex items-center justify-between\">\n                          <span className=\"text-xs\">{feature.name}</span>\n                          <div className=\"flex items-center gap-2\">\n                            <Switch\n                              checked={feature.enabled}\n                              onCheckedChange={(checked) => toggleFeature(department.id, feature.id, checked)}\n                              disabled={!isAdmin || loading}\n                            />\n                            {isAdmin && (\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                aria-label=\"Remove feature\"\n                                onClick={() => removeFeature(department.id, feature.id)}\n                                disabled={loading}\n                              >\n                                <Trash className=\"h-4 w-4 text-red-500\" />\n                              </Button>\n                            )}\n                          </div>\n                        </div>\n                      ))}\n                      {isAdmin && (\n                        <div className=\"pt-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => openAddFeatureDialog(department)} disabled={loading}>\n                            Add Feature\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                  {department.features.length === 0 && isAdmin && (\n                    <div className=\"pt-2 border-t\">\n                      <span className=\"text-sm font-medium\">Feature Settings:</span>\n                      <div className=\"pt-2\">\n                        <Button size=\"sm\" variant=\"outline\" onClick={() => initializeFeatures(department.id)} disabled={loading}>\n                          Initialize Features\n                        </Button>\n                        <Button size=\"sm\" className=\"ml-2\" variant=\"secondary\" onClick={() => openAddFeatureDialog(department)} disabled={loading}>\n                          Add Feature\n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        {/* Detailed Table */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Department Management</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Name</TableHead>\n                  <TableHead>Code</TableHead>\n                  <TableHead className=\"hidden md:table-cell\">Description</TableHead>\n                  <TableHead>Staff</TableHead>\n                  <TableHead>Performance</TableHead>\n                  <TableHead className=\"text-right\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {departmentList.map((department) => {\n                  const stats = getDepartmentStats(department.id);\n                  return (\n                    <TableRow\n                      key={department.id}\n                      className={`${selectedDepartment?.id === department.id ? 'bg-muted/40' : ''}`}\n                      onClick={() => setSelectedDepartment(department)}\n                    >\n                      <TableCell className=\"font-medium\">{department.name}</TableCell>\n                      <TableCell>\n                        <Badge variant=\"outline\">{department.code}</Badge>\n                      </TableCell>\n                      <TableCell className=\"hidden md:table-cell max-w-xs truncate\">\n                        {department.description}\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <span>{stats.activeStaff}/{stats.totalStaff}</span>\n                          <Progress value={(stats.activeStaff / Math.max(stats.totalStaff, 1)) * 100} className=\"h-1 w-12\" />\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-sm\">{stats.avgPerformance}/100</span>\n                          <Progress value={stats.avgPerformance} className=\"h-1 w-12\" />\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <div className=\"flex justify-end gap-2\">\n                          {isAdmin && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => {\n                              setSelectedDepartment(department);\n                              setIsEditDialogOpen(true);\n                            }}\n                          >\n                            <Edit className=\"h-4 w-4\" />\n                            <span className=\"sr-only\">Edit</span>\n                          </Button>\n                          )}\n                          {isAdmin && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => {\n                              setSelectedDepartment(department);\n                              setIsDeleteDialogOpen(true);\n                            }}\n                            disabled={stats.totalStaff > 0}\n                          >\n                            <Trash className=\"h-4 w-4\" />\n                            <span className=\"sr-only\">Delete</span>\n                          </Button>\n                          )}\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n                {departmentList.length === 0 && (\n                  <TableRow>\n                    <TableCell colSpan={6} className=\"text-center py-8 text-muted-foreground\">\n                      No departments found. Create your first department.\n                    </TableCell>\n                  </TableRow>\n                )}\n              </TableBody>\n            </Table>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Edit Department Dialog */}\n      <Dialog open={isEditDialogOpen} onOpenChange={setIsEditDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Department</DialogTitle>\n            <DialogDescription>\n              Update department information and settings.\n            </DialogDescription>\n          </DialogHeader>\n          \n          <Form {...editForm}>\n            <form onSubmit={editForm.handleSubmit(onEdit)} className=\"space-y-4\">\n              <FormField\n                control={editForm.control}\n                name=\"name\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Department Name*</FormLabel>\n                    <FormControl>\n                      <Input {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={editForm.control}\n                name=\"code\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Department Code*</FormLabel>\n                    <FormControl>\n                      <Input {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={editForm.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Description</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        className=\"min-h-[100px]\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"flex justify-end gap-2 pt-4\">\n                <Button type=\"button\" variant=\"outline\" onClick={() => setIsEditDialogOpen(false)}>\n                  Cancel\n                </Button>\n                <Button type=\"submit\">Update Department</Button>\n              </div>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Add Feature Dialog */}\n      <Dialog open={isAddFeatureDialogOpen} onOpenChange={setIsAddFeatureDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Add Feature</DialogTitle>\n            <DialogDescription>\n              Choose from catalog or define a custom feature.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <span className=\"text-sm font-medium\">Catalog</span>\n              <div className=\"flex flex-wrap gap-2 mt-2\">\n                {featureCatalog.slice(0, 10).map((f) => (\n                  <Badge key={f.id} variant=\"outline\" className=\"cursor-pointer\" onClick={() => pickCatalogFeature(f.id)}>\n                    {f.name}\n                  </Badge>\n                ))}\n                {featureCatalog.length === 0 && (\n                  <span className=\"text-xs text-muted-foreground\">No catalog available</span>\n                )}\n              </div>\n            </div>\n            <div className=\"grid grid-cols-1 gap-3\">\n              <div>\n                <label className=\"text-sm\">Feature Name*</label>\n                <Input value={newFeature.name} onChange={(e) => setNewFeature({ ...newFeature, name: e.target.value })} placeholder=\"e.g., Enquiry Tracking\" />\n              </div>\n              <div>\n                <label className=\"text-sm\">Feature ID (optional)</label>\n                <Input value={newFeature.id} onChange={(e) => setNewFeature({ ...newFeature, id: e.target.value })} placeholder=\"e.g., enquiry-tracking\" />\n              </div>\n              <div>\n                <label className=\"text-sm\">Description</label>\n                <Textarea value={newFeature.description} onChange={(e) => setNewFeature({ ...newFeature, description: e.target.value })} placeholder=\"Short description\" />\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm\">Enabled</span>\n                <Switch checked={newFeature.enabled} onCheckedChange={(v) => setNewFeature({ ...newFeature, enabled: v })} />\n              </div>\n            </div>\n            <div className=\"flex justify-end gap-2\">\n              <Button variant=\"outline\" onClick={() => setIsAddFeatureDialogOpen(false)}>Cancel</Button>\n              <Button onClick={submitAddFeature}>Add Feature</Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Department Dialog */}\n      <AlertDialog open={isDeleteDialogOpen} onOpenChange={setIsDeleteDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Are you sure?</AlertDialogTitle>\n            <AlertDialogDescription>\n              This will permanently delete the department \n              \"{selectedDepartment?.name}\". \n              {selectedDepartment && getDepartmentStats(selectedDepartment.id).totalStaff > 0 && (\n                <span className=\"text-destructive font-semibold\">\n                  {\" \"}This department has {getDepartmentStats(selectedDepartment.id).totalStaff} staff members assigned to it.\n                </span>\n              )}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction onClick={onDelete} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\n              Delete Department\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </PageLayout>\n  );\n};\n\nexport default Departments;\n","import React, { useEffect, useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { ArrowLeft, Edit, Mail, Phone, MapPin, Calendar, User, Target, Clock, Star, Cake, Briefcase } from \"lucide-react\";\nimport PageLayout from \"@/components/layout/PageLayout\";\n// Local/static fallbacks removed; rely solely on Supabase\nimport { EnhancedStaffMember } from \"@/types/staff\";\nimport { initialCountries } from \"@/pages/inventory/countries/data/countryData\";\nimport { format } from \"date-fns\";\nimport LoginTracker from \"@/components/staff/LoginTracker\";\nimport StaffStatusManager from \"@/components/staff/StaffStatusManager\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { adminSupabase, isAdminClientConfigured } from \"@/lib/supabaseClient\";\nimport { checkBucketExists } from \"@/lib/storageChecks\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { getStaffReferralLink, getDeterministicStaffReferralLink } from \"@/services/staffReferralService\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useRealTimeCountriesData } from \"@/hooks/useRealTimeCountriesData\";\nimport { listDocuments, uploadDocument, getSignedUrl, approveDocument, rejectDocument, deleteDocument } from \"@/services/staffDocumentsService\";\nimport { getBankAccount, upsertBankAccount, updateBankVerificationStatus } from \"@/services/staffBankService\";\nimport { StaffDocument, StaffBankAccount } from \"@/types/staff\";\nimport { AuthService } from \"@/services/authService\";\nimport TargetSettings from \"@/components/staff/TargetSettings\";\nimport { staffWorkingHoursService } from \"@/services/staffWorkingHoursService\";\nimport { staffTargetService } from \"@/services/staffTargetService\";\n\nconst StaffProfile: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const [staff, setStaff] = useState<EnhancedStaffMember | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isStaffActive, setIsStaffActive] = useState(false);\n  const [referralLink, setReferralLink] = useState<string>(\"\");\n  const [uploadingAvatar, setUploadingAvatar] = useState(false);\n  const { toast } = useToast();\n  const { getCountryById } = useRealTimeCountriesData();\n  const [managerDetails, setManagerDetails] = useState<{\n    id: string;\n    name: string;\n    email?: string;\n    role?: string;\n    department?: string;\n    position?: string;\n  } | null>(null);\n\n  // New: Verification Documents & Bank Account state\n  const [documents, setDocuments] = useState<StaffDocument[]>([]);\n  const [docLoading, setDocLoading] = useState<boolean>(false);\n  const [docType, setDocType] = useState<string>(\"id_proof\");\n  const [docFile, setDocFile] = useState<File | null>(null);\n  const [docNotes, setDocNotes] = useState<string>(\"\");\n  const [uploadingDoc, setUploadingDoc] = useState<boolean>(false);\n\n  const [bank, setBank] = useState<StaffBankAccount | null>(null);\n  const [bankName, setBankName] = useState<string>(\"\");\n  const [accountHolderName, setAccountHolderName] = useState<string>(\"\");\n  const [accountNumber, setAccountNumber] = useState<string>(\"\");\n  const [bankCountry, setBankCountry] = useState<string>(\"\");\n  const [ifscOrSwift, setIfscOrSwift] = useState<string>(\"\");\n  const [branch, setBranch] = useState<string>(\"\");\n  const [savingBank, setSavingBank] = useState<boolean>(false);\n  const [currentRole, setCurrentRole] = useState<string>(\"agent\");\n\n  // Working Hours & Shifts state (Supabase-backed)\n  const defaultWorkingHoursUI = {\n    monday: { isWorking: false, shifts: [] as any[] },\n    tuesday: { isWorking: false, shifts: [] as any[] },\n    wednesday: { isWorking: false, shifts: [] as any[] },\n    thursday: { isWorking: false, shifts: [] as any[] },\n    friday: { isWorking: false, shifts: [] as any[] },\n    saturday: { isWorking: false, shifts: [] as any[] },\n    sunday: { isWorking: false, shifts: [] as any[] },\n  };\n  const [uiWorkingHours, setUiWorkingHours] = useState<any>(defaultWorkingHoursUI);\n  const [whLoading, setWhLoading] = useState<boolean>(false);\n  const [whTimezone, setWhTimezone] = useState<string>((Intl.DateTimeFormat().resolvedOptions().timeZone || \"\"));\n\n  // Performance Targets state (Supabase-backed)\n  const [targets, setTargets] = useState<any[]>([]);\n  const [targetsLoading, setTargetsLoading] = useState<boolean>(false);\n  const [targetsSaving, setTargetsSaving] = useState<boolean>(false);\n\n  useEffect(() => {\n    // Resolve current user role for HR actions\n    AuthService.getCurrentSession().then(({ user }) => {\n      if (user?.role) setCurrentRole(user.role);\n    }).catch(() => {});\n\n    const mapProfileToEnhancedStaff = (p: any): EnhancedStaffMember => {\n      const today = new Date().toISOString().slice(0, 10);\n\n      const defaultWorkingHours: any = {\n        monday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        tuesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        wednesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        thursday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        friday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        saturday: { isWorking: false },\n        sunday: { isWorking: false },\n      };\n\n      const defaultPerformance = {\n        daily: {\n          date: today,\n          tasksCompleted: 0,\n          responseTime: 0,\n          customerSatisfaction: 0,\n        },\n        monthly: {\n          month: today.slice(0, 7),\n          totalTasks: 0,\n          averageResponseTime: 0,\n          averageCustomerSatisfaction: 0,\n          targetAchievement: 0,\n        },\n        quarterly: {\n          quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`,\n          performanceRating: 0,\n          goalsAchieved: 0,\n          totalGoals: 0,\n          growthPercentage: 0,\n        },\n        overall: {\n          totalExperience: '0 years',\n          performanceScore: 0,\n          ranking: 0,\n          badges: [],\n        },\n      };\n\n      const status = ['active', 'inactive', 'on-leave'].includes(p?.status) ? p.status : 'active';\n\n      return {\n        id: p.id,\n        name: p.name || (p.email ? String(p.email).split('@')[0] : 'Staff Member'),\n        email: p.email || '',\n        phone: p.phone || '',\n        department: p.department || 'General',\n        role: p.role || 'staff',\n        position: p.position || undefined,\n        status,\n        avatar: p.avatar || undefined,\n        joinDate: (p.created_at ? String(p.created_at).slice(0, 10) : today),\n        createdAt: p.created_at || undefined,\n        updatedAt: p.updated_at || undefined,\n        dateOfBirth: undefined,\n        skills: [],\n        certifications: [],\n        performance: defaultPerformance,\n        targets: [],\n        permissions: [],\n        workingHours: defaultWorkingHours,\n        reportingManager: undefined,\n        teamMembers: undefined,\n        employeeId: p.employee_id || '',\n        operationalCountries: [],\n        salaryStructure: undefined,\n        leaveBalance: undefined,\n        attendanceRecord: undefined,\n      };\n    };\n\n    const mapStaffRowToEnhancedStaff = (s: any): EnhancedStaffMember => {\n      const today = new Date().toISOString().slice(0, 10);\n\n      const defaultWorkingHours: any = {\n        monday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        tuesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        wednesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        thursday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        friday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n        saturday: { isWorking: false },\n        sunday: { isWorking: false },\n      };\n\n      const defaultPerformance = {\n        daily: {\n          date: today,\n          tasksCompleted: 0,\n          responseTime: 0,\n          customerSatisfaction: 0,\n        },\n        monthly: {\n          month: today.slice(0, 7),\n          totalTasks: 0,\n          averageResponseTime: 0,\n          averageCustomerSatisfaction: 0,\n          targetAchievement: 0,\n        },\n        quarterly: {\n          quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`,\n          performanceRating: 0,\n          goalsAchieved: 0,\n          totalGoals: 0,\n          growthPercentage: 0,\n        },\n        overall: {\n          totalExperience: '0 years',\n          performanceScore: 0,\n          ranking: 0,\n          badges: [],\n        },\n      };\n\n      const status = ['active', 'inactive', 'on-leave'].includes(s?.status) ? s.status : 'active';\n\n      return {\n        id: s.id,\n        name: s.name || (s.email ? String(s.email).split('@')[0] : 'Staff Member'),\n        email: s.email || '',\n        phone: s.phone || '',\n        department: s.department || 'General',\n        role: s.role || 'staff',\n        position: s.position || undefined,\n        status,\n        avatar: undefined,\n        joinDate: (s.join_date ? String(s.join_date).slice(0, 10) : today),\n        createdAt: s.created_at || undefined,\n        updatedAt: s.updated_at || undefined,\n        dateOfBirth: (s.date_of_birth ? String(s.date_of_birth) : undefined),\n        skills: [],\n        certifications: [],\n        performance: defaultPerformance,\n        targets: [],\n        permissions: [],\n        workingHours: defaultWorkingHours,\n        reportingManager: s.reporting_manager || undefined,\n        teamMembers: undefined,\n        employeeId: s.employee_id || '',\n        operationalCountries: Array.isArray(s.operational_countries) ? s.operational_countries : [],\n        salaryStructure: undefined,\n        leaveBalance: undefined,\n        attendanceRecord: undefined,\n      };\n    };\n\n    const loadStaffProfile = async () => {\n      if (!id) return;\n      try {\n        // Load from both 'profiles' and 'staff' tables and merge\n        const { data: profileData, error: profileError } = await supabase\n          .from('profiles')\n          .select('id, name, email, phone, department, role, status, employee_id, position, created_at, updated_at, avatar')\n          .eq('id', id)\n          .maybeSingle();\n\n        const { data: staffData, error: staffError } = await supabase\n          .from('staff' as any)\n          .select('id, name, email, phone, department, role, status, employee_id, join_date, date_of_birth, reporting_manager, operational_countries, created_at, updated_at')\n          .eq('id', id)\n          .maybeSingle();\n\n        if (profileError) console.warn('Supabase profile fetch failed:', profileError);\n        if (staffError) console.warn('Supabase staff fetch failed:', staffError);\n\n        const prof = profileData ? mapProfileToEnhancedStaff(profileData) : undefined;\n        const staffMapped = staffData ? mapStaffRowToEnhancedStaff(staffData) : undefined;\n\n        if (prof || staffMapped) {\n          let merged = prof || (staffMapped as EnhancedStaffMember);\n          if (staffMapped) {\n            merged = {\n              ...merged,\n              // Prefer richer fields from staff table when available\n              joinDate: staffMapped.joinDate || merged.joinDate,\n              dateOfBirth: staffMapped.dateOfBirth || merged.dateOfBirth,\n              reportingManager: staffMapped.reportingManager || merged.reportingManager,\n              operationalCountries:\n                staffMapped.operationalCountries && staffMapped.operationalCountries.length > 0\n                  ? staffMapped.operationalCountries\n                  : merged.operationalCountries || [],\n              createdAt: merged.createdAt || staffMapped.createdAt,\n              updatedAt: staffMapped.updatedAt || merged.updatedAt,\n            };\n          }\n          setStaff(merged);\n        } else {\n          setStaff(null);\n        }\n      } catch (err) {\n        console.warn('Error loading staff profile:', err);\n        setStaff(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadStaffProfile();\n  }, [id]);\n\n  // Load documents and bank when staff is available\n  useEffect(() => {\n    const loadDocsAndBank = async () => {\n      if (!staff?.id) return;\n      try {\n        setDocLoading(true);\n        const docs = await listDocuments(staff.id);\n        // attach signed URL for quick preview/download\n        const withUrls: StaffDocument[] = await Promise.all(docs.map(async (d) => {\n          const url = await getSignedUrl(d.storagePath, 3600);\n          return { ...d, signedUrl: url || undefined };\n        }));\n        setDocuments(withUrls);\n      } catch (e: any) {\n        console.warn('Failed to load documents:', e?.message || e);\n      } finally {\n        setDocLoading(false);\n      }\n      try {\n        const ba = await getBankAccount(staff.id);\n        setBank(ba);\n        if (ba) {\n          setBankName(ba.bankName || '');\n          setAccountHolderName(ba.accountHolderName || '');\n          setBankCountry(ba.country || '');\n          setIfscOrSwift(ba.ifscOrSwift || '');\n          setBranch(ba.branch || '');\n        }\n      } catch (e: any) {\n        console.warn('Failed to load bank account:', e?.message || e);\n      }\n    };\n    loadDocsAndBank();\n  }, [staff?.id]);\n\n  // Ensure shifts have stable IDs for UI operations\n  const ensureShiftIds = (hours: any) => {\n    const withIds: any = {};\n    const dayKeys = [\"monday\",\"tuesday\",\"wednesday\",\"thursday\",\"friday\",\"saturday\",\"sunday\"];\n    dayKeys.forEach((day) => {\n      const dayData = hours?.[day] || { isWorking: false, shifts: [] };\n      const shifts = Array.isArray(dayData.shifts) ? dayData.shifts.map((s: any, idx: number) => ({\n        id: s.id || `shift_${day}_${Date.now()}_${idx}`,\n        startTime: s.startTime || s.start_time || \"09:00\",\n        endTime: s.endTime || s.end_time || \"17:00\",\n        breakStart: s.breakStart || s.break_start || undefined,\n        breakEnd: s.breakEnd || s.break_end || undefined,\n        label: s.label || undefined,\n      })) : [];\n      withIds[day] = { isWorking: !!dayData.isWorking, shifts };\n    });\n    return withIds;\n  };\n\n  // Load working hours & targets when staff is available\n  useEffect(() => {\n    const loadWorkingHours = async () => {\n      if (!staff?.id) return;\n      try {\n        setWhLoading(true);\n        const { data } = await staffWorkingHoursService.getWorkingHoursByStaff(staff.id);\n        const prepared = ensureShiftIds(data);\n        setUiWorkingHours(prepared);\n        // Load timezone separately for view-only display\n        const tzRes = await staffWorkingHoursService.getTimezoneByStaff(staff.id);\n        if (tzRes && tzRes.timezone) {\n          setWhTimezone(String(tzRes.timezone));\n        }\n      } catch (e: any) {\n        console.warn(\"Failed to load working hours:\", e?.message || e);\n        setUiWorkingHours(defaultWorkingHoursUI);\n      } finally {\n        setWhLoading(false);\n      }\n    };\n\n    const loadTargets = async () => {\n      if (!staff?.id) return;\n      try {\n        setTargetsLoading(true);\n        const { data } = await staffTargetService.listTargetsByStaff(staff.id);\n        setTargets(data || []);\n      } catch (e: any) {\n        console.warn(\"Failed to load targets:\", e?.message || e);\n        setTargets([]);\n      } finally {\n        setTargetsLoading(false);\n      }\n    };\n\n    loadWorkingHours();\n    loadTargets();\n  }, [staff?.id]);\n\n  // View mode: editing is handled in Edit Profile page\n\n  const handleSaveTargets = async () => {\n    if (!staff?.id) return;\n    setTargetsSaving(true);\n    try {\n      const { error } = await staffTargetService.replaceTargetsForStaff(staff.id, targets as any);\n      if (error) throw error;\n      toast({ title: \"Targets updated\" });\n    } catch (e: any) {\n      toast({ title: \"Save failed\", description: e?.message || \"Could not save targets\", variant: \"destructive\" });\n    } finally {\n      setTargetsSaving(false);\n    }\n  };\n\n  const refreshDocuments = async () => {\n    if (!staff?.id) return;\n    const docs = await listDocuments(staff.id);\n    const withUrls: StaffDocument[] = await Promise.all(docs.map(async (d) => {\n      const url = await getSignedUrl(d.storagePath, 3600);\n      return { ...d, signedUrl: url || undefined };\n    }));\n    setDocuments(withUrls);\n  };\n\n  const handleDocFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0] || null;\n    setDocFile(file);\n  };\n\n  const handleDocumentUpload = async () => {\n    if (!staff?.id || !docFile) return;\n    setUploadingDoc(true);\n    try {\n      const inserted = await uploadDocument(staff.id, docFile, docType, docNotes);\n      const url = await getSignedUrl(inserted.storagePath, 3600);\n      setDocuments((prev) => [{ ...inserted, signedUrl: url || undefined }, ...prev]);\n      setDocFile(null);\n      setDocNotes('');\n      toast({ title: 'Document uploaded', description: inserted.fileName });\n    } catch (e: any) {\n      toast({ title: 'Upload failed', description: e?.message || 'Error uploading document', variant: 'destructive' });\n    } finally {\n      setUploadingDoc(false);\n    }\n  };\n\n  const handleApproveDoc = async (docId: string) => {\n    try {\n      await approveDocument(docId);\n      await refreshDocuments();\n      toast({ title: 'Document approved' });\n    } catch (e: any) {\n      toast({ title: 'Action failed', description: e?.message || 'Could not approve', variant: 'destructive' });\n    }\n  };\n\n  const handleRejectDoc = async (docId: string) => {\n    try {\n      await rejectDocument(docId, 'Rejected by HR');\n      await refreshDocuments();\n      toast({ title: 'Document rejected' });\n    } catch (e: any) {\n      toast({ title: 'Action failed', description: e?.message || 'Could not reject', variant: 'destructive' });\n    }\n  };\n\n  const handleDeleteDoc = async (doc: StaffDocument) => {\n    try {\n      await deleteDocument(doc);\n      setDocuments((prev) => prev.filter((d) => d.id !== doc.id));\n      toast({ title: 'Document deleted' });\n    } catch (e: any) {\n      toast({ title: 'Delete failed', description: e?.message || 'Could not delete', variant: 'destructive' });\n    }\n  };\n\n  const handleBankSave = async () => {\n    if (!staff?.id) return;\n    if (!bankName || !accountHolderName || !accountNumber) {\n      toast({ title: 'Missing required fields', description: 'Bank name, account holder, and account number are required', variant: 'destructive' });\n      return;\n    }\n    setSavingBank(true);\n    try {\n      const updated = await upsertBankAccount(staff.id, {\n        bankName,\n        accountHolderName,\n        accountNumber,\n        country: bankCountry || undefined,\n        ifscOrSwift: ifscOrSwift || undefined,\n        branch: branch || undefined,\n      });\n      setBank(updated);\n      setAccountNumber('');\n      toast({ title: 'Bank details saved', description: ` ${updated.accountNumberLast4}` });\n    } catch (e: any) {\n      toast({ title: 'Save failed', description: e?.message || 'Could not save bank details', variant: 'destructive' });\n    } finally {\n      setSavingBank(false);\n    }\n  };\n\n  const handleBankVerify = async (status: 'verified' | 'rejected') => {\n    if (!bank?.id) return;\n    try {\n      await updateBankVerificationStatus(bank.id, status);\n      const ba = await getBankAccount(staff!.id);\n      setBank(ba);\n      toast({ title: status === 'verified' ? 'Bank verified' : 'Bank rejected' });\n    } catch (e: any) {\n      toast({ title: 'Action failed', description: e?.message || 'Could not update verification', variant: 'destructive' });\n    }\n  };\n\n  useEffect(() => {\n    const updateReferral = async () => {\n      if (staff?.id) {\n        try {\n          const link = await getStaffReferralLink(staff.id);\n          setReferralLink(link);\n        } catch (e) {\n          setReferralLink(getDeterministicStaffReferralLink(staff.id));\n        }\n      }\n    };\n    updateReferral();\n  }, [staff?.id]);\n\n  const getCountryName = (countryId: string) => {\n    const real = getCountryById(countryId);\n    if (real?.name) return real.name;\n    const fallback = initialCountries.find(c => c.id === countryId);\n    return fallback ? fallback.name : `Country ${countryId}`;\n  };\n\n  const formatDate = (dateString: string) => {\n    try {\n      return format(new Date(dateString), \"PPP\");\n    } catch (error) {\n      return dateString;\n    }\n  };\n\n  const isUUID = (str: string) => {\n    return /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(str);\n  };\n\n  useEffect(() => {\n    const fetchManagerDetails = async () => {\n      const rm = staff?.reportingManager;\n      if (!rm) {\n        setManagerDetails(null);\n        return;\n      }\n\n      // If reportingManager is already a name (not a UUID), use it directly\n      if (!isUUID(rm)) {\n        setManagerDetails({ id: rm, name: rm });\n        return;\n      }\n\n      try {\n        const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n        // Try profiles first\n        const { data: prof, error: profErr } = await client\n          .from('profiles')\n          .select('id, name, email, role, department, position')\n          .eq('id', rm)\n          .maybeSingle();\n\n        if (prof) {\n          setManagerDetails({\n            id: prof.id,\n            name: prof.name || 'Unknown',\n            email: prof.email || undefined,\n            role: prof.role || undefined,\n            department: prof.department || undefined,\n            position: prof.position || undefined,\n          });\n          return;\n        }\n\n        if (profErr) {\n          console.warn('Failed to load reporting manager from profiles:', profErr);\n        }\n\n        // Fallback to staff table\n        const { data: srow, error: sErr } = await client\n          .from('staff' as any)\n          .select('id, name, email, role, department, position')\n          .eq('id', rm)\n          .maybeSingle();\n\n        if (srow) {\n          setManagerDetails({\n            id: srow.id,\n            name: srow.name || 'Unknown',\n            email: srow.email || undefined,\n            role: srow.role || undefined,\n            department: srow.department || undefined,\n            position: srow.position || undefined,\n          });\n          return;\n        }\n\n        if (sErr) {\n          console.warn('Failed to load reporting manager from staff:', sErr);\n        }\n\n        // If all lookups fail, just show the raw value\n        setManagerDetails({ id: rm, name: rm });\n      } catch (e) {\n        console.warn('Error fetching reporting manager details:', e);\n        setManagerDetails({ id: rm, name: rm });\n      }\n    };\n\n    fetchManagerDetails();\n  }, [staff?.reportingManager]);\n\n  const handleAvatarFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    try {\n      const file = e.target.files?.[0];\n      if (!file || !staff?.id) return;\n      setUploadingAvatar(true);\n      // Ensure bucket exists\n      const { exists } = await checkBucketExists('agent_branding');\n      if (!exists) {\n        toast({ title: 'Branding bucket missing', description: 'Create bucket \"agent_branding\" or run migrations.', variant: 'destructive' });\n        return;\n      }\n      const storage = (isAdminClientConfigured && adminSupabase) ? adminSupabase.storage : supabase.storage;\n      const client = (isAdminClientConfigured && adminSupabase) ? adminSupabase : supabase;\n      const safeName = `${crypto.randomUUID()}-${file.name}`.replace(/\\s+/g, '_');\n      const path = `agents/${staff.id}/avatar/${safeName}`;\n      // Resolve content type\n      const ext = file.name.split('.').pop()?.toLowerCase() || '';\n      let contentType = file.type || '';\n      if (!contentType) {\n        if (ext === 'png') contentType = 'image/png';\n        else if (ext === 'jpg' || ext === 'jpeg') contentType = 'image/jpeg';\n        else if (ext === 'webp') contentType = 'image/webp';\n        else contentType = 'image/png';\n      }\n      const res = await storage.from('agent_branding').upload(path, file, { upsert: true, contentType });\n      if ((res as any)?.error) throw (res as any).error;\n      const { data: pub } = storage.from('agent_branding').getPublicUrl(path);\n      const { error } = await client.from('profiles').update({ avatar: pub?.publicUrl, updated_at: new Date().toISOString() }).eq('id', staff.id);\n      if (error) throw error;\n      setStaff(prev => prev ? { ...prev, avatar: pub?.publicUrl } : prev);\n      toast({ title: 'Profile image updated' });\n    } catch (err: any) {\n      console.error('Profile image upload failed', err);\n      toast({ title: 'Upload failed', description: err?.message || 'Could not upload profile image', variant: 'destructive' });\n    } finally {\n      setUploadingAvatar(false);\n      // Reset the input if any\n      (e.target as HTMLInputElement).value = '';\n    }\n  };\n\n  const handleStatusUpdate = async (newStatus: 'active' | 'inactive') => {\n    if (!staff) return;\n    try {\n      const { error } = await supabase\n        .from('profiles')\n        .update({ status: newStatus, updated_at: new Date().toISOString() })\n        .eq('id', staff.id);\n      if (error) {\n        console.warn('Supabase status update failed, applying locally:', error);\n      }\n      setStaff({ ...staff, status: newStatus });\n    } catch (err) {\n      console.error('Error updating status:', err);\n    }\n  };\n\n  const handleLoginStatusChange = (isActive: boolean) => {\n    setIsStaffActive(isActive);\n  };\n\n  const renderWorkingHours = (workingHours: any) => {\n    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\n    \n    return days.map(day => {\n      const dayData = workingHours[day];\n      const dayName = day.charAt(0).toUpperCase() + day.slice(1);\n      \n      // Handle both legacy and new format\n      if (dayData?.shifts && dayData.shifts.length > 0) {\n        // New shift-based format\n        return (\n          <div key={day} className=\"flex justify-between items-start\">\n            <span className=\"capitalize font-medium text-gray-900 dark:text-gray-100\">{dayName}</span>\n            <div className=\"text-right\">\n              {dayData.shifts.map((shift: any, index: number) => (\n                <div key={shift.id || index} className=\"text-sm text-gray-600 dark:text-gray-300 mb-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <Clock className=\"h-3 w-3\" />\n                    <span>\n                      {shift.label && `${shift.label}: `}\n                      {shift.startTime} - {shift.endTime}\n                    </span>\n                  </div>\n                  {shift.breakStart && shift.breakEnd && (\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400 ml-5\">\n                      Break: {shift.breakStart} - {shift.breakEnd}\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n      } else if (dayData?.isWorking && dayData?.startTime && dayData?.endTime) {\n        // Legacy format\n        return (\n          <div key={day} className=\"flex justify-between items-center\">\n            <span className=\"capitalize font-medium text-gray-900 dark:text-gray-100\">{dayName}</span>\n            <div className=\"flex items-center gap-2\">\n              <Clock className=\"h-3 w-3 text-gray-500 dark:text-gray-400\" />\n              <span className=\"text-sm text-gray-600 dark:text-gray-300\">\n                {dayData.startTime} - {dayData.endTime}\n              </span>\n            </div>\n          </div>\n        );\n      } else {\n        // Not working\n        return (\n          <div key={day} className=\"flex justify-between items-center\">\n            <span className=\"capitalize font-medium text-gray-900 dark:text-gray-100\">{dayName}</span>\n            <div className=\"flex items-center gap-2\">\n              <Clock className=\"h-3 w-3 text-gray-500 dark:text-gray-400\" />\n              <span className=\"text-sm text-gray-600 dark:text-gray-300\">Off</span>\n            </div>\n          </div>\n        );\n      }\n    });\n  };\n\n  if (loading) {\n    return (\n      <PageLayout\n        title=\"Loading...\"\n        breadcrumbItems={[\n          { title: \"Home\", href: \"/\" },\n          { title: \"Staff Management\", href: \"/management/staff\" },\n          { title: \"Profile\", href: \"#\" },\n        ]}\n      >\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-lg text-gray-900 dark:text-gray-100\">Loading staff profile...</div>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  if (!staff) {\n    return (\n      <PageLayout\n        title=\"Staff Not Found\"\n        breadcrumbItems={[\n          { title: \"Home\", href: \"/\" },\n          { title: \"Staff Management\", href: \"/management/staff\" },\n          { title: \"Profile\", href: \"#\" },\n        ]}\n      >\n        <div className=\"text-center py-12\">\n          <h2 className=\"text-2xl font-bold text-red-600 mb-4\">Staff member not found</h2>\n          <p className=\"text-gray-600 dark:text-gray-300 mb-6\">The staff member you're looking for doesn't exist or has been removed.</p>\n          <Button asChild>\n            <Link to=\"/management/staff\">\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Staff List\n            </Link>\n          </Button>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout\n      title={staff.name}\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n        { title: staff.name, href: \"#\" },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between\">\n          <Button variant=\"outline\" size=\"sm\" asChild>\n            <Link to=\"/management/staff\">\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Staff List\n            </Link>\n          </Button>\n          <Button asChild>\n            <Link to={`/management/staff/edit/${staff.id}`}>\n              <Edit className=\"mr-2 h-4 w-4\" />\n              Edit Profile\n            </Link>\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Profile Overview */}\n          <Card className=\"lg:col-span-1 bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n            <CardHeader>\n              <div className=\"flex flex-col items-center space-y-4\">\n                <div className=\"relative\">\n                  <Avatar className=\"h-24 w-24\">\n                    <AvatarImage src={staff.avatar} alt={staff.name} />\n                    <AvatarFallback className=\"text-lg bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300\">\n                      {staff.name.split(' ').map(n => n[0]).join('')}\n                    </AvatarFallback>\n                  </Avatar>\n                  {isStaffActive && (\n                    <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center\">\n                      <div className=\"w-2 h-2 bg-white rounded-full\"></div>\n                    </div>\n                  )}\n                </div>\n                <div className=\"text-center\">\n                  <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">{staff.name}</h2>\n                  <p className=\"text-gray-600 dark:text-gray-300\">{staff.role}</p>\n                  <div className=\"flex items-center justify-center gap-2 mt-2\">\n                    <Badge\n                      variant={staff.status === \"active\" ? \"default\" : \"secondary\"}\n                      className=\"mt-2\"\n                    >\n                      {staff.status === \"active\" ? \"Active\" : staff.status === \"inactive\" ? \"Inactive\" : \"On Leave\"}\n                    </Badge>\n                    {isStaffActive && (\n                      <Badge variant=\"outline\" className=\"mt-2 border-green-500 text-green-600\">\n                        Online\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n                <div className=\"mt-3 flex items-center justify-center\">\n                  <label className=\"inline-flex items-center\">\n                    <input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={handleAvatarFileChange}\n                      className=\"hidden\"\n                      id=\"staff-avatar-input\"\n                    />\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => document.getElementById('staff-avatar-input')?.click()} disabled={uploadingAvatar}>\n                      {uploadingAvatar ? 'Uploading...' : 'Change Photo'}\n                    </Button>\n                  </label>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center space-x-2\">\n                <Mail className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                <span className=\"text-sm text-gray-900 dark:text-gray-100\">{staff.email}</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Phone className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                <span className=\"text-sm text-gray-900 dark:text-gray-100\">{staff.phone}</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <User className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                <span className=\"text-sm text-gray-900 dark:text-gray-100\">Employee ID: {staff.employeeId}</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Calendar className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                <span className=\"text-sm text-gray-900 dark:text-gray-100\">Joined: {formatDate(staff.joinDate)}</span>\n              </div>\n              {staff.dateOfBirth && (\n                <div className=\"flex items-center space-x-2\">\n                  <Cake className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">DOB: {formatDate(staff.dateOfBirth)}</span>\n                </div>\n              )}\n              {staff.department && (\n                <div className=\"flex items-center space-x-2\">\n                  <Briefcase className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">Department: {staff.department}</span>\n                </div>\n              )}\n              {staff.position && (\n                <div className=\"flex items-center space-x-2\">\n                  <Briefcase className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">Position: {staff.position}</span>\n                </div>\n              )}\n              {staff.role && (\n                <div className=\"flex items-center space-x-2\">\n                  <User className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">Role: {staff.role}</span>\n                </div>\n              )}\n              {staff.reportingManager && (\n                <div className=\"flex items-center space-x-2\">\n                  <User className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">\n                    Reporting Manager: {managerDetails ? (\n                      <>\n                        <Link to={`/management/staff/profile/${managerDetails.id}`} className=\"underline\">\n                          {managerDetails.name}\n                        </Link>\n                        {(managerDetails.role || managerDetails.department || managerDetails.position) && (\n                          <>  {[managerDetails.role, managerDetails.department, managerDetails.position].filter(Boolean).join(', ')}</>\n                        )}\n                      </>\n                    ) : (\n                      staff.reportingManager\n                    )}\n                  </span>\n                </div>\n              )}\n              {staff.createdAt && (\n                <div className=\"flex items-center space-x-2\">\n                  <Calendar className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">Created: {formatDate(staff.createdAt)}</span>\n                </div>\n              )}\n              {staff.updatedAt && (\n                <div className=\"flex items-center space-x-2\">\n                  <Calendar className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">Updated: {formatDate(staff.updatedAt)}</span>\n                </div>\n              )}\n              {staff.operationalCountries && staff.operationalCountries.length > 0 && (\n                <div className=\"flex items-center space-x-2\">\n                  <MapPin className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-900 dark:text-gray-100\">\n                    Operational Countries: {staff.operationalCountries.map((cId) => getCountryName(cId)).join(', ')}\n                  </span>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Details */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Staff Status Management */}\n            <StaffStatusManager \n              staff={staff} \n              onStatusUpdate={handleStatusUpdate}\n            />\n\n            {/* Login Tracker */}\n            <LoginTracker \n              staffId={staff.id}\n              staffName={staff.name}\n              onStatusChange={handleLoginStatusChange}\n            />\n\n            {/* Staff Referral Link */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Staff Referral Link</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex flex-col md:flex-row gap-3\">\n                  <Input value={referralLink || (staff ? `https://tripoex.com/signup/agent?ref=staff_${staff.id}` : '')} readOnly />\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" onClick={() => referralLink && navigator.clipboard.writeText(referralLink)}>Copy</Button>\n                    <Button asChild>\n                      <a href={referralLink || (staff ? `https://tripoex.com/signup/agent?ref=staff_${staff.id}` : '#')} target=\"_blank\" rel=\"noopener noreferrer\">\n                        Open\n                      </a>\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-300\">\n                  Share to onboard new agents.\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Performance Overview */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Performance Overview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\n                      {staff.performance.overall.performanceScore}\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">Performance Score</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600\">\n                      {staff.performance.daily.customerSatisfaction}/5\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">Satisfaction</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-purple-600\">\n                      {staff.performance.overall.ranking}\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">Ranking</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-orange-600\">\n                      {staff.performance.overall.badges.length}\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">Badges</div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Verification Documents */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Verification Documents</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex flex-col md:flex-row gap-3 items-end\">\n                  <div className=\"w-full md:w-48\">\n                    <Label className=\"text-sm\">Document Type</Label>\n                    <Select value={docType} onValueChange={setDocType}>\n                      <SelectTrigger className=\"mt-1\"><SelectValue placeholder=\"Select type\" /></SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"id_proof\">ID Proof</SelectItem>\n                        <SelectItem value=\"address_proof\">Address Proof</SelectItem>\n                        <SelectItem value=\"bank_statement\">Bank Statement</SelectItem>\n                        <SelectItem value=\"education_certificate\">Education Certificate</SelectItem>\n                        <SelectItem value=\"employment_letter\">Employment Letter</SelectItem>\n                        <SelectItem value=\"other\">Other</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"w-full md:flex-1\">\n                    <Label className=\"text-sm\">Notes (optional)</Label>\n                    <Textarea className=\"mt-1\" value={docNotes} onChange={(e) => setDocNotes(e.target.value)} rows={2} />\n                  </div>\n                  <div className=\"w-full md:w-64\">\n                    <Label className=\"text-sm\">File</Label>\n                    <Input type=\"file\" accept=\"application/pdf,image/*\" onChange={handleDocFileChange} />\n                  </div>\n                  <Button onClick={handleDocumentUpload} disabled={uploadingDoc || !docFile}>\n                    {uploadingDoc ? 'Uploading...' : 'Upload'}\n                  </Button>\n                </div>\n\n                <Separator className=\"my-2\" />\n\n                {docLoading ? (\n                  <div className=\"text-sm text-gray-600 dark:text-gray-300\">Loading documents...</div>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {documents.length === 0 ? (\n                      <div className=\"text-sm text-gray-600 dark:text-gray-300\">No documents uploaded yet.</div>\n                    ) : (\n                      documents.map((doc) => (\n                        <div key={doc.id} className=\"flex items-center justify-between p-2 border rounded-md dark:border-gray-700\">\n                          <div className=\"flex items-center gap-3\">\n                            <Badge variant=\"secondary\" className=\"capitalize\">{doc.docType.replace('_',' ')}</Badge>\n                            <a href={doc.signedUrl || '#'} target=\"_blank\" rel=\"noopener noreferrer\" className=\"underline\">\n                              {doc.fileName}\n                            </a>\n                            <Badge variant={doc.status === 'approved' ? 'default' : doc.status === 'rejected' ? 'destructive' : 'outline'}>\n                              {doc.status.charAt(0).toUpperCase() + doc.status.slice(1)}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            {(currentRole === 'hr_manager' || currentRole === 'manager' || currentRole === 'super_admin') ? (\n                              <>\n                                <Button size=\"sm\" variant=\"outline\" onClick={() => handleApproveDoc(doc.id)} disabled={doc.status === 'approved'}>\n                                  Approve\n                                </Button>\n                                <Button size=\"sm\" variant=\"destructive\" onClick={() => handleRejectDoc(doc.id)} disabled={doc.status === 'rejected'}>\n                                  Reject\n                                </Button>\n                              </>\n                            ) : null}\n                            <Button size=\"sm\" variant=\"ghost\" onClick={() => handleDeleteDoc(doc)}>\n                              Delete\n                            </Button>\n                          </div>\n                        </div>\n                      ))\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Bank Account Details */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Bank Account Details</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {bank ? (\n                  <div className=\"text-sm text-gray-700 dark:text-gray-200\">\n                    <div className=\"flex flex-wrap gap-4 mb-2\">\n                      <Badge variant=\"outline\">{bank.bankName}</Badge>\n                      <Badge variant=\"outline\">{bank.accountHolderName}</Badge>\n                      <Badge variant=\"outline\"> {bank.accountNumberLast4}</Badge>\n                      {bank.country && <Badge variant=\"outline\">{bank.country}</Badge>}\n                      {bank.ifscOrSwift && <Badge variant=\"outline\">{bank.ifscOrSwift}</Badge>}\n                      {bank.branch && <Badge variant=\"outline\">{bank.branch}</Badge>}\n                    </div>\n                    <div>\n                      <span className=\"mr-2\">Verification:</span>\n                      <Badge variant={bank.verifiedStatus === 'verified' ? 'default' : bank.verifiedStatus === 'rejected' ? 'destructive' : 'secondary'}>\n                        {bank.verifiedStatus}\n                      </Badge>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-sm text-gray-600 dark:text-gray-300\">No bank details found. Add below.</div>\n                )}\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                  <div>\n                    <Label className=\"text-sm\">Bank Name</Label>\n                    <Input className=\"mt-1\" value={bankName} onChange={(e) => setBankName(e.target.value)} />\n                  </div>\n                  <div>\n                    <Label className=\"text-sm\">Account Holder Name</Label>\n                    <Input className=\"mt-1\" value={accountHolderName} onChange={(e) => setAccountHolderName(e.target.value)} />\n                  </div>\n                  <div>\n                    <Label className=\"text-sm\">Account Number</Label>\n                    <Input className=\"mt-1\" type=\"text\" value={accountNumber} onChange={(e) => setAccountNumber(e.target.value)} placeholder=\"Enter full number (will be encrypted)\" />\n                  </div>\n                  <div>\n                    <Label className=\"text-sm\">Country</Label>\n                    <Input className=\"mt-1\" value={bankCountry} onChange={(e) => setBankCountry(e.target.value)} />\n                  </div>\n                  <div>\n                    <Label className=\"text-sm\">IFSC/SWIFT</Label>\n                    <Input className=\"mt-1\" value={ifscOrSwift} onChange={(e) => setIfscOrSwift(e.target.value)} />\n                  </div>\n                  <div>\n                    <Label className=\"text-sm\">Branch</Label>\n                    <Input className=\"mt-1\" value={branch} onChange={(e) => setBranch(e.target.value)} />\n                  </div>\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button onClick={handleBankSave} disabled={savingBank}>\n                    {savingBank ? 'Saving...' : (bank ? 'Update Bank Details' : 'Add Bank Details')}\n                  </Button>\n                  {(currentRole === 'hr_manager' || currentRole === 'manager' || currentRole === 'super_admin') && bank?.id ? (\n                    <>\n                      <Button variant=\"outline\" onClick={() => handleBankVerify('verified')}>Mark Verified</Button>\n                      <Button variant=\"destructive\" onClick={() => handleBankVerify('rejected')}>Reject</Button>\n                    </>\n                  ) : null}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Skills & Certifications */}\n            {(staff.skills && staff.skills.length > 0) || (staff.certifications && staff.certifications.length > 0) ? (\n              <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n                <CardHeader>\n                  <CardTitle className=\"text-gray-900 dark:text-gray-100\">Skills & Certifications</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {staff.skills && staff.skills.length > 0 && (\n                    <div>\n                      <h4 className=\"font-medium mb-2 text-gray-900 dark:text-gray-100\">Skills</h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {staff.skills.map((skill, index) => (\n                          <Badge key={index} variant=\"secondary\">\n                            {skill}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                  {staff.certifications && staff.certifications.length > 0 && (\n                    <div>\n                      <h4 className=\"font-medium mb-2 text-gray-900 dark:text-gray-100\">Certifications</h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {staff.certifications.map((cert, index) => (\n                          <Badge key={index} variant=\"outline\">\n                            <Star className=\"h-3 w-3 mr-1\" />\n                            {cert}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            ) : null}\n\n            {/* Operational Countries */}\n            {staff.operationalCountries && staff.operationalCountries.length > 0 && (\n              <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n                <CardHeader>\n                  <CardTitle className=\"text-gray-900 dark:text-gray-100\">Operational Countries</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {staff.operationalCountries.map((countryId) => (\n                      <Badge key={countryId} variant=\"outline\">\n                        <MapPin className=\"h-3 w-3 mr-1\" />\n                        {getCountryName(countryId)}\n                      </Badge>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Performance Targets (Supabase-backed CRUD) */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100 flex items-center justify-between\">\n                  <span>Performance Targets</span>\n                  {targetsLoading && (\n                    <span className=\"text-xs text-muted-foreground\">Loading</span>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <TargetSettings\n                  department={staff.department || \"General\"}\n                  role={staff.role || \"staff\"}\n                  targets={targets as any}\n                  onTargetsChange={(next) => setTargets(next as any)}\n                />\n                <div className=\"flex items-center gap-3\">\n                  <Button onClick={handleSaveTargets} disabled={targetsSaving}>\n                    {targetsSaving ? \"Saving\" : \"Save Targets\"}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Working Hours & Shifts (View Mode) */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100 flex items-center justify-between\">\n                  <span>Working Hours & Shifts</span>\n                  {whLoading && (\n                    <span className=\"text-xs text-muted-foreground\">Loading</span>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                  {['monday','tuesday','wednesday','thursday','friday','saturday','sunday'].map((day) => {\n                    const dayLabelMap: Record<string, string> = {\n                      monday: 'Monday',\n                      tuesday: 'Tuesday',\n                      wednesday: 'Wednesday',\n                      thursday: 'Thursday',\n                      friday: 'Friday',\n                      saturday: 'Saturday',\n                      sunday: 'Sunday',\n                    };\n                    const d = (uiWorkingHours as any)?.[day] || { isWorking: false, shifts: [] };\n                    return (\n                      <div key={day} className=\"rounded-md border border-gray-200 dark:border-gray-700\">\n                        <div className=\"flex items-center justify-between px-3 py-2\">\n                          <span className=\"font-medium text-gray-900 dark:text-gray-100\">{dayLabelMap[day]}</span>\n                          <Badge variant=\"outline\">{d.isWorking ? 'Working' : 'Off'}</Badge>\n                        </div>\n                        <div className=\"px-3 pb-3 space-y-1\">\n                          {d.isWorking && Array.isArray(d.shifts) && d.shifts.length > 0 ? (\n                            d.shifts.map((s: any, idx: number) => (\n                              <div key={s.id || idx} className=\"text-sm text-muted-foreground\">\n                                {s.startTime || s.start_time}  {s.endTime || s.end_time}\n                                {s.breakStart || s.break_start ? (\n                                  <span> (Break {s.breakStart || s.break_start}-{s.breakEnd || s.break_end})</span>\n                                ) : null}\n                                {s.label ? <span>  {s.label}</span> : null}\n                              </div>\n                            ))\n                          ) : (\n                            <div className=\"text-sm text-muted-foreground\">No shifts</div>\n                          )}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">To update working hours, use the Edit Profile button above.</div>\n              </CardContent>\n            </Card>\n\n            {/* Timezone (View Mode) */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Timezone</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"h-4 w-4\" />\n                  <span className=\"font-medium text-gray-900 dark:text-gray-100\">{whTimezone || 'Not set'}</span>\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Manage timezone in Edit Profile.</div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default StaffProfile;\n","\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { format } from 'date-fns';\nimport { Save, X, Plus, Trash2, Target, ArrowLeft, Calendar as CalendarIcon } from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { EnhancedStaffMember, Target as TargetType } from '@/types/staff';\nimport { departments } from '@/data/departmentData';\nimport { toast } from '@/hooks/use-toast';\nimport EmployeeCodeField from '@/components/staff/EmployeeCodeField';\nimport OperationalCountriesSelector from '@/components/staff/OperationalCountriesSelector';\nimport ReportingManagerSelector from '@/components/staff/ReportingManagerSelector';\nimport TargetSettings from '@/components/staff/TargetSettings';\nimport WorkingHoursSection from '@/components/staff/WorkingHoursSection';\nimport LoginCredentials from '@/components/staff/LoginCredentials';\nimport { validateEmployeeCode, isEmployeeCodeUnique } from '@/utils/employeeCodeGenerator';\nimport { validatePasswordStrength, checkUsernameUniqueness } from '@/utils/credentialGenerator';\nimport { updateStaffMember } from '@/services/staffStorageService';\nimport { syncStaffWithAuthSystem } from '@/services/credentialService';\nimport { supabase } from '@/integrations/supabase/client';\nimport { staffWorkingHoursService } from '@/services/staffWorkingHoursService';\nimport { staffTargetService } from '@/services/staffTargetService';\nimport { TIMEZONE_OPTIONS, formatTimezoneDisplay } from '@/data/timezones';\n\nconst staffSchema = z.object({\n  name: z.string().min(2, 'Name must be at least 2 characters'),\n  email: z.string().email('Invalid email address'),\n  phone: z.string().min(10, 'Phone number must be at least 10 characters'),\n  department: z.string().min(1, 'Department is required'),\n  role: z.string().min(1, 'Role is required'),\n  status: z.enum(['active', 'inactive', 'on-leave']),\n  employeeId: z.string()\n    .min(1, \"Employee code must be at least 1 digit\")\n    .max(10, \"Employee code must be at most 10 digits\")\n    .refine(validateEmployeeCode, \"Employee code must be digits only\"),\n  operationalCountries: z.array(z.string()).min(1, \"Please select at least one operational country\"),\n  skills: z.array(z.string()),\n  certifications: z.array(z.string()),\n  reportingManager: z.string(),\n  joinDate: z.date({\n    required_error: \"Joining date is required\",\n  }),\n  dateOfBirth: z.date({\n    required_error: \"Date of birth is required\",\n  }),\n  // Optional login credentials fields for editing\n  username: z.string().optional(),\n  password: z.string().optional(),\n  confirmPassword: z.string().optional(),\n  mustChangePassword: z.boolean().default(false)\n}).refine((data) => {\n  if (data.password && data.confirmPassword) {\n    return data.password === data.confirmPassword;\n  }\n  return true;\n}, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\ntype StaffFormData = z.infer<typeof staffSchema>;\n\nconst EditStaff: React.FC = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [staff, setStaff] = useState<EnhancedStaffMember | null>(null);\n  const [newSkill, setNewSkill] = useState('');\n  const [newCertification, setNewCertification] = useState('');\n  const [showCredentials, setShowCredentials] = useState(false);\n  const [workingHours, setWorkingHours] = useState<any>({\n    monday: { isWorking: false, shifts: [] },\n    tuesday: { isWorking: false, shifts: [] },\n    wednesday: { isWorking: false, shifts: [] },\n    thursday: { isWorking: false, shifts: [] },\n    friday: { isWorking: false, shifts: [] },\n    saturday: { isWorking: false, shifts: [] },\n    sunday: { isWorking: false, shifts: [] }\n  });\n  const [whTimezone, setWhTimezone] = useState<string>(Intl.DateTimeFormat().resolvedOptions().timeZone || '');\n  const [targets, setTargets] = useState<TargetType[]>([]);\n\n  const form = useForm<StaffFormData>({\n    resolver: zodResolver(staffSchema.refine((data) => \n      isEmployeeCodeUnique(data.employeeId, id), {\n        message: \"Employee code must be unique\",\n        path: [\"employeeId\"]\n      }\n    )),\n    defaultValues: {\n      name: '',\n      email: '',\n      phone: '',\n      department: '',\n      role: '',\n      status: 'active',\n      employeeId: '',\n      skills: [],\n      certifications: [],\n      operationalCountries: [],\n      reportingManager: '',\n      joinDate: new Date(),\n      dateOfBirth: new Date(),\n      username: '',\n      password: '',\n      confirmPassword: '',\n      mustChangePassword: false,\n    }\n  });\n\n  useEffect(() => {\n    const mapProfileToEnhancedStaff = (p: any): EnhancedStaffMember => {\n      const today = new Date().toISOString().slice(0, 10);\n      const status = ['active', 'inactive', 'on-leave'].includes(p?.status) ? p.status : 'active';\n      return {\n        id: p.id,\n        name: p.name || (p.email ? String(p.email).split('@')[0] : 'Staff Member'),\n        email: p.email || '',\n        phone: p.phone || '',\n        department: p.department || 'General',\n        role: p.role || 'staff',\n        status,\n        avatar: p.avatar || undefined,\n        joinDate: (p.created_at ? String(p.created_at).slice(0, 10) : today),\n        dateOfBirth: undefined,\n        skills: [],\n        certifications: [],\n        performance: {\n          daily: { date: today, tasksCompleted: 0, responseTime: 0, customerSatisfaction: 0 },\n          monthly: { month: today.slice(0, 7), totalTasks: 0, averageResponseTime: 0, averageCustomerSatisfaction: 0, targetAchievement: 0 },\n          quarterly: { quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`, performanceRating: 0, goalsAchieved: 0, totalGoals: 0, growthPercentage: 0 },\n          overall: { totalExperience: '0 years', performanceScore: 0, ranking: 0, badges: [] },\n        },\n        targets: [],\n        permissions: [],\n        workingHours: {\n          monday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          tuesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          wednesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          thursday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          friday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          saturday: { isWorking: false },\n          sunday: { isWorking: false },\n        },\n        reportingManager: undefined,\n        teamMembers: undefined,\n        employeeId: p.employee_id || '',\n        operationalCountries: [],\n        salaryStructure: undefined,\n        leaveBalance: undefined,\n        attendanceRecord: undefined,\n      };\n    };\n\n    const mapStaffRowToEnhancedStaff = (s: any): EnhancedStaffMember => {\n      const today = new Date().toISOString().slice(0, 10);\n      const status = ['active', 'inactive', 'on-leave'].includes(s?.status) ? s.status : 'active';\n      return {\n        id: s.id,\n        name: s.name || (s.email ? String(s.email).split('@')[0] : 'Staff Member'),\n        email: s.email || '',\n        phone: s.phone || '',\n        department: s.department || 'General',\n        role: s.role || 'staff',\n        status,\n        avatar: s.avatar || undefined,\n        joinDate: (s.join_date ? String(s.join_date).slice(0, 10) : today),\n        dateOfBirth: s.date_of_birth ? String(s.date_of_birth).slice(0, 10) : undefined,\n        skills: [],\n        certifications: [],\n        performance: {\n          daily: { date: today, tasksCompleted: 0, responseTime: 0, customerSatisfaction: 0 },\n          monthly: { month: today.slice(0, 7), totalTasks: 0, averageResponseTime: 0, averageCustomerSatisfaction: 0, targetAchievement: 0 },\n          quarterly: { quarter: `Q${Math.floor((new Date().getMonth() / 3) + 1)}-${new Date().getFullYear()}`, performanceRating: 0, goalsAchieved: 0, totalGoals: 0, growthPercentage: 0 },\n          overall: { totalExperience: '0 years', performanceScore: 0, ranking: 0, badges: [] },\n        },\n        targets: [],\n        permissions: [],\n        workingHours: {\n          monday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          tuesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          wednesday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          thursday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          friday: { isWorking: true, startTime: '09:00', endTime: '17:00' },\n          saturday: { isWorking: false },\n          sunday: { isWorking: false },\n        },\n        reportingManager: s.reporting_manager || '',\n        teamMembers: undefined,\n        employeeId: s.employee_id || '',\n        operationalCountries: Array.isArray(s.operational_countries) ? s.operational_countries : [],\n        salaryStructure: undefined,\n        leaveBalance: undefined,\n        attendanceRecord: undefined,\n      };\n    };\n\n    const loadStaff = async () => {\n      if (!id) return;\n      try {\n        const { data, error } = await supabase\n          .from('profiles')\n          .select('id, name, email, phone, department, role, status, employee_id, created_at, avatar')\n          .eq('id', id)\n          .maybeSingle();\n        if (error) {\n          console.warn('Supabase profile fetch failed:', error);\n        }\n        if (data) {\n          const staffMember = mapProfileToEnhancedStaff(data);\n\n          // Merge extended fields from staff table (join_date, date_of_birth, reporting_manager, operational_countries, employee_id)\n          let mergedStaffMember = staffMember;\n          try {\n            const { data: staffRow, error: staffRowError } = await supabase\n              .from('staff' as any)\n              .select('join_date, date_of_birth, reporting_manager, operational_countries, employee_id')\n              .eq('id', id)\n              .maybeSingle();\n\n            if (staffRowError) {\n              console.warn('Supabase staff (extended fields) fetch failed:', staffRowError);\n            }\n\n            if (staffRow) {\n              const extra = mapStaffRowToEnhancedStaff(staffRow);\n              mergedStaffMember = {\n                ...staffMember,\n                employeeId: extra.employeeId || staffMember.employeeId,\n                joinDate: extra.joinDate || staffMember.joinDate,\n                dateOfBirth: extra.dateOfBirth || staffMember.dateOfBirth,\n                reportingManager: extra.reportingManager || staffMember.reportingManager,\n                operationalCountries: Array.isArray(extra.operationalCountries) ? extra.operationalCountries : (staffMember.operationalCountries || []),\n              };\n            }\n          } catch (augmentErr) {\n            console.warn('Failed to augment staff details from staff table:', augmentErr);\n          }\n\n          setStaff(mergedStaffMember);\n\n          // Convert legacy working hours format to new shift format if needed\n          const convertedWorkingHours = convertLegacyWorkingHours(mergedStaffMember.workingHours);\n          setWorkingHours(convertedWorkingHours);\n          setTargets(mergedStaffMember.targets || []);\n\n          // Load persisted Working Hours & Targets from Supabase if available\n          try {\n            const wh = await staffWorkingHoursService.getWorkingHoursByStaff(id);\n            if (!wh.error) setWorkingHours(wh.data);\n            // Load timezone separately\n            try {\n              const tzRes = await staffWorkingHoursService.getTimezoneByStaff(id);\n              if (!tzRes.error && tzRes.timezone) {\n                setWhTimezone(String(tzRes.timezone));\n              }\n            } catch (tzErr) {\n              console.warn('Failed to load timezone for staff', tzErr);\n            }\n          } catch (err) {\n            console.warn('Failed to load working hours for staff', err);\n          }\n          try {\n            const tg = await staffTargetService.listTargetsByStaff(id);\n            if (!tg.error) setTargets(tg.data);\n          } catch (err) {\n            console.warn('Failed to load targets for staff', err);\n          }\n\n          const joinDate = mergedStaffMember.joinDate ? new Date(mergedStaffMember.joinDate) : new Date();\n          const dateOfBirth = mergedStaffMember.dateOfBirth ? new Date(mergedStaffMember.dateOfBirth) : new Date();\n\n          const editableStatus = mergedStaffMember.status === 'on-leave' ? 'inactive' : mergedStaffMember.status as 'active' | 'inactive' | 'on-leave';\n\n          form.reset({\n            name: mergedStaffMember.name,\n            email: mergedStaffMember.email,\n            phone: mergedStaffMember.phone,\n            department: mergedStaffMember.department,\n            role: mergedStaffMember.role,\n            status: editableStatus,\n            employeeId: mergedStaffMember.employeeId || '',\n            operationalCountries: mergedStaffMember.operationalCountries || [],\n            skills: mergedStaffMember.skills,\n            certifications: mergedStaffMember.certifications,\n            reportingManager: mergedStaffMember.reportingManager || '',\n            joinDate: joinDate,\n            dateOfBirth: dateOfBirth,\n            mustChangePassword: false,\n          });\n        } else {\n          // Fallback: try loading from 'staff' table\n          const { data: staffData, error: staffError } = await supabase\n            .from('staff' as any)\n            .select('id, name, email, phone, department, role, status, employee_id, join_date, date_of_birth, reporting_manager, operational_countries, avatar')\n            .eq('id', id)\n            .maybeSingle();\n\n          if (staffError) {\n            console.warn('Supabase staff fetch failed:', staffError);\n          }\n\n          if (staffData) {\n            const staffMember = mapStaffRowToEnhancedStaff(staffData);\n            setStaff(staffMember);\n\n            const convertedWorkingHours = convertLegacyWorkingHours(staffMember.workingHours);\n            setWorkingHours(convertedWorkingHours);\n            setTargets(staffMember.targets || []);\n\n            const joinDate = staffMember.joinDate ? new Date(staffMember.joinDate) : new Date();\n            const dateOfBirth = staffMember.dateOfBirth ? new Date(staffMember.dateOfBirth) : new Date();\n\n            const editableStatus = staffMember.status === 'on-leave' ? 'inactive' : staffMember.status as 'active' | 'inactive' | 'on-leave';\n\n            form.reset({\n              name: staffMember.name,\n              email: staffMember.email,\n              phone: staffMember.phone,\n              department: staffMember.department,\n              role: staffMember.role,\n              status: editableStatus,\n              employeeId: staffMember.employeeId || '',\n              operationalCountries: staffMember.operationalCountries || [],\n              skills: staffMember.skills,\n              certifications: staffMember.certifications,\n              reportingManager: staffMember.reportingManager || '',\n              joinDate: joinDate,\n              dateOfBirth: dateOfBirth,\n              mustChangePassword: false,\n            });\n          } else {\n            setStaff(null);\n          }\n        }\n      } catch (err) {\n        console.warn('Error loading staff from Supabase:', err);\n      }\n    };\n\n    loadStaff();\n  }, [id, form]);\n\n  // Helper function to convert legacy working hours to new shift format\n  const convertLegacyWorkingHours = (legacyHours: any) => {\n    const convertedHours: any = {};\n    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\n    \n    days.forEach(day => {\n      const dayData = legacyHours[day];\n      if (dayData && dayData.isWorking && dayData.startTime && dayData.endTime) {\n        // Convert old format to new shift format\n        convertedHours[day] = {\n          isWorking: true,\n          shifts: [{\n            id: `shift_${Date.now()}_${day}`,\n            startTime: dayData.startTime,\n            endTime: dayData.endTime,\n            breakStart: dayData.breakTime ? '12:00' : undefined,\n            breakEnd: dayData.breakTime ? '13:00' : undefined,\n            label: 'Regular Shift'\n          }]\n        };\n      } else {\n        convertedHours[day] = { isWorking: false, shifts: [] };\n      }\n    });\n    \n    return convertedHours;\n  };\n\n  const onSubmit = async (data: StaffFormData) => {\n    if (!staff) return;\n\n    const updatedStaff: EnhancedStaffMember = {\n      ...staff,\n      name: data.name,\n      email: data.email,\n      phone: data.phone,\n      department: data.department,\n      role: data.role,\n      status: data.status,\n      employeeId: data.employeeId,\n      operationalCountries: data.operationalCountries,\n      skills: data.skills,\n      certifications: data.certifications,\n      workingHours,\n      targets,\n      reportingManager: data.reportingManager,\n      joinDate: data.joinDate.toISOString().slice(0, 10),\n      dateOfBirth: data.dateOfBirth.toISOString().slice(0, 10),\n    };\n\n    // Update using the staff storage service to ensure consistency\n    updateStaffMember(id!, updatedStaff);\n\n    // Persist extended fields into public.staff (join_date, date_of_birth, reporting_manager, operational_countries)\n    try {\n      const { data: staffRow, error: staffErr } = await supabase\n        .from('staff' as any)\n        .select('id')\n        .eq('id', id)\n        .maybeSingle();\n\n      const staffPayload: any = {\n        id,\n        name: data.name,\n        email: data.email,\n        phone: data.phone,\n        department: data.department,\n        role: data.role,\n        status: data.status,\n        employee_id: data.employeeId,\n        join_date: updatedStaff.joinDate ?? null,\n        reporting_manager: updatedStaff.reportingManager ?? null,\n        date_of_birth: updatedStaff.dateOfBirth ?? null,\n        operational_countries: Array.isArray(updatedStaff.operationalCountries)\n          ? updatedStaff.operationalCountries\n          : null,\n        updated_at: new Date().toISOString(),\n      };\n\n      if (staffErr || !staffRow) {\n        await supabase\n          .from('staff' as any)\n          .upsert(staffPayload, { onConflict: 'id' });\n      } else {\n        await supabase\n          .from('staff' as any)\n          .update(staffPayload)\n          .eq('id', id);\n      }\n    } catch (staffSaveErr) {\n      console.warn('Failed to persist extended staff fields:', staffSaveErr);\n    }\n\n    // If login credentials are provided, sync with auth system\n    if (data.username && data.password && showCredentials) {\n      await syncStaffWithAuthSystem(updatedStaff, data.username, data.password, data.mustChangePassword);\n      console.log('Updated staff member with new login credentials:', { \n        staff: updatedStaff.name, \n        username: data.username,\n        email: updatedStaff.email,\n        mustChangePassword: data.mustChangePassword \n      });\n    }\n\n    // Persist Working Hours & Performance Targets to Supabase\n    try {\n      const upsertWH = await staffWorkingHoursService.upsertWorkingHours(id!, workingHours, whTimezone || undefined);\n      if (upsertWH.error) console.warn('Working hours upsert error:', upsertWH.error);\n    } catch (err) {\n      console.warn('Working hours upsert failed:', err);\n    }\n    try {\n      const replaceTargets = await staffTargetService.replaceTargetsForStaff(id!, targets || []);\n      if (replaceTargets.error) console.warn('Targets replace error:', replaceTargets.error);\n    } catch (err) {\n      console.warn('Targets replace failed:', err);\n    }\n    \n    // Trigger a storage event to notify other components\n    window.dispatchEvent(new Event('storage'));\n    \n    console.log('Updating staff:', updatedStaff);\n    toast({\n      title: \"Staff profile updated successfully!\",\n      description: `${data.name}'s profile has been updated with status: ${data.status}`,\n    });\n    navigate(`/management/staff/profile/${id}`);\n  };\n\n  const addSkill = () => {\n    if (newSkill.trim()) {\n      const currentSkills = form.getValues('skills');\n      form.setValue('skills', [...currentSkills, newSkill.trim()]);\n      setNewSkill('');\n    }\n  };\n\n  const removeSkill = (skillToRemove: string) => {\n    const currentSkills = form.getValues('skills');\n    form.setValue('skills', currentSkills.filter(skill => skill !== skillToRemove));\n  };\n\n  const addCertification = () => {\n    if (newCertification.trim()) {\n      const currentCerts = form.getValues('certifications');\n      form.setValue('certifications', [...currentCerts, newCertification.trim()]);\n      setNewCertification('');\n    }\n  };\n\n  const removeCertification = (certToRemove: string) => {\n    const currentCerts = form.getValues('certifications');\n    form.setValue('certifications', currentCerts.filter(cert => cert !== certToRemove));\n  };\n\n  if (!staff) {\n    return (\n      <PageLayout title=\"Edit Staff\">\n        <div className=\"flex items-center justify-center h-64\">\n          <p className=\"text-red-500\">Staff member not found</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout\n      title=\"Edit Staff Profile\"\n      breadcrumbItems={[\n        { title: \"Home\", href: \"/\" },\n        { title: \"Staff Management\", href: \"/management/staff\" },\n        { title: staff.name, href: `/management/staff/profile/${staff.id}` },\n        { title: \"Edit\", href: `/management/staff/edit/${staff.id}` },\n      ]}\n    >\n      <div className=\"space-y-6\">\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Edit Staff Profile</h2>\n            <p className=\"text-muted-foreground\">Update staff member information and settings</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={() => navigate('/management/staff')}>\n              <ArrowLeft className=\"mr-2 h-4 w-4\" />\n              Back to Staff\n            </Button>\n            <Button variant=\"outline\" onClick={() => navigate(`/management/staff/profile/${id}`)}>\n              <X className=\"mr-2 h-4 w-4\" />\n              Cancel\n            </Button>\n          </div>\n        </div>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Basic Information */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Basic Information</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Full Name</FormLabel>\n                        <FormControl>\n                          <Input {...field} className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"employeeId\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Employee Code</FormLabel>\n                        <FormControl>\n                          <EmployeeCodeField\n                            value={field.value}\n                            onChange={field.onChange}\n                            excludeId={id}\n                            error={form.formState.errors.employeeId?.message}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Email</FormLabel>\n                        <FormControl>\n                          <Input {...field} type=\"email\" className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"phone\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Phone</FormLabel>\n                        <FormControl>\n                          <Input {...field} className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"dateOfBirth\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Date of Birth</FormLabel>\n                        <Popover>\n                          <PopoverTrigger asChild>\n                            <FormControl>\n                              <Button\n                                variant={\"outline\"}\n                                className={cn(\n                                  \"w-full pl-3 text-left font-normal bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\",\n                                  !field.value && \"text-muted-foreground\"\n                                )}\n                              >\n                                {field.value ? (\n                                  format(field.value, \"PPP\")\n                                ) : (\n                                  <span>Pick a date</span>\n                                )}\n                                <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                              </Button>\n                            </FormControl>\n                          </PopoverTrigger>\n                          <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                            <Calendar\n                              mode=\"single\"\n                              selected={field.value}\n                              onSelect={field.onChange}\n                              disabled={(date) =>\n                                date > new Date() || date < new Date(\"1900-01-01\")\n                              }\n                              initialFocus\n                            />\n                          </PopoverContent>\n                        </Popover>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"joinDate\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Joining Date</FormLabel>\n                        <Popover>\n                          <PopoverTrigger asChild>\n                            <FormControl>\n                              <Button\n                                variant={\"outline\"}\n                                className={cn(\n                                  \"w-full pl-3 text-left font-normal bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\",\n                                  !field.value && \"text-muted-foreground\"\n                                )}\n                              >\n                                {field.value ? (\n                                  format(field.value, \"PPP\")\n                                ) : (\n                                  <span>Pick a date</span>\n                                )}\n                                <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                              </Button>\n                            </FormControl>\n                          </PopoverTrigger>\n                          <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                            <Calendar\n                              mode=\"single\"\n                              selected={field.value}\n                              onSelect={field.onChange}\n                              disabled={(date) =>\n                                date > new Date(new Date().setDate(new Date().getDate() + 365)) || \n                                date < new Date(\"2020-01-01\")\n                              }\n                              initialFocus\n                            />\n                          </PopoverContent>\n                        </Popover>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"department\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Department</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || undefined}>\n                          <FormControl>\n                            <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                              <SelectValue placeholder=\"Select department\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            {departments.map((dept) => (\n                              <SelectItem key={dept.id} value={dept.id}>\n                                {dept.name}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"role\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Role</FormLabel>\n                        <FormControl>\n                          <Input {...field} className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"status\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Status</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value || undefined}>\n                          <FormControl>\n                            <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                              <SelectValue placeholder=\"Select status\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"active\">Active</SelectItem>\n                            <SelectItem value=\"inactive\">Inactive</SelectItem>\n                            <SelectItem value=\"on-leave\">On Leave</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                        <p className=\"text-xs text-muted-foreground mt-1\">\n                          Note: Leave status can be managed through the leave management system\n                        </p>\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Reporting Manager Field */}\n                  <FormField\n                    control={form.control}\n                    name=\"reportingManager\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-900 dark:text-gray-100\">Reporting Manager</FormLabel>\n                        <FormControl>\n                          <ReportingManagerSelector\n                            value={field.value || ''}\n                            onChange={field.onChange}\n                            excludeId={id}\n                            label=\"\"\n                            placeholder=\"Select reporting manager...\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Login Credentials Section */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-gray-900 dark:text-gray-100\">Login Credentials</CardTitle>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setShowCredentials(!showCredentials)}\n                  >\n                    {showCredentials ? 'Hide' : 'Update'} Credentials\n                  </Button>\n                </div>\n              </CardHeader>\n              {showCredentials && (\n                <CardContent>\n                  <LoginCredentials\n                    control={form.control}\n                    watchedEmail={form.watch('email')}\n                    watchedName={form.watch('name')}\n                    formErrors={form.formState.errors}\n                  />\n                </CardContent>\n              )}\n            </Card>\n\n            {/* Operational Countries */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Operational Countries</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <FormField\n                  control={form.control}\n                  name=\"operationalCountries\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormControl>\n                        <OperationalCountriesSelector\n                          selectedCountries={field.value}\n                          onCountriesChange={field.onChange}\n                          placeholder=\"Select countries this staff member manages...\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            {/* Skills */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Skills</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add new skill\"\n                    value={newSkill}\n                    onChange={(e) => setNewSkill(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addSkill())}\n                    className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\"\n                  />\n                  <Button type=\"button\" onClick={addSkill}>\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {form.watch('skills').map((skill, index) => (\n                    <Badge key={index} variant=\"secondary\" className=\"flex items-center gap-1\">\n                      {skill}\n                      <button\n                        type=\"button\"\n                        onClick={() => removeSkill(skill)}\n                        className=\"ml-1 hover:text-red-500\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Certifications */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Certifications</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"Add new certification\"\n                    value={newCertification}\n                    onChange={(e) => setNewCertification(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addCertification())}\n                    className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\"\n                  />\n                  <Button type=\"button\" onClick={addCertification}>\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {form.watch('certifications').map((cert, index) => (\n                    <Badge key={index} variant=\"secondary\" className=\"flex items-center gap-1\">\n                      {cert}\n                      <button\n                        type=\"button\"\n                        onClick={() => removeCertification(cert)}\n                        className=\"ml-1 hover:text-red-500\"\n                      >\n                        <X className=\"h-3 w-3\" />\n                      </button>\n                    </Badge>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Performance Targets */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Performance Targets</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {form.watch('department') && form.watch('role') && (\n                  <TargetSettings\n                    department={form.watch('department')}\n                    role={form.watch('role')}\n                    targets={targets}\n                    onTargetsChange={setTargets}\n                  />\n                )}\n                {(!form.watch('department') || !form.watch('role')) && (\n                  <div className=\"text-center text-muted-foreground py-8\">\n                    <Target className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>Please select department and role first to configure targets</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Timezone (Edit separately) */}\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardHeader>\n                <CardTitle className=\"text-gray-900 dark:text-gray-100\">Timezone</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <Label className=\"text-sm\">Timezone</Label>\n                <Select value={whTimezone || ''} onValueChange={setWhTimezone}>\n                  <SelectTrigger className=\"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100\">\n                    <SelectValue placeholder=\"Select a timezone\" />\n                  </SelectTrigger>\n                  <SelectContent className=\"max-h-80 overflow-y-auto\">\n                    {TIMEZONE_OPTIONS.map((opt) => (\n                      <SelectItem key={opt.value} value={opt.value}>\n                        <div className=\"flex flex-col text-left\">\n                          <span className=\"font-medium\">{opt.label}</span>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {opt.abbreviation}, {opt.offset}  {opt.cities.join(', ')}\n                          </span>\n                          <span className=\"text-[10px] text-muted-foreground\">{opt.value}</span>\n                        </div>\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </CardContent>\n            </Card>\n\n            {/* Working Hours */}\n            <WorkingHoursSection\n              workingHours={workingHours}\n              onWorkingHoursChange={setWorkingHours}\n            />\n\n            {/* Submit Button */}\n            <div className=\"flex justify-end\">\n              <Button type=\"submit\" className=\"min-w-32\">\n                <Save className=\"mr-2 h-4 w-4\" />\n                Save Changes\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default EditStaff;\n","import React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { Button } from \"../../components/ui/button\";\nimport { Input } from \"../../components/ui/input\";\nimport { Badge } from \"../../components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"../../components/ui/avatar\";\nimport { \n  Search, \n  Users, \n  UserPlus, \n  Shield,\n  ShieldCheck,\n  UserCheck,\n  Mail,\n  Phone\n} from \"lucide-react\";\nimport PageLayout from \"../../components/layout/PageLayout\";\nimport { supabase, adminSupabase, isAdminClientConfigured } from \"@/lib/supabaseClient\";\nimport type { Tables } from \"@/integrations/supabase/types\";\nimport { toast } from \"../../hooks/use-toast\";\nimport { useApp } from \"../../contexts/AppContext\";\n\n// Import users from authData\n// Removed mock data; now using Supabase profiles\n\ntype ProfileRow = Tables<'profiles'>;\ntype AdminProfile = {\n  id: ProfileRow['id'];\n  name: ProfileRow['name'];\n  email: ProfileRow['email'];\n  role: 'super_admin' | 'manager' | 'hr_manager';\n  department: string; // default to empty string when null\n  phone?: ProfileRow['phone'];\n  status?: 'active' | 'inactive' | 'suspended';\n  position?: ProfileRow['position'];\n  created_at?: ProfileRow['created_at'];\n  updated_at?: ProfileRow['updated_at'];\n};\n\nconst AdminManagement: React.FC = () => {\n  const { currentUser } = useApp();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filterRole, setFilterRole] = useState<string>(\"all\");\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [adminUsers, setAdminUsers] = useState<AdminProfile[]>([]);\n\n  // Load admin users on component mount\n  useEffect(() => {\n    const loadAdmins = async () => {\n      try {\n        let { data, error } = await supabase\n          .from('profiles')\n          .select('id,name,email,role,department,phone,status,position,created_at,updated_at')\n          .in('role', ['super_admin', 'manager', 'hr_manager']);\n        // If RLS blocks or other error, try admin client when configured\n        if (error) {\n          if (isAdminClientConfigured) {\n            const adminRes = await adminSupabase\n              .from('profiles')\n              .select('id,name,email,role,department,phone,status,position,created_at,updated_at')\n              .in('role', ['super_admin', 'manager', 'hr_manager']);\n            if (adminRes.error) {\n              throw adminRes.error;\n            }\n            data = adminRes.data as any[];\n          } else {\n            throw error;\n          }\n        }\n\n        // Map rows defensively to our AdminProfile shape\n        const admins: AdminProfile[] = (data || []).map((row: any) => {\n          const r = row as ProfileRow;\n          return {\n            id: r.id,\n            name: r.name,\n            email: r.email,\n            role: (r.role as AdminProfile['role']) ?? 'manager',\n            department: r.department ?? '',\n            phone: r.phone ?? undefined,\n            status: (r.status as AdminProfile['status']) ?? undefined,\n            position: r.position ?? undefined,\n            created_at: r.created_at ?? undefined,\n            updated_at: r.updated_at ?? undefined,\n          };\n        });\n\n        setAdminUsers(admins);\n      } catch (e) {\n        toast({\n          title: 'Load failed',\n          description: 'Unable to load admin users.',\n          variant: 'destructive'\n        });\n      }\n    };\n    loadAdmins();\n  }, []);\n\n  // Check if current user is super admin\n  const isSuperAdmin = currentUser?.role === 'super_admin';\n\n  const filteredAdmins = adminUsers.filter(admin => {\n    const term = searchTerm.toLowerCase();\n    const matchesSearch = \n      (admin.name ?? '').toLowerCase().includes(term) ||\n      (admin.email ?? '').toLowerCase().includes(term) ||\n      (admin.department ?? '').toLowerCase().includes(term);\n    \n    const matchesRoleFilter = filterRole === \"all\" || admin.role === filterRole;\n    const matchesStatusFilter = filterStatus === \"all\" || admin.status === filterStatus;\n    \n    return matchesSearch && matchesRoleFilter && matchesStatusFilter;\n  });\n\n  // Local create/edit/status actions removed; use Role Manager for admin ops\n\n  // Get counts for stats\n  const superAdminCount = adminUsers.filter(admin => admin.role === 'super_admin').length;\n  const managerCount = adminUsers.filter(admin => admin.role === 'manager').length;\n  const hrManagerCount = adminUsers.filter(admin => admin.role === 'hr_manager').length;\n  const activeCount = adminUsers.filter(admin => admin.status === 'active').length;\n\n  return (\n    <PageLayout>\n      <div className=\"container mx-auto py-6 max-w-7xl\">\n        <div className=\"flex flex-col space-y-6\">\n          <div className=\"flex flex-col space-y-2\">\n            <h2 className=\"text-3xl font-bold tracking-tight\">Admin Management</h2>\n            <p className=\"text-muted-foreground\">\n              Manage super admin and manager accounts with role-based permissions\n            </p>\n          </div>\n\n          {/* Navigation Tabs */}\n          <div className=\"flex flex-col sm:flex-row gap-2\">\n            <Button variant=\"outline\" asChild className=\"justify-start\">\n              <Link to=\"/management/admin/role-manager\">\n                <Shield className=\"mr-2 h-4 w-4\" />\n                Role Manager\n              </Link>\n            </Button>\n            <Button variant=\"default\" className=\"justify-start\">\n              <ShieldCheck className=\"mr-2 h-4 w-4\" />\n              Admin Management\n            </Button>\n          </div>\n\n          {/* Stats Cards */}\n          <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4\">\n            <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Total Admins</CardTitle>\n                <Users className=\"h-3 w-3 md:h-4 md:w-4 text-muted-foreground\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100\">{adminUsers.length}</div>\n                <p className=\"text-xs text-muted-foreground flex items-center mt-1\">\n                  Admin users\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Super Admins</CardTitle>\n                <ShieldCheck className=\"h-3 w-3 md:h-4 md:w-4 text-purple-500\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-xl md:text-2xl font-bold text-purple-600\">{superAdminCount}</div>\n                <p className=\"text-xs text-muted-foreground\">Full system access</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Managers</CardTitle>\n                <Shield className=\"h-3 w-3 md:h-4 md:w-4 text-blue-500\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-xl md:text-2xl font-bold text-blue-600\">{managerCount + hrManagerCount}</div>\n                <p className=\"text-xs text-muted-foreground\">Department managers</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-shadow border-gray-200 dark:border-gray-700\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                <CardTitle className=\"text-xs md:text-sm font-medium text-gray-600 dark:text-gray-300\">Active</CardTitle>\n                <UserCheck className=\"h-3 w-3 md:h-4 md:w-4 text-green-500\" />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-xl md:text-2xl font-bold text-green-600\">{activeCount}</div>\n                <p className=\"text-xs text-muted-foreground\">Active accounts</p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Search and Filter */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm\">\n            <div className=\"p-4 md:p-6\">\n              <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-4 w-full sm:w-auto\">\n                  <div className=\"relative w-full sm:w-64 md:w-80\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4\" />\n                    <Input\n                      type=\"text\"\n                      placeholder=\"Search admins...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      className=\"pl-10 h-10 text-sm bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600\"\n                    />\n                  </div>\n                  <div className=\"flex gap-2 w-full sm:w-auto\">\n                    <select\n                      value={filterRole}\n                      onChange={(e) => setFilterRole(e.target.value)}\n                      className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm min-w-[120px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\n                    >\n                      <option value=\"all\">All Roles</option>\n                      <option value=\"super_admin\">Super Admin</option>\n                      <option value=\"manager\">Manager</option>\n                      <option value=\"hr_manager\">HR Manager</option>\n                    </select>\n                    <select\n                      value={filterStatus}\n                      onChange={(e) => setFilterStatus(e.target.value)}\n                      className=\"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm min-w-[100px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\n                    >\n                      <option value=\"all\">All Status</option>\n                      <option value=\"active\">Active</option>\n                      <option value=\"inactive\">Inactive</option>\n                    </select>\n                  </div>\n                </div>\n                \n                {isSuperAdmin && (\n                  <Button className=\"w-full sm:w-auto\" asChild>\n                    <Link to=\"/management/admin/role-manager\">\n                      <Shield className=\"mr-2 h-4 w-4\" />\n                      <span className=\"hidden sm:inline\">Go to Role Manager</span>\n                      <span className=\"sm:hidden\">Role Manager</span>\n                    </Link>\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Admin Users Grid */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4 md:gap-6\">\n            {filteredAdmins.map((admin) => (\n              <Card key={admin.id} className=\"hover:shadow-lg transition-all duration-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-blue-200 dark:hover:border-blue-600\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-start space-x-3\">\n                    <Avatar className=\"h-12 w-12 shrink-0\">\n                      <AvatarImage src={'/placeholder.svg'} alt={admin.name} />\n                      <AvatarFallback className=\"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 font-medium\">\n                        {(admin.name ?? '').split(' ').map(n => n?.[0] ?? '').join('') || 'U'}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1 min-w-0\">\n                      <CardTitle className=\"text-base md:text-lg font-semibold text-gray-900 dark:text-gray-100 truncate\">\n                        {admin.name}\n                      </CardTitle>\n                      <p className=\"text-sm font-medium text-gray-600 dark:text-gray-300 truncate\">{admin.position}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">{admin.department}</p>\n                    </div>\n                    <div>\n                      <Badge \n                        className={`\n                          ${admin.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' : \n                            'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300'}\n                        `}\n                      >\n                        {admin.status === 'active' ? 'Active' : 'Inactive'}\n                      </Badge>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex justify-between text-xs md:text-sm\">\n                      <span className=\"text-gray-600 dark:text-gray-300\">Role:</span>\n                      <Badge \n                        className={`\n                          ${admin.role === 'super_admin' ? 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300' : \n                            admin.role === 'hr_manager' ? 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300' :\n                            'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300'}\n                        `}\n                      >\n                        {admin.role === 'super_admin' ? 'Super Admin' : \n                         admin.role === 'hr_manager' ? 'HR Manager' : 'Manager'}\n                      </Badge>\n                    </div>\n                    <div className=\"flex justify-between text-xs md:text-sm\">\n                      <span className=\"text-gray-600 dark:text-gray-300\">Created:</span>\n                      <span className=\"font-medium text-gray-900 dark:text-gray-100\">{admin.created_at ? new Date(admin.created_at).toLocaleDateString() : ''}</span>\n                    </div>\n                    \n                    {/* Contact Info */}\n                    <div className=\"flex flex-col sm:flex-row gap-1 sm:gap-2 text-xs text-gray-500 dark:text-gray-400 pt-1\">\n                      <div className=\"flex items-center gap-1\">\n                        <Mail className=\"h-3 w-3\" />\n                        <span className=\"truncate\">{admin.email}</span>\n                      </div>\n                      {admin.phone && (\n                        <div className=\"flex items-center gap-1\">\n                          <Phone className=\"h-3 w-3\" />\n                          <span>{admin.phone}</span>\n                        </div>\n                      )}\n                    </div>\n                    \n                    {/* Actions are managed in Role Manager page */}\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          {filteredAdmins.length === 0 && (\n            <Card className=\"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700\">\n              <CardContent className=\"text-center py-8 md:py-12\">\n                <Shield className=\"h-12 w-12 md:h-16 md:w-16 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg md:text-xl font-medium text-gray-900 dark:text-gray-100 mb-2\">No admin users found</h3>\n                <p className=\"text-sm md:text-base text-gray-600 dark:text-gray-300 mb-4 max-w-md mx-auto\">\n                  {searchTerm || filterRole !== 'all' || filterStatus !== 'all' \n                    ? \"Try adjusting your search criteria\" \n                    : \"Manage admin roles from the Role Manager page\"}\n                </p>\n                {isSuperAdmin && (\n                  <Button asChild>\n                    <Link to=\"/management/admin/role-manager\">\n                      <Shield className=\"mr-2 h-4 w-4\" />\n                      Go to Role Manager\n                    </Link>\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n      {/* Actions and creation/edit now managed on Role Manager page */}\n    </PageLayout>\n  );\n};\n\nexport default AdminManagement;","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAppSettingsAccess } from '@/hooks/useAppSettingsAccess';\nimport { appSettingsService, SETTING_CATEGORIES, AppSetting, AppSettingsService } from '@/services/appSettingsService';\nimport { GeneralSettings } from '@/components/settings/categories/GeneralSettings';\nimport { SEOSettings } from '@/components/settings/categories/SEOSettings';\nimport { BrandingSettings } from '@/components/settings/categories/BrandingSettings';\nimport { ContentSettings } from '@/components/settings/categories/ContentSettings';\nimport { AuthenticationSettings } from '@/components/settings/categories/AuthenticationSettings';\nimport { IntegrationsSettings } from '@/components/settings/categories/IntegrationsSettings';\nimport AppSettingsHeader from '@/components/settings/AppSettingsHeader';\nimport AppSettingsSidebar from '@/components/settings/AppSettingsSidebar';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport { \n  Settings, \n  Search, \n  Globe, \n  Palette, \n  Shield, \n  Lock, \n  Bell, \n  CreditCard, \n  Plug, \n  Wrench, \n  FileText,\n  Save,\n  RefreshCw,\n  AlertTriangle,\n  Database,\n  Users\n} from 'lucide-react';\n\n// Category icons mapping\nconst categoryIcons = {\n  [SETTING_CATEGORIES.GENERAL]: Settings,\n  [SETTING_CATEGORIES.SEO]: Search,\n  [SETTING_CATEGORIES.BRANDING]: Palette,\n  [SETTING_CATEGORIES.PERMISSIONS]: Shield,\n  [SETTING_CATEGORIES.AUTHENTICATION]: Lock,\n  [SETTING_CATEGORIES.NOTIFICATIONS]: Bell,\n  [SETTING_CATEGORIES.PAYMENT]: CreditCard,\n  [SETTING_CATEGORIES.INTEGRATIONS]: Plug,\n  [SETTING_CATEGORIES.MAINTENANCE]: Wrench,\n  [SETTING_CATEGORIES.CONTENT]: FileText,\n};\n\nconst AppSettingsAdmin: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<string>(SETTING_CATEGORIES.GENERAL);\n  const [settings, setSettings] = useState<Record<string, AppSetting[]>>({});\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasChanges, setHasChanges] = useState(false);\n  const isMobile = useIsMobile();\n  const { toast } = useToast();\n  const { hasAccess, isLoading: accessLoading } = useAppSettingsAccess();\n  const [searchParams] = useSearchParams();\n\n  // Load all settings\n  const loadSettings = async () => {\n    setIsLoading(true);\n    try {\n      const response = await AppSettingsService.getAllSettings();\n      if (response.success && response.data) {\n        setSettings(response.data);\n      } else {\n        toast({\n          title: \"Error loading settings\",\n          description: response.error || \"Failed to load application settings\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      console.error('Error loading settings:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to load application settings\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (hasAccess) {\n      loadSettings();\n    }\n  }, [hasAccess]);\n\n  // Handle URL parameters to auto-select tabs and sections\n  useEffect(() => {\n    const category = searchParams.get('category');\n    const section = searchParams.get('section');\n    \n    if (category && Object.values(SETTING_CATEGORIES).includes(category as any)) {\n      setActiveTab(category);\n      \n      // Store the section in a data attribute or pass it to the component\n      if (section) {\n        // This will be handled by the individual components\n        document.documentElement.setAttribute('data-settings-section', section);\n      }\n    }\n  }, [searchParams]);\n\n  // Save all pending changes\n  const handleSaveAll = async () => {\n    try {\n      // This would typically batch save all changes\n      // For now, we'll just refresh the data\n      await loadSettings();\n      setHasChanges(false);\n      toast({\n        title: \"Settings saved\",\n        description: \"All application settings have been saved successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Error saving settings\",\n        description: \"Failed to save some settings. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Refresh settings\n  const handleRefresh = async () => {\n    await loadSettings();\n    setHasChanges(false);\n    toast({\n      title: \"Settings refreshed\",\n      description: \"Application settings have been reloaded\",\n    });\n  };\n\n  if (accessLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <AppSettingsHeader />\n        <div className=\"flex\">\n          <AppSettingsSidebar />\n          <main className=\"flex-1 p-6\">\n            <div className=\"flex items-center justify-center h-64\">\n              <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-primary\"></div>\n            </div>\n          </main>\n        </div>\n      </div>\n    );\n  }\n\n  if (!hasAccess) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <AppSettingsHeader />\n        <div className=\"flex\">\n          <AppSettingsSidebar />\n          <main className=\"flex-1 p-6\">\n            <Alert variant=\"destructive\">\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription>\n                You don't have permission to access application settings. Please contact your administrator.\n              </AlertDescription>\n            </Alert>\n          </main>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <AppSettingsHeader />\n      <div className=\"flex\">\n        <AppSettingsSidebar />\n        <main className=\"flex-1 p-6 overflow-auto\">\n        {/* Quick Actions Bar */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              {hasChanges && (\n                <Badge variant=\"secondary\" className=\"bg-yellow-100 text-yellow-800\">\n                  Unsaved Changes\n                </Badge>\n              )}\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleRefresh}\n                disabled={isLoading}\n              >\n                <RefreshCw className={`h-4 w-4 mr-2 ${isLoading ? 'animate-spin' : ''}`} />\n                Refresh\n              </Button>\n              <Button\n                size=\"sm\"\n                onClick={handleSaveAll}\n                disabled={!hasChanges || isLoading}\n              >\n                <Save className=\"h-4 w-4 mr-2\" />\n                Save All\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Settings Overview Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <Database className=\"h-8 w-8 text-blue-600\" />\n                <div>\n                  <div className=\"text-2xl font-bold\">\n                    {Object.values(settings).flat().length}\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">Total Settings</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <Palette className=\"h-8 w-8 text-purple-600\" />\n                <div>\n                  <div className=\"text-2xl font-bold\">\n                    {Object.keys(settings).length}\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">Categories</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <Users className=\"h-8 w-8 text-green-600\" />\n                <div>\n                  <div className=\"text-2xl font-bold\">Admin</div>\n                  <p className=\"text-sm text-muted-foreground\">Access Level</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Settings Tabs */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Configuration Management</CardTitle>\n            <CardDescription>\n              Configure application settings by category. Changes are automatically saved.\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Tabs value={activeTab} onValueChange={(value: string) => setActiveTab(value)} className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-4 lg:grid-cols-8\">\n                {[\n                  SETTING_CATEGORIES.GENERAL,\n                  SETTING_CATEGORIES.SEO,\n                  SETTING_CATEGORIES.BRANDING,\n                  SETTING_CATEGORIES.PERMISSIONS,\n                  SETTING_CATEGORIES.AUTHENTICATION,\n                  SETTING_CATEGORIES.NOTIFICATIONS,\n                  SETTING_CATEGORIES.CONTENT,\n                  SETTING_CATEGORIES.INTEGRATIONS,\n                ].map((category) => {\n                  const Icon = categoryIcons[category] || Settings;\n                  const count = settings[category]?.length || 0;\n                  \n                  return (\n                    <TabsTrigger \n                      key={category} \n                      value={category}\n                      className=\"flex items-center gap-2 text-xs\"\n                    >\n                      <Icon className=\"h-4 w-4\" />\n                      <span className=\"hidden sm:inline\">{category}</span>\n                      {count > 0 && (\n                        <Badge variant=\"secondary\" className=\"ml-1 text-xs\">\n                          {count}\n                        </Badge>\n                      )}\n                    </TabsTrigger>\n                  );\n                })}\n              </TabsList>\n\n              {/* General Settings */}\n              <TabsContent value={SETTING_CATEGORIES.GENERAL}>\n                <GeneralSettings />\n              </TabsContent>\n\n              {/* SEO Settings */}\n              <TabsContent value={SETTING_CATEGORIES.SEO}>\n                <SEOSettings />\n              </TabsContent>\n\n              {/* Branding Settings */}\n              <TabsContent value={SETTING_CATEGORIES.BRANDING}>\n                <BrandingSettings />\n              </TabsContent>\n\n              {/* Permissions Settings */}\n              <TabsContent value={SETTING_CATEGORIES.PERMISSIONS}>\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Shield className=\"h-5 w-5\" />\n                      Permission Settings\n                    </CardTitle>\n                    <CardDescription>\n                      Manage user roles and access permissions\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-center py-12\">\n                      <Shield className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                      <h3 className=\"text-lg font-semibold mb-2\">Permission Management</h3>\n                      <p className=\"text-muted-foreground mb-4\">\n                        Configure user roles, permissions, and access controls\n                      </p>\n                      <Button variant=\"outline\">\n                        Coming Soon\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              {/* Authentication Settings */}\n              <TabsContent value={SETTING_CATEGORIES.AUTHENTICATION}>\n                <AuthenticationSettings />\n              </TabsContent>\n\n              {/* Notifications Settings */}\n              <TabsContent value={SETTING_CATEGORIES.NOTIFICATIONS}>\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Bell className=\"h-5 w-5\" />\n                      Notification Settings\n                    </CardTitle>\n                    <CardDescription>\n                      Configure system notifications and alerts\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-center py-12\">\n                      <Bell className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                      <h3 className=\"text-lg font-semibold mb-2\">Notification Management</h3>\n                      <p className=\"text-muted-foreground mb-4\">\n                        Set up email, SMS, and in-app notification preferences\n                      </p>\n                      <Button variant=\"outline\">\n                        Coming Soon\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              {/* Content Settings */}\n              <TabsContent value={SETTING_CATEGORIES.CONTENT}>\n                <ContentSettings />\n              </TabsContent>\n\n              {/* Integrations Settings */}\n              <TabsContent value={SETTING_CATEGORIES.INTEGRATIONS}>\n                <IntegrationsSettings />\n              </TabsContent>\n            </Tabs>\n          </CardContent>\n        </Card>\n        </main>\n      </div>\n    </div>\n  );\n};\n\nexport default AppSettingsAdmin;","import React, { useEffect, useMemo, useState } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { supabase, adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Badge } from '@/components/ui/badge';\nimport { useToast } from '@/components/ui/use-toast';\nimport { Table, TableHeader, TableRow, TableHead, TableBody, TableCell } from '@/components/ui/table';\nimport { Select, SelectTrigger, SelectContent, SelectItem, SelectValue } from '@/components/ui/select';\nimport PageLayout from '@/components/layout/PageLayout';\n\ntype AdminProfile = {\n  id: string;\n  name: string;\n  email: string;\n  role: 'super_admin' | 'manager';\n  department: string;\n  phone?: string;\n  status: 'active' | 'inactive' | 'suspended';\n  created_at?: string;\n};\n\nconst AdminUsers: React.FC = () => {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [admins, setAdmins] = useState<AdminProfile[]>([]);\n  const [loadingList, setLoadingList] = useState(false);\n  const [creating, setCreating] = useState(false);\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [name, setName] = useState('');\n  const [role, setRole] = useState<'super_admin' | 'manager'>('manager');\n  const [department, setDepartment] = useState('Administration');\n  const [phone, setPhone] = useState('');\n\n  const canManageAdmins = useMemo(\n    () => (user?.role === 'super_admin' || user?.role === 'manager'),\n    [user]\n  );\n\n  const loadAdmins = async () => {\n    try {\n      setLoadingList(true);\n      // First try via session client (RLS-aware)\n      let { data, error } = await supabase\n        .from('profiles')\n        .select('id,name,email,role,department,phone,status,created_at')\n        .in('role', ['super_admin', 'manager']);\n\n      if (error && isAdminClientConfigured) {\n        // Fallback to admin client if RLS blocks the query\n        const adminRes = await adminSupabase\n          .from('profiles')\n          .select('id,name,email,role,department,phone,status,created_at')\n          .in('role', ['super_admin', 'manager']);\n        data = adminRes.data as any[];\n      }\n\n      setAdmins((data || []) as AdminProfile[]);\n    } catch (err) {\n      toast({\n        title: 'Load failed',\n        description: 'Unable to load admin users. Please try again later.',\n        variant: 'destructive'\n      });\n    } finally {\n      setLoadingList(false);\n    }\n  };\n\n  useEffect(() => {\n    loadAdmins();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const resetForm = () => {\n    setEmail('');\n    setPassword('');\n    setName('');\n    setRole('manager');\n    setDepartment('Administration');\n    setPhone('');\n  };\n\n  const createAdminUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!isAdminClientConfigured) {\n      toast({\n        title: 'Admin client not configured',\n        description: 'Set env var VITE_SUPABASE_SERVICE_ROLE_KEY to allow creating admin users.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (!email || !password || !name) {\n      toast({\n        title: 'Form incomplete',\n        description: 'Please fill in email, password, and name.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    try {\n      setCreating(true);\n\n      // Create auth user via admin API (doesn't affect current session)\n      const { data: created, error: createError } = await adminSupabase.auth.admin.createUser({\n        email,\n        password,\n        user_metadata: { name, role },\n        email_confirm: true\n      } as any);\n\n      if (createError) throw createError;\n\n      const authUserId = (created?.user?.id as string) || '';\n      if (!authUserId) throw new Error('User created but ID not returned');\n\n      // Create profile record bypassing RLS\n      const profilePayload = {\n        id: authUserId,\n        email,\n        name,\n        role,\n        department,\n        phone,\n        status: 'active' as const,\n        position: role === 'super_admin' ? 'Super Admin' : 'Manager',\n        avatar: '/avatars/default.jpg',\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      };\n\n      const { error: profileError } = await adminSupabase\n        .from('profiles')\n        .insert(profilePayload);\n\n      if (profileError) throw profileError;\n\n      toast({\n        title: 'Admin user created',\n        description: `${role === 'super_admin' ? 'Super Admin' : 'Manager'} created: ${name}`\n      });\n\n      resetForm();\n      await loadAdmins();\n    } catch (err: any) {\n      toast({\n        title: 'Create failed',\n        description: err?.message || 'Unable to create admin user',\n        variant: 'destructive'\n      });\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  if (!canManageAdmins) {\n    return (\n      <PageLayout title=\"Admin Users\">\n        <div className=\"p-2 sm:p-3 md:p-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>No Access</CardTitle>\n              <CardDescription>Only administrators can access this page.</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">Contact your system administrator to request access.</p>\n            </CardContent>\n          </Card>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout \n      title=\"Admin Users\" \n      description=\"Create and manage users with admin roles\"\n      keywords={[\"admin\", \"users\", \"management\"]}\n      breadcrumbItems={[{ title: 'Management', href: '/management' }, { title: 'Admin Users', href: '/management/admin/users' }]}\n    >\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-3\">\n        <div>\n          <h1 className=\"text-2xl font-bold\">Admin Users</h1>\n          <p className=\"text-muted-foreground\">Create and manage users with admin roles.</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"default\">Admins only</Badge>\n          {isAdminClientConfigured ? (\n            <Badge variant=\"secondary\">Admin API configured</Badge>\n          ) : (\n            <Badge variant=\"destructive\">Admin API not configured</Badge>\n          )}\n        </div>\n      </div>\n\n      {/* Create Admin Form */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Create admin user</CardTitle>\n          <CardDescription>Create admin accounts using the service role key without affecting the current session.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={createAdminUser} className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div>\n              <Label htmlFor=\"email\">Email</Label>\n              <Input id=\"email\" type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"admin@example.com\" disabled={!isAdminClientConfigured || creating} />\n            </div>\n            <div>\n              <Label htmlFor=\"password\">Password</Label>\n              <Input id=\"password\" type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} placeholder=\"At least 8 characters\" disabled={!isAdminClientConfigured || creating} />\n            </div>\n            <div>\n              <Label htmlFor=\"name\">Name</Label>\n              <Input id=\"name\" value={name} onChange={(e) => setName(e.target.value)} placeholder=\"John Doe\" disabled={!isAdminClientConfigured || creating} />\n            </div>\n            <div>\n              <Label>Role</Label>\n              <Select value={role} onValueChange={(v) => setRole(v as 'super_admin' | 'manager')} disabled={!isAdminClientConfigured || creating}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select role\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"manager\">Manager</SelectItem>\n                  <SelectItem value=\"super_admin\">Super Admin</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <Label htmlFor=\"department\">Department</Label>\n              <Input id=\"department\" value={department} onChange={(e) => setDepartment(e.target.value)} placeholder=\"Administration\" disabled={!isAdminClientConfigured || creating} />\n            </div>\n            <div>\n              <Label htmlFor=\"phone\">Phone</Label>\n              <Input id=\"phone\" value={phone} onChange={(e) => setPhone(e.target.value)} placeholder=\"+1 234 567 8900\" disabled={!isAdminClientConfigured || creating} />\n            </div>\n            <div className=\"md:col-span-2 flex justify-end\">\n              <Button type=\"submit\" disabled={!isAdminClientConfigured || creating}>\n                {creating ? 'Creating...' : 'Create Admin User'}\n              </Button>\n            </div>\n            {!isAdminClientConfigured && (\n              <div className=\"md:col-span-2\">\n                <p className=\"text-sm text-destructive\">Service role key missing. Set env `VITE_SUPABASE_SERVICE_ROLE_KEY` to enable admin creation.</p>\n              </div>\n            )}\n          </form>\n        </CardContent>\n      </Card>\n\n      {/* Admins List */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Admin users list</CardTitle>\n          <CardDescription>Users who currently have admin roles.</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-md border\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Name</TableHead>\n                  <TableHead>Email</TableHead>\n                  <TableHead>Role</TableHead>\n                  <TableHead>Department</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead>Created At</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {loadingList ? (\n                  <TableRow>\n                    <TableCell colSpan={6}>\n                      <div className=\"py-6 text-center text-muted-foreground\">Loading...</div>\n                    </TableCell>\n                  </TableRow>\n                ) : admins.length === 0 ? (\n                  <TableRow>\n                    <TableCell colSpan={6}>\n                      <div className=\"py-6 text-center text-muted-foreground\">No admin users found</div>\n                    </TableCell>\n                  </TableRow>\n                ) : (\n                  admins.map((a) => (\n                    <TableRow key={a.id}>\n                      <TableCell>{a.name}</TableCell>\n                      <TableCell>{a.email}</TableCell>\n                      <TableCell>\n                        <Badge variant={a.role === 'super_admin' ? 'default' : 'secondary'}>\n                          {a.role === 'super_admin' ? 'Super Admin' : 'Manager'}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>{a.department}</TableCell>\n                      <TableCell>\n                        <Badge variant={a.status === 'active' ? 'default' : a.status === 'suspended' ? 'destructive' : 'secondary'}>\n                          {a.status}\n                        </Badge>\n                      </TableCell>\n                      <TableCell>{a.created_at ? new Date(a.created_at).toLocaleString() : '-'}</TableCell>\n                    </TableRow>\n                  ))\n                )}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n    </PageLayout>\n  );\n};\n\nexport default AdminUsers;","import React, { useState } from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectTrigger, SelectContent, SelectItem, SelectValue } from '@/components/ui/select';\nimport { useToast } from '@/hooks/use-toast';\nimport { adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\n\ntype Props = {\n  onCreated?: () => void;\n};\n\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nconst phoneRegex = /^\\+?[0-9\\- ()]{7,20}$/;\n\nconst CreateAdminForm: React.FC<Props> = ({ onCreated }) => {\n  const { toast } = useToast();\n\n  const [name, setName] = useState('');\n  const [email, setEmail] = useState('');\n  const [phone, setPhone] = useState('');\n  const [role, setRole] = useState<'super_admin' | 'admin'>('super_admin');\n  const [department, setDepartment] = useState('Administrator');\n  const [position, setPosition] = useState('owner');\n  const [password, setPassword] = useState('');\n  const [creating, setCreating] = useState(false);\n\n  const resetForm = () => {\n    setName('');\n    setEmail('');\n    setPhone('');\n    setRole('super_admin');\n    setDepartment('Administrator');\n    setPosition('owner');\n    setPassword('');\n  };\n\n  const handleCreate = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!isAdminClientConfigured) {\n      toast({\n        title: 'Admin client not configured',\n        description: 'Set env var VITE_SUPABASE_SERVICE_ROLE_KEY to allow creating admin users.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (!name.trim() || !email.trim() || !password.trim()) {\n      toast({ title: 'Form incomplete', description: 'Name, email and password are required.', variant: 'destructive' });\n      return;\n    }\n\n    if (!emailRegex.test(email)) {\n      toast({ title: 'Invalid email', description: 'Enter a valid email address.', variant: 'destructive' });\n      return;\n    }\n\n    if (phone && !phoneRegex.test(phone)) {\n      toast({ title: 'Invalid phone', description: 'Enter a valid phone number.', variant: 'destructive' });\n      return;\n    }\n\n    try {\n      setCreating(true);\n\n      // Create auth user via admin API\n      const { data: created, error: createError } = await adminSupabase.auth.admin.createUser({\n        email,\n        password,\n        user_metadata: { name, role },\n        email_confirm: true\n      } as any);\n\n      if (createError) throw createError;\n\n      const authUserId = (created?.user?.id as string) || '';\n      if (!authUserId) throw new Error('User created but ID not returned');\n\n      // Ensure raw_user_meta_data role is set explicitly\n      await adminSupabase.auth.admin.updateUserById(authUserId, {\n        user_metadata: { role }\n      } as any);\n\n      // Upsert profile record bypassing RLS (avoids duplicate key when trigger already created profile)\n      const profilePayload = {\n        id: authUserId,\n        email,\n        name,\n        role,\n        department,\n        phone,\n        status: 'active' as const,\n        position,\n        avatar: '/avatars/default.jpg',\n        created_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      };\n\n      const { error: profileError } = await adminSupabase\n        .from('profiles')\n        .upsert(profilePayload, { onConflict: 'id' });\n\n      if (profileError) throw profileError;\n\n      // Create or update user role record for normalization (if table exists)\n      // This will no-op safely if the table is missing, but we prefer it present via migration\n      const { error: userRoleError } = await adminSupabase\n        .from('user_roles')\n        .upsert({\n          user_id: authUserId,\n          role,\n          source: 'admin_create',\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        }, { onConflict: 'user_id,role' });\n\n      if (userRoleError && !/relation .* user_roles .* does not exist/i.test(userRoleError.message)) {\n        // If table exists but operation failed, surface the error; otherwise ignore missing table\n        throw userRoleError;\n      }\n\n      toast({ title: 'Admin user created', description: `${role} created: ${name}`, variant: 'success' });\n      resetForm();\n      onCreated?.();\n    } catch (err: any) {\n      toast({ title: 'Create failed', description: err?.message || 'Unable to create user', variant: 'destructive' });\n    } finally {\n      setCreating(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleCreate} className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n      <div>\n        <Label htmlFor=\"name\">Name</Label>\n        <Input id=\"name\" value={name} onChange={(e) => setName(e.target.value)} placeholder=\"Full name\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div>\n        <Label htmlFor=\"email\">Email</Label>\n        <Input id=\"email\" type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"admin@example.com\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div>\n        <Label htmlFor=\"phone\">Phone</Label>\n        <Input id=\"phone\" value={phone} onChange={(e) => setPhone(e.target.value)} placeholder=\"+1 234 567 8900\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div>\n        <Label>Role</Label>\n        <Select value={role} onValueChange={(v) => setRole(v as 'super_admin' | 'admin')} disabled={!isAdminClientConfigured || creating}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Select role\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"super_admin\">super_admin</SelectItem>\n            <SelectItem value=\"admin\">admin</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n      <div>\n        <Label htmlFor=\"department\">Department</Label>\n        <Input id=\"department\" value={department} onChange={(e) => setDepartment(e.target.value)} placeholder=\"Administrator\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div>\n        <Label htmlFor=\"position\">Position</Label>\n        <Input id=\"position\" value={position} onChange={(e) => setPosition(e.target.value)} placeholder=\"owner\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div>\n        <Label htmlFor=\"password\">Password</Label>\n        <Input id=\"password\" type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} placeholder=\"At least 8 characters\" disabled={!isAdminClientConfigured || creating} />\n      </div>\n      <div className=\"md:col-span-2 flex justify-end\">\n        <Button type=\"submit\" disabled={!isAdminClientConfigured || creating}>\n          {creating ? 'Creating...' : 'Create User'}\n        </Button>\n      </div>\n      {!isAdminClientConfigured && (\n        <div className=\"md:col-span-2\">\n          <p className=\"text-sm text-destructive\">Service role key missing. Set env `VITE_SUPABASE_SERVICE_ROLE_KEY` to enable admin creation.</p>\n        </div>\n      )}\n    </form>\n  );\n};\n\nexport default CreateAdminForm;","import React, { useState } from 'react';\nimport { Table, TableHeader, TableHead, TableBody, TableRow, TableCell } from '@/components/ui/table';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { useToast } from '@/hooks/use-toast';\nimport { adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\nimport type { AdminProfile } from '../AdminRoleManager';\n\ntype Props = {\n  admins: AdminProfile[];\n  loading?: boolean;\n  onRefresh?: () => void;\n};\n\nconst AdminList: React.FC<Props> = ({ admins, loading, onRefresh }) => {\n  const { toast } = useToast();\n  const [passwords, setPasswords] = useState<Record<string, string>>({});\n  const [updating, setUpdating] = useState<Record<string, boolean>>({});\n\n  const setPasswordFor = (id: string, value: string) => {\n    setPasswords((prev) => ({ ...prev, [id]: value }));\n  };\n\n  const changePassword = async (id: string, email: string) => {\n    const newPassword = passwords[id];\n    if (!newPassword || newPassword.length < 8) {\n      toast({ title: 'Invalid password', description: 'Use at least 8 characters.', variant: 'destructive' });\n      return;\n    }\n\n    if (!isAdminClientConfigured) {\n      toast({ title: 'Admin API unavailable', description: 'Service role key missing.', variant: 'destructive' });\n      return;\n    }\n\n    try {\n      setUpdating((prev) => ({ ...prev, [id]: true }));\n      const { data: users, error } = await adminSupabase.auth.admin.listUsers();\n      if (error) throw error;\n      const target = users.users.find((u: any) => u.email === email);\n      if (!target) throw new Error('Auth user not found for profile');\n\n      const updateRes = await adminSupabase.auth.admin.updateUserById(target.id, { password: newPassword } as any);\n      if (updateRes.error) throw updateRes.error;\n\n      toast({ title: 'Password updated', description: `Password changed for ${email}`, variant: 'success' });\n      setPasswords((prev) => ({ ...prev, [id]: '' }));\n    } catch (err: any) {\n      toast({ title: 'Update failed', description: err?.message || 'Unable to update password', variant: 'destructive' });\n    } finally {\n      setUpdating((prev) => ({ ...prev, [id]: false }));\n    }\n  };\n\n  const setStatus = async (id: string, status: AdminProfile['status']) => {\n    if (!isAdminClientConfigured) {\n      toast({ title: 'Admin API unavailable', description: 'Service role key missing.', variant: 'destructive' });\n      return;\n    }\n\n    try {\n      setUpdating((prev) => ({ ...prev, [id]: true }));\n      const { error } = await adminSupabase\n        .from('profiles')\n        .update({ status, updated_at: new Date().toISOString() })\n        .eq('id', id);\n      if (error) throw error;\n      toast({ title: 'Status updated', description: `Profile set to ${status}`, variant: 'success' });\n      onRefresh?.();\n    } catch (err: any) {\n      toast({ title: 'Update failed', description: err?.message || 'Unable to update status', variant: 'destructive' });\n    } finally {\n      setUpdating((prev) => ({ ...prev, [id]: false }));\n    }\n  };\n\n  return (\n    <div className=\"overflow-x-auto\">\n      {loading ? (\n        <div className=\"text-sm text-muted-foreground\">Loading admins...</div>\n      ) : admins.length === 0 ? (\n        <div className=\"text-sm text-muted-foreground\">No admin profiles found.</div>\n      ) : (\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Name</TableHead>\n              <TableHead>Email</TableHead>\n              <TableHead>Role</TableHead>\n              <TableHead>Department</TableHead>\n              <TableHead>Status</TableHead>\n              <TableHead>Created</TableHead>\n              <TableHead className=\"text-right\">Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {admins.map((a) => (\n              <TableRow key={a.id}>\n                <TableCell>\n                  <div className=\"font-medium\">{a.name}</div>\n                  <div className=\"text-xs text-muted-foreground\">{a.position || ''}</div>\n                </TableCell>\n                <TableCell>{a.email}</TableCell>\n                <TableCell>\n                  <Badge variant={a.role === 'super_admin' ? 'default' : 'secondary'}>{a.role}</Badge>\n                </TableCell>\n                <TableCell>{a.department}</TableCell>\n                <TableCell>\n                  <Badge variant={a.status === 'active' ? 'success' : a.status === 'suspended' ? 'destructive' : 'secondary'}>\n                    {a.status}\n                  </Badge>\n                </TableCell>\n                <TableCell>{a.created_at ? new Date(a.created_at).toLocaleString() : ''}</TableCell>\n                <TableCell className=\"text-right\">\n                  <div className=\"flex items-center gap-2 justify-end\">\n                    <Input\n                      type=\"password\"\n                      value={passwords[a.id] || ''}\n                      onChange={(e) => setPasswordFor(a.id, e.target.value)}\n                      placeholder=\"New password\"\n                      className=\"w-40\"\n                      disabled={!!updating[a.id]}\n                    />\n                    <Button variant=\"outline\" size=\"sm\" disabled={!!updating[a.id]} onClick={() => changePassword(a.id, a.email)}>\n                      {updating[a.id] ? 'Updating...' : 'Change Password'}\n                    </Button>\n                    <Button\n                      variant=\"secondary\"\n                      size=\"sm\"\n                      disabled={!!updating[a.id]}\n                      onClick={() => setStatus(a.id, a.status === 'active' ? 'suspended' : 'active')}\n                    >\n                      {a.status === 'active' ? 'Suspend' : 'Activate'}\n                    </Button>\n                  </div>\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      )}\n    </div>\n  );\n};\n\nexport default AdminList;","import React, { useEffect, useMemo, useState } from 'react';\nimport PageLayout from '@/components/layout/PageLayout';\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Link } from 'react-router-dom';\nimport { ArrowLeft } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { supabase, adminSupabase, isAdminClientConfigured } from '@/lib/supabaseClient';\nimport CreateAdminForm from './components/CreateAdminForm';\nimport AdminList from './components/AdminList';\n\n\nexport type AdminRole = 'super_admin' | 'admin';\n\nexport type AdminProfile = {\n  id: string;\n  name: string;\n  email: string;\n  role: AdminRole;\n  department: string;\n  phone?: string;\n  status: 'active' | 'inactive' | 'suspended';\n  position?: string;\n  created_at?: string;\n  updated_at?: string;\n};\n\nconst AdminRoleManager: React.FC = () => {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [admins, setAdmins] = useState<AdminProfile[]>([]);\n  const [loadingList, setLoadingList] = useState(false);\n\n  const canAccessPage = useMemo(\n    () => (user?.role === 'super_admin' || user?.role === 'admin'),\n    [user]\n  );\n\n  const loadAdmins = async () => {\n    try {\n      setLoadingList(true);\n      // Prefer regular client; fallback to admin client if RLS blocks\n      let { data, error } = await supabase\n        .from('profiles')\n        .select('id,name,email,role,department,phone,status,position,created_at,updated_at')\n        .in('role', ['super_admin', 'admin']);\n\n      if (error && isAdminClientConfigured) {\n        const adminRes = await adminSupabase\n          .from('profiles')\n          .select('id,name,email,role,department,phone,status,position,created_at,updated_at')\n          .in('role', ['super_admin', 'admin']);\n        data = adminRes.data as any[];\n      }\n\n      setAdmins((data || []) as AdminProfile[]);\n    } catch (err) {\n      toast({\n        title: 'Load failed',\n        description: 'Unable to load admin users. Please try again later.',\n        variant: 'destructive'\n      });\n    } finally {\n      setLoadingList(false);\n    }\n  };\n\n  useEffect(() => {\n    loadAdmins();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (!canAccessPage) {\n    return (\n      <PageLayout title=\"Admin Role Manager\">\n        <div className=\"p-2 sm:p-3 md:p-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>No Access</CardTitle>\n              <CardDescription>Only super_admin and admin can access this page.</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">Contact your system administrator to request access.</p>\n            </CardContent>\n          </Card>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  return (\n    <PageLayout \n      title=\"Admin Role Manager\" \n      description=\"Create and manage users with super_admin and admin roles\"\n      keywords={[\"admin\", \"super_admin\", \"management\", \"roles\"]}\n      breadcrumbItems={[{ title: 'Management', href: '/management' }, { title: 'Admin Role Manager', href: '/management/admin/role-manager' }]}\n    >\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"outline\" size=\"sm\" asChild>\n              <Link to=\"/management/admin\">\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Back to Admin\n              </Link>\n            </Button>\n            <div>\n              <h1 className=\"text-2xl font-bold\">Admin Role Manager</h1>\n              <p className=\"text-muted-foreground\">Create and manage admin-level users.</p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Badge variant=\"default\">Admins only</Badge>\n            {isAdminClientConfigured ? (\n              <Badge variant=\"secondary\">Admin API configured</Badge>\n            ) : (\n              <Badge variant=\"destructive\">Admin API not configured</Badge>\n            )}\n          </div>\n        </div>\n\n        {/* Create Admin Form */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Create admin/super_admin</CardTitle>\n            <CardDescription>Uses the service role API; created users can login via /login.</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <CreateAdminForm onCreated={loadAdmins} />\n          </CardContent>\n        </Card>\n\n        {/* Admins List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Existing admin profiles</CardTitle>\n            <CardDescription>View and edit admin-level profiles; change passwords securely.</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <AdminList admins={admins} loading={loadingList} onRefresh={loadAdmins} />\n          </CardContent>\n        </Card>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AdminRoleManager;"],"names":["PayrollManagement","payrollRuns","setPayrollRuns","selectedRun","setSelectedRun","useState","filterStatus","setFilterStatus","searchTerm","setSearchTerm","payrollEntries","id","payrollRunId","employeeId","employeeName","department","basicSalary","totalAllowances","totalDeductions","totalVariablePay","grossSalary","netSalary","overtimePay","taxDeductions","pfDeduction","esiDeduction","loanDeductions","advanceDeductions","componentBreakdown","handleRunPayroll","runId","prev","map","run","status","toast","success","handleApproveRun","getStatusIcon","jsx","CheckCircle","className","Clock","XCircle","filteredRuns","filter","matchesStatus","matchesSearch","period","toLowerCase","includes","totalRuns","length","pendingRuns","r","approvedRuns","totalPayrollAmount","reduce","sum","totalAmount","jsxs","children","Button","Play","Card","CardContent","Users","toFixed","DollarSign","Input","placeholder","value","onChange","e","target","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","CardHeader","CardTitle","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","employeesCount","toLocaleString","Badge","variant","Date","createdDate","toLocaleDateString","Dialog","DialogTrigger","asChild","size","onClick","Eye","DialogContent","DialogHeader","DialogTitle","DialogDescription","entry","Download","LeaveManagement","leaves","setLeaves","selectedLeave","setSelectedLeave","filterType","setFilterType","rejectionReason","setRejectionReason","leaveBalances","annualLeave","sickLeave","casualLeave","maternityPaternityLeave","compensatoryOff","year","lastUpdated","handleLeaveAction","leaveId","action","reason","prevLeaves","leave","approvedBy","approvedDate","toISOString","getLeaveTypeColor","type","filteredLeaves","matchesType","leaveType","totalLeaves","pendingLeaves","l","approvedLeaves","rejectedLeaves","Calendar","startDate","endDate","days","appliedDate","Textarea","disabled","trim","Fragment","AttendanceManagement","selectedDate","setSelectedDate","filterDepartment","setFilterDepartment","attendanceRecords","date","clockIn","clockOut","totalHours","overtime","breaks","startTime","endTime","duration","location","notes","employees","name","CalendarIcon","getStatusColor","totalEmployees","presentToday","lateToday","absentToday","attendanceRate","Math","round","filteredRecords","record","employee","find","emp","matchesDepartment","Progress","TrendingUp","mode","selected","onSelect","Coffee","b","some","SalaryStructureManager","selectedStructure","setSelectedStructure","isCreateDialogOpen","setIsCreateDialogOpen","salaryStructures","setSalaryStructures","allowances","amount","isPercentage","isFixed","taxable","deductions","variablePay","currency","effectiveDate","approvalStatus","handleApproveStructure","structureId","structure","Calculator","calculateGrossSalary","allowancesTotal","allowance","variableTotal","variable","calculateDeductions","deduction","filteredStructures","open","onOpenChange","Plus","Label","htmlFor","s","Edit","sb","supabase","ActiveStaffList","externalSearchTerm","items","setItems","page","setPage","totalCount","setTotalCount","loading","setLoading","error","setError","appliedSearchTerm","useMemo","useEffect","async","from","to","query","select","count","eq","order","ascending","range","term","or","data","mapped","row","email","role","avatar","position","err","msg","String","message","lower","isAuthOrPermission","fetchActiveStaff","totalPages","max","ceil","canPrev","canNext","Search","Alert","AlertDescription","ScrollArea","Avatar","AvatarImage","src","AvatarFallback","charAt","Boolean","join","Link","User","p","ChevronLeft","min","ChevronRight","HRDashboard","analytics","setAnalytics","activeEmployees","departmentWiseCount","Sales","Operations","Finance","HR","averageSalary","totalPayrollCost","leaveUtilization","pendingPayrollApprovals","upcomingBirthdays","daysUntil","complianceAlerts","title","description","dueDate","priority","recentLeaves","setRecentLeaves","createdBy","approvalWorkflow","level","approverRole","PlusCircle","AlertTriangle","slice","Gift","birthday","alert","Object","entries","dept","Tabs","defaultValue","TabsList","TabsTrigger","TabsContent","menuItems","path","icon","LayoutDashboard","CalendarDays","Layers","FileText","ShieldCheck","UserPlus","UserMinus","HRSidebar","navigate","useNavigate","useLocation","cn","item","active","current","pathname","endsWith","startsWith","isActive","badge","HRLayout","PageLayout","hideGlobalSidebar","headerVariant","breadcrumbItems","href","Outlet","PayrollPage","LeavesPage","StaffDocsVerification","i","CheckCircle2","BankVerification","bank","last4","rec","Onboarding","Offboarding","ComplianceCenter","due","a","AgentManagement","currentUser","hasPermission","useApp","isStaff","agents","setAgents","filteredAgents","setFilteredAgents","statusFilter","setStatusFilter","sourceFilter","setSourceFilter","referralFilter","setReferralFilter","referralStaffId","setReferralStaffId","staffMembers","setStaffMembers","approvalModalOpen","setApprovalModalOpen","selectedAgent","setSelectedAgent","stats","setStats","total","inactive","pending","totalRevenue","averageRating","pageSize","setPageSize","currentPage","setCurrentPage","paginatedAgents","React","start","qrMode","setQrMode","staffIdInput","setStaffIdInput","eventCodeInput","setEventCodeInput","qrLink","setQrLink","qrSize","setQrSize","qrCanvasRef","useRef","suspendDialogOpen","setSuspendDialogOpen","suspendReason","setSuspendReason","suspendTarget","setSuspendTarget","isSuspending","setIsSuspending","canSuspend","resolveStaffNameById","member","m","getCurrentStaffId","byEmail","byName","getReferralOwnerId","raw","source_details","decoded","decodeReferralCodeToStaffId","test","match","renderSourceTypeDetails","source_type","ownerId","staffName","myId","myName","renderCreatedByLine","source","created_by","normalizeStatus","loadAgents","filterAgents","AgentManagementService","getStaffMembers","getAgents","agentData","agent","user_id","phone","performance_score","total_bookings","revenue_generated","join_date","created_at","last_active","updated_at","suspension_reason","getLocalAccessMaps","creatorMap","Map","assignedMap","rawStaffAgents","localStorage","getItem","JSON","parse","forEach","creatorId","staffId","set","assignments","Array","isArray","staffAssignments","get","Set","asgn","sid","add","rawFallback","assigned_staff","enrichedAgents","finalAgents","me","isCreator","isAssigned","has","refOwnerId","isMyReferral","creatorIds","creatorNameMap","in","getStoredStaff","isAdminOrStaffCreated","sourceLabel","details","hydratedAgents","computeBookingsAndRevenue","calculateStats","agentList","userIds","statsMap","revenue","amt","Number","total_amount","stat","rating","filtered","meId","AlertCircle","val","Sheet","SheetTrigger","QrCode","SheetContent","side","SheetHeader","SheetTitle","SheetDescription","link","getStaffReferralLink","code","publicUrl","__vite_import_meta_env__","VITE_PUBLIC_SITE_URL","VITE_SITE_URL","origin","window","replace","getSignupBase","encodeURIComponent","navigator","clipboard","writeText","canvas","document","getElementById","url","toDataURL","createElement","download","click","QRCodeCanvas","ref","includeMargin","TooltipProvider","hoverable","sticky","align","truncate","Shield","Switch","checked","onCheckedChange","newStatus","updateAgent","handleStatusChange","Tooltip","TooltipTrigger","TooltipContent","handleViewAgent","handleEditAgent","handleOpenSuspendDialog","PauseCircle","reactivateAgent","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","idForUpdate","suspendAgent","AgentApprovalModal","isOpen","onClose","onAgentUpdated","AddAgent","hasAdminAccess","useAccessControl","isSubmitting","setIsSubmitting","loadingStaff","setLoadingStaff","formErrors","setFormErrors","showCredentialsModal","setShowCredentialsModal","modalCredentials","setModalCredentials","password","autoAssignStaffId","setAutoAssignStaffId","emailExists","setEmailExists","phoneExists","setPhoneExists","existingProfile","setExistingProfile","formData","setFormData","company_name","sendMagicLinkEmail","trackLoginActivity","fetchStaffMembers","params","URLSearchParams","search","maybeSingle","validId","info","handleInputChange","field","t","setTimeout","exists","AuthService","userExistsByEmail","clearTimeout","digits","userExistsByPhone","ArrowLeft","onSubmit","preventDefault","errors","keys","validateForm","signupRequest","signupAgent","agentId","selectedStaff","primaryStaffId","primaryAssignErr","addStaffAssignmentToAgent","isPrimary","additionalStaff","secondaryAssignErr","assignFlowErr","patchAgentSettingsPreferences","security","prefsErr","magicLinkError","authHelpers","signInWithMagicLink","warning","credsData","genError","generateCredentials","creator","user_metadata","storeAgentCredentials","username","temporaryPassword","forcePasswordChange","isTemporary","createdAt","storeErr","genErr","Mail","Phone","Building","rows","staff","Checkbox","handleStaffAssignment","DialogFooter","StaffAssignmentTab","onAssignmentChange","setAssignments","isAddDialogOpen","setIsAddDialogOpen","isEditDialogOpen","setIsEditDialogOpen","currentAssignment","setCurrentAssignment","isRemoveDialogOpen","setIsRemoveDialogOpen","availableStaff","setAvailableStaff","selectedStaffId","setSelectedStaffId","setIsPrimary","setNotes","effectiveAgentId","formatDate","dateStr","format","staffRes","res","getAgentStaffAssignments","load","resetForm","Info","event","lead","referral","website","other","toUpperCase","staffMember","assignment","BadgeCheck","MapPin","assignedAt","assignedByName","assignedByRole","openEditDialog","openRemoveDialog","Trash","updateStaffAssignmentForAgent","removeStaffAssignmentFromAgent","AgentProfile","useParams","setAgent","queries","setQueries","bookings","setBookings","customers","setCustomers","recentActivity","setRecentActivity","isEditingDetails","setIsEditingDetails","detailsForm","setDetailsForm","agency_code","city","country","commission_type","commission_value","alternate_email","business_phone","mobile_numbers_text","partnership","business_address","license_number","iata_number","specializations_text","taxRecords","setTaxRecords","taxLoading","setTaxLoading","editingTax","setEditingTax","useToast","statusUpdating","setStatusUpdating","brandingFiles","setBrandingFiles","brandingLoading","setBrandingLoading","uploadingDocs","setUploadingDocs","brandingInputRef","profileImageInputRef","taxCertInputRef","certTargetRecordId","setCertTargetRecordId","uploadingTaxCert","setUploadingTaxCert","creatorProfile","setCreatorProfile","previewOpen","setPreviewOpen","previewItem","setPreviewItem","loadAgentData","client","isAdminClientConfigured","adminSupabase","agentRow","single","uiAgent","isNaN","parseInt","agency_name","business_type","commissionType","commission_structure","commissionValue","profileImage","profile_image","contact","address","joinDate","totalQueries","totalBookings","conversionRate","revenueGenerated","averageBookingValue","activeCustomers","mobile_numbers","specializations","agent_tax_info","documents","split","pop","loadBrandingFiles","agentIdNum","getQueriesByAgentId","getBookingsByAgentId","getCustomersByAgentId","getRecentActivity","getAgentById","tx","getAgentTaxInfo","storageClient","brandingBucket","brandingPrefix","storage","list","limit","offset","files","pub","getPublicUrl","formatDateTime","dateTimeStr","formatCurrency","Intl","NumberFormat","style","updateDetailsField","handleDeleteTaxCertificate","tax_certificate_url","bucket","marker","idx","indexOf","rest","firstSlash","rmErr","remove","update","alt","Globe","rel","Star","mobileNumbersArray","specializationsArray","v","step","accept","f","file","safeName","crypto","randomUUID","ext","contentType","upload","upsert","currentUrl","after","substring","key","parseErr","multiple","newUrls","fullPath","push","docRow","existingDocs","updatedDocs","updErr","Upload","filteredDocs","u","handleDeleteDocument","isPdf","agent_id","latest","tax_verified","payload","tax_country","tax_type","tax_number","pan_number","gst_number","vat_number","tax_registered","tax_notes","insert","upsertAgentTaxInfo","taxBucket","now","upErr","handleToggleTaxVerified","destination","cities","travelDates","booking","customerName","customer","bookingsCount","totalSpent","lastBookingDate","activity","index","CheckCheck","PieChart","BarChart3","agentFormSchema","z.object","z.string","mobile","agentType","z.enum","required_error","company","optional","confirmPassword","z.boolean","default","sendCredentialsEmail","countries","z.array","language","sourceType","sourceDetails","z.any","remarks","termsAgreed","refine","EditAgent","logoUrl","setLogoUrl","isGeneratingCredentials","setIsGeneratingCredentials","generatedCredentials","setGeneratedCredentials","form","useForm","resolver","zodResolver","defaultValues","watch","isMounted","reset","preferred_language","Form","handleSubmit","values","idStr","updatePayload","syncErr","syncAgentEmailAcrossAuth","credErr","setAgentCredentials","emailServerUrl","VITE_EMAIL_SERVER_URL","loginUrl","html","agentWelcomeTemplate","companyName","recipientName","actionUrl","fetch","method","headers","body","stringify","subject","json","catch","generatedPassword","generateSecurePassword","setValue","RefreshCw","FormLabel","FormField","control","render","FormItem","FormControl","FormMessage","agentEmail","getValues","FormDescription","Save","Key","Copy","AlertTitle","StaffManagement","staffData","setStaffData","mapProfileToEnhancedStaff","today","defaultPerformance","daily","tasksCompleted","responseTime","customerSatisfaction","monthly","month","totalTasks","averageResponseTime","averageCustomerSatisfaction","targetAchievement","quarterly","quarter","floor","getMonth","getFullYear","performanceRating","goalsAchieved","totalGoals","growthPercentage","overall","totalExperience","performanceScore","ranking","badges","dateOfBirth","skills","certifications","performance","targets","permissions","workingHours","monday","isWorking","tuesday","wednesday","thursday","friday","saturday","sunday","reportingManager","teamMembers","employee_id","operationalCountries","salaryStructure","leaveBalance","attendanceRecord","allStaff","loadStaffData","filteredStaff","matchesFilter","activeStaff","onLeaveStaff","inactiveStaff","getStatusBadgeVariant","UserCheck","UserX","getCountryNameById","countryId","initialCountries","c","Building2","n","supabaseError","prevData","handleStatusUpdate","delete","handleDeleteStaff","Trash2","staffSchema","validateEmployeeCode","z.date","checkUsernameUniqueness","validatePasswordStrength","isValid","mustChangePassword","AddStaff","newSkill","setNewSkill","newCertification","setNewCertification","setWorkingHours","shifts","setTargets","dobInput","setDobInput","departmentList","setDepartmentList","loadingDepartments","setLoadingDepartments","watchedEmail","watchedName","watchedDOB","selectedDeptCode","selectedDept","d","selectedDeptName","mounted","departmentService","getDepartments","addSkill","currentSkills","addCertification","currentCerts","X","newStaff","uuidv4","enquiriesHandled","conversions","totalEnquiries","clientRetentionRate","random","authUserId","syncStaffWithAuthSystem","ensureReferralExistsForStaff","staffWorkingHoursService","upsertWorkingHours","staffTargetService","replaceTargetsForStaff","EmployeeCodeField","formState","onBlur","parts","y","day","candidate","getDate","clearErrors","Popover","PopoverTrigger","PopoverContent","setDate","initialFocus","ReportingManagerSelector","label","LoginCredentials","OperationalCountriesSelector","selectedCountries","onCountriesChange","onKeyPress","skill","skillToRemove","removeSkill","cert","certToRemove","removeCertification","TargetSettings","onTargetsChange","Target","WorkingHoursSection","onWorkingHoursChange","departmentFormSchema","Departments","isAdmin","staffCounts","setStaffCounts","isDeleteDialogOpen","setIsDeleteDialogOpen","selectedDepartment","setSelectedDepartment","isAddFeatureDialogOpen","setIsAddFeatureDialogOpen","featureTargetDepartment","setFeatureTargetDepartment","newFeature","setNewFeature","enabled","config","editForm","counts","getStaffCountsByDepartment","featureCatalog","features","openAddFeatureDialog","getDepartmentStats","deptId","totalStaff","avgPerformance","createDepartment","Settings","feature","departmentId","featureId","updatedFeatures","updateDepartment","toggleFeature","removeFeatureFromDepartment","removeFeature","initializeDepartmentFeatures","initializeFeatures","colSpan","updates","pickCatalogFeature","featurePayload","addFeatureToDepartment","deleteDepartment","StaffProfile","setStaff","isStaffActive","setIsStaffActive","referralLink","setReferralLink","uploadingAvatar","setUploadingAvatar","getCountryById","useRealTimeCountriesData","managerDetails","setManagerDetails","setDocuments","docLoading","setDocLoading","docType","setDocType","docFile","setDocFile","docNotes","setDocNotes","uploadingDoc","setUploadingDoc","setBank","bankName","setBankName","accountHolderName","setAccountHolderName","accountNumber","setAccountNumber","bankCountry","setBankCountry","ifscOrSwift","setIfscOrSwift","branch","setBranch","savingBank","setSavingBank","currentRole","setCurrentRole","defaultWorkingHoursUI","uiWorkingHours","setUiWorkingHours","whLoading","setWhLoading","whTimezone","setWhTimezone","DateTimeFormat","resolvedOptions","timeZone","targetsLoading","setTargetsLoading","targetsSaving","setTargetsSaving","getCurrentSession","then","user","profileData","profileError","staffError","prof","updatedAt","staffMapped","date_of_birth","reporting_manager","operational_countries","mapStaffRowToEnhancedStaff","merged","loadStaffProfile","docs","listDocuments","withUrls","Promise","all","getSignedUrl","storagePath","signedUrl","ba","getBankAccount","loadDocsAndBank","getWorkingHoursByStaff","prepared","hours","withIds","dayData","start_time","end_time","breakStart","break_start","breakEnd","break_end","ensureShiftIds","tzRes","getTimezoneByStaff","timezone","loadWorkingHours","listTargetsByStaff","loadTargets","refreshDocuments","handleBankVerify","updateBankVerificationStatus","getDeterministicStaffReferralLink","updateReferral","getCountryName","real","fallback","dateString","rm","profErr","srow","sErr","fetchManagerDetails","checkBucketExists","Cake","Briefcase","cId","StaffStatusManager","onStatusUpdate","LoginTracker","onStatusChange","readOnly","inserted","uploadDocument","fileName","Separator","doc","docId","approveDocument","handleApproveDoc","rejectDocument","handleRejectDoc","deleteDocument","handleDeleteDoc","accountNumberLast4","verifiedStatus","updated","upsertBankAccount","next","EditStaff","showCredentials","setShowCredentials","isEmployeeCodeUnique","mergedStaffMember","staffRow","staffRowError","extra","augmentErr","convertedWorkingHours","convertLegacyWorkingHours","wh","tzErr","tg","editableStatus","loadStaff","legacyHours","convertedHours","breakTime","updatedStaff","updateStaffMember","staffErr","staffPayload","onConflict","staffSaveErr","dispatchEvent","Event","excludeId","departments","TIMEZONE_OPTIONS","opt","abbreviation","AdminManagement","filterRole","setFilterRole","adminUsers","setAdminUsers","adminRes","admins","loadAdmins","isSuperAdmin","filteredAdmins","admin","matchesRoleFilter","matchesStatusFilter","superAdminCount","managerCount","hrManagerCount","activeCount","categoryIcons","SETTING_CATEGORIES","GENERAL","SEO","BRANDING","Palette","PERMISSIONS","AUTHENTICATION","Lock","NOTIFICATIONS","Bell","PAYMENT","CreditCard","INTEGRATIONS","Plug","MAINTENANCE","Wrench","CONTENT","AppSettingsAdmin","activeTab","setActiveTab","settings","setSettings","isLoading","setIsLoading","hasChanges","setHasChanges","useIsMobile","hasAccess","accessLoading","useAppSettingsAccess","searchParams","useSearchParams","loadSettings","response","AppSettingsService","getAllSettings","category","section","documentElement","setAttribute","AppSettingsHeader","AppSettingsSidebar","Database","flat","CardDescription","Icon","GeneralSettings","SEOSettings","BrandingSettings","AuthenticationSettings","ContentSettings","IntegrationsSettings","AdminUsers","useAuth","setAdmins","loadingList","setLoadingList","creating","setCreating","setEmail","setPassword","setName","setRole","setDepartment","setPhone","canManageAdmins","keywords","created","createError","auth","createUser","email_confirm","Error","profilePayload","emailRegex","phoneRegex","CreateAdminForm","onCreated","setPosition","updateUserById","userRoleError","AdminList","onRefresh","passwords","setPasswords","updating","setUpdating","setPasswordFor","newPassword","users","listUsers","updateRes","changePassword","setStatus","AdminRoleManager","canAccessPage"],"mappings":"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"}