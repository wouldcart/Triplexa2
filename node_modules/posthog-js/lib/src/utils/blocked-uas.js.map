{"version":3,"file":"blocked-uas.js","sourceRoot":"","sources":["../../../src/utils/blocked-uas.ts"],"names":[],"mappings":";;;AAAA,0DAA0D;AAC1D,sCAA8D;AAC9D,sCAAoE;AAA3D,+GAAA,uBAAuB,OAAA;AAAE,mGAAA,WAAW,OAAA;AAmBtC,IAAM,WAAW,GAAG,UAAU,SAAgC,EAAE,uBAAiC;IACpG,IAAI,CAAC,SAAS,EAAE,CAAC;QACb,OAAO,KAAK,CAAA;IAChB,CAAC;IACD,IAAM,EAAE,GAAG,SAAS,CAAC,SAAS,CAAA;IAC9B,IAAI,EAAE,EAAE,CAAC;QACL,IAAI,IAAA,kBAAe,EAAC,EAAE,EAAE,uBAAuB,CAAC,EAAE,CAAC;YAC/C,OAAO,IAAI,CAAA;QACf,CAAC;IACL,CAAC;IACD,IAAI,CAAC;QACD,yCAAyC;QACzC,IAAM,MAAM,GAAG,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,aAAgC,CAAA;QAC1D,IACI,CAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,MAAM;YACd,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,UAAC,QAAQ,IAAK,OAAA,IAAA,kBAAe,EAAC,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,KAAK,EAAE,uBAAuB,CAAC,EAAzD,CAAyD,CAAC,EAC7F,CAAC;YACC,OAAO,IAAI,CAAA;QACf,CAAC;IACL,CAAC;IAAC,WAAM,CAAC;QACL,gEAAgE;IACpE,CAAC;IAED,OAAO,CAAC,CAAC,SAAS,CAAC,SAAS,CAAA;IAE5B,iHAAiH;IACjH,4GAA4G;IAC5G,sFAAsF;IAEtF,kHAAkH;IAClH,8GAA8G;IAC9G,4FAA4F;IAC5F,8FAA8F;AAClG,CAAC,CAAA;AAjCY,QAAA,WAAW,eAiCvB","sourcesContent":["// Re-export shared bot detection logic from @posthog/core\nimport { isBlockedUA as isBlockedUACore } from '@posthog/core'\nexport { DEFAULT_BLOCKED_UA_STRS, isBlockedUA } from '@posthog/core'\n\n// There's more in the type, but this is all we use. It's currently experimental, see\n// https://developer.mozilla.org/en-US/docs/Web/API/Navigator/userAgentData\n// if you're reading this in the future, when it's no longer experimental, please remove this type and use an official one.\n// Be extremely defensive here to ensure backwards and *forwards* compatibility, and remove this defensiveness in the\n// future when it is safe to do so.\nexport interface NavigatorUAData {\n    brands?: {\n        brand: string\n        version: string\n    }[]\n}\ndeclare global {\n    interface Navigator {\n        userAgentData?: NavigatorUAData\n    }\n}\n\nexport const isLikelyBot = function (navigator: Navigator | undefined, customBlockedUserAgents: string[]): boolean {\n    if (!navigator) {\n        return false\n    }\n    const ua = navigator.userAgent\n    if (ua) {\n        if (isBlockedUACore(ua, customBlockedUserAgents)) {\n            return true\n        }\n    }\n    try {\n        // eslint-disable-next-line compat/compat\n        const uaData = navigator?.userAgentData as NavigatorUAData\n        if (\n            uaData?.brands &&\n            uaData.brands.some((brandObj) => isBlockedUACore(brandObj?.brand, customBlockedUserAgents))\n        ) {\n            return true\n        }\n    } catch {\n        // ignore the error, we were using experimental browser features\n    }\n\n    return !!navigator.webdriver\n\n    // There's some more enhancements we could make in this area, e.g. it's possible to check if Chrome dev tools are\n    // open, which will detect some bots that are trying to mask themselves and might get past the checks above.\n    // However, this would give false positives for actual humans who have dev tools open.\n\n    // We could also use the data in navigator.userAgentData.getHighEntropyValues() to detect bots, but we should wait\n    // until this stops being experimental. The MDN docs imply that this might eventually require user permission.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/NavigatorUAData/getHighEntropyValues\n    // It would be very bad if posthog-js caused a permission prompt to appear on every page load.\n}\n"]}